import{s as fe,f as N,g as T,h as V,d as f,j as _,i as b,r as se,e as R,u as h,a as L,c as q,l as S,m as D,z as y,n as J,I as Q,v as Nt,J as be,A as ce,w as Tt,x as Ut,y as St,D as Se,M as Dt,p as $e,N as At,O as Oe,k as Ne,P as Re,Q as jt,G as ke,B as Ot,C as Pt,H as Vt,E as Te,F as Ue,R as ye,o as Bt,K as Ft,t as Ge}from"./scheduler.fede8105.js";import{h as re,u as pe}from"./await_block.ecc72e0a.js";import{e as ae}from"./each.e59479a4.js";import{S as ue,i as _e,a as v,g as Y,t as M,c as Z,b as ee,d as te,m as le,e as ne,f as Pe}from"./index.257844fa.js";import{g as x,c as ve,a as Ee}from"./context.682cab63.js";import{g as he,b as oe,a as Rt}from"./util.883c3f21.js";import{w as Ie}from"./index.3ac45322.js";import{m as Ve,u as Be,g as je,c as yt,a as wt,r as $t,n as Gt}from"./index.fdd37b7b.js";import{e as Le}from"./singletons.2de72073.js";import{a as Et,s as Lt}from"./context.fa34f1f8.js";import{G as Me}from"./GenericUserIcon.9c0f7754.js";import{d as De}from"./index.esm.4b6e8736.js";import{t as qt,P as Kt}from"./PlusIcon.3856cf8f.js";import{d as we,c as Ht}from"./calendar.5942d46b.js";import{p as zt}from"./stores.22d56d45.js";function Xt(r){const e=r.slice(),n=oe(e[14]);return e[15]=n,e}function qe(r){var s;let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:tl,then:Qt,catch:Jt,value:13,blocks:[,,,]};return re(n=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),t),{c(){e=R(),t.block.c()},l(i){e=R(),t.block.l(i)},m(i,c){b(i,e,c),t.block.m(i,t.anchor=c),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(i,c){var o;r=i,t.ctx=r,c&13&&n!==(n=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&re(n,t)||pe(t,r,c)},i(i){l||(v(t.block),l=!0)},o(i){for(let c=0;c<3;c+=1){const o=t.blocks[c];M(o)}l=!1},d(i){i&&f(e),t.block.d(i),t.token=null,t=null}}}function Jt(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Qt(r){let e,n,l,t=!r[4]["jolt:low-data-mode"]&&Ke(r),s=r[13].content!=null&&He(r);return{c(){t&&t.c(),e=L(),s&&s.c(),n=R()},l(i){t&&t.l(i),e=q(i),s&&s.l(i),n=R()},m(i,c){t&&t.m(i,c),b(i,e,c),s&&s.m(i,c),b(i,n,c),l=!0},p(i,c){i[4]["jolt:low-data-mode"]?t&&(Y(),M(t,1,1,()=>{t=null}),Z()):t?(t.p(i,c),c&16&&v(t,1)):(t=Ke(i),t.c(),v(t,1),t.m(e.parentNode,e)),i[13].content!=null?s?s.p(i,c):(s=He(i),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(i){l||(v(t),l=!0)},o(i){M(t),l=!1},d(i){i&&(f(e),f(n)),t&&t.d(i),s&&s.d(i)}}}function Ke(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:el,then:Yt,catch:Wt,value:14,blocks:[,,,]};return re(n=je(r[6].api,r[5]??r[6].api.cache.users,r[13].author),t),{c(){e=R(),t.block.c()},l(s){e=R(),t.block.l(s)},m(s,i){b(s,e,i),t.block.m(s,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(s,i){r=s,t.ctx=r,i&45&&n!==(n=je(r[6].api,r[5]??r[6].api.cache.users,r[13].author))&&re(n,t)||pe(t,r,i)},i(s){l||(v(t.block),l=!0)},o(s){for(let i=0;i<3;i+=1){const c=t.blocks[i];M(c)}l=!1},d(s){s&&f(e),t.block.d(s),t.token=null,t=null}}}function Wt(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Yt(r){let e,n,l,t;const s=[xt,Zt],i=[];function c(a,m){return a[14]!=null?0:1}function o(a,m){return m===0?Xt(a):a}return e=c(r),n=i[e]=s[e](o(r,e)),{c(){n.c(),l=R()},l(a){n.l(a),l=R()},m(a,m){i[e].m(a,m),b(a,l,m),t=!0},p(a,m){let d=e;e=c(a),e===d?i[e].p(o(a,e),m):(Y(),M(i[d],1,1,()=>{i[d]=null}),Z(),n=i[e],n?n.p(o(a,e),m):(n=i[e]=s[e](o(a,e)),n.c()),v(n,1),n.m(l.parentNode,l))},i(a){t||(v(n),t=!0)},o(a){M(n),t=!1},d(a){a&&f(l),i[e].d(a)}}}function Zt(r){let e,n,l;return e=new Me({}),{c(){ee(e.$$.fragment),n=S(`

						Unknown User`)},l(t){te(e.$$.fragment,t),n=D(t,`

						Unknown User`)},m(t,s){le(e,t,s),b(t,n,s),l=!0},p:h,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){M(e.$$.fragment,t),l=!1},d(t){t&&f(n),ne(e,t)}}}function xt(r){let e,n,l,t,s=r[15]+"",i;return{c(){e=N("img"),t=L(),i=S(s),this.h()},l(c){e=T(c,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),t=q(c),i=D(c,s),this.h()},h(){_(e,"class","cover"),Q(e.src,n=he(r[14]))||_(e,"src",n),_(e,"alt",l=r[15]),_(e,"width","24px"),_(e,"height","24px")},m(c,o){b(c,e,o),b(c,t,o),b(c,i,o)},p(c,o){o&45&&!Q(e.src,n=he(c[14]))&&_(e,"src",n),o&45&&l!==(l=c[15])&&_(e,"alt",l),o&45&&s!==(s=c[15]+"")&&J(i,s)},i:h,o:h,d(c){c&&(f(e),f(t),f(i))}}}function el(r){let e;return{c(){e=S("<Unknown User>")},l(n){e=D(n,"<Unknown User>")},m(n,l){b(n,e,l)},p:h,i:h,o:h,d(n){n&&f(e)}}}function He(r){let e,n=r[13].content+"",l;return{c(){e=N("span"),l=S(n),this.h()},l(t){e=T(t,"SPAN",{class:!0});var s=V(e);l=D(s,n),s.forEach(f),this.h()},h(){_(e,"class","message-content svelte-pdgjwp")},m(t,s){b(t,e,s),y(e,l)},p(t,s){s&13&&n!==(n=t[13].content+"")&&J(l,n)},d(t){t&&f(e)}}}function tl(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function ll(r){let e,n,l,t=r[2]!=null&&qe(r);return{c(){e=N("a"),t&&t.c(),this.h()},l(s){e=T(s,"A",{href:!0,class:!0});var i=V(e);t&&t.l(i),i.forEach(f),this.h()},h(){_(e,"href",n=Le+"/"+(r[1]==null?`channels/${r[2]}/${r[0]}`:`servers/${r[1]}/channels/${r[2]}/${r[0]}`)),_(e,"class","svelte-pdgjwp")},m(s,i){b(s,e,i),t&&t.m(e,null),l=!0},p(s,[i]){s[2]!=null?t?(t.p(s,i),i&4&&v(t,1)):(t=qe(s),t.c(),v(t,1),t.m(e,null)):t&&(Y(),M(t,1,1,()=>{t=null}),Z()),(!l||i&7&&n!==(n=Le+"/"+(s[1]==null?`channels/${s[2]}/${s[0]}`:`servers/${s[1]}/channels/${s[2]}/${s[0]}`)))&&_(e,"href",n)},i(s){l||(v(t),l=!0)},o(s){M(t),l=!1},d(s){s&&f(e),t&&t.d()}}}function nl(r,e,n){let l,t,s,i,c;const o=x(ve),a=x(Ee);se(r,a,$=>n(4,i=$));const m=x(Et);se(r,m,$=>n(1,l=$));const d=x(Lt);se(r,d,$=>n(2,t=$));const u=x(Ve);se(r,u,$=>n(3,s=$));const p=x(Be);se(r,p,$=>n(5,c=$));let{id:O}=e;const P=({_id:$})=>O==$;return r.$$set=$=>{"id"in $&&n(0,O=$.id)},[O,l,t,s,i,c,o,a,m,d,u,p,P]}class rl extends ue{constructor(e){super(),_e(this,e,nl,ll,fe,{id:0})}}function ze(r){const e=oe(r[3]);r[4]=e}function Xe(r){r[5]=r[7][0],r[6]=r[7][1]}function Je(r){const e=oe(r[3]);r[4]=e}function il(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:dl,then:fl,catch:al,value:3};return re(n=r[1].api.fetchUser(r[0].id),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){b(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&re(n,l)||pe(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function sl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:bl,then:gl,catch:pl,value:7};return re(n=Promise.all([r[0].from,r[0].to].map(r[2])),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){b(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=Promise.all([r[0].from,r[0].to].map(r[2])))&&re(n,l)||pe(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function ol(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Ul,then:vl,catch:kl,value:3};return re(n=r[1].api.fetchUser(r[0].by),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){b(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].by))&&re(n,l)||pe(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function cl(r){let e=r[0].content+"",n;return{c(){n=S(e)},l(l){n=D(l,e)},m(l,t){b(l,n,t)},p(l,t){t&1&&e!==(e=l[0].content+"")&&J(n,e)},d(l){l&&f(n)}}}function al(r){return{c:h,l:h,m:h,p:h,d:h}}function fl(r){ze(r);let e,n,l,t,s=r[4]+"",i,c,o;function a(u,p){if(u[0].type=="user_banned")return ml;if(u[0].type=="user_joined")return hl;if(u[0].type=="user_kicked")return _l;if(u[0].type=="user_left")return ul}let m=a(r),d=m&&m(r);return{c(){e=N("img"),t=L(),i=S(s),c=L(),d&&d.c(),o=R(),this.h()},l(u){e=T(u,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=q(u),i=D(u,s),c=q(u),d&&d.l(u),o=R(),this.h()},h(){_(e,"class","cover"),Q(e.src,n=he(r[3]))||_(e,"src",n),_(e,"width","24px"),_(e,"height","24px"),_(e,"alt",l=r[4])},m(u,p){b(u,e,p),b(u,t,p),b(u,i,p),b(u,c,p),d&&d.m(u,p),b(u,o,p)},p(u,p){ze(u),p&1&&!Q(e.src,n=he(u[3]))&&_(e,"src",n),p&1&&l!==(l=u[4])&&_(e,"alt",l),p&1&&s!==(s=u[4]+"")&&J(i,s),m!==(m=a(u))&&(d&&d.d(1),d=m&&m(u),d&&(d.c(),d.m(o.parentNode,o)))},d(u){u&&(f(e),f(t),f(i),f(c),f(o)),d&&d.d(u)}}}function ul(r){let e;return{c(){e=S("left the chat.")},l(n){e=D(n,"left the chat.")},m(n,l){b(n,e,l)},d(n){n&&f(e)}}}function _l(r){let e;return{c(){e=S("was kicked.")},l(n){e=D(n,"was kicked.")},m(n,l){b(n,e,l)},d(n){n&&f(e)}}}function hl(r){let e;return{c(){e=S("has joined the chat.")},l(n){e=D(n,"has joined the chat.")},m(n,l){b(n,e,l)},d(n){n&&f(e)}}}function ml(r){let e;return{c(){e=S("was banned.")},l(n){e=D(n,"was banned.")},m(n,l){b(n,e,l)},d(n){n&&f(e)}}}function dl(r){return{c:h,l:h,m:h,p:h,d:h}}function pl(r){return{c:h,l:h,m:h,p:h,d:h}}function gl(r){Xe(r);let e,n=oe(r[5])+"",l,t,s=oe(r[6])+"",i,c;return{c(){e=S("Channel ownership changed from "),l=S(n),t=S(" to "),i=S(s),c=S(".")},l(o){e=D(o,"Channel ownership changed from "),l=D(o,n),t=D(o," to "),i=D(o,s),c=D(o,".")},m(o,a){b(o,e,a),b(o,l,a),b(o,t,a),b(o,i,a),b(o,c,a)},p(o,a){Xe(o),a&1&&n!==(n=oe(o[5])+"")&&J(l,n),a&1&&s!==(s=oe(o[6])+"")&&J(i,s)},d(o){o&&(f(e),f(l),f(t),f(i),f(c))}}}function bl(r){return{c:h,l:h,m:h,p:h,d:h}}function kl(r){return{c:h,l:h,m:h,p:h,d:h}}function vl(r){Je(r);let e,n,l,t,s=r[4]+"",i,c,o;function a(u,p){if(u[0].type=="channel_description_changed")return El;if(u[0].type=="channel_icon_changed")return $l;if(u[0].type=="channel_renamed")return wl;if(u[0].type=="user_added"||u[0].type=="user_remove")return yl}let m=a(r),d=m&&m(r);return{c(){e=N("img"),t=L(),i=S(s),c=L(),d&&d.c(),o=R(),this.h()},l(u){e=T(u,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=q(u),i=D(u,s),c=q(u),d&&d.l(u),o=R(),this.h()},h(){_(e,"class","cover"),Q(e.src,n=he(r[3]))||_(e,"src",n),_(e,"width","24px"),_(e,"height","24px"),_(e,"alt",l=r[4])},m(u,p){b(u,e,p),b(u,t,p),b(u,i,p),b(u,c,p),d&&d.m(u,p),b(u,o,p)},p(u,p){Je(u),p&1&&!Q(e.src,n=he(u[3]))&&_(e,"src",n),p&1&&l!==(l=u[4])&&_(e,"alt",l),p&1&&s!==(s=u[4]+"")&&J(i,s),m===(m=a(u))&&d?d.p(u,p):(d&&d.d(1),d=m&&m(u),d&&(d.c(),d.m(o.parentNode,o)))},d(u){u&&(f(e),f(t),f(i),f(c),f(o)),d&&d.d(u)}}}function yl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Tl,then:Cl,catch:Ml,value:3};return re(n=r[1].api.fetchUser(r[0].id),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){b(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&re(n,l)||pe(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function wl(r){let e,n=r[0].name+"",l,t;return{c(){e=S("renamed this channel to "),l=S(n),t=S(".")},l(s){e=D(s,"renamed this channel to "),l=D(s,n),t=D(s,".")},m(s,i){b(s,e,i),b(s,l,i),b(s,t,i)},p(s,i){i&1&&n!==(n=s[0].name+"")&&J(l,n)},d(s){s&&(f(e),f(l),f(t))}}}function $l(r){let e;return{c(){e=S("changes this channel icon.")},l(n){e=D(n,"changes this channel icon.")},m(n,l){b(n,e,l)},p:h,d(n){n&&f(e)}}}function El(r){let e;return{c(){e=S("changed this channel's description.")},l(n){e=D(n,"changed this channel's description.")},m(n,l){b(n,e,l)},p:h,d(n){n&&f(e)}}}function Ml(r){return{c:h,l:h,m:h,p:h,d:h}}function Cl(r){let e,n=oe(r[3])+"",l,t;function s(o,a){if(o[0].type=="user_added")return Nl;if(o[0].type=="user_remove")return Il}let i=s(r),c=i&&i(r);return{c(){c&&c.c(),e=L(),l=S(n),t=S(".")},l(o){c&&c.l(o),e=q(o),l=D(o,n),t=D(o,".")},m(o,a){c&&c.m(o,a),b(o,e,a),b(o,l,a),b(o,t,a)},p(o,a){i!==(i=s(o))&&(c&&c.d(1),c=i&&i(o),c&&(c.c(),c.m(e.parentNode,e))),a&1&&n!==(n=oe(o[3])+"")&&J(l,n)},d(o){o&&(f(e),f(l),f(t)),c&&c.d(o)}}}function Il(r){let e;return{c(){e=S("removed")},l(n){e=D(n,"removed")},m(n,l){b(n,e,l)},d(n){n&&f(e)}}}function Nl(r){let e;return{c(){e=S("added")},l(n){e=D(n,"added")},m(n,l){b(n,e,l)},d(n){n&&f(e)}}}function Tl(r){return{c:h,l:h,m:h,p:h,d:h}}function Ul(r){return{c:h,l:h,m:h,p:h,d:h}}function Sl(r){let e;function n(s,i){if(s[0].type=="text")return cl;if(s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove")return ol;if(s[0].type=="channel_ownership_changed")return sl;if(s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left")return il}let l=n(r),t=l&&l(r);return{c(){e=N("span"),t&&t.c(),this.h()},l(s){e=T(s,"SPAN",{class:!0});var i=V(e);t&&t.l(i),i.forEach(f),this.h()},h(){_(e,"class","container svelte-qj8q6t")},m(s,i){b(s,e,i),t&&t.m(e,null)},p(s,[i]){l===(l=n(s))&&t?t.p(s,i):(t&&t.d(1),t=l&&l(s),t&&(t.c(),t.m(e,null)))},i:h,o:h,d(s){s&&f(e),t&&t.d()}}}function Dl(r,e,n){const l=x(ve);let{system:t}=e;const s=i=>l.api.fetchUser(i);return r.$$set=i=>{"system"in i&&n(0,t=i.system)},[t,l,s]}class Al extends ue{constructor(e){super(),_e(this,e,Dl,Sl,fe,{system:0})}}function jl(r){let e,n,l,t,s,i,c,o="Ok",a,m,d="Cancel",u,p,O;const P=r[3].default,$=Nt(P,r,r[2],null);return{c(){e=N("dialog"),n=N("div"),$&&$.c(),l=L(),t=N("hr"),s=L(),i=N("form"),c=N("button"),c.textContent=o,a=L(),m=N("button"),m.textContent=d,this.h()},l(k){e=T(k,"DIALOG",{});var I=V(e);n=T(I,"DIV",{});var C=V(n);$&&$.l(C),l=q(C),t=T(C,"HR",{}),s=q(C),i=T(C,"FORM",{id:!0,method:!0});var w=V(i);c=T(w,"BUTTON",{type:!0,"data-svelte-h":!0}),be(c)!=="svelte-fdbbw9"&&(c.textContent=o),a=q(w),m=T(w,"BUTTON",{type:!0,"data-svelte-h":!0}),be(m)!=="svelte-1gqjcfl"&&(m.textContent=d),w.forEach(f),C.forEach(f),I.forEach(f),this.h()},h(){_(c,"type","submit"),_(m,"type","reset"),_(i,"id","modal-form"),_(i,"method","dialog")},m(k,I){b(k,e,I),y(e,n),$&&$.m(n,null),y(n,l),y(n,t),y(n,s),y(n,i),y(i,c),y(i,a),y(i,m),r[6](e),u=!0,p||(O=[ce(m,"click",r[5]),ce(i,"submit",r[4]),ce(e,"close",r[7])],p=!0)},p(k,[I]){$&&$.p&&(!u||I&4)&&Tt($,P,k,k[2],u?St(P,k[2],I,null):Ut(k[2]),null)},i(k){u||(v($,k),u=!0)},o(k){M($,k),u=!1},d(k){k&&f(e),$&&$.d(k),r[6](null),p=!1,Se(O)}}}function Ol(r,e,n){let{$$slots:l={},$$scope:t}=e,{showModal:s}=e,i;function c(d){Dt.call(this,r,d)}const o=()=>n(0,s=!1);function a(d){$e[d?"unshift":"push"](()=>{i=d,n(1,i)})}const m=()=>n(0,s=!1);return r.$$set=d=>{"showModal"in d&&n(0,s=d.showModal),"$$scope"in d&&n(2,t=d.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(s?i==null||i.showModal():i==null||i.close())},[s,i,t,l,c,o,a,m]}class Pl extends ue{constructor(e){super(),_e(this,e,Ol,jl,fe,{showModal:0})}}function Vl(r){let e,n="External Link",l,t,s,i,c="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=N("h1"),e.textContent=n,l=L(),t=N("hr"),s=L(),i=N("p"),i.textContent=c,this.h()},l(o){e=T(o,"H1",{class:!0,"data-svelte-h":!0}),be(e)!=="svelte-qkxu7n"&&(e.textContent=n),l=q(o),t=T(o,"HR",{}),s=q(o),i=T(o,"P",{"data-svelte-h":!0}),be(i)!=="svelte-os1rtp"&&(i.textContent=c),this.h()},h(){_(e,"class","text-3xl")},m(o,a){b(o,e,a),b(o,l,a),b(o,t,a),b(o,s,a),b(o,i,a)},p:h,d(o){o&&(f(e),f(l),f(t),f(s),f(i))}}}function Bl(r){let e,n,l,t,s,i,c,o;function a(d){r[2](d)}let m={$$slots:{default:[Vl]},$$scope:{ctx:r}};return r[1]!==void 0&&(m.showModal=r[1]),e=new Pl({props:m}),$e.push(()=>Pe(e,"showModal",a)),e.$on("submit",r[3]),{c(){ee(e.$$.fragment),l=L(),t=N("a"),s=S(r[0]),this.h()},l(d){te(e.$$.fragment,d),l=q(d),t=T(d,"A",{href:!0,target:!0,rel:!0});var u=V(t);s=D(u,r[0]),u.forEach(f),this.h()},h(){_(t,"href",r[0]),_(t,"target","_blank"),_(t,"rel","noreferrer")},m(d,u){le(e,d,u),b(d,l,u),b(d,t,u),y(t,s),i=!0,c||(o=ce(t,"click",At(r[4])),c=!0)},p(d,[u]){const p={};u&32&&(p.$$scope={dirty:u,ctx:d}),!n&&u&2&&(n=!0,p.showModal=d[1],Oe(()=>n=!1)),e.$set(p),(!i||u&1)&&J(s,d[0]),(!i||u&1)&&_(t,"href",d[0])},i(d){i||(v(e.$$.fragment,d),i=!0)},o(d){M(e.$$.fragment,d),i=!1},d(d){d&&(f(l),f(t)),ne(e,d),c=!1,o()}}}function Fl(r,e,n){let{href:l}=e,t=!1;function s(o){t=o,n(1,t)}const i=()=>window.open(l),c=()=>n(1,t=!0);return r.$$set=o=>{"href"in o&&n(0,l=o.href)},[l,t,s,i,c]}class Fe extends ue{constructor(e){super(),_e(this,e,Fl,Bl,fe,{href:0})}}function Rl(r){let e,n,l,t;const s=[zl,Hl],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=R()},l(o){n.l(o),l=R()},m(o,a){i[e].m(o,a),b(o,l,a),t=!0},p(o,a){let m=e;e=c(o),e===m?i[e].p(o,a):(Y(),M(i[m],1,1,()=>{i[m]=null}),Z(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(l.parentNode,l))},i(o){t||(v(n),t=!0)},o(o){M(n),t=!1},d(o){o&&f(l),i[e].d(o)}}}function Gl(r){let e,n,l=r[0].filename+"",t,s,i,c;return i=new Fe({props:{href:r[1]}}),{c(){e=N("span"),n=S("[File "),t=S(l),s=S(`]
			`),ee(i.$$.fragment),this.h()},l(o){e=T(o,"SPAN",{class:!0});var a=V(e);n=D(a,"[File "),t=D(a,l),s=D(a,`]
			`),te(i.$$.fragment,a),a.forEach(f),this.h()},h(){_(e,"class","text-gray-500")},m(o,a){b(o,e,a),y(e,n),y(e,t),y(e,s),le(i,e,null),c=!0},p(o,a){(!c||a&1)&&l!==(l=o[0].filename+"")&&J(t,l);const m={};a&2&&(m.href=o[1]),i.$set(m)},i(o){c||(v(i.$$.fragment,o),c=!0)},o(o){M(i.$$.fragment,o),c=!1},d(o){o&&f(e),ne(i)}}}function Ll(r){let e,n,l;return{c(){e=N("audio"),n=N("source"),this.h()},l(t){e=T(t,"AUDIO",{});var s=V(e);n=T(s,"SOURCE",{src:!0}),s.forEach(f),this.h()},h(){Q(n.src,l=r[1])||_(n,"src",l),e.controls=!0},m(t,s){b(t,e,s),y(e,n)},p(t,s){s&2&&!Q(n.src,l=t[1])&&_(n,"src",l)},i:h,o:h,d(t){t&&f(e)}}}function ql(r){let e,n,l;return{c(){e=N("video"),n=N("source"),this.h()},l(t){e=T(t,"VIDEO",{class:!0});var s=V(e);n=T(s,"SOURCE",{src:!0}),s.forEach(f),this.h()},h(){Q(n.src,l=r[1])||_(n,"src",l),e.controls=!0,_(e,"class","svelte-m38imf")},m(t,s){b(t,e,s),y(e,n)},p(t,s){s&2&&!Q(n.src,l=t[1])&&_(n,"src",l)},i:h,o:h,d(t){t&&f(e)}}}function Kl(r){let e,n,l,t;const s=[en,xl],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=R()},l(o){n.l(o),l=R()},m(o,a){i[e].m(o,a),b(o,l,a),t=!0},p(o,a){let m=e;e=c(o),e===m?i[e].p(o,a):(Y(),M(i[m],1,1,()=>{i[m]=null}),Z(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(l.parentNode,l))},i(o){t||(v(n),t=!0)},o(o){M(n),t=!1},d(o){o&&f(l),i[e].d(o)}}}function Hl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!0,pending:Zl,then:Jl,catch:Xl,value:4,error:6};return re(n=fetch(r[1]),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){b(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&2&&n!==(n=fetch(r[1]))&&re(n,l)||pe(l,r,s)},i:h,o:h,d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function zl(r){let e,n,l,t,s;return l=new Fe({props:{href:r[1]}}),{c(){e=N("span"),n=S("[Text "),ee(l.$$.fragment),t=S("]"),this.h()},l(i){e=T(i,"SPAN",{class:!0});var c=V(e);n=D(c,"[Text "),te(l.$$.fragment,c),t=D(c,"]"),c.forEach(f),this.h()},h(){_(e,"class","text-gray-500")},m(i,c){b(i,e,c),y(e,n),le(l,e,null),y(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),l.$set(o)},i(i){s||(v(l.$$.fragment,i),s=!0)},o(i){M(l.$$.fragment,i),s=!1},d(i){i&&f(e),ne(l)}}}function Xl(r){let e,n,l=r[0].filename+"",t,s,i=r[6]+"",c;return{c(){e=N("p"),n=S("Unable to download "),t=S(l),s=S(": "),c=S(i)},l(o){e=T(o,"P",{});var a=V(e);n=D(a,"Unable to download "),t=D(a,l),s=D(a,": "),c=D(a,i),a.forEach(f)},m(o,a){b(o,e,a),y(e,n),y(e,t),y(e,s),y(e,c)},p(o,a){a&1&&l!==(l=o[0].filename+"")&&J(t,l),a&2&&i!==(i=o[6]+"")&&J(c,i)},d(o){o&&f(e)}}}function Jl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Yl,then:Wl,catch:Ql,value:5};return re(n=r[4].text(),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){b(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&2&&n!==(n=r[4].text())&&re(n,l)||pe(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function Ql(r){return{c:h,l:h,m:h,p:h,d:h}}function Wl(r){let e,n=r[5]+"",l;return{c(){e=N("p"),l=S(n)},l(t){e=T(t,"P",{});var s=V(e);l=D(s,n),s.forEach(f)},m(t,s){b(t,e,s),y(e,l)},p(t,s){s&2&&n!==(n=t[5]+"")&&J(l,n)},d(t){t&&f(e)}}}function Yl(r){return{c:h,l:h,m:h,p:h,d:h}}function Zl(r){return{c:h,l:h,m:h,p:h,d:h}}function xl(r){let e,n,l;return{c(){e=N("img"),this.h()},l(t){e=T(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Q(e.src,n=r[1])||_(e,"src",n),_(e,"alt",l=r[0].filename),_(e,"class","max-w-xl max-h-xl svelte-m38imf")},m(t,s){b(t,e,s)},p(t,s){s&2&&!Q(e.src,n=t[1])&&_(e,"src",n),s&1&&l!==(l=t[0].filename)&&_(e,"alt",l)},i:h,o:h,d(t){t&&f(e)}}}function en(r){let e,n,l,t,s;return l=new Fe({props:{href:r[1]}}),{c(){e=N("span"),n=S("[Image "),ee(l.$$.fragment),t=S("]"),this.h()},l(i){e=T(i,"SPAN",{class:!0});var c=V(e);n=D(c,"[Image "),te(l.$$.fragment,c),t=D(c,"]"),c.forEach(f),this.h()},h(){_(e,"class","text-gray-500")},m(i,c){b(i,e,c),y(e,n),le(l,e,null),y(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),l.$set(o)},i(i){s||(v(l.$$.fragment,i),s=!0)},o(i){M(l.$$.fragment,i),s=!1},d(i){i&&f(e),ne(l)}}}function tn(r){let e,n,l,t;const s=[Kl,ql,Ll,Gl,Rl],i=[];function c(o,a){return o[0].metadata.type=="Image"?0:o[0].metadata.type=="Video"?1:o[0].metadata.type=="Audio"?2:o[0].metadata.type=="File"?3:o[0].metadata.type=="Text"?4:-1}return~(n=c(r))&&(l=i[n]=s[n](r)),{c(){e=N("div"),l&&l.c()},l(o){e=T(o,"DIV",{});var a=V(e);l&&l.l(a),a.forEach(f)},m(o,a){b(o,e,a),~n&&i[n].m(e,null),t=!0},p(o,[a]){let m=n;n=c(o),n===m?~n&&i[n].p(o,a):(l&&(Y(),M(i[m],1,1,()=>{i[m]=null}),Z()),~n?(l=i[n],l?l.p(o,a):(l=i[n]=s[n](o),l.c()),v(l,1),l.m(e,null)):l=null)},i(o){t||(v(l),t=!0)},o(o){M(l),t=!1},d(o){o&&f(e),~n&&i[n].d()}}}function ln(r,e,n){let l,t;const s=x(Ee);se(r,s,c=>n(2,t=c));let{attachment:i}=e;return r.$$set=c=>{"attachment"in c&&n(0,i=c.attachment)},r.$$.update=()=>{r.$$.dirty&1&&n(1,l=Rt(i))},[i,l,t,s]}class nn extends ue{constructor(e){super(),_e(this,e,ln,tn,fe,{attachment:0})}}function rn(r){let e,n="oop website embed, can't handle that :(";return{c(){e=N("span"),e.textContent=n,this.h()},l(l){e=T(l,"SPAN",{style:!0,"data-svelte-h":!0}),be(e)!=="svelte-rjpnkw"&&(e.textContent=n),this.h()},h(){Ne(e,"color","var(--secondary-foreground)")},m(l,t){b(l,e,t)},p:h,d(l){l&&f(e)}}}function sn(r){let e,n,l,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&Qe(r),s=r[0].title&&We(r),i=r[0].description&&Ye(r);return{c(){e=N("div"),t&&t.c(),n=L(),s&&s.c(),l=L(),i&&i.c(),this.h()},l(c){e=T(c,"DIV",{class:!0,style:!0});var o=V(e);t&&t.l(o),n=q(o),s&&s.l(o),l=q(o),i&&i.l(o),o.forEach(f),this.h()},h(){_(e,"class","text-embed svelte-ppm433"),Ne(e,"border-left","solid "+r[0].colour)},m(c,o){b(c,e,o),t&&t.m(e,null),y(e,n),s&&s.m(e,null),y(e,l),i&&i.m(e,null)},p(c,o){c[0].icon_url&&!c[1]["jolt:low-data-mode"]?t?t.p(c,o):(t=Qe(c),t.c(),t.m(e,n)):t&&(t.d(1),t=null),c[0].title?s?s.p(c,o):(s=We(c),s.c(),s.m(e,l)):s&&(s.d(1),s=null),c[0].description?i?i.p(c,o):(i=Ye(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null),o&1&&Ne(e,"border-left","solid "+c[0].colour)},d(c){c&&f(e),t&&t.d(),s&&s.d(),i&&i.d()}}}function on(r){let e,n,l,t,s;return{c(){e=N("video"),n=N("source"),this.h()},l(i){e=T(i,"VIDEO",{class:!0});var c=V(e);n=T(c,"SOURCE",{src:!0,width:!0,height:!0}),c.forEach(f),this.h()},h(){Q(n.src,l=r[0].url)||_(n,"src",l),_(n,"width",t=r[0].width),_(n,"height",s=r[0].height),e.controls=!0,_(e,"class","svelte-ppm433")},m(i,c){b(i,e,c),y(e,n)},p(i,c){c&1&&!Q(n.src,l=i[0].url)&&_(n,"src",l),c&1&&t!==(t=i[0].width)&&_(n,"width",t),c&1&&s!==(s=i[0].height)&&_(n,"height",s)},d(i){i&&f(e)}}}function cn(r){let e,n,l,t;return{c(){e=N("img"),this.h()},l(s){e=T(s,"IMG",{src:!0,width:!0,height:!0,class:!0}),this.h()},h(){Q(e.src,n=r[0].url)||_(e,"src",n),_(e,"width",l=r[0].width),_(e,"height",t=r[0].height),_(e,"class","svelte-ppm433")},m(s,i){b(s,e,i)},p(s,i){i&1&&!Q(e.src,n=s[0].url)&&_(e,"src",n),i&1&&l!==(l=s[0].width)&&_(e,"width",l),i&1&&t!==(t=s[0].height)&&_(e,"height",t)},d(s){s&&f(e)}}}function Qe(r){let e,n,l;return{c(){e=N("img"),this.h()},l(t){e=T(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){Q(e.src,n=r[0].icon_url)||_(e,"src",n),_(e,"alt",l=r[0].title),_(e,"width","24"),_(e,"height","24"),_(e,"class","svelte-ppm433")},m(t,s){b(t,e,s)},p(t,s){s&1&&!Q(e.src,n=t[0].icon_url)&&_(e,"src",n),s&1&&l!==(l=t[0].title)&&_(e,"alt",l)},d(t){t&&f(e)}}}function We(r){let e,n=r[0].title+"",l;return{c(){e=N("h1"),l=S(n)},l(t){e=T(t,"H1",{});var s=V(e);l=D(s,n),s.forEach(f)},m(t,s){b(t,e,s),y(e,l)},p(t,s){s&1&&n!==(n=t[0].title+"")&&J(l,n)},d(t){t&&f(e)}}}function Ye(r){let e,n=r[0].description+"",l;return{c(){e=N("p"),l=S(n)},l(t){e=T(t,"P",{});var s=V(e);l=D(s,n),s.forEach(f)},m(t,s){b(t,e,s),y(e,l)},p(t,s){s&1&&n!==(n=t[0].description+"")&&J(l,n)},d(t){t&&f(e)}}}function an(r){let e;function n(s,i){if(s[0].type=="Image"&&!s[1]["jolt:low-data-mode"])return cn;if(s[0].type=="Video"&&!s[1]["jolt:low-data-mode"])return on;if(s[0].type=="Text")return sn;if(s[0].type=="Website")return rn}let l=n(r),t=l&&l(r);return{c(){t&&t.c(),e=R()},l(s){t&&t.l(s),e=R()},m(s,i){t&&t.m(s,i),b(s,e,i)},p(s,[i]){l===(l=n(s))&&t?t.p(s,i):(t&&t.d(1),t=l&&l(s),t&&(t.c(),t.m(e.parentNode,e)))},i:h,o:h,d(s){s&&f(e),t&&t.d(s)}}}function fn(r,e,n){let l,{embed:t}=e;const s=x(Ee);return se(r,s,i=>n(1,l=i)),r.$$set=i=>{"embed"in i&&n(0,t=i.embed)},[t,l,s]}class un extends ue{constructor(e){super(),_e(this,e,fn,an,fe,{embed:0})}}function _n(r){let e,n,l;return{c(){e=N("textarea"),this.h()},l(t){e=T(t,"TEXTAREA",{maxlength:!0,placeholder:!0,class:!0}),V(e).forEach(f),this.h()},h(){_(e,"maxlength","2000"),_(e,"placeholder",r[1]),_(e,"class","svelte-kqfcqt")},m(t,s){b(t,e,s),Re(e,r[0]),n||(l=[ce(e,"blur",r[3]),ce(e,"input",r[4]),ce(e,"keydown",r[6]),ce(e,"input",r[7])],n=!0)},p(t,[s]){s&2&&_(e,"placeholder",t[1]),s&1&&Re(e,t[0])},i:h,o:h,d(t){t&&f(e),n=!1,Se(l)}}}function hn(r,e,n){const l=x(ve),t=x(yt);let{placeholder:s=void 0}=e,{value:i=""}=e,{sendTypingEvents:c}=e;const o=jt();function a(){c&&l.websocket.send({type:"EndTyping",channel:t._id})}function m(){if(c){if(i==""){l.websocket.send({type:"EndTyping",channel:t._id});return}l.websocket.send({type:"BeginTyping",channel:t._id})}}const d=p=>{var O;o("keydown",p),!(p.shiftKey||p.key!="Enter")&&(p.preventDefault(),(O=p.currentTarget.form)==null||O.requestSubmit())};function u(){i=this.value,n(0,i)}return r.$$set=p=>{"placeholder"in p&&n(1,s=p.placeholder),"value"in p&&n(0,i=p.value),"sendTypingEvents"in p&&n(5,c=p.sendTypingEvents)},[i,s,o,a,m,c,d,u]}class Mt extends ue{constructor(e){super(),_e(this,e,hn,_n,fe,{placeholder:1,value:0,sendTypingEvents:5})}}function Ze(r,e,n){const l=r.slice();return l[22]=e[n],l}function xe(r,e,n){const l=r.slice();return l[25]=e[n],l}function Ae(r){const e=r.slice(),n=new Date(e[0].edited);return e[6]=n,e}function mn(r){const e=r.slice(),n=he(e[1],e[2],e[0]);return e[28]=n,e}function et(r,e,n){const l=r.slice();return l[29]=e[n],l}function tt(r){let e,n,l=ae(r[0].replies),t=[];for(let i=0;i<l.length;i+=1)t[i]=lt(et(r,l,i));const s=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){e=N("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=T(i,"DIV",{class:!0});var c=V(e);for(let o=0;o<t.length;o+=1)t[o].l(c);c.forEach(f),this.h()},h(){_(e,"class","replies svelte-wy25lb")},m(i,c){b(i,e,c);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null);n=!0},p(i,c){if(c[0]&1){l=ae(i[0].replies);let o;for(o=0;o<l.length;o+=1){const a=et(i,l,o);t[o]?(t[o].p(a,c),v(t[o],1)):(t[o]=lt(a),t[o].c(),v(t[o],1),t[o].m(e,null))}for(Y(),o=l.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)v(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)M(t[c]);n=!1},d(i){i&&f(e),ke(t,i)}}}function lt(r){let e,n;return e=new rl({props:{id:r[29]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.id=l[29]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function nt(r){let e,n,l,t,s,i,c,o=we(r[6]).calendar()+"",a,m,d;const u=[pn,dn],p=[];function O(k,I){return k[5]["jolt:low-data-mode"]||k[1]==null?0:1}function P(k,I){return I===1?mn(k):k}n=O(r),l=p[n]=u[n](P(r,n));let $=r[0].edited!=null&&rt(Ae(r));return{c(){e=N("div"),l.c(),t=L(),s=S(r[4]),i=L(),c=N("p"),a=S(o),m=L(),$&&$.c(),this.h()},l(k){e=T(k,"DIV",{class:!0});var I=V(e);l.l(I),t=q(I),s=D(I,r[4]),i=q(I),c=T(I,"P",{class:!0});var C=V(c);a=D(C,o),m=q(C),$&&$.l(C),C.forEach(f),I.forEach(f),this.h()},h(){_(c,"class","timestamp svelte-wy25lb"),_(e,"class","user-detail svelte-wy25lb")},m(k,I){b(k,e,I),p[n].m(e,null),y(e,t),y(e,s),y(e,i),y(e,c),y(c,a),y(c,m),$&&$.m(c,null),d=!0},p(k,I){let C=n;n=O(k),n===C?p[n].p(P(k,n),I):(Y(),M(p[C],1,1,()=>{p[C]=null}),Z(),l=p[n],l?l.p(P(k,n),I):(l=p[n]=u[n](P(k,n)),l.c()),v(l,1),l.m(e,t)),(!d||I[0]&16)&&J(s,k[4]),(!d||I[0]&64)&&o!==(o=we(k[6]).calendar()+"")&&J(a,o),k[0].edited!=null?$?$.p(Ae(k),I):($=rt(Ae(k)),$.c(),$.m(c,null)):$&&($.d(1),$=null)},i(k){d||(v(l),d=!0)},o(k){M(l),d=!1},d(k){k&&f(e),p[n].d(),$&&$.d()}}}function dn(r){let e,n,l,t;const s=[bn,gn],i=[];function c(o,a){return o[28]==null?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=R()},l(o){n.l(o),l=R()},m(o,a){i[e].m(o,a),b(o,l,a),t=!0},p(o,a){let m=e;e=c(o),e===m?i[e].p(o,a):(Y(),M(i[m],1,1,()=>{i[m]=null}),Z(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(l.parentNode,l))},i(o){t||(v(n),t=!0)},o(o){M(n),t=!1},d(o){o&&f(l),i[e].d(o)}}}function pn(r){let e,n;return e=new Me({}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p:h,i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function gn(r){let e,n;return{c(){e=N("img"),this.h()},l(l){e=T(l,"IMG",{class:!0,alt:!0,src:!0,width:!0,height:!0}),this.h()},h(){_(e,"class","cover"),_(e,"alt",r[4]),Q(e.src,n=r[28])||_(e,"src",n),_(e,"width","40px"),_(e,"height","40px")},m(l,t){b(l,e,t)},p(l,t){t[0]&16&&_(e,"alt",l[4]),t[0]&7&&!Q(e.src,n=l[28])&&_(e,"src",n)},i:h,o:h,d(l){l&&f(e)}}}function bn(r){let e,n;return e=new Me({}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p:h,i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function rt(r){let e,n="(edited)",l,t,s;return{c(){e=N("span"),e.textContent=n,this.h()},l(i){e=T(i,"SPAN",{class:!0,"data-svelte-h":!0}),be(e)!=="svelte-1c19xdw"&&(e.textContent=n),this.h()},h(){_(e,"class","timestamp svelte-wy25lb")},m(i,c){b(i,e,c),t||(s=Ot(l=qt.call(null,e,{placement:"top",content:we(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away-subtle",duration:100})),t=!0)},p(i,c){r=i,l&&Pt(l.update)&&c[0]&1&&l.update.call(null,{placement:"top",content:we(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away-subtle",duration:100})},d(i){i&&f(e),t=!1,s()}}}function kn(r){let e,n=r[0].content+"",l;return{c(){e=N("span"),l=S(n),this.h()},l(t){e=T(t,"SPAN",{class:!0});var s=V(e);l=D(s,n),s.forEach(f),this.h()},h(){_(e,"class","message-content svelte-wy25lb")},m(t,s){b(t,e,s),y(e,l)},p(t,s){s[0]&1&&n!==(n=t[0].content+"")&&J(l,n)},i:h,o:h,d(t){t&&f(e)}}}function vn(r){let e,n,l,t,s,i;function c(a){r[16](a)}let o={placeholder:"Edit this message",sendTypingEvents:!1};return r[3]!==void 0&&(o.value=r[3]),n=new Mt({props:o}),$e.push(()=>Pe(n,"value",c)),n.$on("keydown",r[17]),{c(){e=N("form"),ee(n.$$.fragment),this.h()},l(a){e=T(a,"FORM",{id:!0,class:!0});var m=V(e);te(n.$$.fragment,m),m.forEach(f),this.h()},h(){_(e,"id","message-edit-form"),_(e,"class","message-form")},m(a,m){b(a,e,m),le(n,e,null),t=!0,s||(i=ce(e,"submit",r[11]),s=!0)},p(a,m){const d={};!l&&m[0]&8&&(l=!0,d.value=a[3],Oe(()=>l=!1)),n.$set(d)},i(a){t||(v(n.$$.fragment,a),t=!0)},o(a){M(n.$$.fragment,a),t=!1},d(a){a&&f(e),ne(n),s=!1,i()}}}function it(r){let e,n;return e=new Al({props:{system:r[0].system}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.system=l[0].system),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function st(r){let e,n,l=ae(r[0].attachments),t=[];for(let i=0;i<l.length;i+=1)t[i]=ot(xe(r,l,i));const s=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=R()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=R()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);b(i,e,c),n=!0},p(i,c){if(c[0]&1){l=ae(i[0].attachments);let o;for(o=0;o<l.length;o+=1){const a=xe(i,l,o);t[o]?(t[o].p(a,c),v(t[o],1)):(t[o]=ot(a),t[o].c(),v(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=l.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)v(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)M(t[c]);n=!1},d(i){i&&f(e),ke(t,i)}}}function ot(r){let e,n;return e=new nn({props:{attachment:r[25]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.attachment=l[25]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function ct(r){let e,n,l=ae(r[0].embeds),t=[];for(let i=0;i<l.length;i+=1)t[i]=at(Ze(r,l,i));const s=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=R()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=R()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);b(i,e,c),n=!0},p(i,c){if(c[0]&1){l=ae(i[0].embeds);let o;for(o=0;o<l.length;o+=1){const a=Ze(i,l,o);t[o]?(t[o].p(a,c),v(t[o],1)):(t[o]=at(a),t[o].c(),v(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=l.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)v(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)M(t[c]);n=!1},d(i){i&&f(e),ke(t,i)}}}function at(r){let e,n;return e=new un({props:{embed:r[22]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.embed=l[22]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function yn(r){let e,n,l=r[12](r[0])&&r[0].system==null,t,s,i,c,o,a,m,d,u=r[0].replies!=null&&r[0].replies.length!=0&&tt(r),p=l&&nt(r);const O=[vn,kn],P=[];function $(w,A){return w[3]!=null?0:w[0].content!=null?1:-1}~(s=$(r))&&(i=P[s]=O[s](r));let k=r[0].system!=null&&it(r),I=r[0].attachments!=null&&st(r),C=r[0].embeds!=null&&ct(r);return{c(){e=N("div"),u&&u.c(),n=L(),p&&p.c(),t=L(),i&&i.c(),c=L(),k&&k.c(),o=L(),I&&I.c(),a=L(),C&&C.c(),this.h()},l(w){e=T(w,"DIV",{id:!0,class:!0});var A=V(e);u&&u.l(A),n=q(A),p&&p.l(A),t=q(A),i&&i.l(A),c=q(A),k&&k.l(A),o=q(A),I&&I.l(A),a=q(A),C&&C.l(A),A.forEach(f),this.h()},h(){_(e,"id",m="MESSAGE-"+r[0]._id),_(e,"class","message-container svelte-wy25lb")},m(w,A){b(w,e,A),u&&u.m(e,null),y(e,n),p&&p.m(e,null),y(e,t),~s&&P[s].m(e,null),y(e,c),k&&k.m(e,null),y(e,o),I&&I.m(e,null),y(e,a),C&&C.m(e,null),d=!0},p(w,A){w[0].replies!=null&&w[0].replies.length!=0?u?(u.p(w,A),A[0]&1&&v(u,1)):(u=tt(w),u.c(),v(u,1),u.m(e,n)):u&&(Y(),M(u,1,1,()=>{u=null}),Z()),A[0]&1&&(l=w[12](w[0])&&w[0].system==null),l?p?(p.p(w,A),A[0]&1&&v(p,1)):(p=nt(w),p.c(),v(p,1),p.m(e,t)):p&&(Y(),M(p,1,1,()=>{p=null}),Z());let G=s;s=$(w),s===G?~s&&P[s].p(w,A):(i&&(Y(),M(P[G],1,1,()=>{P[G]=null}),Z()),~s?(i=P[s],i?i.p(w,A):(i=P[s]=O[s](w),i.c()),v(i,1),i.m(e,c)):i=null),w[0].system!=null?k?(k.p(w,A),A[0]&1&&v(k,1)):(k=it(w),k.c(),v(k,1),k.m(e,o)):k&&(Y(),M(k,1,1,()=>{k=null}),Z()),w[0].attachments!=null?I?(I.p(w,A),A[0]&1&&v(I,1)):(I=st(w),I.c(),v(I,1),I.m(e,a)):I&&(Y(),M(I,1,1,()=>{I=null}),Z()),w[0].embeds!=null?C?(C.p(w,A),A[0]&1&&v(C,1)):(C=ct(w),C.c(),v(C,1),C.m(e,null)):C&&(Y(),M(C,1,1,()=>{C=null}),Z()),(!d||A[0]&1&&m!==(m="MESSAGE-"+w[0]._id))&&_(e,"id",m)},i(w){d||(v(u),v(p),v(i),v(k),v(I),v(C),d=!0)},o(w){M(u),M(p),M(i),M(k),M(I),M(C),d=!1},d(w){w&&f(e),u&&u.d(),p&&p.d(),~s&&P[s].d(),k&&k.d(),I&&I.d(),C&&C.d()}}}function wn(r,e,n){let l,t,s,i,c,o;we.extend(Ht);let{message:a}=e,{messageIndex:m}=e,d,u,p;const O=x(Ee);se(r,O,E=>n(5,o=E));const P=x(ve),$=x(Et);se(r,$,E=>n(14,s=E));const k=x(Ve),I=x(Be);se(r,I,E=>n(15,i=E));const C=x(wt);se(r,C,E=>n(18,c=E));async function w(E,z){n(2,p=c==null?void 0:c.find(F=>F._id.server==E&&F._id.user==z))}async function A(){const E=await P.api.editMessage(a.channel,a._id,{content:d});k==null||k.update(z=>(z[z.findIndex(F=>F._id==a._id)]=E,z)),n(3,d=void 0)}function G(E){var H;if(k==null)return!0;const F=Vt(k)[m-1];return F==null?!0:E.author!=F.author||E.masquerade!=F.masquerade||De(E._id)-De(F._id)>=7*60*1e3||(((H=E.replies)==null?void 0:H.length)??0)!=0}function me(E){d=E,n(3,d)}const ie=E=>{E.detail.key=="Escape"&&n(3,d=void 0)};return r.$$set=E=>{"message"in E&&n(0,a=E.message),"messageIndex"in E&&n(13,m=E.messageIndex)},r.$$.update=()=>{r.$$.dirty[0]&32769&&je(P.api,i??P.api.cache.users,a.author).then(E=>n(1,u=E)),r.$$.dirty[0]&16385&&(s==null||w(s,a.author)),r.$$.dirty[0]&7&&n(4,l=u==null?"Unknown User":oe(u,p,a)),r.$$.dirty[0]&1&&n(6,t=De(a._id))},[a,u,p,d,l,o,t,O,$,I,C,A,G,m,s,i,me,ie]}class $n extends ue{constructor(e){super(),_e(this,e,wn,yn,fe,{message:0,messageIndex:13},null,[-1,-1])}}function En(r){let e,n;return{c(){e=Te("svg"),n=Te("path"),this.h()},l(l){e=Ue(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=V(e);n=Ue(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(n).forEach(f),t.forEach(f),this.h()},h(){_(n,"stroke-linecap","round"),_(n,"stroke-linejoin","round"),_(n,"d","M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),_(e,"xmlns","http://www.w3.org/2000/svg"),_(e,"fill","none"),_(e,"viewBox","0 0 24 24"),_(e,"stroke-width","1.5"),_(e,"stroke","currentColor"),_(e,"width","24px"),_(e,"height","24px")},m(l,t){b(l,e,t),y(e,n)},p:h,i:h,o:h,d(l){l&&f(e)}}}class Ct extends ue{constructor(e){super(),_e(this,e,null,En,fe,{})}}function Mn(r){let e,n;return{c(){e=Te("svg"),n=Te("path"),this.h()},l(l){e=Ue(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=V(e);n=Ue(t,"path",{"stroke-linecap":!0,d:!0}),V(n).forEach(f),t.forEach(f),this.h()},h(){_(n,"stroke-linecap","round"),_(n,"d","M16.5 12a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"),_(e,"xmlns","http://www.w3.org/2000/svg"),_(e,"fill","none"),_(e,"viewBox","0 0 24 24"),_(e,"stroke-width","1.5"),_(e,"stroke","currentColor"),_(e,"width","24px"),_(e,"height","24px")},m(l,t){b(l,e,t),y(e,n)},p:h,i:h,o:h,d(l){l&&f(e)}}}class Cn extends ue{constructor(e){super(),_e(this,e,null,Mn,fe,{})}}function ft(r){const e=oe(r[5]);r[6]=e}function In(r){let e,n,l;return e=new Me({}),{c(){ee(e.$$.fragment),n=S(`
				<UnknownUser>`)},l(t){te(e.$$.fragment,t),n=D(t,`
				<UnknownUser>`)},m(t,s){le(e,t,s),b(t,n,s),l=!0},p:h,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){M(e.$$.fragment,t),l=!1},d(t){t&&f(n),ne(e,t)}}}function Nn(r){ft(r);let e,n,l,t,s=r[6]+"",i;return{c(){e=N("img"),t=L(),i=S(s),this.h()},l(c){e=T(c,"IMG",{class:!0,src:!0,alt:!0}),t=q(c),i=D(c,s),this.h()},h(){_(e,"class","cover svelte-zbyf5q"),Q(e.src,n=he(r[5]))||_(e,"src",n),_(e,"alt",l=r[6])},m(c,o){b(c,e,o),b(c,t,o),b(c,i,o)},p(c,o){ft(c),o&1&&!Q(e.src,n=he(c[5]))&&_(e,"src",n),o&1&&l!==(l=c[6])&&_(e,"alt",l),o&1&&s!==(s=c[6]+"")&&J(i,s)},i:h,o:h,d(c){c&&(f(e),f(t),f(i))}}}function Tn(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function ut(r){let e,n=r[0].message.content+"",l;return{c(){e=N("p"),l=S(n),this.h()},l(t){e=T(t,"P",{class:!0});var s=V(e);l=D(s,n),s.forEach(f),this.h()},h(){_(e,"class","message-content svelte-zbyf5q")},m(t,s){b(t,e,s),y(e,l)},p(t,s){s&1&&n!==(n=t[0].message.content+"")&&J(l,n)},d(t){t&&f(e)}}}function Un(r){let e,n,l,t,s,i,c,o,a,m,d,u,p,O,P=r[0].mention?"ON":"OFF",$,k,I,C,w,A,G,me,ie,E={ctx:r,current:null,token:null,hasCatch:!0,pending:Tn,then:Nn,catch:In,value:5,blocks:[,,,]};re(s=r[2].api.fetchUser(r[0].message.author),E);let z=r[0].message.content&&ut(r);return p=new Cn({}),A=new Ct({}),{c(){e=N("div"),n=N("p"),l=S(`Replying to
		`),t=N("strong"),E.block.c(),i=L(),z&&z.c(),c=L(),o=N("div"),a=L(),m=N("label"),d=N("input"),u=L(),ee(p.$$.fragment),O=L(),$=S(P),I=L(),C=N("div"),w=N("button"),ee(A.$$.fragment),this.h()},l(F){e=T(F,"DIV",{class:!0});var H=V(e);n=T(H,"P",{});var de=V(n);l=D(de,`Replying to
		`),t=T(de,"STRONG",{});var B=V(t);E.block.l(B),B.forEach(f),de.forEach(f),i=q(H),z&&z.l(H),c=q(H),o=T(H,"DIV",{class:!0}),V(o).forEach(f),a=q(H),m=T(H,"LABEL",{class:!0,"aria-label":!0});var U=V(m);d=T(U,"INPUT",{id:!0,style:!0,type:!0}),u=q(U),te(p.$$.fragment,U),O=q(U),$=D(U,P),U.forEach(f),I=q(H),C=T(H,"DIV",{});var X=V(C);w=T(X,"BUTTON",{});var g=V(w);te(A.$$.fragment,g),g.forEach(f),X.forEach(f),H.forEach(f),this.h()},h(){_(o,"class","flex-divider"),_(d,"id","mention"),Ne(d,"display","none"),_(d,"type","checkbox"),_(m,"class","mention-button svelte-zbyf5q"),_(m,"aria-label",k="Mention author "+(r[0].mention?"ON":"OFF")),_(e,"class","container svelte-zbyf5q")},m(F,H){b(F,e,H),y(e,n),y(n,l),y(n,t),E.block.m(t,E.anchor=null),E.mount=()=>t,E.anchor=null,y(e,i),z&&z.m(e,null),y(e,c),y(e,o),y(e,a),y(e,m),y(m,d),d.checked=r[0].mention,y(m,u),le(p,m,null),y(m,O),y(m,$),y(e,I),y(e,C),y(C,w),le(A,w,null),G=!0,me||(ie=[ce(d,"change",r[3]),ce(w,"click",r[4])],me=!0)},p(F,[H]){r=F,E.ctx=r,H&1&&s!==(s=r[2].api.fetchUser(r[0].message.author))&&re(s,E)||pe(E,r,H),r[0].message.content?z?z.p(r,H):(z=ut(r),z.c(),z.m(e,c)):z&&(z.d(1),z=null),H&1&&(d.checked=r[0].mention),(!G||H&1)&&P!==(P=r[0].mention?"ON":"OFF")&&J($,P),(!G||H&1&&k!==(k="Mention author "+(r[0].mention?"ON":"OFF")))&&_(m,"aria-label",k)},i(F){G||(v(E.block),v(p.$$.fragment,F),v(A.$$.fragment,F),G=!0)},o(F){for(let H=0;H<3;H+=1){const de=E.blocks[H];M(de)}M(p.$$.fragment,F),M(A.$$.fragment,F),G=!1},d(F){F&&f(e),E.block.d(),E.token=null,E=null,z&&z.d(),ne(p),ne(A),me=!1,Se(ie)}}}function Sn(r,e,n){let{reply:l}=e;const t=x(ve),s=x($t);function i(){l.mention=this.checked,n(0,l)}const c=()=>s.update(o=>(o=o.filter(a=>a.message._id!=l.message._id),o));return r.$$set=o=>{"reply"in o&&n(0,l=o.reply)},[l,s,t,i,c]}class Dn extends ue{constructor(e){super(),_e(this,e,Sn,Un,fe,{reply:0})}}function _t(r,e,n){const l=r.slice();return l[30]=e[n],l}function ht(r,e,n){const l=r.slice();return l[33]=e[n],l}function mt(r,e,n){const l=r.slice();return l[36]=e[n],l[38]=n,l}function An(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function jn(r){let e,n,l=ae(r[8]),t=[];for(let i=0;i<l.length;i+=1)t[i]=dt(mt(r,l,i));const s=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=R()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=R()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);b(i,e,c),n=!0},p(i,c){if(c[0]&256){l=ae(i[8]);let o;for(o=0;o<l.length;o+=1){const a=mt(i,l,o);t[o]?(t[o].p(a,c),v(t[o],1)):(t[o]=dt(a),t[o].c(),v(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=l.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)v(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)M(t[c]);n=!1},d(i){i&&f(e),ke(t,i)}}}function dt(r){let e,n;return e=new $n({props:{message:r[36],messageIndex:r[38]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&256&&(s.message=l[36]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function On(r){let e;return{c(){e=S("Loading...")},l(n){e=D(n,"Loading...")},m(n,l){b(n,e,l)},p:h,i:h,o:h,d(n){n&&f(e)}}}function pt(r){let e,n,l,t=Array.from(r[1]).map(vt).join(", ")+"",s,i,c,o,a,m,d,u,p;return m=new Ct({}),{c(){e=N("div"),n=N("p"),l=S(`Uploading
				`),s=S(t),i=L(),c=N("div"),o=L(),a=N("button"),ee(m.$$.fragment),this.h()},l(O){e=T(O,"DIV",{class:!0});var P=V(e);n=T(P,"P",{});var $=V(n);l=D($,`Uploading
				`),s=D($,t),$.forEach(f),i=q(P),c=T(P,"DIV",{class:!0}),V(c).forEach(f),o=q(P),a=T(P,"BUTTON",{});var k=V(a);te(m.$$.fragment,k),k.forEach(f),P.forEach(f),this.h()},h(){_(c,"class","flex-divider"),_(e,"class","flex-container")},m(O,P){b(O,e,P),y(e,n),y(n,l),y(n,s),y(e,i),y(e,c),y(e,o),y(e,a),le(m,a,null),d=!0,u||(p=ce(a,"click",r[19]),u=!0)},p(O,P){(!d||P[0]&2)&&t!==(t=Array.from(O[1]).map(vt).join(", ")+"")&&J(s,t)},i(O){d||(v(m.$$.fragment,O),d=!0)},o(O){M(m.$$.fragment,O),d=!1},d(O){O&&f(e),ne(m),u=!1,p()}}}function gt(r){let e,n;return e=new Dn({props:{reply:r[33]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&128&&(s.reply=l[33]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function Pn(r){let e,n,l;return{c(){e=N("img"),this.h()},l(t){e=T(t,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),this.h()},h(){_(e,"class","cover"),Q(e.src,n=he(r[30]))||_(e,"src",n),_(e,"width","16px"),_(e,"height","16px"),_(e,"alt",l=oe(r[30]))},m(t,s){b(t,e,s)},p(t,s){s[0]&32&&!Q(e.src,n=he(t[30]))&&_(e,"src",n),s[0]&32&&l!==(l=oe(t[30]))&&_(e,"alt",l)},i:h,o:h,d(t){t&&f(e)}}}function Vn(r){let e,n;return e=new Me({}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p:h,i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function bt(r){let e,n,l,t;const s=[Vn,Pn],i=[];function c(o,a){return o[4]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=R()},l(o){n.l(o),l=R()},m(o,a){i[e].m(o,a),b(o,l,a),t=!0},p(o,a){let m=e;e=c(o),e===m?i[e].p(o,a):(Y(),M(i[m],1,1,()=>{i[m]=null}),Z(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(l.parentNode,l))},i(o){t||(v(n),t=!0)},o(o){M(n),t=!1},d(o){o&&f(l),i[e].d(o)}}}function kt(r){let e=r[14](r[5])+"",n;return{c(){n=S(e)},l(l){n=D(l,e)},m(l,t){b(l,n,t)},p(l,t){t[0]&32&&e!==(e=l[14](l[5])+"")&&J(n,e)},d(l){l&&f(n)}}}function Bn(r){let e,n,l,t,s,i,c,o,a,m,d,u,p,O,P,$,k,I,C={ctx:r,current:null,token:null,hasCatch:!1,pending:On,then:jn,catch:An,blocks:[,,,]};re(l=r[3],C);let w=r[1]!=null&&r[1].length!=0&&pt(r),A=ae(r[7]),G=[];for(let B=0;B<A.length;B+=1)G[B]=gt(ht(r,A,B));const me=B=>M(G[B],1,1,()=>{G[B]=null});let ie=ae(r[5]),E=[];for(let B=0;B<ie.length;B+=1)E[B]=bt(_t(r,ie,B));const z=B=>M(E[B],1,1,()=>{E[B]=null});let F=r[5].length!=0&&kt(r);u=new Kt({});function H(B){r[20](B)}let de={sendTypingEvents:r[4]["jolt:send-typing-indicators"],placeholder:"Send message in "+r[6]};return r[0]!==void 0&&(de.value=r[0]),O=new Mt({props:de}),$e.push(()=>Pe(O,"value",H)),{c(){e=N("main"),n=N("div"),C.block.c(),t=L(),w&&w.c(),s=L();for(let B=0;B<G.length;B+=1)G[B].c();i=L(),c=N("div");for(let B=0;B<E.length;B+=1)E[B].c();o=L(),F&&F.c(),a=L(),m=N("form"),d=N("button"),ee(u.$$.fragment),p=L(),ee(O.$$.fragment),this.h()},l(B){e=T(B,"MAIN",{class:!0});var U=V(e);n=T(U,"DIV",{class:!0});var X=V(n);C.block.l(X),X.forEach(f),t=q(U),w&&w.l(U),s=q(U);for(let W=0;W<G.length;W+=1)G[W].l(U);i=q(U),c=T(U,"DIV",{class:!0});var g=V(c);for(let W=0;W<E.length;W+=1)E[W].l(g);o=q(g),F&&F.l(g),g.forEach(f),a=q(U),m=T(U,"FORM",{class:!0,id:!0});var j=V(m);d=T(j,"BUTTON",{class:!0});var K=V(d);te(u.$$.fragment,K),K.forEach(f),p=q(j),te(O.$$.fragment,j),j.forEach(f),U.forEach(f),this.h()},h(){_(n,"class","messages-list svelte-nypmac"),_(c,"class","typing-indicator svelte-nypmac"),_(d,"class","file-upload svelte-nypmac"),_(m,"class","message-form"),_(m,"id","send-message-form"),_(e,"class","main-content-container svelte-nypmac")},m(B,U){b(B,e,U),y(e,n),C.block.m(n,C.anchor=null),C.mount=()=>n,C.anchor=null,r[18](n),y(e,t),w&&w.m(e,null),y(e,s);for(let X=0;X<G.length;X+=1)G[X]&&G[X].m(e,null);y(e,i),y(e,c);for(let X=0;X<E.length;X+=1)E[X]&&E[X].m(c,null);y(c,o),F&&F.m(c,null),y(e,a),y(e,m),y(m,d),le(u,d,null),y(m,p),le(O,m,null),$=!0,k||(I=[ce(d,"click",r[13]),ce(m,"submit",r[12])],k=!0)},p(B,U){if(r=B,C.ctx=r,U[0]&8&&l!==(l=r[3])&&re(l,C)||pe(C,r,U),r[1]!=null&&r[1].length!=0?w?(w.p(r,U),U[0]&2&&v(w,1)):(w=pt(r),w.c(),v(w,1),w.m(e,s)):w&&(Y(),M(w,1,1,()=>{w=null}),Z()),U[0]&128){A=ae(r[7]);let g;for(g=0;g<A.length;g+=1){const j=ht(r,A,g);G[g]?(G[g].p(j,U),v(G[g],1)):(G[g]=gt(j),G[g].c(),v(G[g],1),G[g].m(e,i))}for(Y(),g=A.length;g<G.length;g+=1)me(g);Z()}if(U[0]&48){ie=ae(r[5]);let g;for(g=0;g<ie.length;g+=1){const j=_t(r,ie,g);E[g]?(E[g].p(j,U),v(E[g],1)):(E[g]=bt(j),E[g].c(),v(E[g],1),E[g].m(c,o))}for(Y(),g=ie.length;g<E.length;g+=1)z(g);Z()}r[5].length!=0?F?F.p(r,U):(F=kt(r),F.c(),F.m(c,null)):F&&(F.d(1),F=null);const X={};U[0]&16&&(X.sendTypingEvents=r[4]["jolt:send-typing-indicators"]),U[0]&64&&(X.placeholder="Send message in "+r[6]),!P&&U[0]&1&&(P=!0,X.value=r[0],Oe(()=>P=!1)),O.$set(X)},i(B){if(!$){v(C.block),v(w);for(let U=0;U<A.length;U+=1)v(G[U]);for(let U=0;U<ie.length;U+=1)v(E[U]);v(u.$$.fragment,B),v(O.$$.fragment,B),$=!0}},o(B){for(let U=0;U<3;U+=1){const X=C.blocks[U];M(X)}M(w),G=G.filter(Boolean);for(let U=0;U<G.length;U+=1)M(G[U]);E=E.filter(Boolean);for(let U=0;U<E.length;U+=1)M(E[U]);M(u.$$.fragment,B),M(O.$$.fragment,B),$=!1},d(B){B&&f(e),C.block.d(),C.token=null,C=null,r[18](null),w&&w.d(),ke(G,B),ke(E,B),F&&F.d(),ne(u),ne(O),k=!1,Se(I)}}}const vt=r=>r.name;function Fn(r,e,n){let l,t,s,i;se(r,zt,g=>n(17,l=g));let{channel:c}=e,{replies:o=[]}=e,{messageInput:a=""}=e,{files:m=[]}=e;const d=x(Ee);se(r,d,g=>n(4,s=g));const u=x(ve),p=Ie([]);se(r,p,g=>n(8,i=g));const O=Ie([]),P=Ie([]),$=Ie(o);se(r,$,g=>n(7,t=g)),ye(Ve,p),ye(wt,O),ye(Be,P),ye($t,$),ye(yt,c);let k,I=[],C="Unknown Channel",w=Promise.resolve();async function A(g){if(!g){u.removeAllListeners("ChannelStartTyping"),u.removeAllListeners("ChannelStopTyping");return}u.on("ChannelStartTyping",async({id:j,user:K})=>{var W;if(!(K==((W=u.user)==null?void 0:W._id)||j!=c._id)){for(const{_id:ge}of I)if(K==ge)return;n(5,I[I.length]=await u.api.fetchUser(K),I)}}),u.on("ChannelStopTyping",({id:j,user:K})=>{j==c._id&&n(5,I=I.filter(W=>W._id!=K))})}async function G(){const g=await Promise.all(m.map(j=>u.autumn.uploadFile(j)));n(1,m=[]),await u.api.sendMessage(c._id,{content:a.trim(),replies:t.map(({message:{_id:j},mention:K})=>({id:j,mention:K})),attachments:g}),$.set([]),n(0,a="")}function me(g){if(g.channel!=c._id)return;const j=k.offsetHeight+k.scrollTop>k.scrollHeight-20;document.hasFocus()&&j&&u.api.ackMessage(c._id,g._id),p.update(K=>(K.push(g),K)),j&&Ge().then(()=>k.scrollTo(0,k.scrollHeight))}function ie({id:g,channel:j}){j==c._id&&p.update(K=>K.filter(W=>W._id!=g))}function E({id:g,channel:j,data:K}){j==c._id&&p.update(W=>{const ge=W.findIndex(It=>It._id==g),Ce=W[ge];return K.content!=null&&(Ce.content=K.content),K.embeds!=null&&(Ce.embeds=K.embeds),Ce.edited=K.edited,W[ge]=Ce,W})}function z(g){var j;((j=g.clipboardData)==null?void 0:j.files)!=null&&g.clipboardData.files.length!=0&&(g.preventDefault(),m==null?n(1,m=Array.from(g.clipboardData.files)):n(1,m=m.concat(Array.from(g.clipboardData.files))))}function F(){const g=document.createElement("input");g.type="file",g.onchange=j=>{const K=j;K.target.files!=null&&n(1,m=m.concat(Array.from(K.target.files)))},g.click()}Bt(()=>{u.on("Message",me),u.on("MessageDelete",ie),u.on("MessageUpdate",E),document.addEventListener("paste",z)}),Ft(()=>{u.removeListener("Message",me),u.removeListener("MessageDelete",ie),u.removeListener("MessageUpdate",E),document.removeEventListener("paste",z)});async function H(g){var j;if(g.channel_type=="TextChannel"||g.channel_type=="Group"){n(6,C=`#${g.name}`);return}if(g.channel_type=="SavedMessages"){n(6,C="Saved Notes");return}try{n(6,C=`@${oe(await u.api.fetchUser(g.recipients[0]==((j=u.user)==null?void 0:j._id)?g.recipients[1]:g.recipients[0]))}`)}catch{n(6,C="Unknown Channel")}}function de(g){if(g.length==0)throw new Error("function called with an array of length 0");const j=g.map(K=>oe(K));return j.length==1?`${j[0]} is typing...`:j.length>=5?"Several users are typing...":`${j.slice(0,j.length-1).join(", ")} and ${j[j.length-1]} are typing...`}function B(g){$e[g?"unshift":"push"](()=>{k=g,n(2,k)})}const U=()=>n(1,m=[]);function X(g){a=g,n(0,a)}return r.$$set=g=>{"channel"in g&&n(15,c=g.channel),"replies"in g&&n(16,o=g.replies),"messageInput"in g&&n(0,a=g.messageInput),"files"in g&&n(1,m=g.files)},r.$$.update=()=>{if(r.$$.dirty[0]&32780){const g=x(Gt);n(3,w=u.api.queryMessages(c._id,{sort:"Latest",include_users:!0,limit:100,nearby:g}).then(j=>{if(Array.isArray(j)){let K;g==null?K=j.reverse():K=j.sort((W,ge)=>W._id.localeCompare(ge._id)),p.set(K)}else{let K;g==null?K=j.messages.reverse():K=j.messages.sort((W,ge)=>W._id.localeCompare(ge._id)),p.set(K),P.set(j.users),O.set(j.members??[])}})),$.set([]),n(5,I=[]),w.then(()=>{Ge().then(()=>k.scrollTo(0,k.scrollHeight))})}if(r.$$.dirty[0]&16&&A(s["jolt:receive-typing-indicators"]),r.$$.dirty[0]&32768&&H(c),r.$$.dirty[0]&131072){const g=document.getElementById(`MESSAGE-${l.url.hash.slice(1)}`);g==null||g.animate([{backgroundColor:"var(--mention)"},{backgroundColor:"var(--mention)",offset:.6},{backgroundColor:"transparent"}],{duration:3e3,iterations:1})}},[a,m,k,w,s,I,C,t,i,d,p,$,G,F,de,c,o,l,B,U,X]}class tr extends ue{constructor(e){super(),_e(this,e,Fn,Bn,fe,{channel:15,replies:16,messageInput:0,files:1},null,[-1,-1])}}export{tr as T};
