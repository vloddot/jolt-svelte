import{s as fe,f as U,g as N,h as V,d as u,j as h,i as g,r as se,e as B,u as m,a as R,c as L,l as T,m as S,z as y,n as J,I as Q,v as Ct,K as pe,A as oe,w as Mt,x as Ut,y as Nt,D as Te,M as Tt,p as ge,N as St,O as je,k as ye,P as Fe,Q as Dt,G as be,B as At,C as jt,H as Ot,E as Ue,F as Ne,R as ve,o as Pt,J as Vt,t as Re}from"./scheduler.693b9c9b.js";import{h as ne,u as de}from"./await_block.1641c5fa.js";import{e as ae}from"./each.e59479a4.js";import{S as ue,i as _e,a as v,g as W,t as I,c as Y,b as x,d as ee,m as te,e as le,f as Oe}from"./index.bb1ba657.js";import{g as Z,c as ke,a as $e}from"./context.ca3e4b8d.js";import{g as he,b as ce,a as Bt}from"./util.883c3f21.js";import{w as Me}from"./index.f1869c04.js";import{b as Le}from"./paths.a0b5f327.js";import{a as kt,s as Ft}from"./context.fa34f1f8.js";import{U as Ee}from"./UserIcon.bf988ebc.js";import{d as Se}from"./index.esm.4b6e8736.js";import{t as Rt,P as Lt}from"./PlusIcon.80cf0953.js";import{d as we,c as qt}from"./calendar.5942d46b.js";async function Ae(r,e,n){if(n=="0".repeat(26))return;let l;return Array.isArray(e)?l=e.find(t=>t._id==n):l=e.get(n),l??await r.fetchUser(n)}const vt=Symbol(),Pe=Symbol(),yt=Symbol(),Ve=Symbol(),wt=Symbol();function Gt(r){const e=r.slice(),n=ce(e[14]);return e[15]=n,e}function qe(r){var s;let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Yt,then:Ht,catch:Kt,value:13,blocks:[,,,]};return ne(n=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),t),{c(){e=B(),t.block.c()},l(i){e=B(),t.block.l(i)},m(i,c){g(i,e,c),t.block.m(i,t.anchor=c),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(i,c){var o;r=i,t.ctx=r,c&13&&n!==(n=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&ne(n,t)||de(t,r,c)},i(i){l||(v(t.block),l=!0)},o(i){for(let c=0;c<3;c+=1){const o=t.blocks[c];I(o)}l=!1},d(i){i&&u(e),t.block.d(i),t.token=null,t=null}}}function Kt(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Ht(r){let e,n,l,t=!r[4]["jolt:low-data-mode"]&&Ge(r),s=r[13].content!=null&&Ke(r);return{c(){t&&t.c(),e=R(),s&&s.c(),n=B()},l(i){t&&t.l(i),e=L(i),s&&s.l(i),n=B()},m(i,c){t&&t.m(i,c),g(i,e,c),s&&s.m(i,c),g(i,n,c),l=!0},p(i,c){i[4]["jolt:low-data-mode"]?t&&(W(),I(t,1,1,()=>{t=null}),Y()):t?(t.p(i,c),c&16&&v(t,1)):(t=Ge(i),t.c(),v(t,1),t.m(e.parentNode,e)),i[13].content!=null?s?s.p(i,c):(s=Ke(i),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(i){l||(v(t),l=!0)},o(i){I(t),l=!1},d(i){i&&(u(e),u(n)),t&&t.d(i),s&&s.d(i)}}}function Ge(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Wt,then:Xt,catch:zt,value:14,blocks:[,,,]};return ne(n=Ae(r[6].api,r[5]??r[6].api.cache.users,r[13].author),t),{c(){e=B(),t.block.c()},l(s){e=B(),t.block.l(s)},m(s,i){g(s,e,i),t.block.m(s,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(s,i){r=s,t.ctx=r,i&45&&n!==(n=Ae(r[6].api,r[5]??r[6].api.cache.users,r[13].author))&&ne(n,t)||de(t,r,i)},i(s){l||(v(t.block),l=!0)},o(s){for(let i=0;i<3;i+=1){const c=t.blocks[i];I(c)}l=!1},d(s){s&&u(e),t.block.d(s),t.token=null,t=null}}}function zt(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Xt(r){let e,n,l,t;const s=[Qt,Jt],i=[];function c(a,d){return a[14]!=null?0:1}function o(a,d){return d===0?Gt(a):a}return e=c(r),n=i[e]=s[e](o(r,e)),{c(){n.c(),l=B()},l(a){n.l(a),l=B()},m(a,d){i[e].m(a,d),g(a,l,d),t=!0},p(a,d){let _=e;e=c(a),e===_?i[e].p(o(a,e),d):(W(),I(i[_],1,1,()=>{i[_]=null}),Y(),n=i[e],n?n.p(o(a,e),d):(n=i[e]=s[e](o(a,e)),n.c()),v(n,1),n.m(l.parentNode,l))},i(a){t||(v(n),t=!0)},o(a){I(n),t=!1},d(a){a&&u(l),i[e].d(a)}}}function Jt(r){let e,n,l;return e=new Ee({}),{c(){x(e.$$.fragment),n=T(`

						Unknown User`)},l(t){ee(e.$$.fragment,t),n=S(t,`

						Unknown User`)},m(t,s){te(e,t,s),g(t,n,s),l=!0},p:m,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){t&&u(n),le(e,t)}}}function Qt(r){let e,n,l,t,s=r[15]+"",i;return{c(){e=U("img"),t=R(),i=T(s),this.h()},l(c){e=N(c,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),t=L(c),i=S(c,s),this.h()},h(){h(e,"class","cover"),Q(e.src,n=he(r[14]))||h(e,"src",n),h(e,"alt",l=r[15]),h(e,"width","24px"),h(e,"height","24px")},m(c,o){g(c,e,o),g(c,t,o),g(c,i,o)},p(c,o){o&45&&!Q(e.src,n=he(c[14]))&&h(e,"src",n),o&45&&l!==(l=c[15])&&h(e,"alt",l),o&45&&s!==(s=c[15]+"")&&J(i,s)},i:m,o:m,d(c){c&&(u(e),u(t),u(i))}}}function Wt(r){let e;return{c(){e=T("<Unknown User>")},l(n){e=S(n,"<Unknown User>")},m(n,l){g(n,e,l)},p:m,i:m,o:m,d(n){n&&u(e)}}}function Ke(r){let e,n=r[13].content+"",l;return{c(){e=U("span"),l=T(n),this.h()},l(t){e=N(t,"SPAN",{class:!0});var s=V(e);l=S(s,n),s.forEach(u),this.h()},h(){h(e,"class","message-content svelte-1y3x0re")},m(t,s){g(t,e,s),y(e,l)},p(t,s){s&13&&n!==(n=t[13].content+"")&&J(l,n)},d(t){t&&u(e)}}}function Yt(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Zt(r){let e,n,l,t=r[2]!=null&&qe(r);return{c(){e=U("a"),t&&t.c(),this.h()},l(s){e=N(s,"A",{href:!0});var i=V(e);t&&t.l(i),i.forEach(u),this.h()},h(){h(e,"href",n=Le+"/"+(r[1]==null?`channels/${r[2]}#${r[0]}`:`servers/${r[1]}/channels/${r[2]}#${r[0]}`))},m(s,i){g(s,e,i),t&&t.m(e,null),l=!0},p(s,[i]){s[2]!=null?t?(t.p(s,i),i&4&&v(t,1)):(t=qe(s),t.c(),v(t,1),t.m(e,null)):t&&(W(),I(t,1,1,()=>{t=null}),Y()),(!l||i&7&&n!==(n=Le+"/"+(s[1]==null?`channels/${s[2]}#${s[0]}`:`servers/${s[1]}/channels/${s[2]}#${s[0]}`)))&&h(e,"href",n)},i(s){l||(v(t),l=!0)},o(s){I(t),l=!1},d(s){s&&u(e),t&&t.d()}}}function xt(r,e,n){let l,t,s,i,c;const o=Z(ke),a=Z($e);se(r,a,w=>n(4,i=w));const d=Z(kt);se(r,d,w=>n(1,l=w));const _=Z(Ft);se(r,_,w=>n(2,t=w));const f=Z(Pe);se(r,f,w=>n(3,s=w));const p=Z(Ve);se(r,p,w=>n(5,c=w));let{id:D}=e;const A=({_id:w})=>D==w;return r.$$set=w=>{"id"in w&&n(0,D=w.id)},[D,l,t,s,i,c,o,a,d,_,f,p,A]}class el extends ue{constructor(e){super(),_e(this,e,xt,Zt,fe,{id:0})}}function He(r){const e=ce(r[3]);r[4]=e}function ze(r){r[5]=r[7][0],r[6]=r[7][1]}function Xe(r){const e=ce(r[3]);r[4]=e}function tl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:ul,then:sl,catch:il,value:3};return ne(n=r[1].api.fetchUser(r[0].id),l),{c(){e=B(),l.block.c()},l(t){e=B(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&ne(n,l)||de(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function ll(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:ml,then:hl,catch:_l,value:7};return ne(n=Promise.all([r[0].from,r[0].to].map(r[2])),l),{c(){e=B(),l.block.c()},l(t){e=B(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=Promise.all([r[0].from,r[0].to].map(r[2])))&&ne(n,l)||de(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function nl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Cl,then:pl,catch:dl,value:3};return ne(n=r[1].api.fetchUser(r[0].by),l),{c(){e=B(),l.block.c()},l(t){e=B(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].by))&&ne(n,l)||de(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function rl(r){let e=r[0].content+"",n;return{c(){n=T(e)},l(l){n=S(l,e)},m(l,t){g(l,n,t)},p(l,t){t&1&&e!==(e=l[0].content+"")&&J(n,e)},d(l){l&&u(n)}}}function il(r){return{c:m,l:m,m,p:m,d:m}}function sl(r){He(r);let e,n,l,t,s=r[4]+"",i,c,o;function a(f,p){if(f[0].type=="user_banned")return fl;if(f[0].type=="user_joined")return al;if(f[0].type=="user_kicked")return cl;if(f[0].type=="user_left")return ol}let d=a(r),_=d&&d(r);return{c(){e=U("img"),t=R(),i=T(s),c=R(),_&&_.c(),o=B(),this.h()},l(f){e=N(f,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=L(f),i=S(f,s),c=L(f),_&&_.l(f),o=B(),this.h()},h(){h(e,"class","cover"),Q(e.src,n=he(r[3]))||h(e,"src",n),h(e,"width","24px"),h(e,"height","24px"),h(e,"alt",l=r[4])},m(f,p){g(f,e,p),g(f,t,p),g(f,i,p),g(f,c,p),_&&_.m(f,p),g(f,o,p)},p(f,p){He(f),p&1&&!Q(e.src,n=he(f[3]))&&h(e,"src",n),p&1&&l!==(l=f[4])&&h(e,"alt",l),p&1&&s!==(s=f[4]+"")&&J(i,s),d!==(d=a(f))&&(_&&_.d(1),_=d&&d(f),_&&(_.c(),_.m(o.parentNode,o)))},d(f){f&&(u(e),u(t),u(i),u(c),u(o)),_&&_.d(f)}}}function ol(r){let e;return{c(){e=T("left the chat.")},l(n){e=S(n,"left the chat.")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function cl(r){let e;return{c(){e=T("was kicked.")},l(n){e=S(n,"was kicked.")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function al(r){let e;return{c(){e=T("has joined the chat.")},l(n){e=S(n,"has joined the chat.")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function fl(r){let e;return{c(){e=T("was banned.")},l(n){e=S(n,"was banned.")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function ul(r){return{c:m,l:m,m,p:m,d:m}}function _l(r){return{c:m,l:m,m,p:m,d:m}}function hl(r){ze(r);let e,n=ce(r[5])+"",l,t,s=ce(r[6])+"",i,c;return{c(){e=T("Channel ownership changed from "),l=T(n),t=T(" to "),i=T(s),c=T(".")},l(o){e=S(o,"Channel ownership changed from "),l=S(o,n),t=S(o," to "),i=S(o,s),c=S(o,".")},m(o,a){g(o,e,a),g(o,l,a),g(o,t,a),g(o,i,a),g(o,c,a)},p(o,a){ze(o),a&1&&n!==(n=ce(o[5])+"")&&J(l,n),a&1&&s!==(s=ce(o[6])+"")&&J(i,s)},d(o){o&&(u(e),u(l),u(t),u(i),u(c))}}}function ml(r){return{c:m,l:m,m,p:m,d:m}}function dl(r){return{c:m,l:m,m,p:m,d:m}}function pl(r){Xe(r);let e,n,l,t,s=r[4]+"",i,c,o;function a(f,p){if(f[0].type=="channel_description_changed")return vl;if(f[0].type=="channel_icon_changed")return kl;if(f[0].type=="channel_renamed")return bl;if(f[0].type=="user_added"||f[0].type=="user_remove")return gl}let d=a(r),_=d&&d(r);return{c(){e=U("img"),t=R(),i=T(s),c=R(),_&&_.c(),o=B(),this.h()},l(f){e=N(f,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=L(f),i=S(f,s),c=L(f),_&&_.l(f),o=B(),this.h()},h(){h(e,"class","cover"),Q(e.src,n=he(r[3]))||h(e,"src",n),h(e,"width","24px"),h(e,"height","24px"),h(e,"alt",l=r[4])},m(f,p){g(f,e,p),g(f,t,p),g(f,i,p),g(f,c,p),_&&_.m(f,p),g(f,o,p)},p(f,p){Xe(f),p&1&&!Q(e.src,n=he(f[3]))&&h(e,"src",n),p&1&&l!==(l=f[4])&&h(e,"alt",l),p&1&&s!==(s=f[4]+"")&&J(i,s),d===(d=a(f))&&_?_.p(f,p):(_&&_.d(1),_=d&&d(f),_&&(_.c(),_.m(o.parentNode,o)))},d(f){f&&(u(e),u(t),u(i),u(c),u(o)),_&&_.d(f)}}}function gl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Il,then:wl,catch:yl,value:3};return ne(n=r[1].api.fetchUser(r[0].id),l),{c(){e=B(),l.block.c()},l(t){e=B(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&ne(n,l)||de(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function bl(r){let e,n=r[0].name+"",l,t;return{c(){e=T("renamed this channel to "),l=T(n),t=T(".")},l(s){e=S(s,"renamed this channel to "),l=S(s,n),t=S(s,".")},m(s,i){g(s,e,i),g(s,l,i),g(s,t,i)},p(s,i){i&1&&n!==(n=s[0].name+"")&&J(l,n)},d(s){s&&(u(e),u(l),u(t))}}}function kl(r){let e;return{c(){e=T("changes this channel icon.")},l(n){e=S(n,"changes this channel icon.")},m(n,l){g(n,e,l)},p:m,d(n){n&&u(e)}}}function vl(r){let e;return{c(){e=T("changed this channel's description.")},l(n){e=S(n,"changed this channel's description.")},m(n,l){g(n,e,l)},p:m,d(n){n&&u(e)}}}function yl(r){return{c:m,l:m,m,p:m,d:m}}function wl(r){let e,n=ce(r[3])+"",l,t;function s(o,a){if(o[0].type=="user_added")return El;if(o[0].type=="user_remove")return $l}let i=s(r),c=i&&i(r);return{c(){c&&c.c(),e=R(),l=T(n),t=T(".")},l(o){c&&c.l(o),e=L(o),l=S(o,n),t=S(o,".")},m(o,a){c&&c.m(o,a),g(o,e,a),g(o,l,a),g(o,t,a)},p(o,a){i!==(i=s(o))&&(c&&c.d(1),c=i&&i(o),c&&(c.c(),c.m(e.parentNode,e))),a&1&&n!==(n=ce(o[3])+"")&&J(l,n)},d(o){o&&(u(e),u(l),u(t)),c&&c.d(o)}}}function $l(r){let e;return{c(){e=T("removed")},l(n){e=S(n,"removed")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function El(r){let e;return{c(){e=T("added")},l(n){e=S(n,"added")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function Il(r){return{c:m,l:m,m,p:m,d:m}}function Cl(r){return{c:m,l:m,m,p:m,d:m}}function Ml(r){let e;function n(s,i){if(s[0].type=="text")return rl;if(s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove")return nl;if(s[0].type=="channel_ownership_changed")return ll;if(s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left")return tl}let l=n(r),t=l&&l(r);return{c(){t&&t.c(),e=B()},l(s){t&&t.l(s),e=B()},m(s,i){t&&t.m(s,i),g(s,e,i)},p(s,[i]){l===(l=n(s))&&t?t.p(s,i):(t&&t.d(1),t=l&&l(s),t&&(t.c(),t.m(e.parentNode,e)))},i:m,o:m,d(s){s&&u(e),t&&t.d(s)}}}function Ul(r,e,n){const l=Z(ke);let{system:t}=e;const s=i=>l.api.fetchUser(i);return r.$$set=i=>{"system"in i&&n(0,t=i.system)},[t,l,s]}class Nl extends ue{constructor(e){super(),_e(this,e,Ul,Ml,fe,{system:0})}}function Tl(r){let e,n,l,t,s,i,c,o="Ok",a,d,_="Cancel",f,p,D;const A=r[3].default,w=Ct(A,r,r[2],null);return{c(){e=U("dialog"),n=U("div"),w&&w.c(),l=R(),t=U("hr"),s=R(),i=U("form"),c=U("button"),c.textContent=o,a=R(),d=U("button"),d.textContent=_,this.h()},l(k){e=N(k,"DIALOG",{});var C=V(e);n=N(C,"DIV",{});var M=V(n);w&&w.l(M),l=L(M),t=N(M,"HR",{}),s=L(M),i=N(M,"FORM",{id:!0,method:!0});var $=V(i);c=N($,"BUTTON",{type:!0,"data-svelte-h":!0}),pe(c)!=="svelte-fdbbw9"&&(c.textContent=o),a=L($),d=N($,"BUTTON",{type:!0,"data-svelte-h":!0}),pe(d)!=="svelte-1gqjcfl"&&(d.textContent=_),$.forEach(u),M.forEach(u),C.forEach(u),this.h()},h(){h(c,"type","submit"),h(d,"type","reset"),h(i,"id","modal-form"),h(i,"method","dialog")},m(k,C){g(k,e,C),y(e,n),w&&w.m(n,null),y(n,l),y(n,t),y(n,s),y(n,i),y(i,c),y(i,a),y(i,d),r[6](e),f=!0,p||(D=[oe(d,"click",r[5]),oe(i,"submit",r[4]),oe(e,"close",r[7])],p=!0)},p(k,[C]){w&&w.p&&(!f||C&4)&&Mt(w,A,k,k[2],f?Nt(A,k[2],C,null):Ut(k[2]),null)},i(k){f||(v(w,k),f=!0)},o(k){I(w,k),f=!1},d(k){k&&u(e),w&&w.d(k),r[6](null),p=!1,Te(D)}}}function Sl(r,e,n){let{$$slots:l={},$$scope:t}=e,{showModal:s}=e,i;function c(_){Tt.call(this,r,_)}const o=()=>n(0,s=!1);function a(_){ge[_?"unshift":"push"](()=>{i=_,n(1,i)})}const d=()=>n(0,s=!1);return r.$$set=_=>{"showModal"in _&&n(0,s=_.showModal),"$$scope"in _&&n(2,t=_.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(s?i==null||i.showModal():i==null||i.close())},[s,i,t,l,c,o,a,d]}class Dl extends ue{constructor(e){super(),_e(this,e,Sl,Tl,fe,{showModal:0})}}function Al(r){let e,n="External Link",l,t,s,i,c="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=U("h1"),e.textContent=n,l=R(),t=U("hr"),s=R(),i=U("p"),i.textContent=c,this.h()},l(o){e=N(o,"H1",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-qkxu7n"&&(e.textContent=n),l=L(o),t=N(o,"HR",{}),s=L(o),i=N(o,"P",{"data-svelte-h":!0}),pe(i)!=="svelte-os1rtp"&&(i.textContent=c),this.h()},h(){h(e,"class","text-3xl")},m(o,a){g(o,e,a),g(o,l,a),g(o,t,a),g(o,s,a),g(o,i,a)},p:m,d(o){o&&(u(e),u(l),u(t),u(s),u(i))}}}function jl(r){let e,n,l,t,s,i,c,o;function a(_){r[2](_)}let d={$$slots:{default:[Al]},$$scope:{ctx:r}};return r[1]!==void 0&&(d.showModal=r[1]),e=new Dl({props:d}),ge.push(()=>Oe(e,"showModal",a)),e.$on("submit",r[3]),{c(){x(e.$$.fragment),l=R(),t=U("a"),s=T(r[0]),this.h()},l(_){ee(e.$$.fragment,_),l=L(_),t=N(_,"A",{href:!0,target:!0,rel:!0});var f=V(t);s=S(f,r[0]),f.forEach(u),this.h()},h(){h(t,"href",r[0]),h(t,"target","_blank"),h(t,"rel","noreferrer")},m(_,f){te(e,_,f),g(_,l,f),g(_,t,f),y(t,s),i=!0,c||(o=oe(t,"click",St(r[4])),c=!0)},p(_,[f]){const p={};f&32&&(p.$$scope={dirty:f,ctx:_}),!n&&f&2&&(n=!0,p.showModal=_[1],je(()=>n=!1)),e.$set(p),(!i||f&1)&&J(s,_[0]),(!i||f&1)&&h(t,"href",_[0])},i(_){i||(v(e.$$.fragment,_),i=!0)},o(_){I(e.$$.fragment,_),i=!1},d(_){_&&(u(l),u(t)),le(e,_),c=!1,o()}}}function Ol(r,e,n){let{href:l}=e,t=!1;function s(o){t=o,n(1,t)}const i=()=>window.open(l),c=()=>n(1,t=!0);return r.$$set=o=>{"href"in o&&n(0,l=o.href)},[l,t,s,i,c]}class Be extends ue{constructor(e){super(),_e(this,e,Ol,jl,fe,{href:0})}}function Pl(r){let e,n,l,t;const s=[ql,Ll],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=B()},l(o){n.l(o),l=B()},m(o,a){i[e].m(o,a),g(o,l,a),t=!0},p(o,a){let d=e;e=c(o),e===d?i[e].p(o,a):(W(),I(i[d],1,1,()=>{i[d]=null}),Y(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(l.parentNode,l))},i(o){t||(v(n),t=!0)},o(o){I(n),t=!1},d(o){o&&u(l),i[e].d(o)}}}function Vl(r){let e,n,l=r[0].filename+"",t,s,i,c;return i=new Be({props:{href:r[1]}}),{c(){e=U("span"),n=T("[File "),t=T(l),s=T(`]
			`),x(i.$$.fragment),this.h()},l(o){e=N(o,"SPAN",{class:!0});var a=V(e);n=S(a,"[File "),t=S(a,l),s=S(a,`]
			`),ee(i.$$.fragment,a),a.forEach(u),this.h()},h(){h(e,"class","text-gray-500")},m(o,a){g(o,e,a),y(e,n),y(e,t),y(e,s),te(i,e,null),c=!0},p(o,a){(!c||a&1)&&l!==(l=o[0].filename+"")&&J(t,l);const d={};a&2&&(d.href=o[1]),i.$set(d)},i(o){c||(v(i.$$.fragment,o),c=!0)},o(o){I(i.$$.fragment,o),c=!1},d(o){o&&u(e),le(i)}}}function Bl(r){let e,n,l;return{c(){e=U("audio"),n=U("source"),this.h()},l(t){e=N(t,"AUDIO",{});var s=V(e);n=N(s,"SOURCE",{src:!0}),s.forEach(u),this.h()},h(){Q(n.src,l=r[1])||h(n,"src",l),e.controls=!0},m(t,s){g(t,e,s),y(e,n)},p(t,s){s&2&&!Q(n.src,l=t[1])&&h(n,"src",l)},i:m,o:m,d(t){t&&u(e)}}}function Fl(r){let e,n,l;return{c(){e=U("video"),n=U("source"),this.h()},l(t){e=N(t,"VIDEO",{class:!0});var s=V(e);n=N(s,"SOURCE",{src:!0}),s.forEach(u),this.h()},h(){Q(n.src,l=r[1])||h(n,"src",l),e.controls=!0,h(e,"class","svelte-lgczjd")},m(t,s){g(t,e,s),y(e,n)},p(t,s){s&2&&!Q(n.src,l=t[1])&&h(n,"src",l)},i:m,o:m,d(t){t&&u(e)}}}function Rl(r){let e,n,l,t;const s=[Wl,Ql],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=B()},l(o){n.l(o),l=B()},m(o,a){i[e].m(o,a),g(o,l,a),t=!0},p(o,a){let d=e;e=c(o),e===d?i[e].p(o,a):(W(),I(i[d],1,1,()=>{i[d]=null}),Y(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(l.parentNode,l))},i(o){t||(v(n),t=!0)},o(o){I(n),t=!1},d(o){o&&u(l),i[e].d(o)}}}function Ll(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!0,pending:Jl,then:Kl,catch:Gl,value:4,error:6};return ne(n=fetch(r[1]),l),{c(){e=B(),l.block.c()},l(t){e=B(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&2&&n!==(n=fetch(r[1]))&&ne(n,l)||de(l,r,s)},i:m,o:m,d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function ql(r){let e,n,l,t,s;return l=new Be({props:{href:r[1]}}),{c(){e=U("span"),n=T("[Text "),x(l.$$.fragment),t=T("]"),this.h()},l(i){e=N(i,"SPAN",{class:!0});var c=V(e);n=S(c,"[Text "),ee(l.$$.fragment,c),t=S(c,"]"),c.forEach(u),this.h()},h(){h(e,"class","text-gray-500")},m(i,c){g(i,e,c),y(e,n),te(l,e,null),y(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),l.$set(o)},i(i){s||(v(l.$$.fragment,i),s=!0)},o(i){I(l.$$.fragment,i),s=!1},d(i){i&&u(e),le(l)}}}function Gl(r){let e,n,l=r[0].filename+"",t,s,i=r[6]+"",c;return{c(){e=U("p"),n=T("Unable to download "),t=T(l),s=T(": "),c=T(i)},l(o){e=N(o,"P",{});var a=V(e);n=S(a,"Unable to download "),t=S(a,l),s=S(a,": "),c=S(a,i),a.forEach(u)},m(o,a){g(o,e,a),y(e,n),y(e,t),y(e,s),y(e,c)},p(o,a){a&1&&l!==(l=o[0].filename+"")&&J(t,l),a&2&&i!==(i=o[6]+"")&&J(c,i)},d(o){o&&u(e)}}}function Kl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Xl,then:zl,catch:Hl,value:5};return ne(n=r[4].text(),l),{c(){e=B(),l.block.c()},l(t){e=B(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&2&&n!==(n=r[4].text())&&ne(n,l)||de(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function Hl(r){return{c:m,l:m,m,p:m,d:m}}function zl(r){let e,n=r[5]+"",l;return{c(){e=U("p"),l=T(n)},l(t){e=N(t,"P",{});var s=V(e);l=S(s,n),s.forEach(u)},m(t,s){g(t,e,s),y(e,l)},p(t,s){s&2&&n!==(n=t[5]+"")&&J(l,n)},d(t){t&&u(e)}}}function Xl(r){return{c:m,l:m,m,p:m,d:m}}function Jl(r){return{c:m,l:m,m,p:m,d:m}}function Ql(r){let e,n,l;return{c(){e=U("img"),this.h()},l(t){e=N(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Q(e.src,n=r[1])||h(e,"src",n),h(e,"alt",l=r[0].filename),h(e,"class","max-w-xl max-h-xl svelte-lgczjd")},m(t,s){g(t,e,s)},p(t,s){s&2&&!Q(e.src,n=t[1])&&h(e,"src",n),s&1&&l!==(l=t[0].filename)&&h(e,"alt",l)},i:m,o:m,d(t){t&&u(e)}}}function Wl(r){let e,n,l,t,s;return l=new Be({props:{href:r[1]}}),{c(){e=U("span"),n=T("[Image "),x(l.$$.fragment),t=T("]"),this.h()},l(i){e=N(i,"SPAN",{class:!0});var c=V(e);n=S(c,"[Image "),ee(l.$$.fragment,c),t=S(c,"]"),c.forEach(u),this.h()},h(){h(e,"class","text-gray-500")},m(i,c){g(i,e,c),y(e,n),te(l,e,null),y(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),l.$set(o)},i(i){s||(v(l.$$.fragment,i),s=!0)},o(i){I(l.$$.fragment,i),s=!1},d(i){i&&u(e),le(l)}}}function Yl(r){let e,n,l,t;const s=[Rl,Fl,Bl,Vl,Pl],i=[];function c(o,a){return o[0].metadata.type=="Image"?0:o[0].metadata.type=="Video"?1:o[0].metadata.type=="Audio"?2:o[0].metadata.type=="File"?3:o[0].metadata.type=="Text"?4:-1}return~(n=c(r))&&(l=i[n]=s[n](r)),{c(){e=U("div"),l&&l.c()},l(o){e=N(o,"DIV",{});var a=V(e);l&&l.l(a),a.forEach(u)},m(o,a){g(o,e,a),~n&&i[n].m(e,null),t=!0},p(o,[a]){let d=n;n=c(o),n===d?~n&&i[n].p(o,a):(l&&(W(),I(i[d],1,1,()=>{i[d]=null}),Y()),~n?(l=i[n],l?l.p(o,a):(l=i[n]=s[n](o),l.c()),v(l,1),l.m(e,null)):l=null)},i(o){t||(v(l),t=!0)},o(o){I(l),t=!1},d(o){o&&u(e),~n&&i[n].d()}}}function Zl(r,e,n){let l,t;const s=Z($e);se(r,s,c=>n(2,t=c));let{attachment:i}=e;return r.$$set=c=>{"attachment"in c&&n(0,i=c.attachment)},r.$$.update=()=>{r.$$.dirty&1&&n(1,l=Bt(i))},[i,l,t,s]}class xl extends ue{constructor(e){super(),_e(this,e,Zl,Yl,fe,{attachment:0})}}function en(r){let e,n="oop website embed, can't handle that :(";return{c(){e=U("span"),e.textContent=n,this.h()},l(l){e=N(l,"SPAN",{style:!0,"data-svelte-h":!0}),pe(e)!=="svelte-rjpnkw"&&(e.textContent=n),this.h()},h(){ye(e,"color","var(--secondary-foreground)")},m(l,t){g(l,e,t)},p:m,d(l){l&&u(e)}}}function tn(r){let e,n,l,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&Je(r),s=r[0].title&&Qe(r),i=r[0].description&&We(r);return{c(){e=U("div"),t&&t.c(),n=R(),s&&s.c(),l=R(),i&&i.c(),this.h()},l(c){e=N(c,"DIV",{class:!0,style:!0});var o=V(e);t&&t.l(o),n=L(o),s&&s.l(o),l=L(o),i&&i.l(o),o.forEach(u),this.h()},h(){h(e,"class","text-embed svelte-467pqv"),ye(e,"border-left","solid "+r[0].colour)},m(c,o){g(c,e,o),t&&t.m(e,null),y(e,n),s&&s.m(e,null),y(e,l),i&&i.m(e,null)},p(c,o){c[0].icon_url&&!c[1]["jolt:low-data-mode"]?t?t.p(c,o):(t=Je(c),t.c(),t.m(e,n)):t&&(t.d(1),t=null),c[0].title?s?s.p(c,o):(s=Qe(c),s.c(),s.m(e,l)):s&&(s.d(1),s=null),c[0].description?i?i.p(c,o):(i=We(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null),o&1&&ye(e,"border-left","solid "+c[0].colour)},d(c){c&&u(e),t&&t.d(),s&&s.d(),i&&i.d()}}}function ln(r){let e,n,l,t,s;return{c(){e=U("video"),n=U("source"),this.h()},l(i){e=N(i,"VIDEO",{});var c=V(e);n=N(c,"SOURCE",{src:!0,width:!0,height:!0}),c.forEach(u),this.h()},h(){Q(n.src,l=r[0].url)||h(n,"src",l),h(n,"width",t=r[0].width),h(n,"height",s=r[0].height),e.controls=!0},m(i,c){g(i,e,c),y(e,n)},p(i,c){c&1&&!Q(n.src,l=i[0].url)&&h(n,"src",l),c&1&&t!==(t=i[0].width)&&h(n,"width",t),c&1&&s!==(s=i[0].height)&&h(n,"height",s)},d(i){i&&u(e)}}}function nn(r){let e,n,l,t;return{c(){e=U("img"),this.h()},l(s){e=N(s,"IMG",{src:!0,width:!0,height:!0}),this.h()},h(){Q(e.src,n=r[0].url)||h(e,"src",n),h(e,"width",l=r[0].width),h(e,"height",t=r[0].height)},m(s,i){g(s,e,i)},p(s,i){i&1&&!Q(e.src,n=s[0].url)&&h(e,"src",n),i&1&&l!==(l=s[0].width)&&h(e,"width",l),i&1&&t!==(t=s[0].height)&&h(e,"height",t)},d(s){s&&u(e)}}}function Je(r){let e,n,l;return{c(){e=U("img"),this.h()},l(t){e=N(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){Q(e.src,n=r[0].icon_url)||h(e,"src",n),h(e,"alt",l=r[0].title),h(e,"width","24"),h(e,"height","24"),h(e,"class","svelte-467pqv")},m(t,s){g(t,e,s)},p(t,s){s&1&&!Q(e.src,n=t[0].icon_url)&&h(e,"src",n),s&1&&l!==(l=t[0].title)&&h(e,"alt",l)},d(t){t&&u(e)}}}function Qe(r){let e,n=r[0].title+"",l;return{c(){e=U("h1"),l=T(n)},l(t){e=N(t,"H1",{});var s=V(e);l=S(s,n),s.forEach(u)},m(t,s){g(t,e,s),y(e,l)},p(t,s){s&1&&n!==(n=t[0].title+"")&&J(l,n)},d(t){t&&u(e)}}}function We(r){let e,n=r[0].description+"",l;return{c(){e=U("p"),l=T(n)},l(t){e=N(t,"P",{});var s=V(e);l=S(s,n),s.forEach(u)},m(t,s){g(t,e,s),y(e,l)},p(t,s){s&1&&n!==(n=t[0].description+"")&&J(l,n)},d(t){t&&u(e)}}}function rn(r){let e;function n(s,i){if(s[0].type=="Image"&&!s[1]["jolt:low-data-mode"])return nn;if(s[0].type=="Video"&&!s[1]["jolt:low-data-mode"])return ln;if(s[0].type=="Text")return tn;if(s[0].type=="Website")return en}let l=n(r),t=l&&l(r);return{c(){t&&t.c(),e=B()},l(s){t&&t.l(s),e=B()},m(s,i){t&&t.m(s,i),g(s,e,i)},p(s,[i]){l===(l=n(s))&&t?t.p(s,i):(t&&t.d(1),t=l&&l(s),t&&(t.c(),t.m(e.parentNode,e)))},i:m,o:m,d(s){s&&u(e),t&&t.d(s)}}}function sn(r,e,n){let l,{embed:t}=e;const s=Z($e);return se(r,s,i=>n(1,l=i)),r.$$set=i=>{"embed"in i&&n(0,t=i.embed)},[t,l,s]}class on extends ue{constructor(e){super(),_e(this,e,sn,rn,fe,{embed:0})}}function cn(r){let e,n,l;return{c(){e=U("textarea"),this.h()},l(t){e=N(t,"TEXTAREA",{maxlength:!0,placeholder:!0,class:!0}),V(e).forEach(u),this.h()},h(){h(e,"maxlength","2000"),h(e,"placeholder",r[1]),h(e,"class","svelte-17tuigu")},m(t,s){g(t,e,s),Fe(e,r[0]),n||(l=[oe(e,"blur",r[3]),oe(e,"input",r[4]),oe(e,"keydown",r[6]),oe(e,"input",r[7])],n=!0)},p(t,[s]){s&2&&h(e,"placeholder",t[1]),s&1&&Fe(e,t[0])},i:m,o:m,d(t){t&&u(e),n=!1,Te(l)}}}function an(r,e,n){const l=Z(ke),t=Z(vt);let{placeholder:s=void 0}=e,{value:i=""}=e,{sendTypingEvents:c}=e;const o=Dt();function a(){c&&l.websocket.send({type:"EndTyping",channel:t._id})}function d(){if(c){if(i==""){l.websocket.send({type:"EndTyping",channel:t._id});return}l.websocket.send({type:"BeginTyping",channel:t._id})}}const _=p=>{var D;o("keydown",p),!(p.shiftKey||p.key!="Enter")&&(p.preventDefault(),(D=p.currentTarget.form)==null||D.requestSubmit())};function f(){i=this.value,n(0,i)}return r.$$set=p=>{"placeholder"in p&&n(1,s=p.placeholder),"value"in p&&n(0,i=p.value),"sendTypingEvents"in p&&n(5,c=p.sendTypingEvents)},[i,s,o,a,d,c,_,f]}class $t extends ue{constructor(e){super(),_e(this,e,an,cn,fe,{placeholder:1,value:0,sendTypingEvents:5})}}function Ye(r,e,n){const l=r.slice();return l[22]=e[n],l}function Ze(r,e,n){const l=r.slice();return l[25]=e[n],l}function De(r){const e=r.slice(),n=new Date(e[0].edited);return e[6]=n,e}function fn(r){const e=r.slice(),n=he(e[1],e[2],e[0]);return e[28]=n,e}function xe(r,e,n){const l=r.slice();return l[29]=e[n],l}function et(r){let e,n,l=ae(r[0].replies),t=[];for(let i=0;i<l.length;i+=1)t[i]=tt(xe(r,l,i));const s=i=>I(t[i],1,1,()=>{t[i]=null});return{c(){e=U("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var c=V(e);for(let o=0;o<t.length;o+=1)t[o].l(c);c.forEach(u),this.h()},h(){h(e,"class","flex-container")},m(i,c){g(i,e,c);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null);n=!0},p(i,c){if(c[0]&1){l=ae(i[0].replies);let o;for(o=0;o<l.length;o+=1){const a=xe(i,l,o);t[o]?(t[o].p(a,c),v(t[o],1)):(t[o]=tt(a),t[o].c(),v(t[o],1),t[o].m(e,null))}for(W(),o=l.length;o<t.length;o+=1)s(o);Y()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)v(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)I(t[c]);n=!1},d(i){i&&u(e),be(t,i)}}}function tt(r){let e,n;return e=new el({props:{id:r[29]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,t){te(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.id=l[29]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){le(e,l)}}}function lt(r){let e,n,l,t,s,i,c,o=we(r[6]).calendar()+"",a,d,_;const f=[_n,un],p=[];function D(k,C){return k[5]["jolt:low-data-mode"]||k[1]==null?0:1}function A(k,C){return C===1?fn(k):k}n=D(r),l=p[n]=f[n](A(r,n));let w=r[0].edited!=null&&nt(De(r));return{c(){e=U("div"),l.c(),t=R(),s=T(r[4]),i=R(),c=U("p"),a=T(o),d=R(),w&&w.c(),this.h()},l(k){e=N(k,"DIV",{class:!0});var C=V(e);l.l(C),t=L(C),s=S(C,r[4]),i=L(C),c=N(C,"P",{class:!0});var M=V(c);a=S(M,o),d=L(M),w&&w.l(M),M.forEach(u),C.forEach(u),this.h()},h(){h(c,"class","timestamp svelte-18ghfdr"),h(e,"class","user-detail svelte-18ghfdr")},m(k,C){g(k,e,C),p[n].m(e,null),y(e,t),y(e,s),y(e,i),y(e,c),y(c,a),y(c,d),w&&w.m(c,null),_=!0},p(k,C){let M=n;n=D(k),n===M?p[n].p(A(k,n),C):(W(),I(p[M],1,1,()=>{p[M]=null}),Y(),l=p[n],l?l.p(A(k,n),C):(l=p[n]=f[n](A(k,n)),l.c()),v(l,1),l.m(e,t)),(!_||C[0]&16)&&J(s,k[4]),(!_||C[0]&64)&&o!==(o=we(k[6]).calendar()+"")&&J(a,o),k[0].edited!=null?w?w.p(De(k),C):(w=nt(De(k)),w.c(),w.m(c,null)):w&&(w.d(1),w=null)},i(k){_||(v(l),_=!0)},o(k){I(l),_=!1},d(k){k&&u(e),p[n].d(),w&&w.d()}}}function un(r){let e,n,l,t;const s=[mn,hn],i=[];function c(o,a){return o[28]==null?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=B()},l(o){n.l(o),l=B()},m(o,a){i[e].m(o,a),g(o,l,a),t=!0},p(o,a){let d=e;e=c(o),e===d?i[e].p(o,a):(W(),I(i[d],1,1,()=>{i[d]=null}),Y(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(l.parentNode,l))},i(o){t||(v(n),t=!0)},o(o){I(n),t=!1},d(o){o&&u(l),i[e].d(o)}}}function _n(r){let e,n;return e=new Ee({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,t){te(e,l,t),n=!0},p:m,i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){le(e,l)}}}function hn(r){let e,n;return{c(){e=U("img"),this.h()},l(l){e=N(l,"IMG",{class:!0,alt:!0,src:!0,width:!0,height:!0}),this.h()},h(){h(e,"class","cover"),h(e,"alt",r[4]),Q(e.src,n=r[28])||h(e,"src",n),h(e,"width","40px"),h(e,"height","40px")},m(l,t){g(l,e,t)},p(l,t){t[0]&16&&h(e,"alt",l[4]),t[0]&7&&!Q(e.src,n=l[28])&&h(e,"src",n)},i:m,o:m,d(l){l&&u(e)}}}function mn(r){let e,n;return e=new Ee({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,t){te(e,l,t),n=!0},p:m,i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){le(e,l)}}}function nt(r){let e,n="(edited)",l,t,s;return{c(){e=U("span"),e.textContent=n,this.h()},l(i){e=N(i,"SPAN",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1c19xdw"&&(e.textContent=n),this.h()},h(){h(e,"class","timestamp svelte-18ghfdr")},m(i,c){g(i,e,c),t||(s=At(l=Rt.call(null,e,{placement:"top",content:we(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away-subtle",duration:100})),t=!0)},p(i,c){r=i,l&&jt(l.update)&&c[0]&1&&l.update.call(null,{placement:"top",content:we(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away-subtle",duration:100})},d(i){i&&u(e),t=!1,s()}}}function dn(r){let e,n=r[0].content+"",l;return{c(){e=U("span"),l=T(n),this.h()},l(t){e=N(t,"SPAN",{style:!0,class:!0});var s=V(e);l=S(s,n),s.forEach(u),this.h()},h(){ye(e,"overflow-wrap","break-word"),h(e,"class","whitespace-pre-wrap")},m(t,s){g(t,e,s),y(e,l)},p(t,s){s[0]&1&&n!==(n=t[0].content+"")&&J(l,n)},i:m,o:m,d(t){t&&u(e)}}}function pn(r){let e,n,l,t,s,i;function c(a){r[16](a)}let o={placeholder:"Edit this message",sendTypingEvents:!1};return r[3]!==void 0&&(o.value=r[3]),n=new $t({props:o}),ge.push(()=>Oe(n,"value",c)),n.$on("keydown",r[17]),{c(){e=U("form"),x(n.$$.fragment),this.h()},l(a){e=N(a,"FORM",{id:!0,class:!0});var d=V(e);ee(n.$$.fragment,d),d.forEach(u),this.h()},h(){h(e,"id","message-edit-form"),h(e,"class","message-form")},m(a,d){g(a,e,d),te(n,e,null),t=!0,s||(i=oe(e,"submit",r[11]),s=!0)},p(a,d){const _={};!l&&d[0]&8&&(l=!0,_.value=a[3],je(()=>l=!1)),n.$set(_)},i(a){t||(v(n.$$.fragment,a),t=!0)},o(a){I(n.$$.fragment,a),t=!1},d(a){a&&u(e),le(n),s=!1,i()}}}function rt(r){let e,n;return e=new Nl({props:{system:r[0].system}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,t){te(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.system=l[0].system),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){le(e,l)}}}function it(r){let e,n,l=ae(r[0].attachments),t=[];for(let i=0;i<l.length;i+=1)t[i]=st(Ze(r,l,i));const s=i=>I(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=B()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=B()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),n=!0},p(i,c){if(c[0]&1){l=ae(i[0].attachments);let o;for(o=0;o<l.length;o+=1){const a=Ze(i,l,o);t[o]?(t[o].p(a,c),v(t[o],1)):(t[o]=st(a),t[o].c(),v(t[o],1),t[o].m(e.parentNode,e))}for(W(),o=l.length;o<t.length;o+=1)s(o);Y()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)v(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)I(t[c]);n=!1},d(i){i&&u(e),be(t,i)}}}function st(r){let e,n;return e=new xl({props:{attachment:r[25]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,t){te(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.attachment=l[25]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){le(e,l)}}}function ot(r){let e,n,l=ae(r[0].embeds),t=[];for(let i=0;i<l.length;i+=1)t[i]=ct(Ye(r,l,i));const s=i=>I(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=B()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=B()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),n=!0},p(i,c){if(c[0]&1){l=ae(i[0].embeds);let o;for(o=0;o<l.length;o+=1){const a=Ye(i,l,o);t[o]?(t[o].p(a,c),v(t[o],1)):(t[o]=ct(a),t[o].c(),v(t[o],1),t[o].m(e.parentNode,e))}for(W(),o=l.length;o<t.length;o+=1)s(o);Y()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)v(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)I(t[c]);n=!1},d(i){i&&u(e),be(t,i)}}}function ct(r){let e,n;return e=new on({props:{embed:r[22]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,t){te(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.embed=l[22]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){le(e,l)}}}function gn(r){let e,n,l=r[12](r[0]),t,s,i,c,o,a,d,_,f=r[0].replies!=null&&r[0].replies.length!=0&&et(r),p=l&&lt(r);const D=[pn,dn],A=[];function w($,j){return $[3]!=null?0:$[0].content!=null?1:-1}~(s=w(r))&&(i=A[s]=D[s](r));let k=r[0].system!=null&&rt(r),C=r[0].attachments!=null&&it(r),M=r[0].embeds!=null&&ot(r);return{c(){e=U("div"),f&&f.c(),n=R(),p&&p.c(),t=R(),i&&i.c(),c=R(),k&&k.c(),o=R(),C&&C.c(),a=R(),M&&M.c(),this.h()},l($){e=N($,"DIV",{id:!0,class:!0});var j=V(e);f&&f.l(j),n=L(j),p&&p.l(j),t=L(j),i&&i.l(j),c=L(j),k&&k.l(j),o=L(j),C&&C.l(j),a=L(j),M&&M.l(j),j.forEach(u),this.h()},h(){h(e,"id",d=r[0]._id),h(e,"class","container svelte-18ghfdr")},m($,j){g($,e,j),f&&f.m(e,null),y(e,n),p&&p.m(e,null),y(e,t),~s&&A[s].m(e,null),y(e,c),k&&k.m(e,null),y(e,o),C&&C.m(e,null),y(e,a),M&&M.m(e,null),_=!0},p($,j){$[0].replies!=null&&$[0].replies.length!=0?f?(f.p($,j),j[0]&1&&v(f,1)):(f=et($),f.c(),v(f,1),f.m(e,n)):f&&(W(),I(f,1,1,()=>{f=null}),Y()),j[0]&1&&(l=$[12]($[0])),l?p?(p.p($,j),j[0]&1&&v(p,1)):(p=lt($),p.c(),v(p,1),p.m(e,t)):p&&(W(),I(p,1,1,()=>{p=null}),Y());let F=s;s=w($),s===F?~s&&A[s].p($,j):(i&&(W(),I(A[F],1,1,()=>{A[F]=null}),Y()),~s?(i=A[s],i?i.p($,j):(i=A[s]=D[s]($),i.c()),v(i,1),i.m(e,c)):i=null),$[0].system!=null?k?(k.p($,j),j[0]&1&&v(k,1)):(k=rt($),k.c(),v(k,1),k.m(e,o)):k&&(W(),I(k,1,1,()=>{k=null}),Y()),$[0].attachments!=null?C?(C.p($,j),j[0]&1&&v(C,1)):(C=it($),C.c(),v(C,1),C.m(e,a)):C&&(W(),I(C,1,1,()=>{C=null}),Y()),$[0].embeds!=null?M?(M.p($,j),j[0]&1&&v(M,1)):(M=ot($),M.c(),v(M,1),M.m(e,null)):M&&(W(),I(M,1,1,()=>{M=null}),Y()),(!_||j[0]&1&&d!==(d=$[0]._id))&&h(e,"id",d)},i($){_||(v(f),v(p),v(i),v(k),v(C),v(M),_=!0)},o($){I(f),I(p),I(i),I(k),I(C),I(M),_=!1},d($){$&&u(e),f&&f.d(),p&&p.d(),~s&&A[s].d(),k&&k.d(),C&&C.d(),M&&M.d()}}}function bn(r,e,n){let l,t,s,i,c,o;we.extend(qt);let{message:a}=e,{messageIndex:d}=e,_,f,p;const D=Z($e);se(r,D,E=>n(5,o=E));const A=Z(ke),w=Z(kt);se(r,w,E=>n(14,s=E));const k=Z(Pe),C=Z(Ve);se(r,C,E=>n(15,i=E));const M=Z(yt);se(r,M,E=>n(18,c=E));async function $(E,X){n(2,p=c==null?void 0:c.find(G=>G._id.server==E&&G._id.user==X))}async function j(){const E=await A.api.editMessage(a.channel,a._id,{content:_});k==null||k.update(X=>(X[X.findIndex(G=>G._id==a._id)]=E,X)),n(3,_=void 0)}function F(E){var K;if(k==null)return!0;const G=Ot(k).at(d-1);return E.author!=(G==null?void 0:G.author)||E.masquerade!=(G==null?void 0:G.masquerade)||Se(E._id)-Se((G==null?void 0:G._id)??"0".repeat(26))>=7*60*1e3||(((K=E.replies)==null?void 0:K.length)??0)!=0}function me(E){_=E,n(3,_)}const re=E=>{E.detail.key=="Escape"&&n(3,_=void 0)};return r.$$set=E=>{"message"in E&&n(0,a=E.message),"messageIndex"in E&&n(13,d=E.messageIndex)},r.$$.update=()=>{r.$$.dirty[0]&32769&&Ae(A.api,i??A.api.cache.users,a.author).then(E=>n(1,f=E)),r.$$.dirty[0]&16385&&(s==null||$(s,a.author)),r.$$.dirty[0]&7&&n(4,l=f==null?"Unknown User":ce(f,p,a)),r.$$.dirty[0]&1&&n(6,t=Se(a._id))},[a,f,p,_,l,o,t,D,w,C,M,j,F,d,s,i,me,re]}class kn extends ue{constructor(e){super(),_e(this,e,bn,gn,fe,{message:0,messageIndex:13},null,[-1,-1])}}function vn(r){let e,n;return{c(){e=Ue("svg"),n=Ue("path"),this.h()},l(l){e=Ne(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=V(e);n=Ne(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),V(n).forEach(u),t.forEach(u),this.h()},h(){h(n,"stroke-linecap","round"),h(n,"stroke-linejoin","round"),h(n,"d","M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","1.5"),h(e,"stroke","currentColor"),h(e,"width","24px"),h(e,"height","24px")},m(l,t){g(l,e,t),y(e,n)},p:m,i:m,o:m,d(l){l&&u(e)}}}class Et extends ue{constructor(e){super(),_e(this,e,null,vn,fe,{})}}function yn(r){let e,n;return{c(){e=Ue("svg"),n=Ue("path"),this.h()},l(l){e=Ne(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=V(e);n=Ne(t,"path",{"stroke-linecap":!0,d:!0}),V(n).forEach(u),t.forEach(u),this.h()},h(){h(n,"stroke-linecap","round"),h(n,"d","M16.5 12a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","1.5"),h(e,"stroke","currentColor"),h(e,"width","24px"),h(e,"height","24px")},m(l,t){g(l,e,t),y(e,n)},p:m,i:m,o:m,d(l){l&&u(e)}}}class wn extends ue{constructor(e){super(),_e(this,e,null,yn,fe,{})}}function at(r){const e=ce(r[5]);r[6]=e}function $n(r){let e,n,l;return e=new Ee({}),{c(){x(e.$$.fragment),n=T(`
				<UnknownUser>`)},l(t){ee(e.$$.fragment,t),n=S(t,`
				<UnknownUser>`)},m(t,s){te(e,t,s),g(t,n,s),l=!0},p:m,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){t&&u(n),le(e,t)}}}function En(r){at(r);let e,n,l,t,s=r[6]+"",i;return{c(){e=U("img"),t=R(),i=T(s),this.h()},l(c){e=N(c,"IMG",{class:!0,src:!0,alt:!0}),t=L(c),i=S(c,s),this.h()},h(){h(e,"class","cover svelte-zbyf5q"),Q(e.src,n=he(r[5]))||h(e,"src",n),h(e,"alt",l=r[6])},m(c,o){g(c,e,o),g(c,t,o),g(c,i,o)},p(c,o){at(c),o&1&&!Q(e.src,n=he(c[5]))&&h(e,"src",n),o&1&&l!==(l=c[6])&&h(e,"alt",l),o&1&&s!==(s=c[6]+"")&&J(i,s)},i:m,o:m,d(c){c&&(u(e),u(t),u(i))}}}function In(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function ft(r){let e,n=r[0].message.content+"",l;return{c(){e=U("p"),l=T(n),this.h()},l(t){e=N(t,"P",{class:!0});var s=V(e);l=S(s,n),s.forEach(u),this.h()},h(){h(e,"class","message-content svelte-zbyf5q")},m(t,s){g(t,e,s),y(e,l)},p(t,s){s&1&&n!==(n=t[0].message.content+"")&&J(l,n)},d(t){t&&u(e)}}}function Cn(r){let e,n,l,t,s,i,c,o,a,d,_,f,p,D,A=r[0].mention?"ON":"OFF",w,k,C,M,$,j,F,me,re,E={ctx:r,current:null,token:null,hasCatch:!0,pending:In,then:En,catch:$n,value:5,blocks:[,,,]};ne(s=r[2].api.fetchUser(r[0].message.author),E);let X=r[0].message.content&&ft(r);return p=new wn({}),j=new Et({}),{c(){e=U("div"),n=U("p"),l=T(`Replying to
		`),t=U("strong"),E.block.c(),i=R(),X&&X.c(),c=R(),o=U("div"),a=R(),d=U("label"),_=U("input"),f=R(),x(p.$$.fragment),D=R(),w=T(A),C=R(),M=U("div"),$=U("button"),x(j.$$.fragment),this.h()},l(G){e=N(G,"DIV",{class:!0});var K=V(e);n=N(K,"P",{});var O=V(n);l=S(O,`Replying to
		`),t=N(O,"STRONG",{});var P=V(t);E.block.l(P),P.forEach(u),O.forEach(u),i=L(K),X&&X.l(K),c=L(K),o=N(K,"DIV",{class:!0}),V(o).forEach(u),a=L(K),d=N(K,"LABEL",{class:!0,"aria-label":!0});var z=V(d);_=N(z,"INPUT",{id:!0,style:!0,type:!0}),f=L(z),ee(p.$$.fragment,z),D=L(z),w=S(z,A),z.forEach(u),C=L(K),M=N(K,"DIV",{});var b=V(M);$=N(b,"BUTTON",{});var q=V($);ee(j.$$.fragment,q),q.forEach(u),b.forEach(u),K.forEach(u),this.h()},h(){h(o,"class","flex-divider"),h(_,"id","mention"),ye(_,"display","none"),h(_,"type","checkbox"),h(d,"class","mention-button svelte-zbyf5q"),h(d,"aria-label",k="Mention author "+(r[0].mention?"ON":"OFF")),h(e,"class","container svelte-zbyf5q")},m(G,K){g(G,e,K),y(e,n),y(n,l),y(n,t),E.block.m(t,E.anchor=null),E.mount=()=>t,E.anchor=null,y(e,i),X&&X.m(e,null),y(e,c),y(e,o),y(e,a),y(e,d),y(d,_),_.checked=r[0].mention,y(d,f),te(p,d,null),y(d,D),y(d,w),y(e,C),y(e,M),y(M,$),te(j,$,null),F=!0,me||(re=[oe(_,"change",r[3]),oe($,"click",r[4])],me=!0)},p(G,[K]){r=G,E.ctx=r,K&1&&s!==(s=r[2].api.fetchUser(r[0].message.author))&&ne(s,E)||de(E,r,K),r[0].message.content?X?X.p(r,K):(X=ft(r),X.c(),X.m(e,c)):X&&(X.d(1),X=null),K&1&&(_.checked=r[0].mention),(!F||K&1)&&A!==(A=r[0].mention?"ON":"OFF")&&J(w,A),(!F||K&1&&k!==(k="Mention author "+(r[0].mention?"ON":"OFF")))&&h(d,"aria-label",k)},i(G){F||(v(E.block),v(p.$$.fragment,G),v(j.$$.fragment,G),F=!0)},o(G){for(let K=0;K<3;K+=1){const O=E.blocks[K];I(O)}I(p.$$.fragment,G),I(j.$$.fragment,G),F=!1},d(G){G&&u(e),E.block.d(),E.token=null,E=null,X&&X.d(),le(p),le(j),me=!1,Te(re)}}}function Mn(r,e,n){let{reply:l}=e;const t=Z(ke),s=Z(wt);function i(){l.mention=this.checked,n(0,l)}const c=()=>s.update(o=>(o=o.filter(a=>a.message._id!=l.message._id),o));return r.$$set=o=>{"reply"in o&&n(0,l=o.reply)},[l,s,t,i,c]}class Un extends ue{constructor(e){super(),_e(this,e,Mn,Cn,fe,{reply:0})}}function ut(r,e,n){const l=r.slice();return l[29]=e[n],l}function _t(r,e,n){const l=r.slice();l[32]=e[n];const t=ce(l[32]);return l[33]=t,l}function ht(r,e,n){const l=r.slice();return l[36]=e[n],l[38]=n,l}function Nn(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Tn(r){let e,n,l=ae(r[9]),t=[];for(let i=0;i<l.length;i+=1)t[i]=mt(ht(r,l,i));const s=i=>I(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=B()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=B()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),n=!0},p(i,c){if(c[0]&512){l=ae(i[9]);let o;for(o=0;o<l.length;o+=1){const a=ht(i,l,o);t[o]?(t[o].p(a,c),v(t[o],1)):(t[o]=mt(a),t[o].c(),v(t[o],1),t[o].m(e.parentNode,e))}for(W(),o=l.length;o<t.length;o+=1)s(o);Y()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)v(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)I(t[c]);n=!1},d(i){i&&u(e),be(t,i)}}}function mt(r){let e,n;return e=new kn({props:{message:r[36],messageIndex:r[38]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,t){te(e,l,t),n=!0},p(l,t){const s={};t[0]&512&&(s.message=l[36]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){le(e,l)}}}function Sn(r){let e;return{c(){e=T("Loading...")},l(n){e=S(n,"Loading...")},m(n,l){g(n,e,l)},p:m,i:m,o:m,d(n){n&&u(e)}}}function dt(r){let e,n,l,t=Array.from(r[1]).map(bt).join(", ")+"",s,i,c,o,a,d,_,f,p;return d=new Et({}),{c(){e=U("div"),n=U("p"),l=T(`Uploading
				`),s=T(t),i=R(),c=U("div"),o=R(),a=U("button"),x(d.$$.fragment),this.h()},l(D){e=N(D,"DIV",{class:!0});var A=V(e);n=N(A,"P",{});var w=V(n);l=S(w,`Uploading
				`),s=S(w,t),w.forEach(u),i=L(A),c=N(A,"DIV",{class:!0}),V(c).forEach(u),o=L(A),a=N(A,"BUTTON",{});var k=V(a);ee(d.$$.fragment,k),k.forEach(u),A.forEach(u),this.h()},h(){h(c,"class","flex-divider"),h(e,"class","flex-container")},m(D,A){g(D,e,A),y(e,n),y(n,l),y(n,s),y(e,i),y(e,c),y(e,o),y(e,a),te(d,a,null),_=!0,f||(p=oe(a,"click",r[17]),f=!0)},p(D,A){(!_||A[0]&2)&&t!==(t=Array.from(D[1]).map(bt).join(", ")+"")&&J(s,t)},i(D){_||(v(d.$$.fragment,D),_=!0)},o(D){I(d.$$.fragment,D),_=!1},d(D){D&&u(e),le(d),f=!1,p()}}}function Dn(r){let e,n,l;return{c(){e=U("img"),this.h()},l(t){e=N(t,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),this.h()},h(){h(e,"class","cover"),Q(e.src,n=he(r[32]))||h(e,"src",n),h(e,"width","16px"),h(e,"height","16px"),h(e,"alt",l=r[33])},m(t,s){g(t,e,s)},p(t,s){s[0]&32&&!Q(e.src,n=he(t[32]))&&h(e,"src",n),s[0]&32&&l!==(l=t[33])&&h(e,"alt",l)},i:m,o:m,d(t){t&&u(e)}}}function An(r){let e,n;return e=new Ee({}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,t){te(e,l,t),n=!0},p:m,i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){le(e,l)}}}function pt(r){let e,n,l,t,s=r[33]+"",i,c,o;const a=[An,Dn],d=[];function _(f,p){return f[4]["jolt:low-data-mode"]?0:1}return n=_(r),l=d[n]=a[n](r),{c(){e=U("div"),l.c(),t=R(),i=T(s),c=T(" is typing..."),this.h()},l(f){e=N(f,"DIV",{class:!0});var p=V(e);l.l(p),t=L(p),i=S(p,s),c=S(p," is typing..."),p.forEach(u),this.h()},h(){h(e,"class","typing-indicator svelte-bx01o2")},m(f,p){g(f,e,p),d[n].m(e,null),y(e,t),y(e,i),y(e,c),o=!0},p(f,p){let D=n;n=_(f),n===D?d[n].p(f,p):(W(),I(d[D],1,1,()=>{d[D]=null}),Y(),l=d[n],l?l.p(f,p):(l=d[n]=a[n](f),l.c()),v(l,1),l.m(e,t)),(!o||p[0]&32)&&s!==(s=f[33]+"")&&J(i,s)},i(f){o||(v(l),o=!0)},o(f){I(l),o=!1},d(f){f&&u(e),d[n].d()}}}function gt(r){let e,n;return e=new Un({props:{reply:r[29]}}),{c(){x(e.$$.fragment)},l(l){ee(e.$$.fragment,l)},m(l,t){te(e,l,t),n=!0},p(l,t){const s={};t[0]&256&&(s.reply=l[29]),e.$set(s)},i(l){n||(v(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){le(e,l)}}}function jn(r){let e,n,l,t,s,i,c,o,a,d,_,f,p,D,A,w,k,C,M={ctx:r,current:null,token:null,hasCatch:!1,pending:Sn,then:Tn,catch:Nn,blocks:[,,,]};ne(l=r[3],M);let $=r[1]!=null&&r[1].length!=0&&dt(r),j=ae(r[5]),F=[];for(let O=0;O<j.length;O+=1)F[O]=pt(_t(r,j,O));const me=O=>I(F[O],1,1,()=>{F[O]=null});let re=ae(r[8]),E=[];for(let O=0;O<re.length;O+=1)E[O]=gt(ut(r,re,O));const X=O=>I(E[O],1,1,()=>{E[O]=null});d=new Lt({});function G(O){r[20](O)}let K={sendTypingEvents:r[4]["jolt:send-typing-indicators"],placeholder:"Send message in "+r[7]};return r[0]!==void 0&&(K.value=r[0]),D=new $t({props:K}),ge.push(()=>Oe(D,"value",G)),{c(){e=U("main"),n=U("div"),M.block.c(),t=R(),$&&$.c(),s=R();for(let O=0;O<F.length;O+=1)F[O].c();i=R();for(let O=0;O<E.length;O+=1)E[O].c();c=R(),o=U("form"),a=U("label"),x(d.$$.fragment),_=R(),f=U("input"),p=R(),x(D.$$.fragment),this.h()},l(O){e=N(O,"MAIN",{class:!0});var P=V(e);n=N(P,"DIV",{class:!0});var z=V(n);M.block.l(z),z.forEach(u),t=L(P),$&&$.l(P),s=L(P);for(let H=0;H<F.length;H+=1)F[H].l(P);i=L(P);for(let H=0;H<E.length;H+=1)E[H].l(P);c=L(P),o=N(P,"FORM",{class:!0,id:!0});var b=V(o);a=N(b,"LABEL",{for:!0,class:!0});var q=V(a);ee(d.$$.fragment,q),q.forEach(u),_=L(b),f=N(b,"INPUT",{type:!0,id:!0,max:!0,class:!0}),p=L(b),ee(D.$$.fragment,b),b.forEach(u),P.forEach(u),this.h()},h(){h(n,"class","messages-list svelte-bx01o2"),h(a,"for","file-upload"),h(a,"class","svelte-bx01o2"),h(f,"type","file"),h(f,"id","file-upload"),h(f,"max","5"),h(f,"class","svelte-bx01o2"),h(o,"class","message-form"),h(o,"id","send-message-form"),h(e,"class","main-content-container svelte-bx01o2")},m(O,P){g(O,e,P),y(e,n),M.block.m(n,M.anchor=null),M.mount=()=>n,M.anchor=null,r[16](n),y(e,t),$&&$.m(e,null),y(e,s);for(let z=0;z<F.length;z+=1)F[z]&&F[z].m(e,null);y(e,i);for(let z=0;z<E.length;z+=1)E[z]&&E[z].m(e,null);y(e,c),y(e,o),y(o,a),te(d,a,null),y(o,_),y(o,f),r[19](f),y(o,p),te(D,o,null),w=!0,k||(C=[oe(f,"change",r[18]),oe(o,"submit",r[13])],k=!0)},p(O,P){if(r=O,M.ctx=r,P[0]&8&&l!==(l=r[3])&&ne(l,M)||de(M,r,P),r[1]!=null&&r[1].length!=0?$?($.p(r,P),P[0]&2&&v($,1)):($=dt(r),$.c(),v($,1),$.m(e,s)):$&&(W(),I($,1,1,()=>{$=null}),Y()),P[0]&48){j=ae(r[5]);let b;for(b=0;b<j.length;b+=1){const q=_t(r,j,b);F[b]?(F[b].p(q,P),v(F[b],1)):(F[b]=pt(q),F[b].c(),v(F[b],1),F[b].m(e,i))}for(W(),b=j.length;b<F.length;b+=1)me(b);Y()}if(P[0]&256){re=ae(r[8]);let b;for(b=0;b<re.length;b+=1){const q=ut(r,re,b);E[b]?(E[b].p(q,P),v(E[b],1)):(E[b]=gt(q),E[b].c(),v(E[b],1),E[b].m(e,c))}for(W(),b=re.length;b<E.length;b+=1)X(b);Y()}const z={};P[0]&16&&(z.sendTypingEvents=r[4]["jolt:send-typing-indicators"]),P[0]&128&&(z.placeholder="Send message in "+r[7]),!A&&P[0]&1&&(A=!0,z.value=r[0],je(()=>A=!1)),D.$set(z)},i(O){if(!w){v(M.block),v($);for(let P=0;P<j.length;P+=1)v(F[P]);for(let P=0;P<re.length;P+=1)v(E[P]);v(d.$$.fragment,O),v(D.$$.fragment,O),w=!0}},o(O){for(let P=0;P<3;P+=1){const z=M.blocks[P];I(z)}I($),F=F.filter(Boolean);for(let P=0;P<F.length;P+=1)I(F[P]);E=E.filter(Boolean);for(let P=0;P<E.length;P+=1)I(E[P]);I(d.$$.fragment,O),I(D.$$.fragment,O),w=!1},d(O){O&&u(e),M.block.d(),M.token=null,M=null,r[16](null),$&&$.d(),be(F,O),be(E,O),le(d),r[19](null),le(D),k=!1,Te(C)}}}const bt=r=>r.name;function On(r,e,n){let l,t,s,{channel:i}=e,{replies:c=[]}=e,{messageInput:o=""}=e,{files:a=null}=e;const d=Z($e);se(r,d,b=>n(4,t=b));const _=Z(ke),f=Me([]);se(r,f,b=>n(9,s=b));const p=Me([]),D=Me([]),A=Me(c);se(r,A,b=>n(8,l=b)),ve(Pe,f),ve(yt,p),ve(Ve,D),ve(wt,A),ve(vt,i);let w,k=[],C,M="Unknown Channel",$=Promise.resolve();async function j(b){if(!b){_.removeAllListeners("ChannelStartTyping"),_.removeAllListeners("ChannelStopTyping");return}_.on("ChannelStartTyping",async({id:q,user:H})=>{var ie;if(!(H==((ie=_.user)==null?void 0:ie._id)||q!=i._id)){for(const{_id:Ie}of k)if(H==Ie)return;n(5,k[k.length]=await _.api.fetchUser(H),k)}}),_.on("ChannelStopTyping",({id:q,user:H})=>{q==i._id&&n(5,k=k.filter(ie=>ie._id!=H))})}async function F(){let b=[];(C==null?void 0:C.files)!=null&&(b=await Promise.all(Array.from(C.files).map(q=>_.autumn.uploadFile(q))),n(6,C.value="",C),n(1,a=null)),await _.api.sendMessage(i._id,{content:o.trim(),replies:l.map(({message:{_id:q},mention:H})=>({id:q,mention:H})),attachments:b}),A.set([]),n(0,o="")}function me(b){if(b.channel!=i._id)return;const q=w.offsetHeight+w.scrollTop>w.scrollHeight-20;document.hasFocus()&&q&&_.api.ackMessage(i._id,b._id),f.update(H=>(H.push(b),H)),q&&Re().then(()=>{var H,ie;((H=w.lastElementChild)==null?void 0:H.scrollIntoView)==null?w.scrollTo(0,w.scrollHeight):(ie=w.lastElementChild)==null||ie.scrollIntoView({behavior:"smooth"})})}function re({id:b,channel:q}){q==i._id&&f.update(H=>H.filter(ie=>ie._id!=b))}function E({id:b,channel:q,data:H}){q==i._id&&f.update(ie=>{const Ie=ie.findIndex(It=>It._id==b),Ce=ie[Ie];return H.content!=null&&(Ce.content=H.content),H.embeds!=null&&(Ce.embeds=H.embeds),Ce.edited=H.edited,ie[Ie]=Ce,ie})}Pt(()=>{_.on("Message",me),_.on("MessageDelete",re),_.on("MessageUpdate",E)}),Vt(()=>{_.removeListener("Message",me),_.removeListener("MessageDelete",re),_.removeListener("MessageUpdate",E)});async function X(b){var q;if(b.channel_type=="TextChannel"||b.channel_type=="Group"){n(7,M=`#${b.name}`);return}if(b.channel_type=="SavedMessages"){n(7,M="Saved Notes");return}try{n(7,M=`@${ce(await _.api.fetchUser(b.recipients[0]==((q=_.user)==null?void 0:q._id)?b.recipients[1]:b.recipients[0]))}`)}catch{n(7,M="Unknown Channel")}}function G(b){ge[b?"unshift":"push"](()=>{w=b,n(2,w)})}const K=()=>{C!=null&&(n(6,C.value="",C),n(1,a=null))};function O(){a=this.files,n(1,a)}function P(b){ge[b?"unshift":"push"](()=>{C=b,n(6,C)})}function z(b){o=b,n(0,o)}return r.$$set=b=>{"channel"in b&&n(14,i=b.channel),"replies"in b&&n(15,c=b.replies),"messageInput"in b&&n(0,o=b.messageInput),"files"in b&&n(1,a=b.files)},r.$$.update=()=>{r.$$.dirty[0]&16396&&(n(3,$=_.api.queryMessages(i._id,{sort:"Latest",include_users:!0}).then(b=>{if(Array.isArray(b)){const q=b.reverse();f.set(q)}else{const q=b.messages.reverse();f.set(q),D.set(b.users),p.set(b.members??[])}})),A.set([]),n(5,k=[]),$.then(()=>{Re().then(()=>w.scrollTo(0,w.scrollHeight))})),r.$$.dirty[0]&16&&j(t["jolt:receive-typing-indicators"]),r.$$.dirty[0]&16384&&X(i)},[o,a,w,$,t,k,C,M,l,s,d,f,A,F,i,c,G,K,O,P,z]}class Qn extends ue{constructor(e){super(),_e(this,e,On,jn,fe,{channel:14,replies:15,messageInput:0,files:1},null,[-1,-1])}}export{Qn as T};
