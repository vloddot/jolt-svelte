import{s as ge,c as ee,n as h,d as Fe,u as Le,g as Ge,e as He,r as Ae,h as Dt,b as De,i as Ut,f as ue,j as Ne,o as At,k as St,t as jt}from"./scheduler.1c041516.js";import{S as ve,i as $e,g as D,h as U,j as R,f as _,k as v,a as b,d as w,p as le,t as M,b as ne,e as q,s as S,c as j,m as I,n as C,x as k,o as K,r as oe,u as se,v as fe,w as ce,z as _e,C as Pt,D as Ot,A as Se,l as Ue,y as ye,E as ze}from"./index.69b25549.js";import{h as ie,u as be}from"./await_block.5a2be2b2.js";import{e as ae}from"./each.e59479a4.js";import{b as de}from"./paths.1bf187e1.js";import{g as te,c as je,a as Ie,b as Vt}from"./context.03d0c4ff.js";import{g as pe,b as me,a as Rt}from"./util.d0b945c2.js";import{U as Ee}from"./UserProfilePicture.baf0363a.js";import{X as Ce,e as Bt,Y as Kt}from"./runtime.esm.4c488b56.js";import{w as Te}from"./index.cd290ac5.js";import{a as Ct,s as Mt}from"./context.fa34f1f8.js";import{d as Ft}from"./index.esm.4b6e8736.js";async function Oe(r,e,n){if(n=="0".repeat(26))return;const l=e.find(t=>t._id==n);return l??await r.fetchUser(n)}const Ve=Symbol(),Nt=Symbol(),Re=Symbol(),Tt=Symbol();function qe(r){const e=me(r[14]);r[15]=e}function Xe(r){var o;let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Xt,then:Gt,catch:Lt,value:13,blocks:[,,,]};return ie(n=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),t),{c(){e=q(),t.block.c()},l(i){e=q(),t.block.l(i)},m(i,f){b(i,e,f),t.block.m(i,t.anchor=f),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(i,f){var s;r=i,t.ctx=r,f&13&&n!==(n=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&ie(n,t)||be(t,r,f)},i(i){l||(w(t.block),l=!0)},o(i){for(let f=0;f<3;f+=1){const s=t.blocks[f];M(s)}l=!1},d(i){i&&_(e),t.block.d(i),t.token=null,t=null}}}function Lt(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Gt(r){let e,n,l,t=!r[4]["jolt:low-data-mode"]&&We(r),o=r[13].content!=null&&Ye(r);return{c(){t&&t.c(),e=S(),o&&o.c(),n=q()},l(i){t&&t.l(i),e=j(i),o&&o.l(i),n=q()},m(i,f){t&&t.m(i,f),b(i,e,f),o&&o.m(i,f),b(i,n,f),l=!0},p(i,f){i[4]["jolt:low-data-mode"]?t&&(le(),M(t,1,1,()=>{t=null}),ne()):t?(t.p(i,f),f&16&&w(t,1)):(t=We(i),t.c(),w(t,1),t.m(e.parentNode,e)),i[13].content!=null?o?o.p(i,f):(o=Ye(i),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i(i){l||(w(t),l=!0)},o(i){M(t),l=!1},d(i){i&&(_(e),_(n)),t&&t.d(i),o&&o.d(i)}}}function We(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:qt,then:zt,catch:Ht,value:14,blocks:[,,,]};return ie(e=Oe(r[6].api,r[5]??r[6].api.cache.users,r[13].author),t),{c(){t.block.c(),n=I(":")},l(o){t.block.l(o),n=C(o,":")},m(o,i){t.block.m(o,t.anchor=i),t.mount=()=>n.parentNode,t.anchor=n,b(o,n,i),l=!0},p(o,i){r=o,t.ctx=r,i&45&&e!==(e=Oe(r[6].api,r[5]??r[6].api.cache.users,r[13].author))&&ie(e,t)||be(t,r,i)},i(o){l||(w(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];M(f)}l=!1},d(o){o&&_(n),t.block.d(o),t.token=null,t=null}}}function Ht(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function zt(r){qe(r);let e,n,l=r[15]+"",t,o,i;return e=new Ee({props:{src:pe(r[14]),name:r[15],width:24,height:24}}),{c(){oe(e.$$.fragment),n=S(),t=I(l),o=S()},l(f){se(e.$$.fragment,f),n=j(f),t=C(f,l),o=j(f)},m(f,s){fe(e,f,s),b(f,n,s),b(f,t,s),b(f,o,s),i=!0},p(f,s){qe(f);const u={};s&45&&(u.src=pe(f[14])),s&45&&(u.name=f[15]),e.$set(u),(!i||s&45)&&l!==(l=f[15]+"")&&K(t,l)},i(f){i||(w(e.$$.fragment,f),i=!0)},o(f){M(e.$$.fragment,f),i=!1},d(f){f&&(_(n),_(t),_(o)),ce(e,f)}}}function qt(r){let e;return{c(){e=I(`<Unknown User>
				`)},l(n){e=C(n,`<Unknown User>
				`)},m(n,l){b(n,e,l)},p:h,i:h,o:h,d(n){n&&_(e)}}}function Ye(r){let e,n=r[13].content+"",l;return{c(){e=D("span"),l=I(n),this.h()},l(t){e=U(t,"SPAN",{class:!0});var o=R(e);l=C(o,n),o.forEach(_),this.h()},h(){v(e,"class","text-gray-600")},m(t,o){b(t,e,o),k(e,l)},p(t,o){o&13&&n!==(n=t[13].content+"")&&K(l,n)},d(t){t&&_(e)}}}function Xt(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Wt(r){let e,n,l,t=r[2]!=null&&Xe(r);return{c(){e=D("a"),t&&t.c(),this.h()},l(o){e=U(o,"A",{href:!0});var i=R(e);t&&t.l(i),i.forEach(_),this.h()},h(){v(e,"href",n=de+"/"+(r[1]==null?`channels/${r[2]}#${r[0]}`:`servers/${r[1]}/channels/${r[2]}#${r[0]}`))},m(o,i){b(o,e,i),t&&t.m(e,null),l=!0},p(o,[i]){o[2]!=null?t?(t.p(o,i),i&4&&w(t,1)):(t=Xe(o),t.c(),w(t,1),t.m(e,null)):t&&(le(),M(t,1,1,()=>{t=null}),ne()),(!l||i&7&&n!==(n=de+"/"+(o[1]==null?`channels/${o[2]}#${o[0]}`:`servers/${o[1]}/channels/${o[2]}#${o[0]}`)))&&v(e,"href",n)},i(o){l||(w(t),l=!0)},o(o){M(t),l=!1},d(o){o&&_(e),t&&t.d()}}}function Yt(r,e,n){let l,t,o,i,f;const s=te(je),u=te(Ie);ee(r,u,E=>n(4,i=E));const a=te(Ct);ee(r,a,E=>n(1,l=E));const c=te(Mt);ee(r,c,E=>n(2,t=E));const m=te(Ve);ee(r,m,E=>n(3,o=E));const B=te(Re);ee(r,B,E=>n(5,f=E));let{id:G}=e;const P=({_id:E})=>G==E;return r.$$set=E=>{"id"in E&&n(0,G=E.id)},[G,l,t,o,i,f,s,u,a,c,m,B,P]}class Jt extends ve{constructor(e){super(),$e(this,e,Yt,Wt,ge,{id:0})}}const Qt=r=>({}),Je=r=>({});function Zt(r){let e,n,l,t,o,i,f,s,u,a,c=r[2]("confirm")+"",m,B,G,P=r[2]("cancel")+"",E,X,F,A;const re=r[4].header,H=Fe(re,r,r[3],Je),V=r[4].default,Q=Fe(V,r,r[3],null);return{c(){e=D("dialog"),n=D("div"),H&&H.c(),l=S(),t=D("hr"),o=S(),Q&&Q.c(),i=S(),f=D("hr"),s=S(),u=D("form"),a=D("button"),m=I(c),B=S(),G=D("button"),E=I(P),this.h()},l(p){e=U(p,"DIALOG",{});var g=R(e);n=U(g,"DIV",{});var d=R(n);H&&H.l(d),l=j(d),t=U(d,"HR",{}),o=j(d),Q&&Q.l(d),i=j(d),f=U(d,"HR",{}),s=j(d),u=U(d,"FORM",{method:!0});var O=R(u);a=U(O,"BUTTON",{type:!0});var Z=R(a);m=C(Z,c),Z.forEach(_),B=j(O),G=U(O,"BUTTON",{type:!0});var Y=R(G);E=C(Y,P),Y.forEach(_),O.forEach(_),d.forEach(_),g.forEach(_),this.h()},h(){v(a,"type","submit"),v(G,"type","reset"),v(u,"method","dialog")},m(p,g){b(p,e,g),k(e,n),H&&H.m(n,null),k(n,l),k(n,t),k(n,o),Q&&Q.m(n,null),k(n,i),k(n,f),k(n,s),k(n,u),k(u,a),k(a,m),k(u,B),k(u,G),k(G,E),r[7](e),X=!0,F||(A=[_e(G,"click",r[6]),_e(u,"submit",r[5]),_e(e,"close",r[8])],F=!0)},p(p,[g]){H&&H.p&&(!X||g&8)&&Le(H,re,p,p[3],X?He(re,p[3],g,Qt):Ge(p[3]),Je),Q&&Q.p&&(!X||g&8)&&Le(Q,V,p,p[3],X?He(V,p[3],g,null):Ge(p[3]),null),(!X||g&4)&&c!==(c=p[2]("confirm")+"")&&K(m,c),(!X||g&4)&&P!==(P=p[2]("cancel")+"")&&K(E,P)},i(p){X||(w(H,p),w(Q,p),X=!0)},o(p){M(H,p),M(Q,p),X=!1},d(p){p&&_(e),H&&H.d(p),Q&&Q.d(p),r[7](null),F=!1,Ae(A)}}}function xt(r,e,n){let l;ee(r,Ce,m=>n(2,l=m));let{$$slots:t={},$$scope:o}=e,{showModal:i}=e,f;function s(m){Dt.call(this,r,m)}const u=()=>n(0,i=!1);function a(m){De[m?"unshift":"push"](()=>{f=m,n(1,f)})}const c=()=>n(0,i=!1);return r.$$set=m=>{"showModal"in m&&n(0,i=m.showModal),"$$scope"in m&&n(3,o=m.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(i?f==null||f.showModal():f==null||f.close())},[i,f,l,o,t,s,u,a,c]}class el extends ve{constructor(e){super(),$e(this,e,xt,Zt,ge,{showModal:0})}}function tl(r){let e,n="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=D("p"),e.textContent=n},l(l){e=U(l,"P",{"data-svelte-h":!0}),Se(e)!=="svelte-os1rtp"&&(e.textContent=n)},m(l,t){b(l,e,t)},p:h,d(l){l&&_(e)}}}function ll(r){let e,n="External Link";return{c(){e=D("h1"),e.textContent=n,this.h()},l(l){e=U(l,"H1",{class:!0,slot:!0,"data-svelte-h":!0}),Se(e)!=="svelte-3ozcvb"&&(e.textContent=n),this.h()},h(){v(e,"class","text-3xl"),v(e,"slot","header")},m(l,t){b(l,e,t)},p:h,d(l){l&&_(e)}}}function nl(r){let e,n,l,t,o,i,f,s;function u(c){r[2](c)}let a={$$slots:{header:[ll],default:[tl]},$$scope:{ctx:r}};return r[1]!==void 0&&(a.showModal=r[1]),e=new el({props:a}),De.push(()=>Pt(e,"showModal",u)),e.$on("submit",r[3]),{c(){oe(e.$$.fragment),l=S(),t=D("a"),o=I(r[0]),this.h()},l(c){se(e.$$.fragment,c),l=j(c),t=U(c,"A",{href:!0,target:!0,rel:!0});var m=R(t);o=C(m,r[0]),m.forEach(_),this.h()},h(){v(t,"href",r[0]),v(t,"target","_blank"),v(t,"rel","noreferrer")},m(c,m){fe(e,c,m),b(c,l,m),b(c,t,m),k(t,o),i=!0,f||(s=_e(t,"click",Ot(r[4])),f=!0)},p(c,[m]){const B={};m&32&&(B.$$scope={dirty:m,ctx:c}),!n&&m&2&&(n=!0,B.showModal=c[1],Ut(()=>n=!1)),e.$set(B),(!i||m&1)&&K(o,c[0]),(!i||m&1)&&v(t,"href",c[0])},i(c){i||(w(e.$$.fragment,c),i=!0)},o(c){M(e.$$.fragment,c),i=!1},d(c){c&&(_(l),_(t)),ce(e,c),f=!1,s()}}}function rl(r,e,n){let{href:l}=e,t=!1;function o(s){t=s,n(1,t)}const i=()=>window.open(l),f=()=>n(1,t=!0);return r.$$set=s=>{"href"in s&&n(0,l=s.href)},[l,t,o,i,f]}class Me extends ve{constructor(e){super(),$e(this,e,rl,nl,ge,{href:0})}}function il(r){let e,n,l,t;const o=[al,ul],i=[];function f(s,u){return s[2]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=q()},l(s){n.l(s),l=q()},m(s,u){i[e].m(s,u),b(s,l,u),t=!0},p(s,u){let a=e;e=f(s),e===a?i[e].p(s,u):(le(),M(i[a],1,1,()=>{i[a]=null}),ne(),n=i[e],n?n.p(s,u):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l))},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),i[e].d(s)}}}function ol(r){let e,n,l=r[0].filename+"",t,o,i,f;return i=new Me({props:{href:r[1]}}),{c(){e=D("span"),n=I("[File "),t=I(l),o=I(`]
			`),oe(i.$$.fragment),this.h()},l(s){e=U(s,"SPAN",{class:!0});var u=R(e);n=C(u,"[File "),t=C(u,l),o=C(u,`]
			`),se(i.$$.fragment,u),u.forEach(_),this.h()},h(){v(e,"class","text-gray-500")},m(s,u){b(s,e,u),k(e,n),k(e,t),k(e,o),fe(i,e,null),f=!0},p(s,u){(!f||u&1)&&l!==(l=s[0].filename+"")&&K(t,l);const a={};u&2&&(a.href=s[1]),i.$set(a)},i(s){f||(w(i.$$.fragment,s),f=!0)},o(s){M(i.$$.fragment,s),f=!1},d(s){s&&_(e),ce(i)}}}function sl(r){let e,n,l;return{c(){e=D("audio"),n=D("source"),this.h()},l(t){e=U(t,"AUDIO",{});var o=R(e);n=U(o,"SOURCE",{src:!0}),o.forEach(_),this.h()},h(){ue(n.src,l=r[1])||v(n,"src",l),e.controls=!0},m(t,o){b(t,e,o),k(e,n)},p(t,o){o&2&&!ue(n.src,l=t[1])&&v(n,"src",l)},i:h,o:h,d(t){t&&_(e)}}}function fl(r){let e,n,l;return{c(){e=D("video"),n=D("source"),this.h()},l(t){e=U(t,"VIDEO",{});var o=R(e);n=U(o,"SOURCE",{src:!0}),o.forEach(_),this.h()},h(){ue(n.src,l=r[1])||v(n,"src",l),e.controls=!0},m(t,o){b(t,e,o),k(e,n)},p(t,o){o&2&&!ue(n.src,l=t[1])&&v(n,"src",l)},i:h,o:h,d(t){t&&_(e)}}}function cl(r){let e,n,l,t;const o=[gl,kl],i=[];function f(s,u){return s[2]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=q()},l(s){n.l(s),l=q()},m(s,u){i[e].m(s,u),b(s,l,u),t=!0},p(s,u){let a=e;e=f(s),e===a?i[e].p(s,u):(le(),M(i[a],1,1,()=>{i[a]=null}),ne(),n=i[e],n?n.p(s,u):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l))},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),i[e].d(s)}}}function ul(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!0,pending:bl,then:hl,catch:_l,value:5,error:7};return ie(n=fetch(r[1]),l),{c(){e=q(),l.block.c()},l(t){e=q(),l.block.l(t)},m(t,o){b(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&2&&n!==(n=fetch(r[1]))&&ie(n,l)||be(l,r,o)},i:h,o:h,d(t){t&&_(e),l.block.d(t),l.token=null,l=null}}}function al(r){let e,n,l,t,o;return l=new Me({props:{href:r[1]}}),{c(){e=D("span"),n=I("[Text "),oe(l.$$.fragment),t=I("]"),this.h()},l(i){e=U(i,"SPAN",{class:!0});var f=R(e);n=C(f,"[Text "),se(l.$$.fragment,f),t=C(f,"]"),f.forEach(_),this.h()},h(){v(e,"class","text-gray-500")},m(i,f){b(i,e,f),k(e,n),fe(l,e,null),k(e,t),o=!0},p(i,f){const s={};f&2&&(s.href=i[1]),l.$set(s)},i(i){o||(w(l.$$.fragment,i),o=!0)},o(i){M(l.$$.fragment,i),o=!1},d(i){i&&_(e),ce(l)}}}function _l(r){let e,n=r[3]("file.download.error")+"",l,t,o=r[0].filename+"",i,f,s=r[7]+"",u;return{c(){e=D("p"),l=I(n),t=S(),i=I(o),f=I(": "),u=I(s)},l(a){e=U(a,"P",{});var c=R(e);l=C(c,n),t=j(c),i=C(c,o),f=C(c,": "),u=C(c,s),c.forEach(_)},m(a,c){b(a,e,c),k(e,l),k(e,t),k(e,i),k(e,f),k(e,u)},p(a,c){c&8&&n!==(n=a[3]("file.download.error")+"")&&K(l,n),c&1&&o!==(o=a[0].filename+"")&&K(i,o),c&2&&s!==(s=a[7]+"")&&K(u,s)},d(a){a&&_(e)}}}function hl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:pl,then:dl,catch:ml,value:6};return ie(n=r[5].text(),l),{c(){e=q(),l.block.c()},l(t){e=q(),l.block.l(t)},m(t,o){b(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&2&&n!==(n=r[5].text())&&ie(n,l)||be(l,r,o)},d(t){t&&_(e),l.block.d(t),l.token=null,l=null}}}function ml(r){return{c:h,l:h,m:h,p:h,d:h}}function dl(r){let e,n=r[6]+"",l;return{c(){e=D("p"),l=I(n)},l(t){e=U(t,"P",{});var o=R(e);l=C(o,n),o.forEach(_)},m(t,o){b(t,e,o),k(e,l)},p(t,o){o&2&&n!==(n=t[6]+"")&&K(l,n)},d(t){t&&_(e)}}}function pl(r){return{c:h,l:h,m:h,p:h,d:h}}function bl(r){return{c:h,l:h,m:h,p:h,d:h}}function kl(r){let e,n,l;return{c(){e=D("img"),this.h()},l(t){e=U(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ue(e.src,n=r[1])||v(e,"src",n),v(e,"alt",l=r[0].filename),v(e,"class","max-w-xl max-h-xl")},m(t,o){b(t,e,o)},p(t,o){o&2&&!ue(e.src,n=t[1])&&v(e,"src",n),o&1&&l!==(l=t[0].filename)&&v(e,"alt",l)},i:h,o:h,d(t){t&&_(e)}}}function gl(r){let e,n,l,t,o;return l=new Me({props:{href:r[1]}}),{c(){e=D("span"),n=I("[Image "),oe(l.$$.fragment),t=I("]"),this.h()},l(i){e=U(i,"SPAN",{class:!0});var f=R(e);n=C(f,"[Image "),se(l.$$.fragment,f),t=C(f,"]"),f.forEach(_),this.h()},h(){v(e,"class","text-gray-500")},m(i,f){b(i,e,f),k(e,n),fe(l,e,null),k(e,t),o=!0},p(i,f){const s={};f&2&&(s.href=i[1]),l.$set(s)},i(i){o||(w(l.$$.fragment,i),o=!0)},o(i){M(l.$$.fragment,i),o=!1},d(i){i&&_(e),ce(l)}}}function vl(r){let e,n,l,t;const o=[cl,fl,sl,ol,il],i=[];function f(s,u){return s[0].metadata.type=="Image"?0:s[0].metadata.type=="Video"?1:s[0].metadata.type=="Audio"?2:s[0].metadata.type=="File"?3:s[0].metadata.type=="Text"?4:-1}return~(n=f(r))&&(l=i[n]=o[n](r)),{c(){e=D("div"),l&&l.c()},l(s){e=U(s,"DIV",{});var u=R(e);l&&l.l(u),u.forEach(_)},m(s,u){b(s,e,u),~n&&i[n].m(e,null),t=!0},p(s,[u]){let a=n;n=f(s),n===a?~n&&i[n].p(s,u):(l&&(le(),M(i[a],1,1,()=>{i[a]=null}),ne()),~n?(l=i[n],l?l.p(s,u):(l=i[n]=o[n](s),l.c()),w(l,1),l.m(e,null)):l=null)},i(s){t||(w(l),t=!0)},o(s){M(l),t=!1},d(s){s&&_(e),~n&&i[n].d()}}}function $l(r,e,n){let l,t,o;ee(r,Ce,s=>n(3,o=s));const i=te(Ie);ee(r,i,s=>n(2,t=s));let{attachment:f}=e;return r.$$set=s=>{"attachment"in s&&n(0,f=s.attachment)},r.$$.update=()=>{r.$$.dirty&1&&n(1,l=Rt(f))},[f,l,t,o,i]}class wl extends ve{constructor(e){super(),$e(this,e,$l,vl,ge,{attachment:0})}}function yl(r){let e,n="oop website embed, can't handle that :(";return{c(){e=D("span"),e.textContent=n,this.h()},l(l){e=U(l,"SPAN",{class:!0,"data-svelte-h":!0}),Se(e)!=="svelte-1exisih"&&(e.textContent=n),this.h()},h(){v(e,"class","text-gray-600")},m(l,t){b(l,e,t)},p:h,i:h,o:h,d(l){l&&_(e)}}}function El(r){let e,n,l,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&Qe(r),o=r[0].title&&Ze(r),i=r[0].description&&xe(r);return{c(){e=D("div"),t&&t.c(),n=S(),o&&o.c(),l=S(),i&&i.c(),this.h()},l(f){e=U(f,"DIV",{style:!0});var s=R(e);t&&t.l(s),n=j(s),o&&o.l(s),l=j(s),i&&i.l(s),s.forEach(_),this.h()},h(){Ue(e,"background-color",r[0].colour)},m(f,s){b(f,e,s),t&&t.m(e,null),k(e,n),o&&o.m(e,null),k(e,l),i&&i.m(e,null)},p(f,s){f[0].icon_url&&!f[1]["jolt:low-data-mode"]?t?t.p(f,s):(t=Qe(f),t.c(),t.m(e,n)):t&&(t.d(1),t=null),f[0].title?o?o.p(f,s):(o=Ze(f),o.c(),o.m(e,l)):o&&(o.d(1),o=null),f[0].description?i?i.p(f,s):(i=xe(f),i.c(),i.m(e,null)):i&&(i.d(1),i=null),s&1&&Ue(e,"background-color",f[0].colour)},i:h,o:h,d(f){f&&_(e),t&&t.d(),o&&o.d(),i&&i.d()}}}function Il(r){let e,n,l,t;const o=[Nl,Ml],i=[];function f(s,u){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=q()},l(s){n.l(s),l=q()},m(s,u){i[e].m(s,u),b(s,l,u),t=!0},p(s,u){let a=e;e=f(s),e===a?i[e].p(s,u):(le(),M(i[a],1,1,()=>{i[a]=null}),ne(),n=i[e],n?n.p(s,u):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l))},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),i[e].d(s)}}}function Cl(r){let e,n,l,t;const o=[Dl,Tl],i=[];function f(s,u){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=q()},l(s){n.l(s),l=q()},m(s,u){i[e].m(s,u),b(s,l,u),t=!0},p(s,u){let a=e;e=f(s),e===a?i[e].p(s,u):(le(),M(i[a],1,1,()=>{i[a]=null}),ne(),n=i[e],n?n.p(s,u):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l))},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),i[e].d(s)}}}function Qe(r){let e,n,l;return{c(){e=D("img"),this.h()},l(t){e=U(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){ue(e.src,n=r[0].icon_url)||v(e,"src",n),v(e,"alt",l=r[0].title),v(e,"width","24"),v(e,"height","24"),v(e,"class","inline rounded-3xl")},m(t,o){b(t,e,o)},p(t,o){o&1&&!ue(e.src,n=t[0].icon_url)&&v(e,"src",n),o&1&&l!==(l=t[0].title)&&v(e,"alt",l)},d(t){t&&_(e)}}}function Ze(r){let e,n=r[0].title+"",l;return{c(){e=D("h1"),l=I(n),this.h()},l(t){e=U(t,"H1",{class:!0});var o=R(e);l=C(o,n),o.forEach(_),this.h()},h(){v(e,"class","text-gray-600")},m(t,o){b(t,e,o),k(e,l)},p(t,o){o&1&&n!==(n=t[0].title+"")&&K(l,n)},d(t){t&&_(e)}}}function xe(r){let e,n=r[0].description+"",l;return{c(){e=D("p"),l=I(n)},l(t){e=U(t,"P",{});var o=R(e);l=C(o,n),o.forEach(_)},m(t,o){b(t,e,o),k(e,l)},p(t,o){o&1&&n!==(n=t[0].description+"")&&K(l,n)},d(t){t&&_(e)}}}function Ml(r){let e,n,l,t,o;return{c(){e=D("video"),n=D("source"),this.h()},l(i){e=U(i,"VIDEO",{});var f=R(e);n=U(f,"SOURCE",{src:!0,width:!0,height:!0}),f.forEach(_),this.h()},h(){ue(n.src,l=r[0].url)||v(n,"src",l),v(n,"width",t=r[0].width),v(n,"height",o=r[0].height),e.controls=!0},m(i,f){b(i,e,f),k(e,n)},p(i,f){f&1&&!ue(n.src,l=i[0].url)&&v(n,"src",l),f&1&&t!==(t=i[0].width)&&v(n,"width",t),f&1&&o!==(o=i[0].height)&&v(n,"height",o)},i:h,o:h,d(i){i&&_(e)}}}function Nl(r){let e,n;return e=new Me({props:{href:r[0].url}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t&1&&(o.href=l[0].url),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function Tl(r){let e,n,l,t;return{c(){e=D("img"),this.h()},l(o){e=U(o,"IMG",{src:!0,width:!0,height:!0}),this.h()},h(){ue(e.src,n=r[0].url)||v(e,"src",n),v(e,"width",l=r[0].width),v(e,"height",t=r[0].height)},m(o,i){b(o,e,i)},p(o,i){i&1&&!ue(e.src,n=o[0].url)&&v(e,"src",n),i&1&&l!==(l=o[0].width)&&v(e,"width",l),i&1&&t!==(t=o[0].height)&&v(e,"height",t)},i:h,o:h,d(o){o&&_(e)}}}function Dl(r){let e,n;return e=new Me({props:{href:r[0].url}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t&1&&(o.href=l[0].url),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function Ul(r){let e,n,l,t;const o=[Cl,Il,El,yl],i=[];function f(s,u){return s[0].type=="Image"?0:s[0].type=="Video"?1:s[0].type=="Text"?2:s[0].type=="Website"?3:-1}return~(e=f(r))&&(n=i[e]=o[e](r)),{c(){n&&n.c(),l=q()},l(s){n&&n.l(s),l=q()},m(s,u){~e&&i[e].m(s,u),b(s,l,u),t=!0},p(s,[u]){let a=e;e=f(s),e===a?~e&&i[e].p(s,u):(n&&(le(),M(i[a],1,1,()=>{i[a]=null}),ne()),~e?(n=i[e],n?n.p(s,u):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l)):n=null)},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),~e&&i[e].d(s)}}}function Al(r,e,n){let l,{embed:t}=e;const o=te(Ie);return ee(r,o,i=>n(1,l=i)),r.$$set=i=>{"embed"in i&&n(0,t=i.embed)},[t,l,o]}class Sl extends ve{constructor(e){super(),$e(this,e,Al,Ul,ge,{embed:0})}}function et(r){const e=me(r[4]);r[5]=e}function tt(r){r[6]=r[8][0],r[7]=r[8][1]}function lt(r){const e=me(r[4]);r[5]=e}function jl(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Hl,then:Bl,catch:Rl,value:4,blocks:[,,,]};return ie(n=r[2].api.fetchUser(r[0].id),t),{c(){e=q(),t.block.c()},l(o){e=q(),t.block.l(o)},m(o,i){b(o,e,i),t.block.m(o,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,i){r=o,t.ctx=r,i&1&&n!==(n=r[2].api.fetchUser(r[0].id))&&ie(n,t)||be(t,r,i)},i(o){l||(w(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];M(f)}l=!1},d(o){o&&_(e),t.block.d(o),t.token=null,t=null}}}function Pl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Xl,then:ql,catch:zl,value:8};return ie(n=Promise.all([r[0].from,r[0].to].map(r[3])),l),{c(){e=q(),l.block.c()},l(t){e=q(),l.block.l(t)},m(t,o){b(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=Promise.all([r[0].from,r[0].to].map(r[3])))&&ie(n,l)||be(l,r,o)},i:h,o:h,d(t){t&&_(e),l.block.d(t),l.token=null,l=null}}}function Ol(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:on,then:Yl,catch:Wl,value:4,blocks:[,,,]};return ie(n=r[2].api.fetchUser(r[0].by),t),{c(){e=q(),t.block.c()},l(o){e=q(),t.block.l(o)},m(o,i){b(o,e,i),t.block.m(o,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,i){r=o,t.ctx=r,i&1&&n!==(n=r[2].api.fetchUser(r[0].by))&&ie(n,t)||be(t,r,i)},i(o){l||(w(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];M(f)}l=!1},d(o){o&&_(e),t.block.d(o),t.token=null,t=null}}}function Vl(r){let e=r[0].content+"",n;return{c(){n=I(e)},l(l){n=C(l,e)},m(l,t){b(l,n,t)},p(l,t){t&1&&e!==(e=l[0].content+"")&&K(n,e)},i:h,o:h,d(l){l&&_(n)}}}function Rl(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Bl(r){et(r);let e,n,l=r[5]+"",t,o,i,f;e=new Ee({props:{src:pe(r[4]),width:24,height:24,name:r[5]}});function s(c,m){if(c[0].type=="user_banned")return Gl;if(c[0].type=="user_joined")return Ll;if(c[0].type=="user_kicked")return Fl;if(c[0].type=="user_left")return Kl}let u=s(r),a=u&&u(r);return{c(){oe(e.$$.fragment),n=S(),t=I(l),o=S(),a&&a.c(),i=q()},l(c){se(e.$$.fragment,c),n=j(c),t=C(c,l),o=j(c),a&&a.l(c),i=q()},m(c,m){fe(e,c,m),b(c,n,m),b(c,t,m),b(c,o,m),a&&a.m(c,m),b(c,i,m),f=!0},p(c,m){et(c);const B={};m&1&&(B.src=pe(c[4])),m&1&&(B.name=c[5]),e.$set(B),(!f||m&1)&&l!==(l=c[5]+"")&&K(t,l),u===(u=s(c))&&a?a.p(c,m):(a&&a.d(1),a=u&&u(c),a&&(a.c(),a.m(i.parentNode,i)))},i(c){f||(w(e.$$.fragment,c),f=!0)},o(c){M(e.$$.fragment,c),f=!1},d(c){c&&(_(n),_(t),_(o),_(i)),ce(e,c),a&&a.d(c)}}}function Kl(r){let e=r[1]("user.chat.left")+"",n,l;return{c(){n=I(e),l=I(".")},l(t){n=C(t,e),l=C(t,".")},m(t,o){b(t,n,o),b(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.chat.left")+"")&&K(n,e)},d(t){t&&(_(n),_(l))}}}function Fl(r){let e=r[1]("user.was-kicked")+"",n,l;return{c(){n=I(e),l=I(".")},l(t){n=C(t,e),l=C(t,".")},m(t,o){b(t,n,o),b(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.was-kicked")+"")&&K(n,e)},d(t){t&&(_(n),_(l))}}}function Ll(r){let e=r[1]("user.chat.joined")+"",n,l;return{c(){n=I(e),l=I(".")},l(t){n=C(t,e),l=C(t,".")},m(t,o){b(t,n,o),b(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.chat.joined")+"")&&K(n,e)},d(t){t&&(_(n),_(l))}}}function Gl(r){let e=r[1]("user.was-banned")+"",n,l;return{c(){n=I(e),l=I(".")},l(t){n=C(t,e),l=C(t,".")},m(t,o){b(t,n,o),b(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.was-banned")+"")&&K(n,e)},d(t){t&&(_(n),_(l))}}}function Hl(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function zl(r){return{c:h,l:h,m:h,p:h,d:h}}function ql(r){tt(r);let e=r[1]("channel.ownership.changed-from")+"",n,l,t=me(r[6])+"",o,i,f=me(r[7])+"",s,u;return{c(){n=I(e),l=S(),o=I(t),i=I(" to "),s=I(f),u=I(".")},l(a){n=C(a,e),l=j(a),o=C(a,t),i=C(a," to "),s=C(a,f),u=C(a,".")},m(a,c){b(a,n,c),b(a,l,c),b(a,o,c),b(a,i,c),b(a,s,c),b(a,u,c)},p(a,c){tt(a),c&2&&e!==(e=a[1]("channel.ownership.changed-from")+"")&&K(n,e),c&1&&t!==(t=me(a[6])+"")&&K(o,t),c&1&&f!==(f=me(a[7])+"")&&K(s,f)},d(a){a&&(_(n),_(l),_(o),_(i),_(s),_(u))}}}function Xl(r){return{c:h,l:h,m:h,p:h,d:h}}function Wl(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Yl(r){lt(r);let e,n,l=r[5]+"",t,o,i,f;e=new Ee({props:{src:pe(r[4]),width:24,height:24,name:r[5]}});function s(c,m){if(c[0].type=="channel_description_changed")return xl;if(c[0].type=="channel_icon_changed")return Zl;if(c[0].type=="channel_renamed")return Ql;if(c[0].type=="user_added"||c[0].type=="user_remove")return Jl}let u=s(r),a=u&&u(r);return{c(){oe(e.$$.fragment),n=S(),t=I(l),o=S(),a&&a.c(),i=q()},l(c){se(e.$$.fragment,c),n=j(c),t=C(c,l),o=j(c),a&&a.l(c),i=q()},m(c,m){fe(e,c,m),b(c,n,m),b(c,t,m),b(c,o,m),a&&a.m(c,m),b(c,i,m),f=!0},p(c,m){lt(c);const B={};m&1&&(B.src=pe(c[4])),m&1&&(B.name=c[5]),e.$set(B),(!f||m&1)&&l!==(l=c[5]+"")&&K(t,l),u===(u=s(c))&&a?a.p(c,m):(a&&a.d(1),a=u&&u(c),a&&(a.c(),a.m(i.parentNode,i)))},i(c){f||(w(e.$$.fragment,c),f=!0)},o(c){M(e.$$.fragment,c),f=!1},d(c){c&&(_(n),_(t),_(o),_(i)),ce(e,c),a&&a.d(c)}}}function Jl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:rn,then:tn,catch:en,value:4};return ie(n=r[2].api.fetchUser(r[0].id),l),{c(){e=q(),l.block.c()},l(t){e=q(),l.block.l(t)},m(t,o){b(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=r[2].api.fetchUser(r[0].id))&&ie(n,l)||be(l,r,o)},d(t){t&&_(e),l.block.d(t),l.token=null,l=null}}}function Ql(r){let e=r[1]("channel.rename-to")+"",n,l,t=r[0].name+"",o,i;return{c(){n=I(e),l=S(),o=I(t),i=I(".")},l(f){n=C(f,e),l=j(f),o=C(f,t),i=C(f,".")},m(f,s){b(f,n,s),b(f,l,s),b(f,o,s),b(f,i,s)},p(f,s){s&2&&e!==(e=f[1]("channel.rename-to")+"")&&K(n,e),s&1&&t!==(t=f[0].name+"")&&K(o,t)},d(f){f&&(_(n),_(l),_(o),_(i))}}}function Zl(r){let e=r[1]("channel.icon.change")+"",n,l;return{c(){n=I(e),l=I(".")},l(t){n=C(t,e),l=C(t,".")},m(t,o){b(t,n,o),b(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("channel.icon.change")+"")&&K(n,e)},d(t){t&&(_(n),_(l))}}}function xl(r){let e=r[1]("channel.description.change")+"",n,l;return{c(){n=I(e),l=I(".")},l(t){n=C(t,e),l=C(t,".")},m(t,o){b(t,n,o),b(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("channel.description.change")+"")&&K(n,e)},d(t){t&&(_(n),_(l))}}}function en(r){return{c:h,l:h,m:h,p:h,d:h}}function tn(r){let e,n=me(r[4])+"",l,t;function o(s,u){if(s[0].type=="user_added")return nn;if(s[0].type=="user_remove")return ln}let i=o(r),f=i&&i(r);return{c(){f&&f.c(),e=S(),l=I(n),t=I(".")},l(s){f&&f.l(s),e=j(s),l=C(s,n),t=C(s,".")},m(s,u){f&&f.m(s,u),b(s,e,u),b(s,l,u),b(s,t,u)},p(s,u){i===(i=o(s))&&f?f.p(s,u):(f&&f.d(1),f=i&&i(s),f&&(f.c(),f.m(e.parentNode,e))),u&1&&n!==(n=me(s[4])+"")&&K(l,n)},d(s){s&&(_(e),_(l),_(t)),f&&f.d(s)}}}function ln(r){let e=r[1]("removed")+"",n;return{c(){n=I(e)},l(l){n=C(l,e)},m(l,t){b(l,n,t)},p(l,t){t&2&&e!==(e=l[1]("removed")+"")&&K(n,e)},d(l){l&&_(n)}}}function nn(r){let e=r[1]("added")+"",n;return{c(){n=I(e)},l(l){n=C(l,e)},m(l,t){b(l,n,t)},p(l,t){t&2&&e!==(e=l[1]("added")+"")&&K(n,e)},d(l){l&&_(n)}}}function rn(r){return{c:h,l:h,m:h,p:h,d:h}}function on(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function sn(r){let e,n,l,t;const o=[Vl,Ol,Pl,jl],i=[];function f(s,u){return s[0].type=="text"?0:s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove"?1:s[0].type=="channel_ownership_changed"?2:s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left"?3:-1}return~(e=f(r))&&(n=i[e]=o[e](r)),{c(){n&&n.c(),l=q()},l(s){n&&n.l(s),l=q()},m(s,u){~e&&i[e].m(s,u),b(s,l,u),t=!0},p(s,[u]){let a=e;e=f(s),e===a?~e&&i[e].p(s,u):(n&&(le(),M(i[a],1,1,()=>{i[a]=null}),ne()),~e?(n=i[e],n?n.p(s,u):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l)):n=null)},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),~e&&i[e].d(s)}}}function fn(r,e,n){let l;ee(r,Ce,f=>n(1,l=f));const t=te(je);let{system:o}=e;const i=f=>t.api.fetchUser(f);return r.$$set=f=>{"system"in f&&n(0,o=f.system)},[o,l,t,i]}class cn extends ve{constructor(e){super(),$e(this,e,fn,sn,ge,{system:0})}}function nt(r,e,n){const l=r.slice();return l[30]=e[n],l}function rt(r,e,n){const l=r.slice();return l[33]=e[n],l}function it(r,e,n){const l=r.slice();return l[36]=e[n].src,l[37]=e[n].alt,l[38]=e[n].onclick,l[39]=e[n].showIf,l}function Pe(r){const e=r.slice(),n=new Date(e[0].edited);return e[8]=n,e}function ot(r,e,n){const l=r.slice();return l[42]=e[n],l}function st(r){let e,n,l=ae(r[0].replies),t=[];for(let i=0;i<l.length;i+=1)t[i]=ft(ot(r,l,i));const o=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){e=D("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=U(i,"DIV",{class:!0});var f=R(e);for(let s=0;s<t.length;s+=1)t[s].l(f);f.forEach(_),this.h()},h(){v(e,"class","flex flex-col")},m(i,f){b(i,e,f);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null);n=!0},p(i,f){if(f[0]&1){l=ae(i[0].replies);let s;for(s=0;s<l.length;s+=1){const u=ot(i,l,s);t[s]?(t[s].p(u,f),w(t[s],1)):(t[s]=ft(u),t[s].c(),w(t[s],1),t[s].m(e,null))}for(le(),s=l.length;s<t.length;s+=1)o(s);ne()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)w(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)M(t[f]);n=!1},d(i){i&&_(e),ye(t,i)}}}function ft(r){let e,n;return e=new Jt({props:{id:r[42]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.id=l[42]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function ct(r){let e,n;return e=new Ee({props:{name:r[4],src:r[3],width:40,height:40}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&16&&(o.name=l[4]),t[0]&8&&(o.src=l[3]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function ut(r){let e,n=r[5]("message.edited")+"",l,t,o=r[6](r[8])+"",i,f,s=r[7](r[8])+"",u,a;return{c(){e=I("["),l=I(n),t=S(),i=I(o),f=S(),u=I(s),a=I("]")},l(c){e=C(c,"["),l=C(c,n),t=j(c),i=C(c,o),f=j(c),u=C(c,s),a=C(c,"]")},m(c,m){b(c,e,m),b(c,l,m),b(c,t,m),b(c,i,m),b(c,f,m),b(c,u,m),b(c,a,m)},p(c,m){m[0]&32&&n!==(n=c[5]("message.edited")+"")&&K(l,n),m[0]&65&&o!==(o=c[6](c[8])+"")&&K(i,o),m[0]&129&&s!==(s=c[7](c[8])+"")&&K(u,s)},d(c){c&&(_(e),_(l),_(t),_(i),_(f),_(u),_(a))}}}function at(r){let e,n,l,t,o,i;function f(){return r[20](r[38])}return{c(){e=D("button"),n=D("img"),t=S(),this.h()},l(s){e=U(s,"BUTTON",{class:!0,"aria-label":!0});var u=R(e);n=U(u,"IMG",{width:!0,height:!0,src:!0,alt:!0}),t=j(u),u.forEach(_),this.h()},h(){v(n,"width","16"),v(n,"height","16"),ue(n.src,l=r[36])||v(n,"src",l),v(n,"alt",r[37]),v(e,"class","ml-2"),v(e,"aria-label",r[37])},m(s,u){b(s,e,u),k(e,n),k(e,t),o||(i=_e(e,"click",f),o=!0)},p(s,u){r=s},d(s){s&&_(e),o=!1,i()}}}function _t(r){var t;let e=((t=r[39])==null?void 0:t.call(r,r[0]))??!0,n,l=e&&at(r);return{c(){l&&l.c(),n=q()},l(o){l&&l.l(o),n=q()},m(o,i){l&&l.m(o,i),b(o,n,i)},p(o,i){var f;i[0]&1&&(e=((f=o[39])==null?void 0:f.call(o,o[0]))??!0),e?l?l.p(o,i):(l=at(o),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(o){o&&_(n),l&&l.d(o)}}}function un(r){let e,n=r[0].content+"",l;return{c(){e=D("span"),l=I(n),this.h()},l(t){e=U(t,"SPAN",{style:!0,class:!0});var o=R(e);l=C(o,n),o.forEach(_),this.h()},h(){Ue(e,"overflow-wrap","break-word"),v(e,"class","whitespace-pre-wrap")},m(t,o){b(t,e,o),k(e,l)},p(t,o){o[0]&1&&n!==(n=t[0].content+"")&&K(l,n)},d(t){t&&_(e)}}}function an(r){let e,n,l,t;return{c(){e=D("form"),n=D("textarea"),this.h()},l(o){e=U(o,"FORM",{class:!0});var i=R(e);n=U(i,"TEXTAREA",{class:!0,placeholder:!0}),R(n).forEach(_),i.forEach(_),this.h()},h(){v(n,"class","outline-none resize-none bg-inherit w-full"),v(n,"placeholder","Edit this message"),v(e,"class","bg-gray-500 rounded-xl px-2 pt-2")},m(o,i){b(o,e,i),k(e,n),ze(n,r[2]),l||(t=[_e(n,"keydown",r[21]),_e(n,"input",r[22]),_e(e,"submit",r[15])],l=!0)},p(o,i){i[0]&4&&ze(n,o[2])},d(o){o&&_(e),l=!1,Ae(t)}}}function ht(r){let e,n;return e=new cn({props:{system:r[0].system}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.system=l[0].system),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function mt(r){let e,n,l=ae(r[0].attachments),t=[];for(let i=0;i<l.length;i+=1)t[i]=dt(rt(r,l,i));const o=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=q()},l(i){for(let f=0;f<t.length;f+=1)t[f].l(i);e=q()},m(i,f){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,f);b(i,e,f),n=!0},p(i,f){if(f[0]&1){l=ae(i[0].attachments);let s;for(s=0;s<l.length;s+=1){const u=rt(i,l,s);t[s]?(t[s].p(u,f),w(t[s],1)):(t[s]=dt(u),t[s].c(),w(t[s],1),t[s].m(e.parentNode,e))}for(le(),s=l.length;s<t.length;s+=1)o(s);ne()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)w(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)M(t[f]);n=!1},d(i){i&&_(e),ye(t,i)}}}function dt(r){let e,n;return e=new wl({props:{attachment:r[33]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.attachment=l[33]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function pt(r){let e,n,l=ae(r[0].embeds),t=[];for(let i=0;i<l.length;i+=1)t[i]=bt(nt(r,l,i));const o=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=q()},l(i){for(let f=0;f<t.length;f+=1)t[f].l(i);e=q()},m(i,f){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,f);b(i,e,f),n=!0},p(i,f){if(f[0]&1){l=ae(i[0].embeds);let s;for(s=0;s<l.length;s+=1){const u=nt(i,l,s);t[s]?(t[s].p(u,f),w(t[s],1)):(t[s]=bt(u),t[s].c(),w(t[s],1),t[s].m(e.parentNode,e))}for(le(),s=l.length;s<t.length;s+=1)o(s);ne()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)w(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)M(t[f]);n=!1},d(i){i&&_(e),ye(t,i)}}}function bt(r){let e,n;return e=new Sl({props:{embed:r[30]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.embed=l[30]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function _n(r){let e,n,l,t,o,i,f,s,u=r[6](r[8])+"",a,c,m=r[7](r[8])+"",B,G,P,E,X,F,A,re,H,V,Q,p,g=r[0].replies!=null&&r[0].replies.length!=0&&st(r),d=!r[1]["jolt:compact-mode"]&&ct(r),O=r[0].edited!=null&&ut(Pe(r)),Z=ae(r[14]),Y=[];for(let y=0;y<Z.length;y+=1)Y[y]=_t(it(r,Z,y));function N(y,L){if(y[2]!=null)return an;if(y[0].content!=null)return un}let $=N(r),T=$&&$(r),z=r[0].system!=null&&ht(r),x=r[0].attachments!=null&&mt(r),W=r[0].embeds!=null&&pt(r);return{c(){e=D("div"),g&&g.c(),n=S(),l=D("div"),d&&d.c(),t=S(),o=I(r[4]),i=S(),f=D("p"),s=I("["),a=I(u),c=S(),B=I(m),G=I(`]

			`),O&&O.c(),P=S(),E=D("div"),X=S(),F=D("div");for(let y=0;y<Y.length;y+=1)Y[y].c();A=S(),T&&T.c(),re=S(),z&&z.c(),H=S(),x&&x.c(),V=S(),W&&W.c(),this.h()},l(y){e=U(y,"DIV",{id:!0,class:!0});var L=R(e);g&&g.l(L),n=j(L),l=U(L,"DIV",{class:!0});var J=R(l);d&&d.l(J),t=j(J),o=C(J,r[4]),i=j(J),f=U(J,"P",{class:!0});var he=R(f);s=C(he,"["),a=C(he,u),c=j(he),B=C(he,m),G=C(he,`]

			`),O&&O.l(he),he.forEach(_),P=j(J),E=U(J,"DIV",{class:!0}),R(E).forEach(_),X=j(J),F=U(J,"DIV",{class:!0});var we=R(F);for(let ke=0;ke<Y.length;ke+=1)Y[ke].l(we);we.forEach(_),J.forEach(_),A=j(L),T&&T.l(L),re=j(L),z&&z.l(L),H=j(L),x&&x.l(L),V=j(L),W&&W.l(L),L.forEach(_),this.h()},h(){v(f,"class","text-gray-500"),v(E,"class","flex-1"),v(F,"class","hidden group-hover:flex"),v(l,"class","flex"),v(e,"id",Q=r[0]._id),v(e,"class","flex flex-col hover:bg-gray-800 group p-4")},m(y,L){b(y,e,L),g&&g.m(e,null),k(e,n),k(e,l),d&&d.m(l,null),k(l,t),k(l,o),k(l,i),k(l,f),k(f,s),k(f,a),k(f,c),k(f,B),k(f,G),O&&O.m(f,null),k(l,P),k(l,E),k(l,X),k(l,F);for(let J=0;J<Y.length;J+=1)Y[J]&&Y[J].m(F,null);k(e,A),T&&T.m(e,null),k(e,re),z&&z.m(e,null),k(e,H),x&&x.m(e,null),k(e,V),W&&W.m(e,null),p=!0},p(y,L){if(y[0].replies!=null&&y[0].replies.length!=0?g?(g.p(y,L),L[0]&1&&w(g,1)):(g=st(y),g.c(),w(g,1),g.m(e,n)):g&&(le(),M(g,1,1,()=>{g=null}),ne()),y[1]["jolt:compact-mode"]?d&&(le(),M(d,1,1,()=>{d=null}),ne()):d?(d.p(y,L),L[0]&2&&w(d,1)):(d=ct(y),d.c(),w(d,1),d.m(l,t)),(!p||L[0]&16)&&K(o,y[4]),(!p||L[0]&320)&&u!==(u=y[6](y[8])+"")&&K(a,u),(!p||L[0]&384)&&m!==(m=y[7](y[8])+"")&&K(B,m),y[0].edited!=null?O?O.p(Pe(y),L):(O=ut(Pe(y)),O.c(),O.m(f,null)):O&&(O.d(1),O=null),L[0]&16385){Z=ae(y[14]);let J;for(J=0;J<Z.length;J+=1){const he=it(y,Z,J);Y[J]?Y[J].p(he,L):(Y[J]=_t(he),Y[J].c(),Y[J].m(F,null))}for(;J<Y.length;J+=1)Y[J].d(1);Y.length=Z.length}$===($=N(y))&&T?T.p(y,L):(T&&T.d(1),T=$&&$(y),T&&(T.c(),T.m(e,re))),y[0].system!=null?z?(z.p(y,L),L[0]&1&&w(z,1)):(z=ht(y),z.c(),w(z,1),z.m(e,H)):z&&(le(),M(z,1,1,()=>{z=null}),ne()),y[0].attachments!=null?x?(x.p(y,L),L[0]&1&&w(x,1)):(x=mt(y),x.c(),w(x,1),x.m(e,V)):x&&(le(),M(x,1,1,()=>{x=null}),ne()),y[0].embeds!=null?W?(W.p(y,L),L[0]&1&&w(W,1)):(W=pt(y),W.c(),w(W,1),W.m(e,null)):W&&(le(),M(W,1,1,()=>{W=null}),ne()),(!p||L[0]&1&&Q!==(Q=y[0]._id))&&v(e,"id",Q)},i(y){p||(w(g),w(d),w(z),w(x),w(W),p=!0)},o(y){M(g),M(d),M(z),M(x),M(W),p=!1},d(y){y&&_(e),g&&g.d(),d&&d.d(),O&&O.d(),ye(Y,y),T&&T.d(),z&&z.d(),x&&x.d(),W&&W.d()}}}function hn(r,e,n){let l,t,o,i,f,s,u,a,c,m,B;ee(r,Ce,$=>n(5,a=$)),ee(r,Bt,$=>n(6,m=$)),ee(r,Kt,$=>n(7,B=$));let{message:G}=e,P,E,X;te(Vt);const F=te(Ie);ee(r,F,$=>n(1,i=$));const A=te(je),re=te(Ct);ee(r,re,$=>n(18,f=$)),te(Mt);const H=te(Ve),V=te(Re);ee(r,V,$=>n(19,s=$));const Q=te(Nt);ee(r,Q,$=>n(23,u=$));const p=te(Tt);ee(r,p,$=>n(24,c=$));const g=[{src:`${de}/reply.svg`,alt:a("message.reply"),onclick(){c!=null&&c.some($=>$.message._id==G._id)||p==null||p.update($=>($.push({message:G,mention:!0}),$))}},{src:`${de}/note.svg`,alt:a("message.edit"),showIf:$=>{var T;return $.author==((T=A.user)==null?void 0:T._id)},onclick:$=>n(2,P=P==null?$.content??"":void 0)},{src:`${de}/trash.svg`,alt:a("message.delete"),showIf:$=>{var T;return $.author==((T=A.user)==null?void 0:T._id)},onclick:$=>A.api.deleteMessage($.channel,$._id)}];async function d($,T){n(17,X=u==null?void 0:u.find(z=>z._id.server==$&&z._id.user==T))}async function O(){const $=await A.api.editMessage(G.channel,G._id,{content:P});H==null||H.update(T=>(T[T.findIndex(z=>z._id==G._id)]=$,T))}const Z=$=>$(G),Y=$=>{if(!$.defaultPrevented){if($.key=="Escape"){$.preventDefault(),n(2,P=void 0);return}$.shiftKey||$.key!="Enter"||($.preventDefault(),O(),n(2,P=void 0))}};function N(){P=this.value,n(2,P)}return r.$$set=$=>{"message"in $&&n(0,G=$.message)},r.$$.update=()=>{r.$$.dirty[0]&524289&&Oe(A.api,s??A.api.cache.users,G.author).then($=>n(16,E=$)),r.$$.dirty[0]&262145&&(f==null||d(f,G.author)),r.$$.dirty[0]&196609&&n(4,l=me(E,X,G)),r.$$.dirty[0]&196611&&n(3,t=i["jolt:low-data-mode"]?`${de}/user.svg`:pe(E,X,G)),r.$$.dirty[0]&1&&n(8,o=Ft(G._id))},[G,i,P,t,l,a,m,B,o,F,re,V,Q,p,g,O,E,X,f,s,Z,Y,N]}class mn extends ve{constructor(e){super(),$e(this,e,hn,_n,ge,{message:0},null,[-1,-1])}}function kt(r,e,n){const l=r.slice();l[25]=e[n],l[27]=e,l[28]=n;const t=l[10].api.fetchUser(l[25].message.author);return l[26]=t,l}function gt(r){const e=`<${r[7]("user.unknown")}>`;r[29]=e}function vt(r){const e=me(r[26]);r[29]=e}function $t(r,e,n){const l=r.slice();l[26]=e[n];const t=me(l[26]);return l[29]=t,l}function wt(r,e,n){const l=r.slice();return l[32]=e[n],l}function yt(r){let e,n;return e=new mn({props:{message:r[32]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&8&&(o.message=l[32]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function Et(r){let e,n,l,t=r[29]+"",o,i,f=r[7]("user.is-typing")+"",s,u,a;return n=new Ee({props:{src:r[2]["jolt:low-data-mode"]?`${de}/user.svg`:pe(r[26]),width:16,height:16,name:r[29]}}),{c(){e=D("div"),oe(n.$$.fragment),l=S(),o=I(t),i=S(),s=I(f),u=I("...")},l(c){e=U(c,"DIV",{});var m=R(e);se(n.$$.fragment,m),l=j(m),o=C(m,t),i=j(m),s=C(m,f),u=C(m,"..."),m.forEach(_)},m(c,m){b(c,e,m),fe(n,e,null),k(e,l),k(e,o),k(e,i),k(e,s),k(e,u),a=!0},p(c,m){const B={};m[0]&36&&(B.src=c[2]["jolt:low-data-mode"]?`${de}/user.svg`:pe(c[26])),m[0]&32&&(B.name=c[29]),n.$set(B),(!a||m[0]&32)&&t!==(t=c[29]+"")&&K(o,t),(!a||m[0]&128)&&f!==(f=c[7]("user.is-typing")+"")&&K(s,f)},i(c){a||(w(n.$$.fragment,c),a=!0)},o(c){M(n.$$.fragment,c),a=!1},d(c){c&&_(e),ce(n)}}}function dn(r){gt(r);let e,n,l=r[29]+"",t,o;return e=new Ee({props:{src:de+"/user.svg",name:r[29]}}),{c(){oe(e.$$.fragment),n=S(),t=I(l)},l(i){se(e.$$.fragment,i),n=j(i),t=C(i,l)},m(i,f){fe(e,i,f),b(i,n,f),b(i,t,f),o=!0},p(i,f){gt(i);const s={};f[0]&128&&(s.name=i[29]),e.$set(s),(!o||f[0]&128)&&l!==(l=i[29]+"")&&K(t,l)},i(i){o||(w(e.$$.fragment,i),o=!0)},o(i){M(e.$$.fragment,i),o=!1},d(i){i&&(_(n),_(t)),ce(e,i)}}}function pn(r){vt(r);let e,n,l=r[29]+"",t,o;return e=new Ee({props:{src:pe(r[26]),name:r[29]}}),{c(){oe(e.$$.fragment),n=S(),t=I(l)},l(i){se(e.$$.fragment,i),n=j(i),t=C(i,l)},m(i,f){fe(e,i,f),b(i,n,f),b(i,t,f),o=!0},p(i,f){vt(i);const s={};f[0]&256&&(s.src=pe(i[26])),f[0]&256&&(s.name=i[29]),e.$set(s),(!o||f[0]&256)&&l!==(l=i[29]+"")&&K(t,l)},i(i){o||(w(e.$$.fragment,i),o=!0)},o(i){M(e.$$.fragment,i),o=!1},d(i){i&&(_(n),_(t)),ce(e,i)}}}function bn(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function It(r){let e,n,l=r[7]("message.replying-to")+"",t,o,i,f,s,u,a=r[25].message.content+"",c,m,B,G,P,E,X,F,A,re,H,V=r[25].mention?"ON":"OFF",Q,p,g,d,O,Z,Y,N,$,T={ctx:r,current:null,token:null,hasCatch:!0,pending:bn,then:pn,catch:dn,value:26,blocks:[,,,]};ie(f=r[26],T);function z(){r[17].call(E,r[27],r[28])}function x(){return r[18](r[25])}return{c(){e=D("div"),n=D("p"),t=I(l),o=S(),i=D("strong"),T.block.c(),s=S(),u=D("p"),c=I(a),m=S(),B=D("div"),G=S(),P=D("div"),E=D("input"),X=S(),F=D("label"),A=D("img"),H=S(),Q=I(V),p=S(),g=D("div"),d=D("button"),O=D("img"),this.h()},l(W){e=U(W,"DIV",{class:!0});var y=R(e);n=U(y,"P",{});var L=R(n);t=C(L,l),o=j(L),i=U(L,"STRONG",{});var J=R(i);T.block.l(J),J.forEach(_),L.forEach(_),s=j(y),u=U(y,"P",{class:!0});var he=R(u);c=C(he,a),he.forEach(_),m=j(y),B=U(y,"DIV",{class:!0}),R(B).forEach(_),G=j(y),P=U(y,"DIV",{class:!0});var we=R(P);E=U(we,"INPUT",{id:!0,style:!0,type:!0}),X=j(we),F=U(we,"LABEL",{class:!0,for:!0});var ke=R(F);A=U(ke,"IMG",{src:!0,class:!0,alt:!0}),H=j(ke),Q=C(ke,V),ke.forEach(_),we.forEach(_),p=j(y),g=U(y,"DIV",{class:!0});var Be=R(g);d=U(Be,"BUTTON",{});var Ke=R(d);O=U(Ke,"IMG",{src:!0,alt:!0}),Ke.forEach(_),Be.forEach(_),y.forEach(_),this.h()},h(){v(u,"class","pl-1 text-gray-600 overflow-ellipsis"),v(B,"class","flex-1"),v(E,"id","mention"),Ue(E,"display","none"),v(E,"type","checkbox"),ue(A.src,re=de+"/at.svg")||v(A,"src",re),v(A,"class","inline"),v(A,"alt","mention"),v(F,"class","cursor-pointer"),v(F,"for","mention"),v(P,"class","pr-2"),ue(O.src,Z=de+"/circle-x.svg")||v(O,"src",Z),v(O,"alt","Cancel mention"),v(g,"class","pr-2"),v(e,"class","flex")},m(W,y){b(W,e,y),k(e,n),k(n,t),k(n,o),k(n,i),T.block.m(i,T.anchor=null),T.mount=()=>i,T.anchor=null,k(e,s),k(e,u),k(u,c),k(e,m),k(e,B),k(e,G),k(e,P),k(P,E),E.checked=r[25].mention,k(P,X),k(P,F),k(F,A),k(F,H),k(F,Q),k(e,p),k(e,g),k(g,d),k(d,O),Y=!0,N||($=[_e(E,"change",z),_e(d,"click",x)],N=!0)},p(W,y){r=W,(!Y||y[0]&128)&&l!==(l=r[7]("message.replying-to")+"")&&K(t,l),T.ctx=r,y[0]&256&&f!==(f=r[26])&&ie(f,T)||be(T,r,y),(!Y||y[0]&256)&&a!==(a=r[25].message.content+"")&&K(c,a),y[0]&256&&(E.checked=r[25].mention),(!Y||y[0]&256)&&V!==(V=r[25].mention?"ON":"OFF")&&K(Q,V)},i(W){Y||(w(T.block),Y=!0)},o(W){for(let y=0;y<3;y+=1){const L=T.blocks[y];M(L)}Y=!1},d(W){W&&_(e),T.block.d(),T.token=null,T=null,N=!1,Ae($)}}}function kn(r){let e,n,l,t="so um hi this is the start, i should make this text box much further down i think",o,i,f,s,u,a,c,m,B,G,P=ae(r[3]),E=[];for(let p=0;p<P.length;p+=1)E[p]=yt(wt(r,P,p));const X=p=>M(E[p],1,1,()=>{E[p]=null});let F=ae(r[5]),A=[];for(let p=0;p<F.length;p+=1)A[p]=Et($t(r,F,p));const re=p=>M(A[p],1,1,()=>{A[p]=null});let H=ae(r[8]),V=[];for(let p=0;p<H.length;p+=1)V[p]=It(kt(r,H,p));const Q=p=>M(V[p],1,1,()=>{V[p]=null});return{c(){e=D("main"),n=D("div"),l=D("p"),l.textContent=t,o=S();for(let p=0;p<E.length;p+=1)E[p].c();i=S();for(let p=0;p<A.length;p+=1)A[p].c();f=S();for(let p=0;p<V.length;p+=1)V[p].c();s=S(),u=D("form"),a=D("textarea"),this.h()},l(p){e=U(p,"MAIN",{class:!0});var g=R(e);n=U(g,"DIV",{class:!0});var d=R(n);l=U(d,"P",{"data-svelte-h":!0}),Se(l)!=="svelte-1kz18j0"&&(l.textContent=t),o=j(d);for(let Z=0;Z<E.length;Z+=1)E[Z].l(d);d.forEach(_),i=j(g);for(let Z=0;Z<A.length;Z+=1)A[Z].l(g);f=j(g);for(let Z=0;Z<V.length;Z+=1)V[Z].l(g);s=j(g),u=U(g,"FORM",{class:!0});var O=R(u);a=U(O,"TEXTAREA",{maxlength:!0,class:!0,placeholder:!0}),R(a).forEach(_),O.forEach(_),g.forEach(_),this.h()},h(){v(n,"class","flex flex-col h-full overflow-x-hidden overflow-y-scroll"),v(a,"maxlength","2000"),v(a,"class","outline-none resize-none bg-inherit w-full h-12"),v(a,"placeholder",c=r[7]("send-message-in")+" "+r[6]),v(u,"class","bg-gray-500 rounded-xl px-2 pt-2 m-4"),v(e,"class","main-content-container flex flex-col")},m(p,g){b(p,e,g),k(e,n),k(n,l),k(n,o);for(let d=0;d<E.length;d+=1)E[d]&&E[d].m(n,null);r[16](n),k(e,i);for(let d=0;d<A.length;d+=1)A[d]&&A[d].m(e,null);k(e,f);for(let d=0;d<V.length;d+=1)V[d]&&V[d].m(e,null);k(e,s),k(e,u),k(u,a),r[20](a),m=!0,B||(G=[_e(a,"blur",r[13]),_e(a,"input",r[14]),_e(a,"keydown",r[19]),_e(u,"submit",r[12])],B=!0)},p(p,g){if(g[0]&8){P=ae(p[3]);let d;for(d=0;d<P.length;d+=1){const O=wt(p,P,d);E[d]?(E[d].p(O,g),w(E[d],1)):(E[d]=yt(O),E[d].c(),w(E[d],1),E[d].m(n,null))}for(le(),d=P.length;d<E.length;d+=1)X(d);ne()}if(g[0]&164){F=ae(p[5]);let d;for(d=0;d<F.length;d+=1){const O=$t(p,F,d);A[d]?(A[d].p(O,g),w(A[d],1)):(A[d]=Et(O),A[d].c(),w(A[d],1),A[d].m(e,f))}for(le(),d=F.length;d<A.length;d+=1)re(d);ne()}if(g[0]&1409){H=ae(p[8]);let d;for(d=0;d<H.length;d+=1){const O=kt(p,H,d);V[d]?(V[d].p(O,g),w(V[d],1)):(V[d]=It(O),V[d].c(),w(V[d],1),V[d].m(e,s))}for(le(),d=H.length;d<V.length;d+=1)Q(d);ne()}(!m||g[0]&192&&c!==(c=p[7]("send-message-in")+" "+p[6]))&&v(a,"placeholder",c)},i(p){if(!m){for(let g=0;g<P.length;g+=1)w(E[g]);for(let g=0;g<F.length;g+=1)w(A[g]);for(let g=0;g<H.length;g+=1)w(V[g]);m=!0}},o(p){E=E.filter(Boolean);for(let g=0;g<E.length;g+=1)M(E[g]);A=A.filter(Boolean);for(let g=0;g<A.length;g+=1)M(A[g]);V=V.filter(Boolean);for(let g=0;g<V.length;g+=1)M(V[g]);m=!1},d(p){p&&_(e),ye(E,p),r[16](null),ye(A,p),ye(V,p),r[20](null),B=!1,Ae(G)}}}function gn(r,e,n){let l,t,o,i=h,f=()=>(i(),i=St(P,N=>n(8,o=N)),P),s;ee(r,Ce,N=>n(7,t=N)),r.$$.on_destroy.push(()=>i());let{channel:u}=e;const a=te(Ie);ee(r,a,N=>n(2,l=N));const c=te(je);let m=Te([]);ee(r,m,N=>n(3,s=N));let B=Te([]),G=Te([]);const P=Te([]);f(),Ne(Ve,m),Ne(Nt,B),Ne(Re,G),Ne(Tt,P);let E,X,F=[];async function A(N){if(!N){c.removeAllListeners("ChannelStartTyping"),c.removeAllListeners("ChannelStopTyping");return}c.on("ChannelStartTyping",async({id:$,user:T})=>{var z;if(!(T==((z=c.user)==null?void 0:z._id)||$!=u._id)){for(const{_id:x}of F)if(T==x)return;n(5,F[F.length]=await c.api.fetchUser(T),F)}}),c.on("ChannelStopTyping",({id:$,user:T})=>{$==u._id&&n(5,F=F.filter(z=>z._id!=T))})}At(()=>{c.on("Message",N=>{N.channel==u._id&&(c.api.ackMessage(u._id,N._id),m.update($=>($.push(N),$)))}),c.on("MessageDelete",({id:N,channel:$})=>{$==u._id&&m.update(T=>T.filter(z=>z._id!=N))}),c.on("MessageUpdate",({id:N,channel:$,data:T})=>{$==u._id&&m.update(z=>{const x=z.findIndex(y=>y._id==N),W=z[x];return T.content!=null&&(W.content=T.content),T.embeds!=null&&(W.embeds=T.embeds),W.edited=T.edited,z[x]=W,z})})});async function re(){await c.api.sendMessage(u._id,{content:E.value.trim(),replies:o.map(({message:{_id:N},mention:$})=>({id:N,mention:$}))}),P.set([]),n(4,E.value="",E)}let H;async function V(N){var $;if(N.channel_type=="TextChannel"||N.channel_type=="VoiceChannel"||N.channel_type=="Group"){n(6,H=`#${N.name}`);return}if(N.channel_type=="SavedMessages"){n(6,H=t("channel.notes"));return}n(6,H=`@${me(await c.api.fetchUser(N.recipients[0]==(($=c.user)==null?void 0:$._id)?N.recipients[1]:N.recipients[0]))}`)}function Q(){l["jolt:send-typing-indicators"]&&c.websocket.send({type:"EndTyping",channel:u._id})}function p(){if(l["jolt:send-typing-indicators"]){if(E.value==""){c.websocket.send({type:"EndTyping",channel:u._id});return}c.websocket.send({type:"BeginTyping",channel:u._id})}}function g(N){De[N?"unshift":"push"](()=>{X=N,n(1,X)})}function d(N,$){N[$].mention=this.checked,P.set(o)}const O=N=>P.update($=>($=$.filter(T=>T.message._id!=N.message._id),$)),Z=N=>{N.shiftKey||N.key!="Enter"||(N.preventDefault(),re())};function Y(N){De[N?"unshift":"push"](()=>{E=N,n(4,E)})}return r.$$set=N=>{"channel"in N&&n(15,u=N.channel)},r.$$.update=()=>{r.$$.dirty[0]&32768&&(c.api.queryMessages(u._id,{sort:"Latest",include_users:!0}).then(N=>{Array.isArray(N)?m.set(N.reverse()):(m.set(N.messages.reverse()),G.set(N.users),B.set(N.members??[]))}),P.set([]),n(5,F=[])),r.$$.dirty[0]&10&&X&&X.offsetHeight+X.scrollTop>X.scrollHeight-20&&jt().then(()=>{X.scrollTo(0,X.scrollHeight)}),r.$$.dirty[0]&4&&A(l["jolt:receive-typing-indicators"]),r.$$.dirty[0]&32768&&V(u)},[P,X,l,s,E,F,H,t,o,a,c,m,re,Q,p,u,g,d,O,Z,Y]}class An extends ve{constructor(e){super(),$e(this,e,gn,kn,ge,{channel:15},null,[-1,-1])}}export{An as C};
