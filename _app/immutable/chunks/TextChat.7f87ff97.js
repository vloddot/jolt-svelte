import{s as ge,f as M,g as C,h as A,d as u,j as a,i as k,r as me,e as K,u as h,a as V,c as L,l as T,m as N,z as w,n as Q,F as x,C as ye,D as Ee,v as Dt,H as Ne,I as de,w as jt,x as At,y as Pt,K as De,L as Bt,p as Me,M as Ot,N as Le,k as Se,O as He,P as Vt,E as Ie,A as Lt,q as ze,Q as Te,R as qt,o as Rt,t as Ft}from"./scheduler.d49036d4.js";import{S as ke,i as be,a as v,g as J,t as y,c as Z,b as re,d as ce,m as ie,e as se,f as qe}from"./index.90a2ee5d.js";import{e as pe}from"./each.e59479a4.js";import{g as oe,c as Ce,a as je}from"./context.c1c8751f.js";import{g as we,b as ve,a as Gt}from"./util.9d7ab3cc.js";import{w as Pe}from"./index.87961ef1.js";import{h as he,u as $e}from"./await_block.872c6e1e.js";import{b as Xe}from"./paths.8ac8206c.js";import{a as Ct,s as Kt}from"./context.fa34f1f8.js";import{U as Ae}from"./UserIcon.3bf05d57.js";import{e as Ht,Y as zt}from"./runtime.esm.9b6bd036.js";import{d as Xt}from"./index.esm.4b6e8736.js";import{P as Qt}from"./PencilSquareIcon.45802a7a.js";import{t as Wt,P as Yt}from"./PlusIcon.cda21593.js";async function Ve(r,e,n){if(n=="0".repeat(26))return;let t;return Array.isArray(e)?t=e.find(l=>l._id==n):t=e.get(n),t??await r.fetchUser(n)}const Ut=Symbol(),Re=Symbol(),Tt=Symbol(),Fe=Symbol(),Ge=Symbol();function Jt(r){const e=r.slice(),n=ve(e[14]);return e[15]=n,e}function Qe(r){var s;let e,n,t,l={ctx:r,current:null,token:null,hasCatch:!1,pending:il,then:xt,catch:Zt,value:13,blocks:[,,,]};return he(n=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),l),{c(){e=K(),l.block.c()},l(i){e=K(),l.block.l(i)},m(i,c){k(i,e,c),l.block.m(i,l.anchor=c),l.mount=()=>e.parentNode,l.anchor=e,t=!0},p(i,c){var o;r=i,l.ctx=r,c&13&&n!==(n=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&he(n,l)||$e(l,r,c)},i(i){t||(v(l.block),t=!0)},o(i){for(let c=0;c<3;c+=1){const o=l.blocks[c];y(o)}t=!1},d(i){i&&u(e),l.block.d(i),l.token=null,l=null}}}function Zt(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function xt(r){let e,n,t,l=!r[4]["jolt:low-data-mode"]&&We(r),s=r[13].content!=null&&Ye(r);return{c(){l&&l.c(),e=V(),s&&s.c(),n=K()},l(i){l&&l.l(i),e=L(i),s&&s.l(i),n=K()},m(i,c){l&&l.m(i,c),k(i,e,c),s&&s.m(i,c),k(i,n,c),t=!0},p(i,c){i[4]["jolt:low-data-mode"]?l&&(J(),y(l,1,1,()=>{l=null}),Z()):l?(l.p(i,c),c&16&&v(l,1)):(l=We(i),l.c(),v(l,1),l.m(e.parentNode,e)),i[13].content!=null?s?s.p(i,c):(s=Ye(i),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(i){t||(v(l),t=!0)},o(i){y(l),t=!1},d(i){i&&(u(e),u(n)),l&&l.d(i),s&&s.d(i)}}}function We(r){let e,n,t,l={ctx:r,current:null,token:null,hasCatch:!1,pending:rl,then:tl,catch:el,value:14,blocks:[,,,]};return he(e=Ve(r[6].api,r[5]??r[6].api.cache.users,r[13].author),l),{c(){l.block.c(),n=T(":")},l(s){l.block.l(s),n=N(s,":")},m(s,i){l.block.m(s,l.anchor=i),l.mount=()=>n.parentNode,l.anchor=n,k(s,n,i),t=!0},p(s,i){r=s,l.ctx=r,i&45&&e!==(e=Ve(r[6].api,r[5]??r[6].api.cache.users,r[13].author))&&he(e,l)||$e(l,r,i)},i(s){t||(v(l.block),t=!0)},o(s){for(let i=0;i<3;i+=1){const c=l.blocks[i];y(c)}t=!1},d(s){s&&u(n),l.block.d(s),l.token=null,l=null}}}function el(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function tl(r){let e,n,t,l;const s=[nl,ll],i=[];function c(f,p){return f[14]!=null?0:1}function o(f,p){return p===0?Jt(f):f}return e=c(r),n=i[e]=s[e](o(r,e)),{c(){n.c(),t=V()},l(f){n.l(f),t=L(f)},m(f,p){i[e].m(f,p),k(f,t,p),l=!0},p(f,p){let d=e;e=c(f),e===d?i[e].p(o(f,e),p):(J(),y(i[d],1,1,()=>{i[d]=null}),Z(),n=i[e],n?n.p(o(f,e),p):(n=i[e]=s[e](o(f,e)),n.c()),v(n,1),n.m(t.parentNode,t))},i(f){l||(v(n),l=!0)},o(f){y(n),l=!1},d(f){f&&u(t),i[e].d(f)}}}function ll(r){let e,n,t;return e=new Ae({}),{c(){re(e.$$.fragment),n=T(`

						Unknown User`)},l(l){ce(e.$$.fragment,l),n=N(l,`

						Unknown User`)},m(l,s){ie(e,l,s),k(l,n,s),t=!0},p:h,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){l&&u(n),se(e,l)}}}function nl(r){let e,n,t,l,s=r[15]+"",i;return{c(){e=M("img"),l=V(),i=T(s),this.h()},l(c){e=C(c,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),l=L(c),i=N(c,s),this.h()},h(){a(e,"class","cover"),x(e.src,n=we(r[14]))||a(e,"src",n),a(e,"alt",t=r[15]),a(e,"width","24px"),a(e,"height","24px")},m(c,o){k(c,e,o),k(c,l,o),k(c,i,o)},p(c,o){o&45&&!x(e.src,n=we(c[14]))&&a(e,"src",n),o&45&&t!==(t=c[15])&&a(e,"alt",t),o&45&&s!==(s=c[15]+"")&&Q(i,s)},i:h,o:h,d(c){c&&(u(e),u(l),u(i))}}}function rl(r){let e;return{c(){e=T(`<Unknown User>
				`)},l(n){e=N(n,`<Unknown User>
				`)},m(n,t){k(n,e,t)},p:h,i:h,o:h,d(n){n&&u(e)}}}function Ye(r){let e,n=r[13].content+"",t;return{c(){e=M("span"),t=T(n),this.h()},l(l){e=C(l,"SPAN",{class:!0});var s=A(e);t=N(s,n),s.forEach(u),this.h()},h(){a(e,"class","text-gray-600")},m(l,s){k(l,e,s),w(e,t)},p(l,s){s&13&&n!==(n=l[13].content+"")&&Q(t,n)},d(l){l&&u(e)}}}function il(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function sl(r){let e,n,t,l=r[2]!=null&&Qe(r);return{c(){e=M("a"),l&&l.c(),this.h()},l(s){e=C(s,"A",{href:!0});var i=A(e);l&&l.l(i),i.forEach(u),this.h()},h(){a(e,"href",n=Xe+"/"+(r[1]==null?`channels/${r[2]}#${r[0]}`:`servers/${r[1]}/channels/${r[2]}#${r[0]}`))},m(s,i){k(s,e,i),l&&l.m(e,null),t=!0},p(s,[i]){s[2]!=null?l?(l.p(s,i),i&4&&v(l,1)):(l=Qe(s),l.c(),v(l,1),l.m(e,null)):l&&(J(),y(l,1,1,()=>{l=null}),Z()),(!t||i&7&&n!==(n=Xe+"/"+(s[1]==null?`channels/${s[2]}#${s[0]}`:`servers/${s[1]}/channels/${s[2]}#${s[0]}`)))&&a(e,"href",n)},i(s){t||(v(l),t=!0)},o(s){y(l),t=!1},d(s){s&&u(e),l&&l.d()}}}function ol(r,e,n){let t,l,s,i,c;const o=oe(Ce),f=oe(je);me(r,f,I=>n(4,i=I));const p=oe(Ct);me(r,p,I=>n(1,t=I));const d=oe(Kt);me(r,d,I=>n(2,l=I));const _=oe(Re);me(r,_,I=>n(3,s=I));const g=oe(Fe);me(r,g,I=>n(5,c=I));let{id:D}=e;const R=({_id:I})=>D==I;return r.$$set=I=>{"id"in I&&n(0,D=I.id)},[D,t,l,s,i,c,o,f,p,d,_,g,R]}class cl extends ke{constructor(e){super(),be(this,e,ol,sl,ge,{id:0})}}function fl(r){let e,n;return{c(){e=ye("svg"),n=ye("path"),this.h()},l(t){e=Ee(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var l=A(e);n=Ee(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),A(n).forEach(u),l.forEach(u),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"stroke-linejoin","round"),a(n,"d","M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(t,l){k(t,e,l),w(e,n)},p:h,i:h,o:h,d(t){t&&u(e)}}}class al extends ke{constructor(e){super(),be(this,e,null,fl,ge,{})}}function ul(r){let e,n;return{c(){e=ye("svg"),n=ye("path"),this.h()},l(t){e=Ee(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var l=A(e);n=Ee(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),A(n).forEach(u),l.forEach(u),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"stroke-linejoin","round"),a(n,"d","M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(t,l){k(t,e,l),w(e,n)},p:h,i:h,o:h,d(t){t&&u(e)}}}class _l extends ke{constructor(e){super(),be(this,e,null,ul,ge,{})}}function Je(r){const e=ve(r[3]);r[4]=e}function Ze(r){r[5]=r[7][0],r[6]=r[7][1]}function xe(r){const e=ve(r[3]);r[4]=e}function hl(r){let e,n,t={ctx:r,current:null,token:null,hasCatch:!1,pending:yl,then:kl,catch:gl,value:3};return he(n=r[1].api.fetchUser(r[0].id),t),{c(){e=K(),t.block.c()},l(l){e=K(),t.block.l(l)},m(l,s){k(l,e,s),t.block.m(l,t.anchor=s),t.mount=()=>e.parentNode,t.anchor=e},p(l,s){r=l,t.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&he(n,t)||$e(t,r,s)},d(l){l&&u(e),t.block.d(l),t.token=null,t=null}}}function ml(r){let e,n,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Ml,then:Il,catch:El,value:7};return he(n=Promise.all([r[0].from,r[0].to].map(r[2])),t),{c(){e=K(),t.block.c()},l(l){e=K(),t.block.l(l)},m(l,s){k(l,e,s),t.block.m(l,t.anchor=s),t.mount=()=>e.parentNode,t.anchor=e},p(l,s){r=l,t.ctx=r,s&1&&n!==(n=Promise.all([r[0].from,r[0].to].map(r[2])))&&he(n,t)||$e(t,r,s)},d(l){l&&u(e),t.block.d(l),t.token=null,t=null}}}function dl(r){let e,n,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Vl,then:Ul,catch:Cl,value:3};return he(n=r[1].api.fetchUser(r[0].by),t),{c(){e=K(),t.block.c()},l(l){e=K(),t.block.l(l)},m(l,s){k(l,e,s),t.block.m(l,t.anchor=s),t.mount=()=>e.parentNode,t.anchor=e},p(l,s){r=l,t.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].by))&&he(n,t)||$e(t,r,s)},d(l){l&&u(e),t.block.d(l),t.token=null,t=null}}}function pl(r){let e=r[0].content+"",n;return{c(){n=T(e)},l(t){n=N(t,e)},m(t,l){k(t,n,l)},p(t,l){l&1&&e!==(e=t[0].content+"")&&Q(n,e)},d(t){t&&u(n)}}}function gl(r){return{c:h,l:h,m:h,p:h,d:h}}function kl(r){Je(r);let e,n,t,l,s=r[4]+"",i,c,o;function f(_,g){if(_[0].type=="user_banned")return $l;if(_[0].type=="user_joined")return wl;if(_[0].type=="user_kicked")return vl;if(_[0].type=="user_left")return bl}let p=f(r),d=p&&p(r);return{c(){e=M("img"),l=V(),i=T(s),c=V(),d&&d.c(),o=K(),this.h()},l(_){e=C(_,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),l=L(_),i=N(_,s),c=L(_),d&&d.l(_),o=K(),this.h()},h(){a(e,"class","cover"),x(e.src,n=we(r[3]))||a(e,"src",n),a(e,"width","24px"),a(e,"height","24px"),a(e,"alt",t=r[4])},m(_,g){k(_,e,g),k(_,l,g),k(_,i,g),k(_,c,g),d&&d.m(_,g),k(_,o,g)},p(_,g){Je(_),g&1&&!x(e.src,n=we(_[3]))&&a(e,"src",n),g&1&&t!==(t=_[4])&&a(e,"alt",t),g&1&&s!==(s=_[4]+"")&&Q(i,s),p!==(p=f(_))&&(d&&d.d(1),d=p&&p(_),d&&(d.c(),d.m(o.parentNode,o)))},d(_){_&&(u(e),u(l),u(i),u(c),u(o)),d&&d.d(_)}}}function bl(r){let e;return{c(){e=T("left the chat.")},l(n){e=N(n,"left the chat.")},m(n,t){k(n,e,t)},d(n){n&&u(e)}}}function vl(r){let e;return{c(){e=T("was kicked.")},l(n){e=N(n,"was kicked.")},m(n,t){k(n,e,t)},d(n){n&&u(e)}}}function wl(r){let e;return{c(){e=T("has joined the chat.")},l(n){e=N(n,"has joined the chat.")},m(n,t){k(n,e,t)},d(n){n&&u(e)}}}function $l(r){let e;return{c(){e=T("was banned.")},l(n){e=N(n,"was banned.")},m(n,t){k(n,e,t)},d(n){n&&u(e)}}}function yl(r){return{c:h,l:h,m:h,p:h,d:h}}function El(r){return{c:h,l:h,m:h,p:h,d:h}}function Il(r){Ze(r);let e,n=ve(r[5])+"",t,l,s=ve(r[6])+"",i,c;return{c(){e=T("Channel ownership changed from "),t=T(n),l=T(" to "),i=T(s),c=T(".")},l(o){e=N(o,"Channel ownership changed from "),t=N(o,n),l=N(o," to "),i=N(o,s),c=N(o,".")},m(o,f){k(o,e,f),k(o,t,f),k(o,l,f),k(o,i,f),k(o,c,f)},p(o,f){Ze(o),f&1&&n!==(n=ve(o[5])+"")&&Q(t,n),f&1&&s!==(s=ve(o[6])+"")&&Q(i,s)},d(o){o&&(u(e),u(t),u(l),u(i),u(c))}}}function Ml(r){return{c:h,l:h,m:h,p:h,d:h}}function Cl(r){return{c:h,l:h,m:h,p:h,d:h}}function Ul(r){xe(r);let e,n,t,l,s=r[4]+"",i,c,o;function f(_,g){if(_[0].type=="channel_description_changed")return Dl;if(_[0].type=="channel_icon_changed")return Sl;if(_[0].type=="channel_renamed")return Nl;if(_[0].type=="user_added"||_[0].type=="user_remove")return Tl}let p=f(r),d=p&&p(r);return{c(){e=M("img"),l=V(),i=T(s),c=V(),d&&d.c(),o=K(),this.h()},l(_){e=C(_,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),l=L(_),i=N(_,s),c=L(_),d&&d.l(_),o=K(),this.h()},h(){a(e,"class","cover"),x(e.src,n=we(r[3]))||a(e,"src",n),a(e,"width","24px"),a(e,"height","24px"),a(e,"alt",t=r[4])},m(_,g){k(_,e,g),k(_,l,g),k(_,i,g),k(_,c,g),d&&d.m(_,g),k(_,o,g)},p(_,g){xe(_),g&1&&!x(e.src,n=we(_[3]))&&a(e,"src",n),g&1&&t!==(t=_[4])&&a(e,"alt",t),g&1&&s!==(s=_[4]+"")&&Q(i,s),p===(p=f(_))&&d?d.p(_,g):(d&&d.d(1),d=p&&p(_),d&&(d.c(),d.m(o.parentNode,o)))},d(_){_&&(u(e),u(l),u(i),u(c),u(o)),d&&d.d(_)}}}function Tl(r){let e,n,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Ol,then:Al,catch:jl,value:3};return he(n=r[1].api.fetchUser(r[0].id),t),{c(){e=K(),t.block.c()},l(l){e=K(),t.block.l(l)},m(l,s){k(l,e,s),t.block.m(l,t.anchor=s),t.mount=()=>e.parentNode,t.anchor=e},p(l,s){r=l,t.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&he(n,t)||$e(t,r,s)},d(l){l&&u(e),t.block.d(l),t.token=null,t=null}}}function Nl(r){let e,n=r[0].name+"",t,l;return{c(){e=T("renamed this channel to "),t=T(n),l=T(".")},l(s){e=N(s,"renamed this channel to "),t=N(s,n),l=N(s,".")},m(s,i){k(s,e,i),k(s,t,i),k(s,l,i)},p(s,i){i&1&&n!==(n=s[0].name+"")&&Q(t,n)},d(s){s&&(u(e),u(t),u(l))}}}function Sl(r){let e;return{c(){e=T("changes this channel icon.")},l(n){e=N(n,"changes this channel icon.")},m(n,t){k(n,e,t)},p:h,d(n){n&&u(e)}}}function Dl(r){let e;return{c(){e=T("changed this channel's description.")},l(n){e=N(n,"changed this channel's description.")},m(n,t){k(n,e,t)},p:h,d(n){n&&u(e)}}}function jl(r){return{c:h,l:h,m:h,p:h,d:h}}function Al(r){let e,n=ve(r[3])+"",t,l;function s(o,f){if(o[0].type=="user_added")return Bl;if(o[0].type=="user_remove")return Pl}let i=s(r),c=i&&i(r);return{c(){c&&c.c(),e=V(),t=T(n),l=T(".")},l(o){c&&c.l(o),e=L(o),t=N(o,n),l=N(o,".")},m(o,f){c&&c.m(o,f),k(o,e,f),k(o,t,f),k(o,l,f)},p(o,f){i!==(i=s(o))&&(c&&c.d(1),c=i&&i(o),c&&(c.c(),c.m(e.parentNode,e))),f&1&&n!==(n=ve(o[3])+"")&&Q(t,n)},d(o){o&&(u(e),u(t),u(l)),c&&c.d(o)}}}function Pl(r){let e;return{c(){e=T("removed")},l(n){e=N(n,"removed")},m(n,t){k(n,e,t)},d(n){n&&u(e)}}}function Bl(r){let e;return{c(){e=T("added")},l(n){e=N(n,"added")},m(n,t){k(n,e,t)},d(n){n&&u(e)}}}function Ol(r){return{c:h,l:h,m:h,p:h,d:h}}function Vl(r){return{c:h,l:h,m:h,p:h,d:h}}function Ll(r){let e;function n(s,i){if(s[0].type=="text")return pl;if(s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove")return dl;if(s[0].type=="channel_ownership_changed")return ml;if(s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left")return hl}let t=n(r),l=t&&t(r);return{c(){l&&l.c(),e=K()},l(s){l&&l.l(s),e=K()},m(s,i){l&&l.m(s,i),k(s,e,i)},p(s,[i]){t===(t=n(s))&&l?l.p(s,i):(l&&l.d(1),l=t&&t(s),l&&(l.c(),l.m(e.parentNode,e)))},i:h,o:h,d(s){s&&u(e),l&&l.d(s)}}}function ql(r,e,n){const t=oe(Ce);let{system:l}=e;const s=i=>t.api.fetchUser(i);return r.$$set=i=>{"system"in i&&n(0,l=i.system)},[l,t,s]}class Rl extends ke{constructor(e){super(),be(this,e,ql,Ll,ge,{system:0})}}function Fl(r){let e,n,t,l,s,i,c,o="Ok",f,p,d="Cancel",_,g,D;const R=r[3].default,I=Dt(R,r,r[2],null);return{c(){e=M("dialog"),n=M("div"),I&&I.c(),t=V(),l=M("hr"),s=V(),i=M("form"),c=M("button"),c.textContent=o,f=V(),p=M("button"),p.textContent=d,this.h()},l(B){e=C(B,"DIALOG",{});var H=A(e);n=C(H,"DIV",{});var P=A(n);I&&I.l(P),t=L(P),l=C(P,"HR",{}),s=L(P),i=C(P,"FORM",{id:!0,method:!0});var z=A(i);c=C(z,"BUTTON",{type:!0,"data-svelte-h":!0}),Ne(c)!=="svelte-fdbbw9"&&(c.textContent=o),f=L(z),p=C(z,"BUTTON",{type:!0,"data-svelte-h":!0}),Ne(p)!=="svelte-1gqjcfl"&&(p.textContent=d),z.forEach(u),P.forEach(u),H.forEach(u),this.h()},h(){a(c,"type","submit"),a(p,"type","reset"),a(i,"id","modal-form"),a(i,"method","dialog")},m(B,H){k(B,e,H),w(e,n),I&&I.m(n,null),w(n,t),w(n,l),w(n,s),w(n,i),w(i,c),w(i,f),w(i,p),r[6](e),_=!0,g||(D=[de(p,"click",r[5]),de(i,"submit",r[4]),de(e,"close",r[7])],g=!0)},p(B,[H]){I&&I.p&&(!_||H&4)&&jt(I,R,B,B[2],_?Pt(R,B[2],H,null):At(B[2]),null)},i(B){_||(v(I,B),_=!0)},o(B){y(I,B),_=!1},d(B){B&&u(e),I&&I.d(B),r[6](null),g=!1,De(D)}}}function Gl(r,e,n){let{$$slots:t={},$$scope:l}=e,{showModal:s}=e,i;function c(d){Bt.call(this,r,d)}const o=()=>n(0,s=!1);function f(d){Me[d?"unshift":"push"](()=>{i=d,n(1,i)})}const p=()=>n(0,s=!1);return r.$$set=d=>{"showModal"in d&&n(0,s=d.showModal),"$$scope"in d&&n(2,l=d.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(s?i==null||i.showModal():i==null||i.close())},[s,i,l,t,c,o,f,p]}class Kl extends ke{constructor(e){super(),be(this,e,Gl,Fl,ge,{showModal:0})}}function Hl(r){let e,n="External Link",t,l,s,i,c="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=M("h1"),e.textContent=n,t=V(),l=M("hr"),s=V(),i=M("p"),i.textContent=c,this.h()},l(o){e=C(o,"H1",{class:!0,"data-svelte-h":!0}),Ne(e)!=="svelte-qkxu7n"&&(e.textContent=n),t=L(o),l=C(o,"HR",{}),s=L(o),i=C(o,"P",{"data-svelte-h":!0}),Ne(i)!=="svelte-os1rtp"&&(i.textContent=c),this.h()},h(){a(e,"class","text-3xl")},m(o,f){k(o,e,f),k(o,t,f),k(o,l,f),k(o,s,f),k(o,i,f)},p:h,d(o){o&&(u(e),u(t),u(l),u(s),u(i))}}}function zl(r){let e,n,t,l,s,i,c,o;function f(d){r[2](d)}let p={$$slots:{default:[Hl]},$$scope:{ctx:r}};return r[1]!==void 0&&(p.showModal=r[1]),e=new Kl({props:p}),Me.push(()=>qe(e,"showModal",f)),e.$on("submit",r[3]),{c(){re(e.$$.fragment),t=V(),l=M("a"),s=T(r[0]),this.h()},l(d){ce(e.$$.fragment,d),t=L(d),l=C(d,"A",{href:!0,target:!0,rel:!0});var _=A(l);s=N(_,r[0]),_.forEach(u),this.h()},h(){a(l,"href",r[0]),a(l,"target","_blank"),a(l,"rel","noreferrer")},m(d,_){ie(e,d,_),k(d,t,_),k(d,l,_),w(l,s),i=!0,c||(o=de(l,"click",Ot(r[4])),c=!0)},p(d,[_]){const g={};_&32&&(g.$$scope={dirty:_,ctx:d}),!n&&_&2&&(n=!0,g.showModal=d[1],Le(()=>n=!1)),e.$set(g),(!i||_&1)&&Q(s,d[0]),(!i||_&1)&&a(l,"href",d[0])},i(d){i||(v(e.$$.fragment,d),i=!0)},o(d){y(e.$$.fragment,d),i=!1},d(d){d&&(u(t),u(l)),se(e,d),c=!1,o()}}}function Xl(r,e,n){let{href:t}=e,l=!1;function s(o){l=o,n(1,l)}const i=()=>window.open(t),c=()=>n(1,l=!0);return r.$$set=o=>{"href"in o&&n(0,t=o.href)},[t,l,s,i,c]}class Ke extends ke{constructor(e){super(),be(this,e,Xl,zl,ge,{href:0})}}function Ql(r){let e,n,t,l;const s=[en,xl],i=[];function c(o,f){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),t=K()},l(o){n.l(o),t=K()},m(o,f){i[e].m(o,f),k(o,t,f),l=!0},p(o,f){let p=e;e=c(o),e===p?i[e].p(o,f):(J(),y(i[p],1,1,()=>{i[p]=null}),Z(),n=i[e],n?n.p(o,f):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(t.parentNode,t))},i(o){l||(v(n),l=!0)},o(o){y(n),l=!1},d(o){o&&u(t),i[e].d(o)}}}function Wl(r){let e,n,t=r[0].filename+"",l,s,i,c;return i=new Ke({props:{href:r[1]}}),{c(){e=M("span"),n=T("[File "),l=T(t),s=T(`]
			`),re(i.$$.fragment),this.h()},l(o){e=C(o,"SPAN",{class:!0});var f=A(e);n=N(f,"[File "),l=N(f,t),s=N(f,`]
			`),ce(i.$$.fragment,f),f.forEach(u),this.h()},h(){a(e,"class","text-gray-500")},m(o,f){k(o,e,f),w(e,n),w(e,l),w(e,s),ie(i,e,null),c=!0},p(o,f){(!c||f&1)&&t!==(t=o[0].filename+"")&&Q(l,t);const p={};f&2&&(p.href=o[1]),i.$set(p)},i(o){c||(v(i.$$.fragment,o),c=!0)},o(o){y(i.$$.fragment,o),c=!1},d(o){o&&u(e),se(i)}}}function Yl(r){let e,n,t;return{c(){e=M("audio"),n=M("source"),this.h()},l(l){e=C(l,"AUDIO",{});var s=A(e);n=C(s,"SOURCE",{src:!0}),s.forEach(u),this.h()},h(){x(n.src,t=r[1])||a(n,"src",t),e.controls=!0},m(l,s){k(l,e,s),w(e,n)},p(l,s){s&2&&!x(n.src,t=l[1])&&a(n,"src",t)},i:h,o:h,d(l){l&&u(e)}}}function Jl(r){let e,n,t;return{c(){e=M("video"),n=M("source"),this.h()},l(l){e=C(l,"VIDEO",{});var s=A(e);n=C(s,"SOURCE",{src:!0}),s.forEach(u),this.h()},h(){x(n.src,t=r[1])||a(n,"src",t),e.controls=!0},m(l,s){k(l,e,s),w(e,n)},p(l,s){s&2&&!x(n.src,t=l[1])&&a(n,"src",t)},i:h,o:h,d(l){l&&u(e)}}}function Zl(r){let e,n,t,l;const s=[fn,cn],i=[];function c(o,f){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),t=K()},l(o){n.l(o),t=K()},m(o,f){i[e].m(o,f),k(o,t,f),l=!0},p(o,f){let p=e;e=c(o),e===p?i[e].p(o,f):(J(),y(i[p],1,1,()=>{i[p]=null}),Z(),n=i[e],n?n.p(o,f):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(t.parentNode,t))},i(o){l||(v(n),l=!0)},o(o){y(n),l=!1},d(o){o&&u(t),i[e].d(o)}}}function xl(r){let e,n,t={ctx:r,current:null,token:null,hasCatch:!0,pending:on,then:ln,catch:tn,value:4,error:6};return he(n=fetch(r[1]),t),{c(){e=K(),t.block.c()},l(l){e=K(),t.block.l(l)},m(l,s){k(l,e,s),t.block.m(l,t.anchor=s),t.mount=()=>e.parentNode,t.anchor=e},p(l,s){r=l,t.ctx=r,s&2&&n!==(n=fetch(r[1]))&&he(n,t)||$e(t,r,s)},i:h,o:h,d(l){l&&u(e),t.block.d(l),t.token=null,t=null}}}function en(r){let e,n,t,l,s;return t=new Ke({props:{href:r[1]}}),{c(){e=M("span"),n=T("[Text "),re(t.$$.fragment),l=T("]"),this.h()},l(i){e=C(i,"SPAN",{class:!0});var c=A(e);n=N(c,"[Text "),ce(t.$$.fragment,c),l=N(c,"]"),c.forEach(u),this.h()},h(){a(e,"class","text-gray-500")},m(i,c){k(i,e,c),w(e,n),ie(t,e,null),w(e,l),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),t.$set(o)},i(i){s||(v(t.$$.fragment,i),s=!0)},o(i){y(t.$$.fragment,i),s=!1},d(i){i&&u(e),se(t)}}}function tn(r){let e,n,t=r[0].filename+"",l,s,i=r[6]+"",c;return{c(){e=M("p"),n=T("Unable to download "),l=T(t),s=T(": "),c=T(i)},l(o){e=C(o,"P",{});var f=A(e);n=N(f,"Unable to download "),l=N(f,t),s=N(f,": "),c=N(f,i),f.forEach(u)},m(o,f){k(o,e,f),w(e,n),w(e,l),w(e,s),w(e,c)},p(o,f){f&1&&t!==(t=o[0].filename+"")&&Q(l,t),f&2&&i!==(i=o[6]+"")&&Q(c,i)},d(o){o&&u(e)}}}function ln(r){let e,n,t={ctx:r,current:null,token:null,hasCatch:!1,pending:sn,then:rn,catch:nn,value:5};return he(n=r[4].text(),t),{c(){e=K(),t.block.c()},l(l){e=K(),t.block.l(l)},m(l,s){k(l,e,s),t.block.m(l,t.anchor=s),t.mount=()=>e.parentNode,t.anchor=e},p(l,s){r=l,t.ctx=r,s&2&&n!==(n=r[4].text())&&he(n,t)||$e(t,r,s)},d(l){l&&u(e),t.block.d(l),t.token=null,t=null}}}function nn(r){return{c:h,l:h,m:h,p:h,d:h}}function rn(r){let e,n=r[5]+"",t;return{c(){e=M("p"),t=T(n)},l(l){e=C(l,"P",{});var s=A(e);t=N(s,n),s.forEach(u)},m(l,s){k(l,e,s),w(e,t)},p(l,s){s&2&&n!==(n=l[5]+"")&&Q(t,n)},d(l){l&&u(e)}}}function sn(r){return{c:h,l:h,m:h,p:h,d:h}}function on(r){return{c:h,l:h,m:h,p:h,d:h}}function cn(r){let e,n,t;return{c(){e=M("img"),this.h()},l(l){e=C(l,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){x(e.src,n=r[1])||a(e,"src",n),a(e,"alt",t=r[0].filename),a(e,"class","max-w-xl max-h-xl")},m(l,s){k(l,e,s)},p(l,s){s&2&&!x(e.src,n=l[1])&&a(e,"src",n),s&1&&t!==(t=l[0].filename)&&a(e,"alt",t)},i:h,o:h,d(l){l&&u(e)}}}function fn(r){let e,n,t,l,s;return t=new Ke({props:{href:r[1]}}),{c(){e=M("span"),n=T("[Image "),re(t.$$.fragment),l=T("]"),this.h()},l(i){e=C(i,"SPAN",{class:!0});var c=A(e);n=N(c,"[Image "),ce(t.$$.fragment,c),l=N(c,"]"),c.forEach(u),this.h()},h(){a(e,"class","text-gray-500")},m(i,c){k(i,e,c),w(e,n),ie(t,e,null),w(e,l),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),t.$set(o)},i(i){s||(v(t.$$.fragment,i),s=!0)},o(i){y(t.$$.fragment,i),s=!1},d(i){i&&u(e),se(t)}}}function an(r){let e,n,t,l;const s=[Zl,Jl,Yl,Wl,Ql],i=[];function c(o,f){return o[0].metadata.type=="Image"?0:o[0].metadata.type=="Video"?1:o[0].metadata.type=="Audio"?2:o[0].metadata.type=="File"?3:o[0].metadata.type=="Text"?4:-1}return~(n=c(r))&&(t=i[n]=s[n](r)),{c(){e=M("div"),t&&t.c()},l(o){e=C(o,"DIV",{});var f=A(e);t&&t.l(f),f.forEach(u)},m(o,f){k(o,e,f),~n&&i[n].m(e,null),l=!0},p(o,[f]){let p=n;n=c(o),n===p?~n&&i[n].p(o,f):(t&&(J(),y(i[p],1,1,()=>{i[p]=null}),Z()),~n?(t=i[n],t?t.p(o,f):(t=i[n]=s[n](o),t.c()),v(t,1),t.m(e,null)):t=null)},i(o){l||(v(t),l=!0)},o(o){y(t),l=!1},d(o){o&&u(e),~n&&i[n].d()}}}function un(r,e,n){let t,l;const s=oe(je);me(r,s,c=>n(2,l=c));let{attachment:i}=e;return r.$$set=c=>{"attachment"in c&&n(0,i=c.attachment)},r.$$.update=()=>{r.$$.dirty&1&&n(1,t=Gt(i))},[i,t,l,s]}class _n extends ke{constructor(e){super(),be(this,e,un,an,ge,{attachment:0})}}function hn(r){let e,n="oop website embed, can't handle that :(";return{c(){e=M("span"),e.textContent=n,this.h()},l(t){e=C(t,"SPAN",{class:!0,"data-svelte-h":!0}),Ne(e)!=="svelte-1exisih"&&(e.textContent=n),this.h()},h(){a(e,"class","text-gray-600")},m(t,l){k(t,e,l)},p:h,d(t){t&&u(e)}}}function mn(r){let e,n,t,l=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&et(r),s=r[0].title&&tt(r),i=r[0].description&&lt(r);return{c(){e=M("div"),l&&l.c(),n=V(),s&&s.c(),t=V(),i&&i.c(),this.h()},l(c){e=C(c,"DIV",{style:!0});var o=A(e);l&&l.l(o),n=L(o),s&&s.l(o),t=L(o),i&&i.l(o),o.forEach(u),this.h()},h(){Se(e,"background-color",r[0].colour)},m(c,o){k(c,e,o),l&&l.m(e,null),w(e,n),s&&s.m(e,null),w(e,t),i&&i.m(e,null)},p(c,o){c[0].icon_url&&!c[1]["jolt:low-data-mode"]?l?l.p(c,o):(l=et(c),l.c(),l.m(e,n)):l&&(l.d(1),l=null),c[0].title?s?s.p(c,o):(s=tt(c),s.c(),s.m(e,t)):s&&(s.d(1),s=null),c[0].description?i?i.p(c,o):(i=lt(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null),o&1&&Se(e,"background-color",c[0].colour)},d(c){c&&u(e),l&&l.d(),s&&s.d(),i&&i.d()}}}function dn(r){let e,n,t,l,s;return{c(){e=M("video"),n=M("source"),this.h()},l(i){e=C(i,"VIDEO",{});var c=A(e);n=C(c,"SOURCE",{src:!0,width:!0,height:!0}),c.forEach(u),this.h()},h(){x(n.src,t=r[0].url)||a(n,"src",t),a(n,"width",l=r[0].width),a(n,"height",s=r[0].height),e.controls=!0},m(i,c){k(i,e,c),w(e,n)},p(i,c){c&1&&!x(n.src,t=i[0].url)&&a(n,"src",t),c&1&&l!==(l=i[0].width)&&a(n,"width",l),c&1&&s!==(s=i[0].height)&&a(n,"height",s)},d(i){i&&u(e)}}}function pn(r){let e,n,t,l;return{c(){e=M("img"),this.h()},l(s){e=C(s,"IMG",{src:!0,width:!0,height:!0}),this.h()},h(){x(e.src,n=r[0].url)||a(e,"src",n),a(e,"width",t=r[0].width),a(e,"height",l=r[0].height)},m(s,i){k(s,e,i)},p(s,i){i&1&&!x(e.src,n=s[0].url)&&a(e,"src",n),i&1&&t!==(t=s[0].width)&&a(e,"width",t),i&1&&l!==(l=s[0].height)&&a(e,"height",l)},d(s){s&&u(e)}}}function et(r){let e,n,t;return{c(){e=M("img"),this.h()},l(l){e=C(l,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){x(e.src,n=r[0].icon_url)||a(e,"src",n),a(e,"alt",t=r[0].title),a(e,"width","24"),a(e,"height","24"),a(e,"class","inline rounded-3xl")},m(l,s){k(l,e,s)},p(l,s){s&1&&!x(e.src,n=l[0].icon_url)&&a(e,"src",n),s&1&&t!==(t=l[0].title)&&a(e,"alt",t)},d(l){l&&u(e)}}}function tt(r){let e,n=r[0].title+"",t;return{c(){e=M("h1"),t=T(n),this.h()},l(l){e=C(l,"H1",{class:!0});var s=A(e);t=N(s,n),s.forEach(u),this.h()},h(){a(e,"class","text-gray-600")},m(l,s){k(l,e,s),w(e,t)},p(l,s){s&1&&n!==(n=l[0].title+"")&&Q(t,n)},d(l){l&&u(e)}}}function lt(r){let e,n=r[0].description+"",t;return{c(){e=M("p"),t=T(n)},l(l){e=C(l,"P",{});var s=A(e);t=N(s,n),s.forEach(u)},m(l,s){k(l,e,s),w(e,t)},p(l,s){s&1&&n!==(n=l[0].description+"")&&Q(t,n)},d(l){l&&u(e)}}}function gn(r){let e;function n(s,i){if(s[0].type=="Image"&&!s[1]["jolt:low-data-mode"])return pn;if(s[0].type=="Video"&&!s[1]["jolt:low-data-mode"])return dn;if(s[0].type=="Text")return mn;if(s[0].type=="Website")return hn}let t=n(r),l=t&&t(r);return{c(){l&&l.c(),e=K()},l(s){l&&l.l(s),e=K()},m(s,i){l&&l.m(s,i),k(s,e,i)},p(s,[i]){t===(t=n(s))&&l?l.p(s,i):(l&&l.d(1),l=t&&t(s),l&&(l.c(),l.m(e.parentNode,e)))},i:h,o:h,d(s){s&&u(e),l&&l.d(s)}}}function kn(r,e,n){let t,{embed:l}=e;const s=oe(je);return me(r,s,i=>n(1,t=i)),r.$$set=i=>{"embed"in i&&n(0,l=i.embed)},[l,t,s]}class bn extends ke{constructor(e){super(),be(this,e,kn,gn,ge,{embed:0})}}function vn(r){let e,n,t;return{c(){e=M("textarea"),this.h()},l(l){e=C(l,"TEXTAREA",{maxlength:!0,placeholder:!0,class:!0}),A(e).forEach(u),this.h()},h(){a(e,"maxlength","2000"),a(e,"placeholder",r[1]),a(e,"class","svelte-kqfcqt")},m(l,s){k(l,e,s),He(e,r[0]),n||(t=[de(e,"blur",r[3]),de(e,"input",r[4]),de(e,"keydown",r[6]),de(e,"input",r[7])],n=!0)},p(l,[s]){s&2&&a(e,"placeholder",l[1]),s&1&&He(e,l[0])},i:h,o:h,d(l){l&&u(e),n=!1,De(t)}}}function wn(r,e,n){const t=oe(Ce),l=oe(Ut);let{placeholder:s=void 0}=e,{value:i=""}=e,{sendTypingEvents:c}=e;const o=Vt();function f(){c&&t.websocket.send({type:"EndTyping",channel:l._id})}function p(){if(c){if(i==""){t.websocket.send({type:"EndTyping",channel:l._id});return}t.websocket.send({type:"BeginTyping",channel:l._id})}}const d=g=>{var D;o("keydown",g),!(g.shiftKey||g.key!="Enter")&&(g.preventDefault(),(D=g.currentTarget.form)==null||D.requestSubmit())};function _(){i=this.value,n(0,i)}return r.$$set=g=>{"placeholder"in g&&n(1,s=g.placeholder),"value"in g&&n(0,i=g.value),"sendTypingEvents"in g&&n(5,c=g.sendTypingEvents)},[i,s,o,f,p,c,d,_]}class Nt extends ke{constructor(e){super(),be(this,e,wn,vn,ge,{placeholder:1,value:0,sendTypingEvents:5})}}function nt(r,e,n){const t=r.slice();return t[26]=e[n],t}function rt(r,e,n){const t=r.slice();return t[29]=e[n],t}function it(r,e,n){const t=r.slice();return t[32]=e[n].src,t[33]=e[n].name,t[34]=e[n].onclick,t[35]=e[n].showIf,t}function Oe(r){const e=r.slice(),n=new Date(e[0].edited);return e[8]=n,e}function $n(r){const e=r.slice(),n=we(e[1],e[2],e[0]);return e[38]=n,e}function st(r,e,n){const t=r.slice();return t[39]=e[n],t}function ot(r){let e,n,t=pe(r[0].replies),l=[];for(let i=0;i<t.length;i+=1)l[i]=ct(st(r,t,i));const s=i=>y(l[i],1,1,()=>{l[i]=null});return{c(){e=M("div");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){e=C(i,"DIV",{class:!0});var c=A(e);for(let o=0;o<l.length;o+=1)l[o].l(c);c.forEach(u),this.h()},h(){a(e,"class","reply-base svelte-1f6fxpx")},m(i,c){k(i,e,c);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null);n=!0},p(i,c){if(c[0]&1){t=pe(i[0].replies);let o;for(o=0;o<t.length;o+=1){const f=st(i,t,o);l[o]?(l[o].p(f,c),v(l[o],1)):(l[o]=ct(f),l[o].c(),v(l[o],1),l[o].m(e,null))}for(J(),o=t.length;o<l.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<t.length;c+=1)v(l[c]);n=!0}},o(i){l=l.filter(Boolean);for(let c=0;c<l.length;c+=1)y(l[c]);n=!1},d(i){i&&u(e),Ie(l,i)}}}function ct(r){let e,n;return e=new cl({props:{id:r[39]}}),{c(){re(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,l){ie(e,t,l),n=!0},p(t,l){const s={};l[0]&1&&(s.id=t[39]),e.$set(s)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){se(e,t)}}}function ft(r){let e,n,t,l;const s=[En,yn],i=[];function c(f,p){return f[5]["jolt:low-data-mode"]||f[1]==null?0:1}function o(f,p){return p===1?$n(f):f}return e=c(r),n=i[e]=s[e](o(r,e)),{c(){n.c(),t=K()},l(f){n.l(f),t=K()},m(f,p){i[e].m(f,p),k(f,t,p),l=!0},p(f,p){let d=e;e=c(f),e===d?i[e].p(o(f,e),p):(J(),y(i[d],1,1,()=>{i[d]=null}),Z(),n=i[e],n?n.p(o(f,e),p):(n=i[e]=s[e](o(f,e)),n.c()),v(n,1),n.m(t.parentNode,t))},i(f){l||(v(n),l=!0)},o(f){y(n),l=!1},d(f){f&&u(t),i[e].d(f)}}}function yn(r){let e,n,t,l;const s=[Mn,In],i=[];function c(o,f){return o[38]==null?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),t=K()},l(o){n.l(o),t=K()},m(o,f){i[e].m(o,f),k(o,t,f),l=!0},p(o,f){let p=e;e=c(o),e===p?i[e].p(o,f):(J(),y(i[p],1,1,()=>{i[p]=null}),Z(),n=i[e],n?n.p(o,f):(n=i[e]=s[e](o),n.c()),v(n,1),n.m(t.parentNode,t))},i(o){l||(v(n),l=!0)},o(o){y(n),l=!1},d(o){o&&u(t),i[e].d(o)}}}function En(r){let e,n;return e=new Ae({}),{c(){re(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,l){ie(e,t,l),n=!0},p:h,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){se(e,t)}}}function In(r){let e,n;return{c(){e=M("img"),this.h()},l(t){e=C(t,"IMG",{class:!0,alt:!0,src:!0,width:!0,height:!0}),this.h()},h(){a(e,"class","cover"),a(e,"alt",r[4]),x(e.src,n=r[38])||a(e,"src",n),a(e,"width","40px"),a(e,"height","40px")},m(t,l){k(t,e,l)},p(t,l){l[0]&16&&a(e,"alt",t[4]),l[0]&7&&!x(e.src,n=t[38])&&a(e,"src",n)},i:h,o:h,d(t){t&&u(e)}}}function Mn(r){let e,n;return e=new Ae({}),{c(){re(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,l){ie(e,t,l),n=!0},p:h,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){se(e,t)}}}function at(r){let e,n=r[6](r[8])+"",t,l,s=r[7](r[8])+"",i,c;return{c(){e=T(`[edited
				`),t=T(n),l=V(),i=T(s),c=T("]")},l(o){e=N(o,`[edited
				`),t=N(o,n),l=L(o),i=N(o,s),c=N(o,"]")},m(o,f){k(o,e,f),k(o,t,f),k(o,l,f),k(o,i,f),k(o,c,f)},p(o,f){f[0]&65&&n!==(n=o[6](o[8])+"")&&Q(t,n),f[0]&129&&s!==(s=o[7](o[8])+"")&&Q(i,s)},d(o){o&&(u(e),u(t),u(l),u(i),u(c))}}}function ut(r){let e,n,t,l,s,i,c;const o=[Un,Cn],f=[];function p(_,g){return typeof _[32]=="string"?0:1}n=p(r),t=f[n]=o[n](r);function d(){return r[18](r[34])}return{c(){e=M("button"),t.c(),l=V(),this.h()},l(_){e=C(_,"BUTTON",{"aria-label":!0,class:!0});var g=A(e);t.l(g),l=L(g),g.forEach(u),this.h()},h(){a(e,"aria-label",r[33]),a(e,"class","svelte-1f6fxpx")},m(_,g){k(_,e,g),f[n].m(e,null),w(e,l),s=!0,i||(c=[de(e,"click",d),Lt(Wt.call(null,e,{placement:"top",content:r[33],theme:"message-controls",animation:"shift-away-subtle",duration:100}))],i=!0)},p(_,g){r=_,t.p(r,g)},i(_){s||(v(t),s=!0)},o(_){y(t),s=!1},d(_){_&&u(e),f[n].d(),i=!1,De(c)}}}function Cn(r){let e,n,t;var l=r[32];function s(i){return{}}return l&&(e=ze(l,s())),{c(){e&&re(e.$$.fragment),n=K()},l(i){e&&ce(e.$$.fragment,i),n=K()},m(i,c){e&&ie(e,i,c),k(i,n,c),t=!0},p(i,c){if(l!==(l=i[32])){if(e){J();const o=e;y(o.$$.fragment,1,0,()=>{se(o,1)}),Z()}l?(e=ze(l,s()),re(e.$$.fragment),v(e.$$.fragment,1),ie(e,n.parentNode,n)):e=null}},i(i){t||(e&&v(e.$$.fragment,i),t=!0)},o(i){e&&y(e.$$.fragment,i),t=!1},d(i){i&&u(n),e&&se(e,i)}}}function Un(r){let e,n;return{c(){e=M("img"),this.h()},l(t){e=C(t,"IMG",{width:!0,height:!0,src:!0,alt:!0}),this.h()},h(){a(e,"width","16px"),a(e,"height","16px"),x(e.src,n=r[32])||a(e,"src",n),a(e,"alt",r[33])},m(t,l){k(t,e,l)},p:h,i:h,o:h,d(t){t&&u(e)}}}function _t(r){var s;let e=((s=r[35])==null?void 0:s.call(r,r[0]))??!0,n,t,l=e&&ut(r);return{c(){l&&l.c(),n=K()},l(i){l&&l.l(i),n=K()},m(i,c){l&&l.m(i,c),k(i,n,c),t=!0},p(i,c){var o;c[0]&1&&(e=((o=i[35])==null?void 0:o.call(i,i[0]))??!0),e?l?(l.p(i,c),c[0]&1&&v(l,1)):(l=ut(i),l.c(),v(l,1),l.m(n.parentNode,n)):l&&(J(),y(l,1,1,()=>{l=null}),Z())},i(i){t||(v(l),t=!0)},o(i){y(l),t=!1},d(i){i&&u(n),l&&l.d(i)}}}function Tn(r){let e,n=r[0].content+"",t;return{c(){e=M("span"),t=T(n),this.h()},l(l){e=C(l,"SPAN",{style:!0,class:!0});var s=A(e);t=N(s,n),s.forEach(u),this.h()},h(){Se(e,"overflow-wrap","break-word"),a(e,"class","whitespace-pre-wrap")},m(l,s){k(l,e,s),w(e,t)},p(l,s){s[0]&1&&n!==(n=l[0].content+"")&&Q(t,n)},i:h,o:h,d(l){l&&u(e)}}}function Nn(r){let e,n,t,l,s,i;function c(f){r[19](f)}let o={placeholder:"Edit this message",sendTypingEvents:!1};return r[3]!==void 0&&(o.value=r[3]),n=new Nt({props:o}),Me.push(()=>qe(n,"value",c)),n.$on("keydown",r[20]),{c(){e=M("form"),re(n.$$.fragment),this.h()},l(f){e=C(f,"FORM",{style:!0,id:!0,class:!0});var p=A(e);ce(n.$$.fragment,p),p.forEach(u),this.h()},h(){Se(e,"padding-left","8px"),a(e,"id","message-edit-form"),a(e,"class","message-form")},m(f,p){k(f,e,p),ie(n,e,null),l=!0,s||(i=de(e,"submit",r[15]),s=!0)},p(f,p){const d={};!t&&p[0]&8&&(t=!0,d.value=f[3],Le(()=>t=!1)),n.$set(d)},i(f){l||(v(n.$$.fragment,f),l=!0)},o(f){y(n.$$.fragment,f),l=!1},d(f){f&&u(e),se(n),s=!1,i()}}}function ht(r){let e,n;return e=new Rl({props:{system:r[0].system}}),{c(){re(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,l){ie(e,t,l),n=!0},p(t,l){const s={};l[0]&1&&(s.system=t[0].system),e.$set(s)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){se(e,t)}}}function mt(r){let e,n,t=pe(r[0].attachments),l=[];for(let i=0;i<t.length;i+=1)l[i]=dt(rt(r,t,i));const s=i=>y(l[i],1,1,()=>{l[i]=null});return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=K()},l(i){for(let c=0;c<l.length;c+=1)l[c].l(i);e=K()},m(i,c){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(i,c);k(i,e,c),n=!0},p(i,c){if(c[0]&1){t=pe(i[0].attachments);let o;for(o=0;o<t.length;o+=1){const f=rt(i,t,o);l[o]?(l[o].p(f,c),v(l[o],1)):(l[o]=dt(f),l[o].c(),v(l[o],1),l[o].m(e.parentNode,e))}for(J(),o=t.length;o<l.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<t.length;c+=1)v(l[c]);n=!0}},o(i){l=l.filter(Boolean);for(let c=0;c<l.length;c+=1)y(l[c]);n=!1},d(i){i&&u(e),Ie(l,i)}}}function dt(r){let e,n;return e=new _n({props:{attachment:r[29]}}),{c(){re(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,l){ie(e,t,l),n=!0},p(t,l){const s={};l[0]&1&&(s.attachment=t[29]),e.$set(s)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){se(e,t)}}}function pt(r){let e,n,t=pe(r[0].embeds),l=[];for(let i=0;i<t.length;i+=1)l[i]=gt(nt(r,t,i));const s=i=>y(l[i],1,1,()=>{l[i]=null});return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=K()},l(i){for(let c=0;c<l.length;c+=1)l[c].l(i);e=K()},m(i,c){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(i,c);k(i,e,c),n=!0},p(i,c){if(c[0]&1){t=pe(i[0].embeds);let o;for(o=0;o<t.length;o+=1){const f=nt(i,t,o);l[o]?(l[o].p(f,c),v(l[o],1)):(l[o]=gt(f),l[o].c(),v(l[o],1),l[o].m(e.parentNode,e))}for(J(),o=t.length;o<l.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<t.length;c+=1)v(l[c]);n=!0}},o(i){l=l.filter(Boolean);for(let c=0;c<l.length;c+=1)y(l[c]);n=!1},d(i){i&&u(e),Ie(l,i)}}}function gt(r){let e,n;return e=new bn({props:{embed:r[26]}}),{c(){re(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,l){ie(e,t,l),n=!0},p(t,l){const s={};l[0]&1&&(s.embed=t[26]),e.$set(s)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){se(e,t)}}}function Sn(r){let e,n,t,l,s,i,c,o,f=r[6](r[8])+"",p,d,_=r[7](r[8])+"",g,D,R,I,B,H,P,z,O,W,G,_e,ee,F,E=r[0].replies!=null&&r[0].replies.length!=0&&ot(r),S=!r[5]["jolt:compact-mode"]&&ft(r),b=r[0].edited!=null&&at(Oe(r)),m=pe(r[14]),$=[];for(let j=0;j<m.length;j+=1)$[j]=_t(it(r,m,j));const X=j=>y($[j],1,1,()=>{$[j]=null}),U=[Nn,Tn],Y=[];function ae(j,q){return j[3]!=null?0:j[0].content!=null?1:-1}~(z=ae(r))&&(O=Y[z]=U[z](r));let te=r[0].system!=null&&ht(r),le=r[0].attachments!=null&&mt(r),fe=r[0].embeds!=null&&pt(r);return{c(){e=M("div"),E&&E.c(),n=V(),t=M("div"),S&&S.c(),l=V(),s=T(r[4]),i=V(),c=M("p"),o=T("["),p=T(f),d=V(),g=T(_),D=T(`]

			`),b&&b.c(),R=V(),I=M("div"),B=V(),H=M("div");for(let j=0;j<$.length;j+=1)$[j].c();P=V(),O&&O.c(),W=V(),te&&te.c(),G=V(),le&&le.c(),_e=V(),fe&&fe.c(),this.h()},l(j){e=C(j,"DIV",{id:!0,class:!0});var q=A(e);E&&E.l(q),n=L(q),t=C(q,"DIV",{class:!0});var ue=A(t);S&&S.l(ue),l=L(ue),s=N(ue,r[4]),i=L(ue),c=C(ue,"P",{class:!0});var ne=A(c);o=N(ne,"["),p=N(ne,f),d=L(ne),g=N(ne,_),D=N(ne,`]

			`),b&&b.l(ne),ne.forEach(u),R=L(ue),I=C(ue,"DIV",{class:!0}),A(I).forEach(u),B=L(ue),H=C(ue,"DIV",{class:!0});var Ue=A(H);for(let Be=0;Be<$.length;Be+=1)$[Be].l(Ue);Ue.forEach(u),ue.forEach(u),P=L(q),O&&O.l(q),W=L(q),te&&te.l(q),G=L(q),le&&le.l(q),_e=L(q),fe&&fe.l(q),q.forEach(u),this.h()},h(){a(c,"class","timestamp svelte-1f6fxpx"),a(I,"class","flex-divider"),a(H,"class","message-controls svelte-1f6fxpx"),a(t,"class","user-detail svelte-1f6fxpx"),a(e,"id",ee=r[0]._id),a(e,"class","container svelte-1f6fxpx")},m(j,q){k(j,e,q),E&&E.m(e,null),w(e,n),w(e,t),S&&S.m(t,null),w(t,l),w(t,s),w(t,i),w(t,c),w(c,o),w(c,p),w(c,d),w(c,g),w(c,D),b&&b.m(c,null),w(t,R),w(t,I),w(t,B),w(t,H);for(let ue=0;ue<$.length;ue+=1)$[ue]&&$[ue].m(H,null);w(e,P),~z&&Y[z].m(e,null),w(e,W),te&&te.m(e,null),w(e,G),le&&le.m(e,null),w(e,_e),fe&&fe.m(e,null),F=!0},p(j,q){if(j[0].replies!=null&&j[0].replies.length!=0?E?(E.p(j,q),q[0]&1&&v(E,1)):(E=ot(j),E.c(),v(E,1),E.m(e,n)):E&&(J(),y(E,1,1,()=>{E=null}),Z()),j[5]["jolt:compact-mode"]?S&&(J(),y(S,1,1,()=>{S=null}),Z()):S?(S.p(j,q),q[0]&32&&v(S,1)):(S=ft(j),S.c(),v(S,1),S.m(t,l)),(!F||q[0]&16)&&Q(s,j[4]),(!F||q[0]&320)&&f!==(f=j[6](j[8])+"")&&Q(p,f),(!F||q[0]&384)&&_!==(_=j[7](j[8])+"")&&Q(g,_),j[0].edited!=null?b?b.p(Oe(j),q):(b=at(Oe(j)),b.c(),b.m(c,null)):b&&(b.d(1),b=null),q[0]&16385){m=pe(j[14]);let ne;for(ne=0;ne<m.length;ne+=1){const Ue=it(j,m,ne);$[ne]?($[ne].p(Ue,q),v($[ne],1)):($[ne]=_t(Ue),$[ne].c(),v($[ne],1),$[ne].m(H,null))}for(J(),ne=m.length;ne<$.length;ne+=1)X(ne);Z()}let ue=z;z=ae(j),z===ue?~z&&Y[z].p(j,q):(O&&(J(),y(Y[ue],1,1,()=>{Y[ue]=null}),Z()),~z?(O=Y[z],O?O.p(j,q):(O=Y[z]=U[z](j),O.c()),v(O,1),O.m(e,W)):O=null),j[0].system!=null?te?(te.p(j,q),q[0]&1&&v(te,1)):(te=ht(j),te.c(),v(te,1),te.m(e,G)):te&&(J(),y(te,1,1,()=>{te=null}),Z()),j[0].attachments!=null?le?(le.p(j,q),q[0]&1&&v(le,1)):(le=mt(j),le.c(),v(le,1),le.m(e,_e)):le&&(J(),y(le,1,1,()=>{le=null}),Z()),j[0].embeds!=null?fe?(fe.p(j,q),q[0]&1&&v(fe,1)):(fe=pt(j),fe.c(),v(fe,1),fe.m(e,null)):fe&&(J(),y(fe,1,1,()=>{fe=null}),Z()),(!F||q[0]&1&&ee!==(ee=j[0]._id))&&a(e,"id",ee)},i(j){if(!F){v(E),v(S);for(let q=0;q<m.length;q+=1)v($[q]);v(O),v(te),v(le),v(fe),F=!0}},o(j){y(E),y(S),$=$.filter(Boolean);for(let q=0;q<$.length;q+=1)y($[q]);y(O),y(te),y(le),y(fe),F=!1},d(j){j&&u(e),E&&E.d(),S&&S.d(),b&&b.d(),Ie($,j),~z&&Y[z].d(),te&&te.d(),le&&le.d(),fe&&fe.d()}}}function Dn(r,e,n){let t,l,s,i,c,o,f,p,d;me(r,Ht,b=>n(6,p=b)),me(r,zt,b=>n(7,d=b));let{message:_}=e,g,D,R,I=oe(je);me(r,I,b=>n(5,f=b));let B=oe(Ce),H=oe(Ct);me(r,H,b=>n(16,s=b));let P=oe(Re),z=oe(Fe);me(r,z,b=>n(17,i=b));let O=oe(Tt);me(r,O,b=>n(21,c=b));let W=oe(Ge);me(r,W,b=>n(22,o=b));const G=[{src:_l,name:"Reply",onclick(){o!=null&&o.some(b=>b.message._id==_._id)||W==null||W.update(b=>(b.push({message:_,mention:!0}),b))}},{src:Qt,name:"Edit",showIf:b=>{var m;return b.author==((m=B.user)==null?void 0:m._id)},onclick:b=>n(3,g=g==null?b.content??"":void 0)},{src:al,name:"Delete",showIf:b=>{var m;return b.author==((m=B.user)==null?void 0:m._id)},onclick:b=>B.api.deleteMessage(b.channel,b._id)}];async function _e(b,m){n(2,R=c==null?void 0:c.find($=>$._id.server==b&&$._id.user==m))}async function ee(){const b=await B.api.editMessage(_.channel,_._id,{content:g});P==null||P.update(m=>(m[m.findIndex($=>$._id==_._id)]=b,m))}const F=b=>b(_);function E(b){g=b,n(3,g)}const S=b=>{console.log(b),b.detail.key=="Escape"&&n(3,g=void 0)};return r.$$set=b=>{"message"in b&&n(0,_=b.message)},r.$$.update=()=>{r.$$.dirty[0]&131073&&Ve(B.api,i??B.api.cache.users,_.author).then(b=>n(1,D=b)),r.$$.dirty[0]&65537&&(s==null||_e(s,_.author)),r.$$.dirty[0]&7&&n(4,t=ve(D,R,_)),r.$$.dirty[0]&1&&n(8,l=Xt(_._id))},[_,D,R,g,t,f,p,d,l,I,H,z,O,W,G,ee,s,i,F,E,S]}class jn extends ke{constructor(e){super(),be(this,e,Dn,Sn,ge,{message:0},null,[-1,-1])}}function An(r){let e,n;return{c(){e=ye("svg"),n=ye("path"),this.h()},l(t){e=Ee(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var l=A(e);n=Ee(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),A(n).forEach(u),l.forEach(u),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"stroke-linejoin","round"),a(n,"d","M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(t,l){k(t,e,l),w(e,n)},p:h,i:h,o:h,d(t){t&&u(e)}}}class St extends ke{constructor(e){super(),be(this,e,null,An,ge,{})}}function Pn(r){let e,n;return{c(){e=ye("svg"),n=ye("path"),this.h()},l(t){e=Ee(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var l=A(e);n=Ee(l,"path",{"stroke-linecap":!0,d:!0}),A(n).forEach(u),l.forEach(u),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"d","M16.5 12a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(t,l){k(t,e,l),w(e,n)},p:h,i:h,o:h,d(t){t&&u(e)}}}class Bn extends ke{constructor(e){super(),be(this,e,null,Pn,ge,{})}}function kt(r){const e=ve(r[5]);r[6]=e}function On(r){let e,n,t;return e=new Ae({}),{c(){re(e.$$.fragment),n=T(`
				<UnknownUser>`)},l(l){ce(e.$$.fragment,l),n=N(l,`
				<UnknownUser>`)},m(l,s){ie(e,l,s),k(l,n,s),t=!0},p:h,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){l&&u(n),se(e,l)}}}function Vn(r){kt(r);let e,n,t,l,s=r[6]+"",i;return{c(){e=M("img"),l=V(),i=T(s),this.h()},l(c){e=C(c,"IMG",{class:!0,src:!0,alt:!0}),l=L(c),i=N(c,s),this.h()},h(){a(e,"class","cover svelte-38n0js"),x(e.src,n=we(r[5]))||a(e,"src",n),a(e,"alt",t=r[6])},m(c,o){k(c,e,o),k(c,l,o),k(c,i,o)},p(c,o){kt(c),o&1&&!x(e.src,n=we(c[5]))&&a(e,"src",n),o&1&&t!==(t=c[6])&&a(e,"alt",t),o&1&&s!==(s=c[6]+"")&&Q(i,s)},i:h,o:h,d(c){c&&(u(e),u(l),u(i))}}}function Ln(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function qn(r){let e,n,t,l,s,i,c,o=r[0].message.content+"",f,p,d,_,g,D,R,I,B,H,P=r[0].mention?"ON":"OFF",z,O,W,G,_e,ee,F,E,S={ctx:r,current:null,token:null,hasCatch:!0,pending:Ln,then:Vn,catch:On,value:5,blocks:[,,,]};return he(s=r[2].api.fetchUser(r[0].message.author),S),B=new Bn({}),_e=new St({}),{c(){e=M("div"),n=M("p"),t=T(`replying to
		`),l=M("strong"),S.block.c(),i=V(),c=M("p"),f=T(o),p=V(),d=M("div"),_=V(),g=M("div"),D=M("input"),R=V(),I=M("label"),re(B.$$.fragment),H=V(),z=T(P),O=V(),W=M("div"),G=M("button"),re(_e.$$.fragment),this.h()},l(b){e=C(b,"DIV",{class:!0});var m=A(e);n=C(m,"P",{});var $=A(n);t=N($,`replying to
		`),l=C($,"STRONG",{});var X=A(l);S.block.l(X),X.forEach(u),$.forEach(u),i=L(m),c=C(m,"P",{class:!0});var U=A(c);f=N(U,o),U.forEach(u),p=L(m),d=C(m,"DIV",{class:!0}),A(d).forEach(u),_=L(m),g=C(m,"DIV",{});var Y=A(g);D=C(Y,"INPUT",{id:!0,style:!0,type:!0}),R=L(Y),I=C(Y,"LABEL",{class:!0,for:!0});var ae=A(I);ce(B.$$.fragment,ae),H=L(ae),z=N(ae,P),ae.forEach(u),Y.forEach(u),O=L(m),W=C(m,"DIV",{});var te=A(W);G=C(te,"BUTTON",{});var le=A(G);ce(_e.$$.fragment,le),le.forEach(u),te.forEach(u),m.forEach(u),this.h()},h(){a(c,"class","message-content svelte-38n0js"),a(d,"class","flex-divider"),a(D,"id","mention"),Se(D,"display","none"),a(D,"type","checkbox"),a(I,"class","mention-button svelte-38n0js"),a(I,"for","mention"),a(e,"class","container svelte-38n0js")},m(b,m){k(b,e,m),w(e,n),w(n,t),w(n,l),S.block.m(l,S.anchor=null),S.mount=()=>l,S.anchor=null,w(e,i),w(e,c),w(c,f),w(e,p),w(e,d),w(e,_),w(e,g),w(g,D),D.checked=r[0].mention,w(g,R),w(g,I),ie(B,I,null),w(I,H),w(I,z),w(e,O),w(e,W),w(W,G),ie(_e,G,null),ee=!0,F||(E=[de(D,"change",r[3]),de(G,"click",r[4])],F=!0)},p(b,[m]){r=b,S.ctx=r,m&1&&s!==(s=r[2].api.fetchUser(r[0].message.author))&&he(s,S)||$e(S,r,m),(!ee||m&1)&&o!==(o=r[0].message.content+"")&&Q(f,o),m&1&&(D.checked=r[0].mention),(!ee||m&1)&&P!==(P=r[0].mention?"ON":"OFF")&&Q(z,P)},i(b){ee||(v(S.block),v(B.$$.fragment,b),v(_e.$$.fragment,b),ee=!0)},o(b){for(let m=0;m<3;m+=1){const $=S.blocks[m];y($)}y(B.$$.fragment,b),y(_e.$$.fragment,b),ee=!1},d(b){b&&u(e),S.block.d(),S.token=null,S=null,se(B),se(_e),F=!1,De(E)}}}function Rn(r,e,n){let{reply:t}=e;const l=oe(Ce),s=oe(Ge);function i(){t.mention=this.checked,n(0,t)}const c=()=>s.update(o=>(o=o.filter(f=>f.message._id!=t.message._id),o));return r.$$set=o=>{"reply"in o&&n(0,t=o.reply)},[t,s,l,i,c]}class Fn extends ke{constructor(e){super(),be(this,e,Rn,qn,ge,{reply:0})}}function bt(r,e,n){const t=r.slice();return t[24]=e[n],t}function vt(r,e,n){const t=r.slice();t[27]=e[n];const l=ve(t[27]);return t[28]=l,t}function wt(r,e,n){const t=r.slice();return t[31]=e[n],t}function $t(r){let e,n;return e=new jn({props:{message:r[31]}}),{c(){re(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,l){ie(e,t,l),n=!0},p(t,l){const s={};l[0]&256&&(s.message=t[31]),e.$set(s)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){se(e,t)}}}function yt(r){let e,n,t,l=Array.from(r[5]).map(Mt).join(", ")+"",s,i,c,o,f,p,d,_,g;return p=new St({}),{c(){e=M("div"),n=M("p"),t=T(`Uploading
				`),s=T(l),i=V(),c=M("div"),o=V(),f=M("button"),re(p.$$.fragment),this.h()},l(D){e=C(D,"DIV",{class:!0});var R=A(e);n=C(R,"P",{});var I=A(n);t=N(I,`Uploading
				`),s=N(I,l),I.forEach(u),i=L(R),c=C(R,"DIV",{class:!0}),A(c).forEach(u),o=L(R),f=C(R,"BUTTON",{});var B=A(f);ce(p.$$.fragment,B),B.forEach(u),R.forEach(u),this.h()},h(){a(c,"class","flex-divider"),a(e,"class","file-uploads svelte-1swq2l3")},m(D,R){k(D,e,R),w(e,n),w(n,t),w(n,s),w(e,i),w(e,c),w(e,o),w(e,f),ie(p,f,null),d=!0,_||(g=de(f,"click",r[15]),_=!0)},p(D,R){(!d||R[0]&32)&&l!==(l=Array.from(D[5]).map(Mt).join(", ")+"")&&Q(s,l)},i(D){d||(v(p.$$.fragment,D),d=!0)},o(D){y(p.$$.fragment,D),d=!1},d(D){D&&u(e),se(p),_=!1,g()}}}function Gn(r){let e,n,t;return{c(){e=M("img"),this.h()},l(l){e=C(l,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),this.h()},h(){a(e,"class","cover"),x(e.src,n=we(r[27]))||a(e,"src",n),a(e,"width","16px"),a(e,"height","16px"),a(e,"alt",t=r[28])},m(l,s){k(l,e,s)},p(l,s){s[0]&8&&!x(e.src,n=we(l[27]))&&a(e,"src",n),s[0]&8&&t!==(t=l[28])&&a(e,"alt",t)},i:h,o:h,d(l){l&&u(e)}}}function Kn(r){let e,n;return e=new Ae({}),{c(){re(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,l){ie(e,t,l),n=!0},p:h,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){se(e,t)}}}function Et(r){let e,n,t,l,s=r[28]+"",i,c,o;const f=[Kn,Gn],p=[];function d(_,g){return _[0]["jolt:low-data-mode"]?0:1}return n=d(r),t=p[n]=f[n](r),{c(){e=M("div"),t.c(),l=V(),i=T(s),c=T(" is typing..."),this.h()},l(_){e=C(_,"DIV",{class:!0});var g=A(e);t.l(g),l=L(g),i=N(g,s),c=N(g," is typing..."),g.forEach(u),this.h()},h(){a(e,"class","typing-indicator svelte-1swq2l3")},m(_,g){k(_,e,g),p[n].m(e,null),w(e,l),w(e,i),w(e,c),o=!0},p(_,g){let D=n;n=d(_),n===D?p[n].p(_,g):(J(),y(p[D],1,1,()=>{p[D]=null}),Z(),t=p[n],t?t.p(_,g):(t=p[n]=f[n](_),t.c()),v(t,1),t.m(e,l)),(!o||g[0]&8)&&s!==(s=_[28]+"")&&Q(i,s)},i(_){o||(v(t),o=!0)},o(_){y(t),o=!1},d(_){_&&u(e),p[n].d()}}}function It(r){let e,n;return e=new Fn({props:{reply:r[24]}}),{c(){re(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,l){ie(e,t,l),n=!0},p(t,l){const s={};l[0]&128&&(s.reply=t[24]),e.$set(s)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){se(e,t)}}}function Hn(r){let e,n,t,l,s,i,c,o,f,p,d,_,g,D,R,I,B,H=pe(r[8]),P=[];for(let m=0;m<H.length;m+=1)P[m]=$t(wt(r,H,m));const z=m=>y(P[m],1,1,()=>{P[m]=null});let O=r[5]!=null&&r[5].length!=0&&yt(r),W=pe(r[3]),G=[];for(let m=0;m<W.length;m+=1)G[m]=Et(vt(r,W,m));const _e=m=>y(G[m],1,1,()=>{G[m]=null});let ee=pe(r[7]),F=[];for(let m=0;m<ee.length;m+=1)F[m]=It(bt(r,ee,m));const E=m=>y(F[m],1,1,()=>{F[m]=null});f=new Yt({});function S(m){r[18](m)}let b={sendTypingEvents:r[0]["jolt:send-typing-indicators"],placeholder:"Send message in "+r[6]};return r[1]!==void 0&&(b.value=r[1]),g=new Nt({props:b}),Me.push(()=>qe(g,"value",S)),{c(){e=M("main"),n=M("div");for(let m=0;m<P.length;m+=1)P[m].c();t=V(),O&&O.c(),l=V();for(let m=0;m<G.length;m+=1)G[m].c();s=V();for(let m=0;m<F.length;m+=1)F[m].c();i=V(),c=M("form"),o=M("label"),re(f.$$.fragment),p=V(),d=M("input"),_=V(),re(g.$$.fragment),this.h()},l(m){e=C(m,"MAIN",{class:!0});var $=A(e);n=C($,"DIV",{class:!0});var X=A(n);for(let ae=0;ae<P.length;ae+=1)P[ae].l(X);X.forEach(u),t=L($),O&&O.l($),l=L($);for(let ae=0;ae<G.length;ae+=1)G[ae].l($);s=L($);for(let ae=0;ae<F.length;ae+=1)F[ae].l($);i=L($),c=C($,"FORM",{class:!0,id:!0});var U=A(c);o=C(U,"LABEL",{for:!0,class:!0});var Y=A(o);ce(f.$$.fragment,Y),Y.forEach(u),p=L(U),d=C(U,"INPUT",{type:!0,id:!0,max:!0,class:!0}),_=L(U),ce(g.$$.fragment,U),U.forEach(u),$.forEach(u),this.h()},h(){a(n,"class","messages-list svelte-1swq2l3"),a(o,"for","file-upload"),a(o,"class","svelte-1swq2l3"),a(d,"type","file"),a(d,"id","file-upload"),a(d,"max","5"),a(d,"class","svelte-1swq2l3"),a(c,"class","message-form"),a(c,"id","send-message-form"),a(e,"class","main-content-container svelte-1swq2l3")},m(m,$){k(m,e,$),w(e,n);for(let X=0;X<P.length;X+=1)P[X]&&P[X].m(n,null);r[14](n),w(e,t),O&&O.m(e,null),w(e,l);for(let X=0;X<G.length;X+=1)G[X]&&G[X].m(e,null);w(e,s);for(let X=0;X<F.length;X+=1)F[X]&&F[X].m(e,null);w(e,i),w(e,c),w(c,o),ie(f,o,null),w(c,p),w(c,d),r[17](d),w(c,_),ie(g,c,null),R=!0,I||(B=[de(d,"change",r[16]),de(c,"submit",r[12])],I=!0)},p(m,$){if($[0]&256){H=pe(m[8]);let U;for(U=0;U<H.length;U+=1){const Y=wt(m,H,U);P[U]?(P[U].p(Y,$),v(P[U],1)):(P[U]=$t(Y),P[U].c(),v(P[U],1),P[U].m(n,null))}for(J(),U=H.length;U<P.length;U+=1)z(U);Z()}if(m[5]!=null&&m[5].length!=0?O?(O.p(m,$),$[0]&32&&v(O,1)):(O=yt(m),O.c(),v(O,1),O.m(e,l)):O&&(J(),y(O,1,1,()=>{O=null}),Z()),$[0]&9){W=pe(m[3]);let U;for(U=0;U<W.length;U+=1){const Y=vt(m,W,U);G[U]?(G[U].p(Y,$),v(G[U],1)):(G[U]=Et(Y),G[U].c(),v(G[U],1),G[U].m(e,s))}for(J(),U=W.length;U<G.length;U+=1)_e(U);Z()}if($[0]&128){ee=pe(m[7]);let U;for(U=0;U<ee.length;U+=1){const Y=bt(m,ee,U);F[U]?(F[U].p(Y,$),v(F[U],1)):(F[U]=It(Y),F[U].c(),v(F[U],1),F[U].m(e,i))}for(J(),U=ee.length;U<F.length;U+=1)E(U);Z()}const X={};$[0]&1&&(X.sendTypingEvents=m[0]["jolt:send-typing-indicators"]),$[0]&64&&(X.placeholder="Send message in "+m[6]),!D&&$[0]&2&&(D=!0,X.value=m[1],Le(()=>D=!1)),g.$set(X)},i(m){if(!R){for(let $=0;$<H.length;$+=1)v(P[$]);v(O);for(let $=0;$<W.length;$+=1)v(G[$]);for(let $=0;$<ee.length;$+=1)v(F[$]);v(f.$$.fragment,m),v(g.$$.fragment,m),R=!0}},o(m){P=P.filter(Boolean);for(let $=0;$<P.length;$+=1)y(P[$]);y(O),G=G.filter(Boolean);for(let $=0;$<G.length;$+=1)y(G[$]);F=F.filter(Boolean);for(let $=0;$<F.length;$+=1)y(F[$]);y(f.$$.fragment,m),y(g.$$.fragment,m),R=!1},d(m){m&&u(e),Ie(P,m),r[14](null),O&&O.d(),Ie(G,m),Ie(F,m),se(f),r[17](null),se(g),I=!1,De(B)}}}const Mt=r=>r.name;function zn(r,e,n){let t,l,s,{channel:i}=e;const c=oe(je);me(r,c,E=>n(0,l=E));const o=oe(Ce),f=Pe([]);me(r,f,E=>n(8,s=E));const p=Pe([]),d=Pe([]),_=Pe([]);me(r,_,E=>n(7,t=E)),Te(Re,f),Te(Tt,p),Te(Fe,d),Te(Ge,_),Te(Ut,i);let g,D,R=[],I,B,H="Unknown Channel";qt(()=>{D&&D.offsetHeight+D.scrollTop>D.scrollHeight-20&&Ft().then(()=>{D.scrollTo(0,D.scrollHeight)})});async function P(E){if(!E){o.removeAllListeners("ChannelStartTyping"),o.removeAllListeners("ChannelStopTyping");return}o.on("ChannelStartTyping",async({id:S,user:b})=>{var m;if(!(b==((m=o.user)==null?void 0:m._id)||S!=i._id)){for(const{_id:$}of R)if(b==$)return;n(3,R[R.length]=await o.api.fetchUser(b),R)}}),o.on("ChannelStopTyping",({id:S,user:b})=>{S==i._id&&n(3,R=R.filter(m=>m._id!=b))})}async function z(){let E=[];(I==null?void 0:I.files)!=null&&(E=await Promise.all(Array.from(I.files).map(S=>o.autumn.uploadFile(S))),n(4,I.value="",I),n(5,B=null)),await o.api.sendMessage(i._id,{content:g.trim(),replies:t.map(({message:{_id:S},mention:b})=>({id:S,mention:b})),attachments:E}),_.set([]),n(1,g="")}Rt(()=>{o.on("Message",E=>{E.channel==i._id&&(o.api.ackMessage(i._id,E._id),f.update(S=>(S.push(E),S)))}),o.on("MessageDelete",({id:E,channel:S})=>{S==i._id&&f.update(b=>b.filter(m=>m._id!=E))}),o.on("MessageUpdate",({id:E,channel:S,data:b})=>{S==i._id&&f.update(m=>{const $=m.findIndex(U=>U._id==E),X=m[$];return b.content!=null&&(X.content=b.content),b.embeds!=null&&(X.embeds=b.embeds),X.edited=b.edited,m[$]=X,m})})});async function O(E){var S;if(E.channel_type=="TextChannel"||E.channel_type=="Group"){n(6,H=`#${E.name}`);return}if(E.channel_type=="SavedMessages"){n(6,H="Saved Notes");return}try{n(6,H=`@${ve(await o.api.fetchUser(E.recipients[0]==((S=o.user)==null?void 0:S._id)?E.recipients[1]:E.recipients[0]))}`)}catch{n(6,H="Unknown Channel")}}function W(E){Me[E?"unshift":"push"](()=>{D=E,n(2,D)})}const G=()=>{I!=null&&(n(4,I.value="",I),n(5,B=null))};function _e(){B=this.files,n(5,B)}function ee(E){Me[E?"unshift":"push"](()=>{I=E,n(4,I)})}function F(E){g=E,n(1,g)}return r.$$set=E=>{"channel"in E&&n(13,i=E.channel)},r.$$.update=()=>{r.$$.dirty[0]&8192&&(o.api.queryMessages(i._id,{sort:"Latest",include_users:!0}).then(E=>{Array.isArray(E)?f.set(E.reverse()):(f.set(E.messages.reverse()),d.set(E.users),p.set(E.members??[]))}),_.set([]),n(3,R=[])),r.$$.dirty[0]&1&&P(l["jolt:receive-typing-indicators"]),r.$$.dirty[0]&8192&&O(i)},[l,g,D,R,I,B,H,t,s,c,f,_,z,i,W,G,_e,ee,F]}class or extends ke{constructor(e){super(),be(this,e,zn,Hn,ge,{channel:13},null,[-1,-1])}}export{or as T};
