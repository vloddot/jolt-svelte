import{s as _e,f as C,g as I,h as q,d as f,j as _,i as g,r as ce,e as R,u as h,a as L,c as G,l as S,m as A,z as v,n as Q,I as W,v as Nt,J as ke,A as fe,w as Tt,x as St,y as At,D as Ae,M as Dt,p as ve,N as jt,O as Oe,k as Ne,P as Re,Q as Pt,G as ye,B as Ot,C as Vt,H as qt,E as Te,F as Se,R as $e,o as Bt,K as Ft,t as Le}from"./scheduler.fede8105.js";import{h as re,u as ge}from"./await_block.ecc72e0a.js";import{e as ue}from"./each.e59479a4.js";import{S as he,i as me,a as k,g as Y,t as E,c as Z,b as ee,d as te,m as le,e as ne,f as Ve}from"./index.257844fa.js";import{g as x,c as we,a as Me}from"./context.682cab63.js";import{g as pe,b as ae,a as Rt}from"./util.883c3f21.js";import{w as Ue}from"./index.3ac45322.js";import{m as qe,u as Be,g as Pe,c as wt,a as $t,r as Et,n as Lt}from"./index.fdd37b7b.js";import{e as Ge}from"./singletons.1e1430be.js";import{a as Mt,s as Gt}from"./context.fa34f1f8.js";import{U as Ce}from"./UserIcon.19461969.js";import{d as De}from"./index.esm.4b6e8736.js";import{t as zt,P as Kt}from"./PlusIcon.3856cf8f.js";import{d as Ee,c as Ht}from"./calendar.5942d46b.js";import{p as Xt}from"./stores.70d07f98.js";function Jt(r){const e=r.slice(),n=ae(e[14]);return e[15]=n,e}function ze(r){var s;let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:ll,then:Wt,catch:Qt,value:13,blocks:[,,,]};return re(n=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),t),{c(){e=R(),t.block.c()},l(i){e=R(),t.block.l(i)},m(i,c){g(i,e,c),t.block.m(i,t.anchor=c),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(i,c){var o;r=i,t.ctx=r,c&13&&n!==(n=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&re(n,t)||ge(t,r,c)},i(i){l||(k(t.block),l=!0)},o(i){for(let c=0;c<3;c+=1){const o=t.blocks[c];E(o)}l=!1},d(i){i&&f(e),t.block.d(i),t.token=null,t=null}}}function Qt(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Wt(r){let e,n,l,t=!r[4]["jolt:low-data-mode"]&&Ke(r),s=r[13].content!=null&&He(r);return{c(){t&&t.c(),e=L(),s&&s.c(),n=R()},l(i){t&&t.l(i),e=G(i),s&&s.l(i),n=R()},m(i,c){t&&t.m(i,c),g(i,e,c),s&&s.m(i,c),g(i,n,c),l=!0},p(i,c){i[4]["jolt:low-data-mode"]?t&&(Y(),E(t,1,1,()=>{t=null}),Z()):t?(t.p(i,c),c&16&&k(t,1)):(t=Ke(i),t.c(),k(t,1),t.m(e.parentNode,e)),i[13].content!=null?s?s.p(i,c):(s=He(i),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(i){l||(k(t),l=!0)},o(i){E(t),l=!1},d(i){i&&(f(e),f(n)),t&&t.d(i),s&&s.d(i)}}}function Ke(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:tl,then:Zt,catch:Yt,value:14,blocks:[,,,]};return re(n=Pe(r[6].api,r[5]??r[6].api.cache.users,r[13].author),t),{c(){e=R(),t.block.c()},l(s){e=R(),t.block.l(s)},m(s,i){g(s,e,i),t.block.m(s,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(s,i){r=s,t.ctx=r,i&45&&n!==(n=Pe(r[6].api,r[5]??r[6].api.cache.users,r[13].author))&&re(n,t)||ge(t,r,i)},i(s){l||(k(t.block),l=!0)},o(s){for(let i=0;i<3;i+=1){const c=t.blocks[i];E(c)}l=!1},d(s){s&&f(e),t.block.d(s),t.token=null,t=null}}}function Yt(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Zt(r){let e,n,l,t;const s=[el,xt],i=[];function c(a,m){return a[14]!=null?0:1}function o(a,m){return m===0?Jt(a):a}return e=c(r),n=i[e]=s[e](o(r,e)),{c(){n.c(),l=R()},l(a){n.l(a),l=R()},m(a,m){i[e].m(a,m),g(a,l,m),t=!0},p(a,m){let d=e;e=c(a),e===d?i[e].p(o(a,e),m):(Y(),E(i[d],1,1,()=>{i[d]=null}),Z(),n=i[e],n?n.p(o(a,e),m):(n=i[e]=s[e](o(a,e)),n.c()),k(n,1),n.m(l.parentNode,l))},i(a){t||(k(n),t=!0)},o(a){E(n),t=!1},d(a){a&&f(l),i[e].d(a)}}}function xt(r){let e,n,l;return e=new Ce({}),{c(){ee(e.$$.fragment),n=S(`

						Unknown User`)},l(t){te(e.$$.fragment,t),n=A(t,`

						Unknown User`)},m(t,s){le(e,t,s),g(t,n,s),l=!0},p:h,i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){E(e.$$.fragment,t),l=!1},d(t){t&&f(n),ne(e,t)}}}function el(r){let e,n,l,t,s=r[15]+"",i;return{c(){e=C("img"),t=L(),i=S(s),this.h()},l(c){e=I(c,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),t=G(c),i=A(c,s),this.h()},h(){_(e,"class","cover"),W(e.src,n=pe(r[14]))||_(e,"src",n),_(e,"alt",l=r[15]),_(e,"width","24px"),_(e,"height","24px")},m(c,o){g(c,e,o),g(c,t,o),g(c,i,o)},p(c,o){o&45&&!W(e.src,n=pe(c[14]))&&_(e,"src",n),o&45&&l!==(l=c[15])&&_(e,"alt",l),o&45&&s!==(s=c[15]+"")&&Q(i,s)},i:h,o:h,d(c){c&&(f(e),f(t),f(i))}}}function tl(r){let e;return{c(){e=S("<Unknown User>")},l(n){e=A(n,"<Unknown User>")},m(n,l){g(n,e,l)},p:h,i:h,o:h,d(n){n&&f(e)}}}function He(r){let e,n=r[13].content+"",l;return{c(){e=C("span"),l=S(n),this.h()},l(t){e=I(t,"SPAN",{class:!0});var s=q(e);l=A(s,n),s.forEach(f),this.h()},h(){_(e,"class","message-content svelte-pdgjwp")},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&13&&n!==(n=t[13].content+"")&&Q(l,n)},d(t){t&&f(e)}}}function ll(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function nl(r){let e,n,l,t=r[2]!=null&&ze(r);return{c(){e=C("a"),t&&t.c(),this.h()},l(s){e=I(s,"A",{href:!0,class:!0});var i=q(e);t&&t.l(i),i.forEach(f),this.h()},h(){_(e,"href",n=Ge+"/"+(r[1]==null?`channels/${r[2]}/${r[0]}`:`servers/${r[1]}/channels/${r[2]}/${r[0]}`)),_(e,"class","svelte-pdgjwp")},m(s,i){g(s,e,i),t&&t.m(e,null),l=!0},p(s,[i]){s[2]!=null?t?(t.p(s,i),i&4&&k(t,1)):(t=ze(s),t.c(),k(t,1),t.m(e,null)):t&&(Y(),E(t,1,1,()=>{t=null}),Z()),(!l||i&7&&n!==(n=Ge+"/"+(s[1]==null?`channels/${s[2]}/${s[0]}`:`servers/${s[1]}/channels/${s[2]}/${s[0]}`)))&&_(e,"href",n)},i(s){l||(k(t),l=!0)},o(s){E(t),l=!1},d(s){s&&f(e),t&&t.d()}}}function rl(r,e,n){let l,t,s,i,c;const o=x(we),a=x(Me);ce(r,a,y=>n(4,i=y));const m=x(Mt);ce(r,m,y=>n(1,l=y));const d=x(Gt);ce(r,d,y=>n(2,t=y));const u=x(qe);ce(r,u,y=>n(3,s=y));const p=x(Be);ce(r,p,y=>n(5,c=y));let{id:O}=e;const V=({_id:y})=>O==y;return r.$$set=y=>{"id"in y&&n(0,O=y.id)},[O,l,t,s,i,c,o,a,m,d,u,p,V]}class il extends he{constructor(e){super(),me(this,e,rl,nl,_e,{id:0})}}function Xe(r){const e=ae(r[3]);r[4]=e}function Je(r){r[5]=r[7][0],r[6]=r[7][1]}function Qe(r){const e=ae(r[3]);r[4]=e}function sl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:pl,then:ul,catch:fl,value:3};return re(n=r[1].api.fetchUser(r[0].id),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&re(n,l)||ge(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function ol(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:kl,then:bl,catch:gl,value:7};return re(n=Promise.all([r[0].from,r[0].to].map(r[2])),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=Promise.all([r[0].from,r[0].to].map(r[2])))&&re(n,l)||ge(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function cl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Sl,then:yl,catch:vl,value:3};return re(n=r[1].api.fetchUser(r[0].by),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].by))&&re(n,l)||ge(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function al(r){let e=r[0].content+"",n;return{c(){n=S(e)},l(l){n=A(l,e)},m(l,t){g(l,n,t)},p(l,t){t&1&&e!==(e=l[0].content+"")&&Q(n,e)},d(l){l&&f(n)}}}function fl(r){return{c:h,l:h,m:h,p:h,d:h}}function ul(r){Xe(r);let e,n,l,t,s=r[4]+"",i,c,o;function a(u,p){if(u[0].type=="user_banned")return dl;if(u[0].type=="user_joined")return ml;if(u[0].type=="user_kicked")return hl;if(u[0].type=="user_left")return _l}let m=a(r),d=m&&m(r);return{c(){e=C("img"),t=L(),i=S(s),c=L(),d&&d.c(),o=R(),this.h()},l(u){e=I(u,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=G(u),i=A(u,s),c=G(u),d&&d.l(u),o=R(),this.h()},h(){_(e,"class","cover"),W(e.src,n=pe(r[3]))||_(e,"src",n),_(e,"width","24px"),_(e,"height","24px"),_(e,"alt",l=r[4])},m(u,p){g(u,e,p),g(u,t,p),g(u,i,p),g(u,c,p),d&&d.m(u,p),g(u,o,p)},p(u,p){Xe(u),p&1&&!W(e.src,n=pe(u[3]))&&_(e,"src",n),p&1&&l!==(l=u[4])&&_(e,"alt",l),p&1&&s!==(s=u[4]+"")&&Q(i,s),m!==(m=a(u))&&(d&&d.d(1),d=m&&m(u),d&&(d.c(),d.m(o.parentNode,o)))},d(u){u&&(f(e),f(t),f(i),f(c),f(o)),d&&d.d(u)}}}function _l(r){let e;return{c(){e=S("left the chat.")},l(n){e=A(n,"left the chat.")},m(n,l){g(n,e,l)},d(n){n&&f(e)}}}function hl(r){let e;return{c(){e=S("was kicked.")},l(n){e=A(n,"was kicked.")},m(n,l){g(n,e,l)},d(n){n&&f(e)}}}function ml(r){let e;return{c(){e=S("has joined the chat.")},l(n){e=A(n,"has joined the chat.")},m(n,l){g(n,e,l)},d(n){n&&f(e)}}}function dl(r){let e;return{c(){e=S("was banned.")},l(n){e=A(n,"was banned.")},m(n,l){g(n,e,l)},d(n){n&&f(e)}}}function pl(r){return{c:h,l:h,m:h,p:h,d:h}}function gl(r){return{c:h,l:h,m:h,p:h,d:h}}function bl(r){Je(r);let e,n=ae(r[5])+"",l,t,s=ae(r[6])+"",i,c;return{c(){e=S("Channel ownership changed from "),l=S(n),t=S(" to "),i=S(s),c=S(".")},l(o){e=A(o,"Channel ownership changed from "),l=A(o,n),t=A(o," to "),i=A(o,s),c=A(o,".")},m(o,a){g(o,e,a),g(o,l,a),g(o,t,a),g(o,i,a),g(o,c,a)},p(o,a){Je(o),a&1&&n!==(n=ae(o[5])+"")&&Q(l,n),a&1&&s!==(s=ae(o[6])+"")&&Q(i,s)},d(o){o&&(f(e),f(l),f(t),f(i),f(c))}}}function kl(r){return{c:h,l:h,m:h,p:h,d:h}}function vl(r){return{c:h,l:h,m:h,p:h,d:h}}function yl(r){Qe(r);let e,n,l,t,s=r[4]+"",i,c,o;function a(u,p){if(u[0].type=="channel_description_changed")return Ml;if(u[0].type=="channel_icon_changed")return El;if(u[0].type=="channel_renamed")return $l;if(u[0].type=="user_added"||u[0].type=="user_remove")return wl}let m=a(r),d=m&&m(r);return{c(){e=C("img"),t=L(),i=S(s),c=L(),d&&d.c(),o=R(),this.h()},l(u){e=I(u,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=G(u),i=A(u,s),c=G(u),d&&d.l(u),o=R(),this.h()},h(){_(e,"class","cover"),W(e.src,n=pe(r[3]))||_(e,"src",n),_(e,"width","24px"),_(e,"height","24px"),_(e,"alt",l=r[4])},m(u,p){g(u,e,p),g(u,t,p),g(u,i,p),g(u,c,p),d&&d.m(u,p),g(u,o,p)},p(u,p){Qe(u),p&1&&!W(e.src,n=pe(u[3]))&&_(e,"src",n),p&1&&l!==(l=u[4])&&_(e,"alt",l),p&1&&s!==(s=u[4]+"")&&Q(i,s),m===(m=a(u))&&d?d.p(u,p):(d&&d.d(1),d=m&&m(u),d&&(d.c(),d.m(o.parentNode,o)))},d(u){u&&(f(e),f(t),f(i),f(c),f(o)),d&&d.d(u)}}}function wl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Tl,then:Il,catch:Cl,value:3};return re(n=r[1].api.fetchUser(r[0].id),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&re(n,l)||ge(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function $l(r){let e,n=r[0].name+"",l,t;return{c(){e=S("renamed this channel to "),l=S(n),t=S(".")},l(s){e=A(s,"renamed this channel to "),l=A(s,n),t=A(s,".")},m(s,i){g(s,e,i),g(s,l,i),g(s,t,i)},p(s,i){i&1&&n!==(n=s[0].name+"")&&Q(l,n)},d(s){s&&(f(e),f(l),f(t))}}}function El(r){let e;return{c(){e=S("changes this channel icon.")},l(n){e=A(n,"changes this channel icon.")},m(n,l){g(n,e,l)},p:h,d(n){n&&f(e)}}}function Ml(r){let e;return{c(){e=S("changed this channel's description.")},l(n){e=A(n,"changed this channel's description.")},m(n,l){g(n,e,l)},p:h,d(n){n&&f(e)}}}function Cl(r){return{c:h,l:h,m:h,p:h,d:h}}function Il(r){let e,n=ae(r[3])+"",l,t;function s(o,a){if(o[0].type=="user_added")return Nl;if(o[0].type=="user_remove")return Ul}let i=s(r),c=i&&i(r);return{c(){c&&c.c(),e=L(),l=S(n),t=S(".")},l(o){c&&c.l(o),e=G(o),l=A(o,n),t=A(o,".")},m(o,a){c&&c.m(o,a),g(o,e,a),g(o,l,a),g(o,t,a)},p(o,a){i!==(i=s(o))&&(c&&c.d(1),c=i&&i(o),c&&(c.c(),c.m(e.parentNode,e))),a&1&&n!==(n=ae(o[3])+"")&&Q(l,n)},d(o){o&&(f(e),f(l),f(t)),c&&c.d(o)}}}function Ul(r){let e;return{c(){e=S("removed")},l(n){e=A(n,"removed")},m(n,l){g(n,e,l)},d(n){n&&f(e)}}}function Nl(r){let e;return{c(){e=S("added")},l(n){e=A(n,"added")},m(n,l){g(n,e,l)},d(n){n&&f(e)}}}function Tl(r){return{c:h,l:h,m:h,p:h,d:h}}function Sl(r){return{c:h,l:h,m:h,p:h,d:h}}function Al(r){let e;function n(s,i){if(s[0].type=="text")return al;if(s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove")return cl;if(s[0].type=="channel_ownership_changed")return ol;if(s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left")return sl}let l=n(r),t=l&&l(r);return{c(){e=C("span"),t&&t.c(),this.h()},l(s){e=I(s,"SPAN",{class:!0});var i=q(e);t&&t.l(i),i.forEach(f),this.h()},h(){_(e,"class","container svelte-qj8q6t")},m(s,i){g(s,e,i),t&&t.m(e,null)},p(s,[i]){l===(l=n(s))&&t?t.p(s,i):(t&&t.d(1),t=l&&l(s),t&&(t.c(),t.m(e,null)))},i:h,o:h,d(s){s&&f(e),t&&t.d()}}}function Dl(r,e,n){const l=x(we);let{system:t}=e;const s=i=>l.api.fetchUser(i);return r.$$set=i=>{"system"in i&&n(0,t=i.system)},[t,l,s]}class jl extends he{constructor(e){super(),me(this,e,Dl,Al,_e,{system:0})}}function Pl(r){let e,n,l,t,s,i,c,o="Ok",a,m,d="Cancel",u,p,O;const V=r[3].default,y=Nt(V,r,r[2],null);return{c(){e=C("dialog"),n=C("div"),y&&y.c(),l=L(),t=C("hr"),s=L(),i=C("form"),c=C("button"),c.textContent=o,a=L(),m=C("button"),m.textContent=d,this.h()},l(b){e=I(b,"DIALOG",{});var M=q(e);n=I(M,"DIV",{});var U=q(n);y&&y.l(U),l=G(U),t=I(U,"HR",{}),s=G(U),i=I(U,"FORM",{id:!0,method:!0});var T=q(i);c=I(T,"BUTTON",{type:!0,"data-svelte-h":!0}),ke(c)!=="svelte-fdbbw9"&&(c.textContent=o),a=G(T),m=I(T,"BUTTON",{type:!0,"data-svelte-h":!0}),ke(m)!=="svelte-1gqjcfl"&&(m.textContent=d),T.forEach(f),U.forEach(f),M.forEach(f),this.h()},h(){_(c,"type","submit"),_(m,"type","reset"),_(i,"id","modal-form"),_(i,"method","dialog")},m(b,M){g(b,e,M),v(e,n),y&&y.m(n,null),v(n,l),v(n,t),v(n,s),v(n,i),v(i,c),v(i,a),v(i,m),r[6](e),u=!0,p||(O=[fe(m,"click",r[5]),fe(i,"submit",r[4]),fe(e,"close",r[7])],p=!0)},p(b,[M]){y&&y.p&&(!u||M&4)&&Tt(y,V,b,b[2],u?At(V,b[2],M,null):St(b[2]),null)},i(b){u||(k(y,b),u=!0)},o(b){E(y,b),u=!1},d(b){b&&f(e),y&&y.d(b),r[6](null),p=!1,Ae(O)}}}function Ol(r,e,n){let{$$slots:l={},$$scope:t}=e,{showModal:s}=e,i;function c(d){Dt.call(this,r,d)}const o=()=>n(0,s=!1);function a(d){ve[d?"unshift":"push"](()=>{i=d,n(1,i)})}const m=()=>n(0,s=!1);return r.$$set=d=>{"showModal"in d&&n(0,s=d.showModal),"$$scope"in d&&n(2,t=d.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(s?i==null||i.showModal():i==null||i.close())},[s,i,t,l,c,o,a,m]}class Vl extends he{constructor(e){super(),me(this,e,Ol,Pl,_e,{showModal:0})}}function ql(r){let e,n="External Link",l,t,s,i,c="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=C("h1"),e.textContent=n,l=L(),t=C("hr"),s=L(),i=C("p"),i.textContent=c,this.h()},l(o){e=I(o,"H1",{class:!0,"data-svelte-h":!0}),ke(e)!=="svelte-qkxu7n"&&(e.textContent=n),l=G(o),t=I(o,"HR",{}),s=G(o),i=I(o,"P",{"data-svelte-h":!0}),ke(i)!=="svelte-os1rtp"&&(i.textContent=c),this.h()},h(){_(e,"class","text-3xl")},m(o,a){g(o,e,a),g(o,l,a),g(o,t,a),g(o,s,a),g(o,i,a)},p:h,d(o){o&&(f(e),f(l),f(t),f(s),f(i))}}}function Bl(r){let e,n,l,t,s,i,c,o;function a(d){r[2](d)}let m={$$slots:{default:[ql]},$$scope:{ctx:r}};return r[1]!==void 0&&(m.showModal=r[1]),e=new Vl({props:m}),ve.push(()=>Ve(e,"showModal",a)),e.$on("submit",r[3]),{c(){ee(e.$$.fragment),l=L(),t=C("a"),s=S(r[0]),this.h()},l(d){te(e.$$.fragment,d),l=G(d),t=I(d,"A",{href:!0,target:!0,rel:!0});var u=q(t);s=A(u,r[0]),u.forEach(f),this.h()},h(){_(t,"href",r[0]),_(t,"target","_blank"),_(t,"rel","noreferrer")},m(d,u){le(e,d,u),g(d,l,u),g(d,t,u),v(t,s),i=!0,c||(o=fe(t,"click",jt(r[4])),c=!0)},p(d,[u]){const p={};u&32&&(p.$$scope={dirty:u,ctx:d}),!n&&u&2&&(n=!0,p.showModal=d[1],Oe(()=>n=!1)),e.$set(p),(!i||u&1)&&Q(s,d[0]),(!i||u&1)&&_(t,"href",d[0])},i(d){i||(k(e.$$.fragment,d),i=!0)},o(d){E(e.$$.fragment,d),i=!1},d(d){d&&(f(l),f(t)),ne(e,d),c=!1,o()}}}function Fl(r,e,n){let{href:l}=e,t=!1;function s(o){t=o,n(1,t)}const i=()=>window.open(l),c=()=>n(1,t=!0);return r.$$set=o=>{"href"in o&&n(0,l=o.href)},[l,t,s,i,c]}class Fe extends he{constructor(e){super(),me(this,e,Fl,Bl,_e,{href:0})}}function Rl(r){let e,n,l,t;const s=[Xl,Hl],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=R()},l(o){n.l(o),l=R()},m(o,a){i[e].m(o,a),g(o,l,a),t=!0},p(o,a){let m=e;e=c(o),e===m?i[e].p(o,a):(Y(),E(i[m],1,1,()=>{i[m]=null}),Z(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),k(n,1),n.m(l.parentNode,l))},i(o){t||(k(n),t=!0)},o(o){E(n),t=!1},d(o){o&&f(l),i[e].d(o)}}}function Ll(r){let e,n,l=r[0].filename+"",t,s,i,c;return i=new Fe({props:{href:r[1]}}),{c(){e=C("span"),n=S("[File "),t=S(l),s=S(`]
			`),ee(i.$$.fragment),this.h()},l(o){e=I(o,"SPAN",{class:!0});var a=q(e);n=A(a,"[File "),t=A(a,l),s=A(a,`]
			`),te(i.$$.fragment,a),a.forEach(f),this.h()},h(){_(e,"class","text-gray-500")},m(o,a){g(o,e,a),v(e,n),v(e,t),v(e,s),le(i,e,null),c=!0},p(o,a){(!c||a&1)&&l!==(l=o[0].filename+"")&&Q(t,l);const m={};a&2&&(m.href=o[1]),i.$set(m)},i(o){c||(k(i.$$.fragment,o),c=!0)},o(o){E(i.$$.fragment,o),c=!1},d(o){o&&f(e),ne(i)}}}function Gl(r){let e,n,l;return{c(){e=C("audio"),n=C("source"),this.h()},l(t){e=I(t,"AUDIO",{});var s=q(e);n=I(s,"SOURCE",{src:!0}),s.forEach(f),this.h()},h(){W(n.src,l=r[1])||_(n,"src",l),e.controls=!0},m(t,s){g(t,e,s),v(e,n)},p(t,s){s&2&&!W(n.src,l=t[1])&&_(n,"src",l)},i:h,o:h,d(t){t&&f(e)}}}function zl(r){let e,n,l;return{c(){e=C("video"),n=C("source"),this.h()},l(t){e=I(t,"VIDEO",{class:!0});var s=q(e);n=I(s,"SOURCE",{src:!0}),s.forEach(f),this.h()},h(){W(n.src,l=r[1])||_(n,"src",l),e.controls=!0,_(e,"class","svelte-m38imf")},m(t,s){g(t,e,s),v(e,n)},p(t,s){s&2&&!W(n.src,l=t[1])&&_(n,"src",l)},i:h,o:h,d(t){t&&f(e)}}}function Kl(r){let e,n,l,t;const s=[tn,en],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=R()},l(o){n.l(o),l=R()},m(o,a){i[e].m(o,a),g(o,l,a),t=!0},p(o,a){let m=e;e=c(o),e===m?i[e].p(o,a):(Y(),E(i[m],1,1,()=>{i[m]=null}),Z(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),k(n,1),n.m(l.parentNode,l))},i(o){t||(k(n),t=!0)},o(o){E(n),t=!1},d(o){o&&f(l),i[e].d(o)}}}function Hl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!0,pending:xl,then:Ql,catch:Jl,value:4,error:6};return re(n=fetch(r[1]),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&2&&n!==(n=fetch(r[1]))&&re(n,l)||ge(l,r,s)},i:h,o:h,d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function Xl(r){let e,n,l,t,s;return l=new Fe({props:{href:r[1]}}),{c(){e=C("span"),n=S("[Text "),ee(l.$$.fragment),t=S("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var c=q(e);n=A(c,"[Text "),te(l.$$.fragment,c),t=A(c,"]"),c.forEach(f),this.h()},h(){_(e,"class","text-gray-500")},m(i,c){g(i,e,c),v(e,n),le(l,e,null),v(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),l.$set(o)},i(i){s||(k(l.$$.fragment,i),s=!0)},o(i){E(l.$$.fragment,i),s=!1},d(i){i&&f(e),ne(l)}}}function Jl(r){let e,n,l=r[0].filename+"",t,s,i=r[6]+"",c;return{c(){e=C("p"),n=S("Unable to download "),t=S(l),s=S(": "),c=S(i)},l(o){e=I(o,"P",{});var a=q(e);n=A(a,"Unable to download "),t=A(a,l),s=A(a,": "),c=A(a,i),a.forEach(f)},m(o,a){g(o,e,a),v(e,n),v(e,t),v(e,s),v(e,c)},p(o,a){a&1&&l!==(l=o[0].filename+"")&&Q(t,l),a&2&&i!==(i=o[6]+"")&&Q(c,i)},d(o){o&&f(e)}}}function Ql(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Zl,then:Yl,catch:Wl,value:5};return re(n=r[4].text(),l),{c(){e=R(),l.block.c()},l(t){e=R(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&2&&n!==(n=r[4].text())&&re(n,l)||ge(l,r,s)},d(t){t&&f(e),l.block.d(t),l.token=null,l=null}}}function Wl(r){return{c:h,l:h,m:h,p:h,d:h}}function Yl(r){let e,n=r[5]+"",l;return{c(){e=C("p"),l=S(n)},l(t){e=I(t,"P",{});var s=q(e);l=A(s,n),s.forEach(f)},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&2&&n!==(n=t[5]+"")&&Q(l,n)},d(t){t&&f(e)}}}function Zl(r){return{c:h,l:h,m:h,p:h,d:h}}function xl(r){return{c:h,l:h,m:h,p:h,d:h}}function en(r){let e,n,l;return{c(){e=C("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){W(e.src,n=r[1])||_(e,"src",n),_(e,"alt",l=r[0].filename),_(e,"class","max-w-xl max-h-xl svelte-m38imf")},m(t,s){g(t,e,s)},p(t,s){s&2&&!W(e.src,n=t[1])&&_(e,"src",n),s&1&&l!==(l=t[0].filename)&&_(e,"alt",l)},i:h,o:h,d(t){t&&f(e)}}}function tn(r){let e,n,l,t,s;return l=new Fe({props:{href:r[1]}}),{c(){e=C("span"),n=S("[Image "),ee(l.$$.fragment),t=S("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var c=q(e);n=A(c,"[Image "),te(l.$$.fragment,c),t=A(c,"]"),c.forEach(f),this.h()},h(){_(e,"class","text-gray-500")},m(i,c){g(i,e,c),v(e,n),le(l,e,null),v(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),l.$set(o)},i(i){s||(k(l.$$.fragment,i),s=!0)},o(i){E(l.$$.fragment,i),s=!1},d(i){i&&f(e),ne(l)}}}function ln(r){let e,n,l,t;const s=[Kl,zl,Gl,Ll,Rl],i=[];function c(o,a){return o[0].metadata.type=="Image"?0:o[0].metadata.type=="Video"?1:o[0].metadata.type=="Audio"?2:o[0].metadata.type=="File"?3:o[0].metadata.type=="Text"?4:-1}return~(n=c(r))&&(l=i[n]=s[n](r)),{c(){e=C("div"),l&&l.c()},l(o){e=I(o,"DIV",{});var a=q(e);l&&l.l(a),a.forEach(f)},m(o,a){g(o,e,a),~n&&i[n].m(e,null),t=!0},p(o,[a]){let m=n;n=c(o),n===m?~n&&i[n].p(o,a):(l&&(Y(),E(i[m],1,1,()=>{i[m]=null}),Z()),~n?(l=i[n],l?l.p(o,a):(l=i[n]=s[n](o),l.c()),k(l,1),l.m(e,null)):l=null)},i(o){t||(k(l),t=!0)},o(o){E(l),t=!1},d(o){o&&f(e),~n&&i[n].d()}}}function nn(r,e,n){let l,t;const s=x(Me);ce(r,s,c=>n(2,t=c));let{attachment:i}=e;return r.$$set=c=>{"attachment"in c&&n(0,i=c.attachment)},r.$$.update=()=>{r.$$.dirty&1&&n(1,l=Rt(i))},[i,l,t,s]}class rn extends he{constructor(e){super(),me(this,e,nn,ln,_e,{attachment:0})}}function sn(r){let e,n="oop website embed, can't handle that :(";return{c(){e=C("span"),e.textContent=n,this.h()},l(l){e=I(l,"SPAN",{style:!0,"data-svelte-h":!0}),ke(e)!=="svelte-rjpnkw"&&(e.textContent=n),this.h()},h(){Ne(e,"color","var(--secondary-foreground)")},m(l,t){g(l,e,t)},p:h,d(l){l&&f(e)}}}function on(r){let e,n,l,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&We(r),s=r[0].title&&Ye(r),i=r[0].description&&Ze(r);return{c(){e=C("div"),t&&t.c(),n=L(),s&&s.c(),l=L(),i&&i.c(),this.h()},l(c){e=I(c,"DIV",{class:!0,style:!0});var o=q(e);t&&t.l(o),n=G(o),s&&s.l(o),l=G(o),i&&i.l(o),o.forEach(f),this.h()},h(){_(e,"class","text-embed svelte-ppm433"),Ne(e,"border-left","solid "+r[0].colour)},m(c,o){g(c,e,o),t&&t.m(e,null),v(e,n),s&&s.m(e,null),v(e,l),i&&i.m(e,null)},p(c,o){c[0].icon_url&&!c[1]["jolt:low-data-mode"]?t?t.p(c,o):(t=We(c),t.c(),t.m(e,n)):t&&(t.d(1),t=null),c[0].title?s?s.p(c,o):(s=Ye(c),s.c(),s.m(e,l)):s&&(s.d(1),s=null),c[0].description?i?i.p(c,o):(i=Ze(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null),o&1&&Ne(e,"border-left","solid "+c[0].colour)},d(c){c&&f(e),t&&t.d(),s&&s.d(),i&&i.d()}}}function cn(r){let e,n,l,t,s;return{c(){e=C("video"),n=C("source"),this.h()},l(i){e=I(i,"VIDEO",{class:!0});var c=q(e);n=I(c,"SOURCE",{src:!0,width:!0,height:!0}),c.forEach(f),this.h()},h(){W(n.src,l=r[0].url)||_(n,"src",l),_(n,"width",t=r[0].width),_(n,"height",s=r[0].height),e.controls=!0,_(e,"class","svelte-ppm433")},m(i,c){g(i,e,c),v(e,n)},p(i,c){c&1&&!W(n.src,l=i[0].url)&&_(n,"src",l),c&1&&t!==(t=i[0].width)&&_(n,"width",t),c&1&&s!==(s=i[0].height)&&_(n,"height",s)},d(i){i&&f(e)}}}function an(r){let e,n,l,t;return{c(){e=C("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,width:!0,height:!0,class:!0}),this.h()},h(){W(e.src,n=r[0].url)||_(e,"src",n),_(e,"width",l=r[0].width),_(e,"height",t=r[0].height),_(e,"class","svelte-ppm433")},m(s,i){g(s,e,i)},p(s,i){i&1&&!W(e.src,n=s[0].url)&&_(e,"src",n),i&1&&l!==(l=s[0].width)&&_(e,"width",l),i&1&&t!==(t=s[0].height)&&_(e,"height",t)},d(s){s&&f(e)}}}function We(r){let e,n,l;return{c(){e=C("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){W(e.src,n=r[0].icon_url)||_(e,"src",n),_(e,"alt",l=r[0].title),_(e,"width","24"),_(e,"height","24"),_(e,"class","svelte-ppm433")},m(t,s){g(t,e,s)},p(t,s){s&1&&!W(e.src,n=t[0].icon_url)&&_(e,"src",n),s&1&&l!==(l=t[0].title)&&_(e,"alt",l)},d(t){t&&f(e)}}}function Ye(r){let e,n=r[0].title+"",l;return{c(){e=C("h1"),l=S(n)},l(t){e=I(t,"H1",{});var s=q(e);l=A(s,n),s.forEach(f)},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&1&&n!==(n=t[0].title+"")&&Q(l,n)},d(t){t&&f(e)}}}function Ze(r){let e,n=r[0].description+"",l;return{c(){e=C("p"),l=S(n)},l(t){e=I(t,"P",{});var s=q(e);l=A(s,n),s.forEach(f)},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&1&&n!==(n=t[0].description+"")&&Q(l,n)},d(t){t&&f(e)}}}function fn(r){let e;function n(s,i){if(s[0].type=="Image"&&!s[1]["jolt:low-data-mode"])return an;if(s[0].type=="Video"&&!s[1]["jolt:low-data-mode"])return cn;if(s[0].type=="Text")return on;if(s[0].type=="Website")return sn}let l=n(r),t=l&&l(r);return{c(){t&&t.c(),e=R()},l(s){t&&t.l(s),e=R()},m(s,i){t&&t.m(s,i),g(s,e,i)},p(s,[i]){l===(l=n(s))&&t?t.p(s,i):(t&&t.d(1),t=l&&l(s),t&&(t.c(),t.m(e.parentNode,e)))},i:h,o:h,d(s){s&&f(e),t&&t.d(s)}}}function un(r,e,n){let l,{embed:t}=e;const s=x(Me);return ce(r,s,i=>n(1,l=i)),r.$$set=i=>{"embed"in i&&n(0,t=i.embed)},[t,l,s]}class _n extends he{constructor(e){super(),me(this,e,un,fn,_e,{embed:0})}}function hn(r){let e,n,l;return{c(){e=C("textarea"),this.h()},l(t){e=I(t,"TEXTAREA",{maxlength:!0,placeholder:!0,class:!0}),q(e).forEach(f),this.h()},h(){_(e,"maxlength","2000"),_(e,"placeholder",r[1]),_(e,"class","svelte-kqfcqt")},m(t,s){g(t,e,s),Re(e,r[0]),n||(l=[fe(e,"blur",r[3]),fe(e,"input",r[4]),fe(e,"keydown",r[6]),fe(e,"input",r[7])],n=!0)},p(t,[s]){s&2&&_(e,"placeholder",t[1]),s&1&&Re(e,t[0])},i:h,o:h,d(t){t&&f(e),n=!1,Ae(l)}}}function mn(r,e,n){const l=x(we),t=x(wt);let{placeholder:s=void 0}=e,{value:i=""}=e,{sendTypingEvents:c}=e;const o=Pt();function a(){c&&l.websocket.send({type:"EndTyping",channel:t._id})}function m(){if(c){if(i==""){l.websocket.send({type:"EndTyping",channel:t._id});return}l.websocket.send({type:"BeginTyping",channel:t._id})}}const d=p=>{var O;o("keydown",p),!(p.shiftKey||p.key!="Enter")&&(p.preventDefault(),(O=p.currentTarget.form)==null||O.requestSubmit())};function u(){i=this.value,n(0,i)}return r.$$set=p=>{"placeholder"in p&&n(1,s=p.placeholder),"value"in p&&n(0,i=p.value),"sendTypingEvents"in p&&n(5,c=p.sendTypingEvents)},[i,s,o,a,m,c,d,u]}class Ct extends he{constructor(e){super(),me(this,e,mn,hn,_e,{placeholder:1,value:0,sendTypingEvents:5})}}function xe(r,e,n){const l=r.slice();return l[22]=e[n],l}function et(r,e,n){const l=r.slice();return l[25]=e[n],l}function je(r){const e=r.slice(),n=new Date(e[0].edited);return e[6]=n,e}function dn(r){const e=r.slice(),n=pe(e[1],e[2],e[0]);return e[28]=n,e}function tt(r,e,n){const l=r.slice();return l[29]=e[n],l}function lt(r){let e,n,l=ue(r[0].replies),t=[];for(let i=0;i<l.length;i+=1)t[i]=nt(tt(r,l,i));const s=i=>E(t[i],1,1,()=>{t[i]=null});return{c(){e=C("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var c=q(e);for(let o=0;o<t.length;o+=1)t[o].l(c);c.forEach(f),this.h()},h(){_(e,"class","replies svelte-wy25lb")},m(i,c){g(i,e,c);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null);n=!0},p(i,c){if(c[0]&1){l=ue(i[0].replies);let o;for(o=0;o<l.length;o+=1){const a=tt(i,l,o);t[o]?(t[o].p(a,c),k(t[o],1)):(t[o]=nt(a),t[o].c(),k(t[o],1),t[o].m(e,null))}for(Y(),o=l.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)k(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)E(t[c]);n=!1},d(i){i&&f(e),ye(t,i)}}}function nt(r){let e,n;return e=new il({props:{id:r[29]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.id=l[29]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function rt(r){let e,n,l,t,s,i,c,o=Ee(r[6]).calendar()+"",a,m,d;const u=[gn,pn],p=[];function O(b,M){return b[5]["jolt:low-data-mode"]||b[1]==null?0:1}function V(b,M){return M===1?dn(b):b}n=O(r),l=p[n]=u[n](V(r,n));let y=r[0].edited!=null&&it(je(r));return{c(){e=C("div"),l.c(),t=L(),s=S(r[4]),i=L(),c=C("p"),a=S(o),m=L(),y&&y.c(),this.h()},l(b){e=I(b,"DIV",{class:!0});var M=q(e);l.l(M),t=G(M),s=A(M,r[4]),i=G(M),c=I(M,"P",{class:!0});var U=q(c);a=A(U,o),m=G(U),y&&y.l(U),U.forEach(f),M.forEach(f),this.h()},h(){_(c,"class","timestamp svelte-wy25lb"),_(e,"class","user-detail svelte-wy25lb")},m(b,M){g(b,e,M),p[n].m(e,null),v(e,t),v(e,s),v(e,i),v(e,c),v(c,a),v(c,m),y&&y.m(c,null),d=!0},p(b,M){let U=n;n=O(b),n===U?p[n].p(V(b,n),M):(Y(),E(p[U],1,1,()=>{p[U]=null}),Z(),l=p[n],l?l.p(V(b,n),M):(l=p[n]=u[n](V(b,n)),l.c()),k(l,1),l.m(e,t)),(!d||M[0]&16)&&Q(s,b[4]),(!d||M[0]&64)&&o!==(o=Ee(b[6]).calendar()+"")&&Q(a,o),b[0].edited!=null?y?y.p(je(b),M):(y=it(je(b)),y.c(),y.m(c,null)):y&&(y.d(1),y=null)},i(b){d||(k(l),d=!0)},o(b){E(l),d=!1},d(b){b&&f(e),p[n].d(),y&&y.d()}}}function pn(r){let e,n,l,t;const s=[kn,bn],i=[];function c(o,a){return o[28]==null?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=R()},l(o){n.l(o),l=R()},m(o,a){i[e].m(o,a),g(o,l,a),t=!0},p(o,a){let m=e;e=c(o),e===m?i[e].p(o,a):(Y(),E(i[m],1,1,()=>{i[m]=null}),Z(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),k(n,1),n.m(l.parentNode,l))},i(o){t||(k(n),t=!0)},o(o){E(n),t=!1},d(o){o&&f(l),i[e].d(o)}}}function gn(r){let e,n;return e=new Ce({}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p:h,i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function bn(r){let e,n;return{c(){e=C("img"),this.h()},l(l){e=I(l,"IMG",{class:!0,alt:!0,src:!0,width:!0,height:!0}),this.h()},h(){_(e,"class","cover"),_(e,"alt",r[4]),W(e.src,n=r[28])||_(e,"src",n),_(e,"width","40px"),_(e,"height","40px")},m(l,t){g(l,e,t)},p(l,t){t[0]&16&&_(e,"alt",l[4]),t[0]&7&&!W(e.src,n=l[28])&&_(e,"src",n)},i:h,o:h,d(l){l&&f(e)}}}function kn(r){let e,n;return e=new Ce({}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p:h,i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function it(r){let e,n="(edited)",l,t,s;return{c(){e=C("span"),e.textContent=n,this.h()},l(i){e=I(i,"SPAN",{class:!0,"data-svelte-h":!0}),ke(e)!=="svelte-1c19xdw"&&(e.textContent=n),this.h()},h(){_(e,"class","timestamp svelte-wy25lb")},m(i,c){g(i,e,c),t||(s=Ot(l=zt.call(null,e,{placement:"top",content:Ee(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away-subtle",duration:100})),t=!0)},p(i,c){r=i,l&&Vt(l.update)&&c[0]&1&&l.update.call(null,{placement:"top",content:Ee(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away-subtle",duration:100})},d(i){i&&f(e),t=!1,s()}}}function vn(r){let e,n=r[0].content+"",l;return{c(){e=C("span"),l=S(n),this.h()},l(t){e=I(t,"SPAN",{class:!0});var s=q(e);l=A(s,n),s.forEach(f),this.h()},h(){_(e,"class","message-content svelte-wy25lb")},m(t,s){g(t,e,s),v(e,l)},p(t,s){s[0]&1&&n!==(n=t[0].content+"")&&Q(l,n)},i:h,o:h,d(t){t&&f(e)}}}function yn(r){let e,n,l,t,s,i;function c(a){r[16](a)}let o={placeholder:"Edit this message",sendTypingEvents:!1};return r[3]!==void 0&&(o.value=r[3]),n=new Ct({props:o}),ve.push(()=>Ve(n,"value",c)),n.$on("keydown",r[17]),{c(){e=C("form"),ee(n.$$.fragment),this.h()},l(a){e=I(a,"FORM",{id:!0,class:!0});var m=q(e);te(n.$$.fragment,m),m.forEach(f),this.h()},h(){_(e,"id","message-edit-form"),_(e,"class","message-form")},m(a,m){g(a,e,m),le(n,e,null),t=!0,s||(i=fe(e,"submit",r[11]),s=!0)},p(a,m){const d={};!l&&m[0]&8&&(l=!0,d.value=a[3],Oe(()=>l=!1)),n.$set(d)},i(a){t||(k(n.$$.fragment,a),t=!0)},o(a){E(n.$$.fragment,a),t=!1},d(a){a&&f(e),ne(n),s=!1,i()}}}function st(r){let e,n;return e=new jl({props:{system:r[0].system}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.system=l[0].system),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function ot(r){let e,n,l=ue(r[0].attachments),t=[];for(let i=0;i<l.length;i+=1)t[i]=ct(et(r,l,i));const s=i=>E(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=R()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=R()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),n=!0},p(i,c){if(c[0]&1){l=ue(i[0].attachments);let o;for(o=0;o<l.length;o+=1){const a=et(i,l,o);t[o]?(t[o].p(a,c),k(t[o],1)):(t[o]=ct(a),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=l.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)k(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)E(t[c]);n=!1},d(i){i&&f(e),ye(t,i)}}}function ct(r){let e,n;return e=new rn({props:{attachment:r[25]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.attachment=l[25]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function at(r){let e,n,l=ue(r[0].embeds),t=[];for(let i=0;i<l.length;i+=1)t[i]=ft(xe(r,l,i));const s=i=>E(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=R()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=R()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),n=!0},p(i,c){if(c[0]&1){l=ue(i[0].embeds);let o;for(o=0;o<l.length;o+=1){const a=xe(i,l,o);t[o]?(t[o].p(a,c),k(t[o],1)):(t[o]=ft(a),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=l.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)k(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)E(t[c]);n=!1},d(i){i&&f(e),ye(t,i)}}}function ft(r){let e,n;return e=new _n({props:{embed:r[22]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.embed=l[22]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function wn(r){let e,n,l=r[12](r[0])&&r[0].system==null,t,s,i,c,o,a,m,d,u=r[0].replies!=null&&r[0].replies.length!=0&&lt(r),p=l&&rt(r);const O=[yn,vn],V=[];function y(T,N){return T[3]!=null?0:T[0].content!=null?1:-1}~(s=y(r))&&(i=V[s]=O[s](r));let b=r[0].system!=null&&st(r),M=r[0].attachments!=null&&ot(r),U=r[0].embeds!=null&&at(r);return{c(){e=C("div"),u&&u.c(),n=L(),p&&p.c(),t=L(),i&&i.c(),c=L(),b&&b.c(),o=L(),M&&M.c(),a=L(),U&&U.c(),this.h()},l(T){e=I(T,"DIV",{id:!0,class:!0});var N=q(e);u&&u.l(N),n=G(N),p&&p.l(N),t=G(N),i&&i.l(N),c=G(N),b&&b.l(N),o=G(N),M&&M.l(N),a=G(N),U&&U.l(N),N.forEach(f),this.h()},h(){_(e,"id",m="MESSAGE-"+r[0]._id),_(e,"class","message-container svelte-wy25lb")},m(T,N){g(T,e,N),u&&u.m(e,null),v(e,n),p&&p.m(e,null),v(e,t),~s&&V[s].m(e,null),v(e,c),b&&b.m(e,null),v(e,o),M&&M.m(e,null),v(e,a),U&&U.m(e,null),d=!0},p(T,N){T[0].replies!=null&&T[0].replies.length!=0?u?(u.p(T,N),N[0]&1&&k(u,1)):(u=lt(T),u.c(),k(u,1),u.m(e,n)):u&&(Y(),E(u,1,1,()=>{u=null}),Z()),N[0]&1&&(l=T[12](T[0])&&T[0].system==null),l?p?(p.p(T,N),N[0]&1&&k(p,1)):(p=rt(T),p.c(),k(p,1),p.m(e,t)):p&&(Y(),E(p,1,1,()=>{p=null}),Z());let z=s;s=y(T),s===z?~s&&V[s].p(T,N):(i&&(Y(),E(V[z],1,1,()=>{V[z]=null}),Z()),~s?(i=V[s],i?i.p(T,N):(i=V[s]=O[s](T),i.c()),k(i,1),i.m(e,c)):i=null),T[0].system!=null?b?(b.p(T,N),N[0]&1&&k(b,1)):(b=st(T),b.c(),k(b,1),b.m(e,o)):b&&(Y(),E(b,1,1,()=>{b=null}),Z()),T[0].attachments!=null?M?(M.p(T,N),N[0]&1&&k(M,1)):(M=ot(T),M.c(),k(M,1),M.m(e,a)):M&&(Y(),E(M,1,1,()=>{M=null}),Z()),T[0].embeds!=null?U?(U.p(T,N),N[0]&1&&k(U,1)):(U=at(T),U.c(),k(U,1),U.m(e,null)):U&&(Y(),E(U,1,1,()=>{U=null}),Z()),(!d||N[0]&1&&m!==(m="MESSAGE-"+T[0]._id))&&_(e,"id",m)},i(T){d||(k(u),k(p),k(i),k(b),k(M),k(U),d=!0)},o(T){E(u),E(p),E(i),E(b),E(M),E(U),d=!1},d(T){T&&f(e),u&&u.d(),p&&p.d(),~s&&V[s].d(),b&&b.d(),M&&M.d(),U&&U.d()}}}function $n(r,e,n){let l,t,s,i,c,o;Ee.extend(Ht);let{message:a}=e,{messageIndex:m}=e,d,u,p;const O=x(Me);ce(r,O,P=>n(5,o=P));const V=x(we),y=x(Mt);ce(r,y,P=>n(14,s=P));const b=x(qe),M=x(Be);ce(r,M,P=>n(15,i=P));const U=x($t);ce(r,U,P=>n(18,c=P));async function T(P,K){n(2,p=c==null?void 0:c.find(D=>D._id.server==P&&D._id.user==K))}async function N(){const P=await V.api.editMessage(a.channel,a._id,{content:d});b==null||b.update(K=>(K[K.findIndex(D=>D._id==a._id)]=P,K)),n(3,d=void 0)}function z(P){var X;if(b==null)return!0;const D=qt(b)[m-1];return D==null?!0:P.author!=D.author||P.masquerade!=D.masquerade||De(P._id)-De(D._id)>=7*60*1e3||(((X=P.replies)==null?void 0:X.length)??0)!=0}function oe(P){d=P,n(3,d)}const H=P=>{P.detail.key=="Escape"&&n(3,d=void 0)};return r.$$set=P=>{"message"in P&&n(0,a=P.message),"messageIndex"in P&&n(13,m=P.messageIndex)},r.$$.update=()=>{r.$$.dirty[0]&32769&&Pe(V.api,i??V.api.cache.users,a.author).then(P=>n(1,u=P)),r.$$.dirty[0]&16385&&(s==null||T(s,a.author)),r.$$.dirty[0]&7&&n(4,l=u==null?"Unknown User":ae(u,p,a)),r.$$.dirty[0]&1&&n(6,t=De(a._id))},[a,u,p,d,l,o,t,O,y,M,U,N,z,m,s,i,oe,H]}class En extends he{constructor(e){super(),me(this,e,$n,wn,_e,{message:0,messageIndex:13},null,[-1,-1])}}function Mn(r){let e,n;return{c(){e=Te("svg"),n=Te("path"),this.h()},l(l){e=Se(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=q(e);n=Se(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),q(n).forEach(f),t.forEach(f),this.h()},h(){_(n,"stroke-linecap","round"),_(n,"stroke-linejoin","round"),_(n,"d","M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),_(e,"xmlns","http://www.w3.org/2000/svg"),_(e,"fill","none"),_(e,"viewBox","0 0 24 24"),_(e,"stroke-width","1.5"),_(e,"stroke","currentColor"),_(e,"width","24px"),_(e,"height","24px")},m(l,t){g(l,e,t),v(e,n)},p:h,i:h,o:h,d(l){l&&f(e)}}}class It extends he{constructor(e){super(),me(this,e,null,Mn,_e,{})}}function Cn(r){let e,n;return{c(){e=Te("svg"),n=Te("path"),this.h()},l(l){e=Se(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=q(e);n=Se(t,"path",{"stroke-linecap":!0,d:!0}),q(n).forEach(f),t.forEach(f),this.h()},h(){_(n,"stroke-linecap","round"),_(n,"d","M16.5 12a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"),_(e,"xmlns","http://www.w3.org/2000/svg"),_(e,"fill","none"),_(e,"viewBox","0 0 24 24"),_(e,"stroke-width","1.5"),_(e,"stroke","currentColor"),_(e,"width","24px"),_(e,"height","24px")},m(l,t){g(l,e,t),v(e,n)},p:h,i:h,o:h,d(l){l&&f(e)}}}class In extends he{constructor(e){super(),me(this,e,null,Cn,_e,{})}}function ut(r){const e=ae(r[5]);r[6]=e}function Un(r){let e,n,l;return e=new Ce({}),{c(){ee(e.$$.fragment),n=S(`
				<UnknownUser>`)},l(t){te(e.$$.fragment,t),n=A(t,`
				<UnknownUser>`)},m(t,s){le(e,t,s),g(t,n,s),l=!0},p:h,i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){E(e.$$.fragment,t),l=!1},d(t){t&&f(n),ne(e,t)}}}function Nn(r){ut(r);let e,n,l,t,s=r[6]+"",i;return{c(){e=C("img"),t=L(),i=S(s),this.h()},l(c){e=I(c,"IMG",{class:!0,src:!0,alt:!0}),t=G(c),i=A(c,s),this.h()},h(){_(e,"class","cover svelte-zbyf5q"),W(e.src,n=pe(r[5]))||_(e,"src",n),_(e,"alt",l=r[6])},m(c,o){g(c,e,o),g(c,t,o),g(c,i,o)},p(c,o){ut(c),o&1&&!W(e.src,n=pe(c[5]))&&_(e,"src",n),o&1&&l!==(l=c[6])&&_(e,"alt",l),o&1&&s!==(s=c[6]+"")&&Q(i,s)},i:h,o:h,d(c){c&&(f(e),f(t),f(i))}}}function Tn(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function _t(r){let e,n=r[0].message.content+"",l;return{c(){e=C("p"),l=S(n),this.h()},l(t){e=I(t,"P",{class:!0});var s=q(e);l=A(s,n),s.forEach(f),this.h()},h(){_(e,"class","message-content svelte-zbyf5q")},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&1&&n!==(n=t[0].message.content+"")&&Q(l,n)},d(t){t&&f(e)}}}function Sn(r){let e,n,l,t,s,i,c,o,a,m,d,u,p,O,V=r[0].mention?"ON":"OFF",y,b,M,U,T,N,z,oe,H,P={ctx:r,current:null,token:null,hasCatch:!0,pending:Tn,then:Nn,catch:Un,value:5,blocks:[,,,]};re(s=r[2].api.fetchUser(r[0].message.author),P);let K=r[0].message.content&&_t(r);return p=new In({}),N=new It({}),{c(){e=C("div"),n=C("p"),l=S(`Replying to
		`),t=C("strong"),P.block.c(),i=L(),K&&K.c(),c=L(),o=C("div"),a=L(),m=C("label"),d=C("input"),u=L(),ee(p.$$.fragment),O=L(),y=S(V),M=L(),U=C("div"),T=C("button"),ee(N.$$.fragment),this.h()},l(D){e=I(D,"DIV",{class:!0});var X=q(e);n=I(X,"P",{});var J=q(n);l=A(J,`Replying to
		`),t=I(J,"STRONG",{});var be=q(t);P.block.l(be),be.forEach(f),J.forEach(f),i=G(X),K&&K.l(X),c=G(X),o=I(X,"DIV",{class:!0}),q(o).forEach(f),a=G(X),m=I(X,"LABEL",{class:!0,"aria-label":!0});var de=q(m);d=I(de,"INPUT",{id:!0,style:!0,type:!0}),u=G(de),te(p.$$.fragment,de),O=G(de),y=A(de,V),de.forEach(f),M=G(X),U=I(X,"DIV",{});var B=q(U);T=I(B,"BUTTON",{});var j=q(T);te(N.$$.fragment,j),j.forEach(f),B.forEach(f),X.forEach(f),this.h()},h(){_(o,"class","flex-divider"),_(d,"id","mention"),Ne(d,"display","none"),_(d,"type","checkbox"),_(m,"class","mention-button svelte-zbyf5q"),_(m,"aria-label",b="Mention author "+(r[0].mention?"ON":"OFF")),_(e,"class","container svelte-zbyf5q")},m(D,X){g(D,e,X),v(e,n),v(n,l),v(n,t),P.block.m(t,P.anchor=null),P.mount=()=>t,P.anchor=null,v(e,i),K&&K.m(e,null),v(e,c),v(e,o),v(e,a),v(e,m),v(m,d),d.checked=r[0].mention,v(m,u),le(p,m,null),v(m,O),v(m,y),v(e,M),v(e,U),v(U,T),le(N,T,null),z=!0,oe||(H=[fe(d,"change",r[3]),fe(T,"click",r[4])],oe=!0)},p(D,[X]){r=D,P.ctx=r,X&1&&s!==(s=r[2].api.fetchUser(r[0].message.author))&&re(s,P)||ge(P,r,X),r[0].message.content?K?K.p(r,X):(K=_t(r),K.c(),K.m(e,c)):K&&(K.d(1),K=null),X&1&&(d.checked=r[0].mention),(!z||X&1)&&V!==(V=r[0].mention?"ON":"OFF")&&Q(y,V),(!z||X&1&&b!==(b="Mention author "+(r[0].mention?"ON":"OFF")))&&_(m,"aria-label",b)},i(D){z||(k(P.block),k(p.$$.fragment,D),k(N.$$.fragment,D),z=!0)},o(D){for(let X=0;X<3;X+=1){const J=P.blocks[X];E(J)}E(p.$$.fragment,D),E(N.$$.fragment,D),z=!1},d(D){D&&f(e),P.block.d(),P.token=null,P=null,K&&K.d(),ne(p),ne(N),oe=!1,Ae(H)}}}function An(r,e,n){let{reply:l}=e;const t=x(we),s=x(Et);function i(){l.mention=this.checked,n(0,l)}const c=()=>s.update(o=>(o=o.filter(a=>a.message._id!=l.message._id),o));return r.$$set=o=>{"reply"in o&&n(0,l=o.reply)},[l,s,t,i,c]}class Dn extends he{constructor(e){super(),me(this,e,An,Sn,_e,{reply:0})}}function ht(r,e,n){const l=r.slice();return l[31]=e[n],l}function mt(r,e,n){const l=r.slice();return l[34]=e[n],l}function dt(r,e,n){const l=r.slice();return l[37]=e[n],l[39]=n,l}function jn(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Pn(r){let e,n,l=ue(r[9]),t=[];for(let i=0;i<l.length;i+=1)t[i]=pt(dt(r,l,i));const s=i=>E(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=R()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=R()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),n=!0},p(i,c){if(c[0]&512){l=ue(i[9]);let o;for(o=0;o<l.length;o+=1){const a=dt(i,l,o);t[o]?(t[o].p(a,c),k(t[o],1)):(t[o]=pt(a),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=l.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)k(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)E(t[c]);n=!1},d(i){i&&f(e),ye(t,i)}}}function pt(r){let e,n;return e=new En({props:{message:r[37],messageIndex:r[39]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&512&&(s.message=l[37]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function On(r){let e;return{c(){e=S("Loading...")},l(n){e=A(n,"Loading...")},m(n,l){g(n,e,l)},p:h,i:h,o:h,d(n){n&&f(e)}}}function gt(r){let e,n,l,t=Array.from(r[1]).map(yt).join(", ")+"",s,i,c,o,a,m,d,u,p;return m=new It({}),{c(){e=C("div"),n=C("p"),l=S(`Uploading
				`),s=S(t),i=L(),c=C("div"),o=L(),a=C("button"),ee(m.$$.fragment),this.h()},l(O){e=I(O,"DIV",{class:!0});var V=q(e);n=I(V,"P",{});var y=q(n);l=A(y,`Uploading
				`),s=A(y,t),y.forEach(f),i=G(V),c=I(V,"DIV",{class:!0}),q(c).forEach(f),o=G(V),a=I(V,"BUTTON",{});var b=q(a);te(m.$$.fragment,b),b.forEach(f),V.forEach(f),this.h()},h(){_(c,"class","flex-divider"),_(e,"class","flex-container")},m(O,V){g(O,e,V),v(e,n),v(n,l),v(n,s),v(e,i),v(e,c),v(e,o),v(e,a),le(m,a,null),d=!0,u||(p=fe(a,"click",r[19]),u=!0)},p(O,V){(!d||V[0]&2)&&t!==(t=Array.from(O[1]).map(yt).join(", ")+"")&&Q(s,t)},i(O){d||(k(m.$$.fragment,O),d=!0)},o(O){E(m.$$.fragment,O),d=!1},d(O){O&&f(e),ne(m),u=!1,p()}}}function bt(r){let e,n;return e=new Dn({props:{reply:r[34]}}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p(l,t){const s={};t[0]&256&&(s.reply=l[34]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function Vn(r){let e,n,l;return{c(){e=C("img"),this.h()},l(t){e=I(t,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),this.h()},h(){_(e,"class","cover"),W(e.src,n=pe(r[31]))||_(e,"src",n),_(e,"width","16px"),_(e,"height","16px"),_(e,"alt",l=ae(r[31]))},m(t,s){g(t,e,s)},p(t,s){s[0]&32&&!W(e.src,n=pe(t[31]))&&_(e,"src",n),s[0]&32&&l!==(l=ae(t[31]))&&_(e,"alt",l)},i:h,o:h,d(t){t&&f(e)}}}function qn(r){let e,n;return e=new Ce({}),{c(){ee(e.$$.fragment)},l(l){te(e.$$.fragment,l)},m(l,t){le(e,l,t),n=!0},p:h,i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){E(e.$$.fragment,l),n=!1},d(l){ne(e,l)}}}function kt(r){let e,n,l,t;const s=[qn,Vn],i=[];function c(o,a){return o[4]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=R()},l(o){n.l(o),l=R()},m(o,a){i[e].m(o,a),g(o,l,a),t=!0},p(o,a){let m=e;e=c(o),e===m?i[e].p(o,a):(Y(),E(i[m],1,1,()=>{i[m]=null}),Z(),n=i[e],n?n.p(o,a):(n=i[e]=s[e](o),n.c()),k(n,1),n.m(l.parentNode,l))},i(o){t||(k(n),t=!0)},o(o){E(n),t=!1},d(o){o&&f(l),i[e].d(o)}}}function vt(r){let e=r[14](r[5])+"",n;return{c(){n=S(e)},l(l){n=A(l,e)},m(l,t){g(l,n,t)},p(l,t){t[0]&32&&e!==(e=l[14](l[5])+"")&&Q(n,e)},d(l){l&&f(n)}}}function Bn(r){let e,n,l,t,s,i,c,o,a,m,d,u,p,O,V,y,b,M,U,T,N={ctx:r,current:null,token:null,hasCatch:!1,pending:On,then:Pn,catch:jn,blocks:[,,,]};re(l=r[3],N);let z=r[1]!=null&&r[1].length!=0&&gt(r),oe=ue(r[8]),H=[];for(let B=0;B<oe.length;B+=1)H[B]=bt(mt(r,oe,B));const P=B=>E(H[B],1,1,()=>{H[B]=null});let K=ue(r[5]),D=[];for(let B=0;B<K.length;B+=1)D[B]=kt(ht(r,K,B));const X=B=>E(D[B],1,1,()=>{D[B]=null});let J=r[5].length!=0&&vt(r);u=new Kt({});function be(B){r[22](B)}let de={sendTypingEvents:r[4]["jolt:send-typing-indicators"],placeholder:"Send message in "+r[7]};return r[0]!==void 0&&(de.value=r[0]),y=new Ct({props:de}),ve.push(()=>Ve(y,"value",be)),{c(){e=C("main"),n=C("div"),N.block.c(),t=L(),z&&z.c(),s=L();for(let B=0;B<H.length;B+=1)H[B].c();i=L(),c=C("div");for(let B=0;B<D.length;B+=1)D[B].c();o=L(),J&&J.c(),a=L(),m=C("form"),d=C("label"),ee(u.$$.fragment),p=L(),O=C("input"),V=L(),ee(y.$$.fragment),this.h()},l(B){e=I(B,"MAIN",{class:!0});var j=q(e);n=I(j,"DIV",{class:!0});var w=q(n);N.block.l(w),w.forEach(f),t=G(j),z&&z.l(j),s=G(j);for(let se=0;se<H.length;se+=1)H[se].l(j);i=G(j),c=I(j,"DIV",{class:!0});var $=q(c);for(let se=0;se<D.length;se+=1)D[se].l($);o=G($),J&&J.l($),$.forEach(f),a=G(j),m=I(j,"FORM",{class:!0,id:!0});var F=q(m);d=I(F,"LABEL",{for:!0,class:!0});var ie=q(d);te(u.$$.fragment,ie),ie.forEach(f),p=G(F),O=I(F,"INPUT",{type:!0,id:!0,max:!0,class:!0}),V=G(F),te(y.$$.fragment,F),F.forEach(f),j.forEach(f),this.h()},h(){_(n,"class","messages-list svelte-b5qazf"),_(c,"class","typing-indicator svelte-b5qazf"),_(d,"for","file-upload"),_(d,"class","svelte-b5qazf"),_(O,"type","file"),_(O,"id","file-upload"),_(O,"max","5"),_(O,"class","svelte-b5qazf"),_(m,"class","message-form"),_(m,"id","send-message-form"),_(e,"class","main-content-container svelte-b5qazf")},m(B,j){g(B,e,j),v(e,n),N.block.m(n,N.anchor=null),N.mount=()=>n,N.anchor=null,r[18](n),v(e,t),z&&z.m(e,null),v(e,s);for(let w=0;w<H.length;w+=1)H[w]&&H[w].m(e,null);v(e,i),v(e,c);for(let w=0;w<D.length;w+=1)D[w]&&D[w].m(c,null);v(c,o),J&&J.m(c,null),v(e,a),v(e,m),v(m,d),le(u,d,null),v(m,p),v(m,O),r[21](O),v(m,V),le(y,m,null),M=!0,U||(T=[fe(O,"change",r[20]),fe(m,"submit",r[13])],U=!0)},p(B,j){if(r=B,N.ctx=r,j[0]&8&&l!==(l=r[3])&&re(l,N)||ge(N,r,j),r[1]!=null&&r[1].length!=0?z?(z.p(r,j),j[0]&2&&k(z,1)):(z=gt(r),z.c(),k(z,1),z.m(e,s)):z&&(Y(),E(z,1,1,()=>{z=null}),Z()),j[0]&256){oe=ue(r[8]);let $;for($=0;$<oe.length;$+=1){const F=mt(r,oe,$);H[$]?(H[$].p(F,j),k(H[$],1)):(H[$]=bt(F),H[$].c(),k(H[$],1),H[$].m(e,i))}for(Y(),$=oe.length;$<H.length;$+=1)P($);Z()}if(j[0]&48){K=ue(r[5]);let $;for($=0;$<K.length;$+=1){const F=ht(r,K,$);D[$]?(D[$].p(F,j),k(D[$],1)):(D[$]=kt(F),D[$].c(),k(D[$],1),D[$].m(c,o))}for(Y(),$=K.length;$<D.length;$+=1)X($);Z()}r[5].length!=0?J?J.p(r,j):(J=vt(r),J.c(),J.m(c,null)):J&&(J.d(1),J=null);const w={};j[0]&16&&(w.sendTypingEvents=r[4]["jolt:send-typing-indicators"]),j[0]&128&&(w.placeholder="Send message in "+r[7]),!b&&j[0]&1&&(b=!0,w.value=r[0],Oe(()=>b=!1)),y.$set(w)},i(B){if(!M){k(N.block),k(z);for(let j=0;j<oe.length;j+=1)k(H[j]);for(let j=0;j<K.length;j+=1)k(D[j]);k(u.$$.fragment,B),k(y.$$.fragment,B),M=!0}},o(B){for(let j=0;j<3;j+=1){const w=N.blocks[j];E(w)}E(z),H=H.filter(Boolean);for(let j=0;j<H.length;j+=1)E(H[j]);D=D.filter(Boolean);for(let j=0;j<D.length;j+=1)E(D[j]);E(u.$$.fragment,B),E(y.$$.fragment,B),M=!1},d(B){B&&f(e),N.block.d(),N.token=null,N=null,r[18](null),z&&z.d(),ye(H,B),ye(D,B),J&&J.d(),ne(u),r[21](null),ne(y),U=!1,Ae(T)}}}const yt=r=>r.name;function Fn(r,e,n){let l,t,s,i;ce(r,Xt,w=>n(17,l=w));let{channel:c}=e,{replies:o=[]}=e,{messageInput:a=""}=e,{files:m=null}=e;const d=x(Me);ce(r,d,w=>n(4,s=w));const u=x(we),p=Ue([]);ce(r,p,w=>n(9,i=w));const O=Ue([]),V=Ue([]),y=Ue(o);ce(r,y,w=>n(8,t=w)),$e(qe,p),$e($t,O),$e(Be,V),$e(Et,y),$e(wt,c);let b,M=[],U,T="Unknown Channel",N=Promise.resolve();async function z(w){if(!w){u.removeAllListeners("ChannelStartTyping"),u.removeAllListeners("ChannelStopTyping");return}u.on("ChannelStartTyping",async({id:$,user:F})=>{var ie;if(!(F==((ie=u.user)==null?void 0:ie._id)||$!=c._id)){for(const{_id:se}of M)if(F==se)return;n(5,M[M.length]=await u.api.fetchUser(F),M)}}),u.on("ChannelStopTyping",({id:$,user:F})=>{$==c._id&&n(5,M=M.filter(ie=>ie._id!=F))})}async function oe(){let w=[];(U==null?void 0:U.files)!=null&&(w=await Promise.all(Array.from(U.files).map($=>u.autumn.uploadFile($))),n(6,U.value="",U),n(1,m=null)),await u.api.sendMessage(c._id,{content:a.trim(),replies:t.map(({message:{_id:$},mention:F})=>({id:$,mention:F})),attachments:w}),y.set([]),n(0,a="")}function H(w){if(w.channel!=c._id)return;const $=b.offsetHeight+b.scrollTop>b.scrollHeight-20;document.hasFocus()&&$&&u.api.ackMessage(c._id,w._id),p.update(F=>(F.push(w),F)),$&&Le().then(()=>b.scrollTo(0,b.scrollHeight))}function P({id:w,channel:$}){$==c._id&&p.update(F=>F.filter(ie=>ie._id!=w))}function K({id:w,channel:$,data:F}){$==c._id&&p.update(ie=>{const se=ie.findIndex(Ut=>Ut._id==w),Ie=ie[se];return F.content!=null&&(Ie.content=F.content),F.embeds!=null&&(Ie.embeds=F.embeds),Ie.edited=F.edited,ie[se]=Ie,ie})}Bt(()=>{u.on("Message",H),u.on("MessageDelete",P),u.on("MessageUpdate",K)}),Ft(()=>{u.removeListener("Message",H),u.removeListener("MessageDelete",P),u.removeListener("MessageUpdate",K)});async function D(w){var $;if(w.channel_type=="TextChannel"||w.channel_type=="Group"){n(7,T=`#${w.name}`);return}if(w.channel_type=="SavedMessages"){n(7,T="Saved Notes");return}try{n(7,T=`@${ae(await u.api.fetchUser(w.recipients[0]==(($=u.user)==null?void 0:$._id)?w.recipients[1]:w.recipients[0]))}`)}catch{n(7,T="Unknown Channel")}}function X(w){if(w.length==0)throw new Error("function called with an array of length 0");const $=w.map(F=>ae(F));return $.length==1?`${$[0]} is typing...`:$.length>=5?"Several users are typing...":`${$.slice(0,$.length-1).join(", ")} and ${$[$.length-1]} are typing...`}function J(w){ve[w?"unshift":"push"](()=>{b=w,n(2,b)})}const be=()=>{U!=null&&(n(6,U.value="",U),n(1,m=null))};function de(){m=this.files,n(1,m)}function B(w){ve[w?"unshift":"push"](()=>{U=w,n(6,U)})}function j(w){a=w,n(0,a)}return r.$$set=w=>{"channel"in w&&n(15,c=w.channel),"replies"in w&&n(16,o=w.replies),"messageInput"in w&&n(0,a=w.messageInput),"files"in w&&n(1,m=w.files)},r.$$.update=()=>{if(r.$$.dirty[0]&32780){const w=x(Lt);n(3,N=u.api.queryMessages(c._id,{sort:"Latest",include_users:!0,limit:100,nearby:w}).then($=>{if(Array.isArray($)){let F;w==null?F=$.reverse():F=$.sort((ie,se)=>ie._id.localeCompare(se._id)),p.set(F)}else{let F;w==null?F=$.messages.reverse():F=$.messages.sort((ie,se)=>ie._id.localeCompare(se._id)),p.set(F),V.set($.users),O.set($.members??[])}})),y.set([]),n(5,M=[]),N.then(()=>{Le().then(()=>b.scrollTo(0,b.scrollHeight))})}if(r.$$.dirty[0]&16&&z(s["jolt:receive-typing-indicators"]),r.$$.dirty[0]&32768&&D(c),r.$$.dirty[0]&131072){const w=document.getElementById(`MESSAGE-${l.url.hash.slice(1)}`);w==null||w.animate([{backgroundColor:"var(--mention)"},{backgroundColor:"var(--mention)",offset:.6},{backgroundColor:"transparent"}],{duration:3e3,iterations:1})}},[a,m,b,N,s,M,U,T,t,i,d,p,y,oe,X,c,o,l,J,be,de,B,j]}class lr extends he{constructor(e){super(),me(this,e,Fn,Bn,_e,{channel:15,replies:16,messageInput:0,files:1},null,[-1,-1])}}export{lr as T};
