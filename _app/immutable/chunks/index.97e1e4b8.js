import{s as ke,d as He,u as qe,g as ze,e as Xe,r as Oe,c as te,h as Vt,b as Ke,i as Pt,n as h,f as _e,j as Ae,o as Rt,k as Bt}from"./scheduler.9b2bc230.js";import{S as ge,i as ve,g as I,s as j,m as E,h as C,j as R,c as V,n as N,f as _,k as v,a as p,x as k,z as de,o as B,d as w,t as M,C as Lt,r as oe,u as se,v as fe,D as Dt,w as ce,A as Ie,e as q,p as ne,b as re,l as Se,y as we,E as We}from"./index.6c81ac7e.js";import{a as he,h as ie,u as be,g as pe,b as me}from"./util.591b1810.js";import{e as ue}from"./each.e59479a4.js";import{g as le,a as Ce,c as je,b as Tt}from"./context.3f5e8c52.js";import{a as At,s as Ut}from"./context.fa34f1f8.js";import{$ as De,b as Kt,c as Ft}from"./runtime.esm.a3f7b725.js";import{U as Ee}from"./UserProfilePicture.4245f318.js";import{w as Ue}from"./index.cace4c42.js";function Re(r,e,n){return new Promise((l,t)=>{n=="0".repeat(26)&&l(void 0);const o=e.find(i=>i._id==n);o==null&&r.fetchUser(n).then(l).catch(t),l(o)})}const Fe=Symbol(),St=Symbol(),Ge=Symbol(),Ot=Symbol(),Gt=r=>({}),Je=r=>({});function Ht(r){let e,n,l,t,o,i,f,s,a,u,c=r[2]("confirm")+"",m,T,X,F=r[2]("cancel")+"",U,A,W,J;const L=r[4].header,Y=He(L,r,r[3],Je),ee=r[4].default,S=He(ee,r,r[3],null);return{c(){e=I("dialog"),n=I("div"),Y&&Y.c(),l=j(),t=I("hr"),o=j(),S&&S.c(),i=j(),f=I("hr"),s=j(),a=I("form"),u=I("button"),m=E(c),T=j(),X=I("button"),U=E(F),this.h()},l(P){e=C(P,"DIALOG",{});var b=R(e);n=C(b,"DIV",{});var g=R(n);Y&&Y.l(g),l=V(g),t=C(g,"HR",{}),o=V(g),S&&S.l(g),i=V(g),f=C(g,"HR",{}),s=V(g),a=C(g,"FORM",{method:!0});var d=R(a);u=C(d,"BUTTON",{type:!0});var Q=R(u);m=N(Q,c),Q.forEach(_),T=V(d),X=C(d,"BUTTON",{type:!0});var $=R(X);U=N($,F),$.forEach(_),d.forEach(_),g.forEach(_),b.forEach(_),this.h()},h(){v(u,"type","submit"),v(X,"type","reset"),v(a,"method","dialog")},m(P,b){p(P,e,b),k(e,n),Y&&Y.m(n,null),k(n,l),k(n,t),k(n,o),S&&S.m(n,null),k(n,i),k(n,f),k(n,s),k(n,a),k(a,u),k(u,m),k(a,T),k(a,X),k(X,U),r[7](e),A=!0,W||(J=[de(X,"click",r[6]),de(a,"submit",r[5]),de(e,"close",r[8])],W=!0)},p(P,[b]){Y&&Y.p&&(!A||b&8)&&qe(Y,L,P,P[3],A?Xe(L,P[3],b,Gt):ze(P[3]),Je),S&&S.p&&(!A||b&8)&&qe(S,ee,P,P[3],A?Xe(ee,P[3],b,null):ze(P[3]),null),(!A||b&4)&&c!==(c=P[2]("confirm")+"")&&B(m,c),(!A||b&4)&&F!==(F=P[2]("cancel")+"")&&B(U,F)},i(P){A||(w(Y,P),w(S,P),A=!0)},o(P){M(Y,P),M(S,P),A=!1},d(P){P&&_(e),Y&&Y.d(P),S&&S.d(P),r[7](null),W=!1,Oe(J)}}}function qt(r,e,n){let l;te(r,De,m=>n(2,l=m));let{$$slots:t={},$$scope:o}=e,{showModal:i}=e,f;function s(m){Vt.call(this,r,m)}const a=()=>n(0,i=!1);function u(m){Ke[m?"unshift":"push"](()=>{f=m,n(1,f)})}const c=()=>n(0,i=!1);return r.$$set=m=>{"showModal"in m&&n(0,i=m.showModal),"$$scope"in m&&n(3,o=m.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(i?f==null||f.showModal():f==null||f.close())},[i,f,l,o,t,s,a,u,c]}class zt extends ge{constructor(e){super(),ve(this,e,qt,Ht,ke,{showModal:0})}}function Xt(r){let e,n="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=I("p"),e.textContent=n},l(l){e=C(l,"P",{"data-svelte-h":!0}),Ie(e)!=="svelte-os1rtp"&&(e.textContent=n)},m(l,t){p(l,e,t)},p:h,d(l){l&&_(e)}}}function Wt(r){let e,n="External Link";return{c(){e=I("h1"),e.textContent=n,this.h()},l(l){e=C(l,"H1",{class:!0,slot:!0,"data-svelte-h":!0}),Ie(e)!=="svelte-3ozcvb"&&(e.textContent=n),this.h()},h(){v(e,"class","text-3xl"),v(e,"slot","header")},m(l,t){p(l,e,t)},p:h,d(l){l&&_(e)}}}function Jt(r){let e,n,l,t,o,i,f,s;function a(c){r[2](c)}let u={$$slots:{header:[Wt],default:[Xt]},$$scope:{ctx:r}};return r[1]!==void 0&&(u.showModal=r[1]),e=new zt({props:u}),Ke.push(()=>Lt(e,"showModal",a)),e.$on("submit",r[3]),{c(){oe(e.$$.fragment),l=j(),t=I("a"),o=E(r[0]),this.h()},l(c){se(e.$$.fragment,c),l=V(c),t=C(c,"A",{href:!0,target:!0,rel:!0});var m=R(t);o=N(m,r[0]),m.forEach(_),this.h()},h(){v(t,"href",r[0]),v(t,"target","_blank"),v(t,"rel","noreferrer")},m(c,m){fe(e,c,m),p(c,l,m),p(c,t,m),k(t,o),i=!0,f||(s=de(t,"click",Dt(r[4])),f=!0)},p(c,[m]){const T={};m&32&&(T.$$scope={dirty:m,ctx:c}),!n&&m&2&&(n=!0,T.showModal=c[1],Pt(()=>n=!1)),e.$set(T),(!i||m&1)&&B(o,c[0]),(!i||m&1)&&v(t,"href",c[0])},i(c){i||(w(e.$$.fragment,c),i=!0)},o(c){M(e.$$.fragment,c),i=!1},d(c){c&&(_(l),_(t)),ce(e,c),f=!1,s()}}}function Qt(r,e,n){let{href:l}=e,t=!1;function o(s){t=s,n(1,t)}const i=()=>window.open(l),f=()=>n(1,t=!0);return r.$$set=s=>{"href"in s&&n(0,l=s.href)},[l,t,o,i,f]}class Te extends ge{constructor(e){super(),ve(this,e,Qt,Jt,ke,{href:0})}}function Yt(r){let e,n="oop website embed, can't handle that :(";return{c(){e=I("span"),e.textContent=n,this.h()},l(l){e=C(l,"SPAN",{class:!0,"data-svelte-h":!0}),Ie(e)!=="svelte-1exisih"&&(e.textContent=n),this.h()},h(){v(e,"class","text-gray-600")},m(l,t){p(l,e,t)},p:h,i:h,o:h,d(l){l&&_(e)}}}function Zt(r){let e,n,l,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&Qe(r),o=r[0].title&&Ye(r),i=r[0].description&&Ze(r);return{c(){e=I("div"),t&&t.c(),n=j(),o&&o.c(),l=j(),i&&i.c(),this.h()},l(f){e=C(f,"DIV",{style:!0});var s=R(e);t&&t.l(s),n=V(s),o&&o.l(s),l=V(s),i&&i.l(s),s.forEach(_),this.h()},h(){Se(e,"background-color",r[0].colour)},m(f,s){p(f,e,s),t&&t.m(e,null),k(e,n),o&&o.m(e,null),k(e,l),i&&i.m(e,null)},p(f,s){f[0].icon_url&&!f[1]["jolt:low-data-mode"]?t?t.p(f,s):(t=Qe(f),t.c(),t.m(e,n)):t&&(t.d(1),t=null),f[0].title?o?o.p(f,s):(o=Ye(f),o.c(),o.m(e,l)):o&&(o.d(1),o=null),f[0].description?i?i.p(f,s):(i=Ze(f),i.c(),i.m(e,null)):i&&(i.d(1),i=null),s&1&&Se(e,"background-color",f[0].colour)},i:h,o:h,d(f){f&&_(e),t&&t.d(),o&&o.d(),i&&i.d()}}}function xt(r){let e,n,l,t;const o=[ll,tl],i=[];function f(s,a){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=q()},l(s){n.l(s),l=q()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let u=e;e=f(s),e===u?i[e].p(s,a):(ne(),M(i[u],1,1,()=>{i[u]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l))},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),i[e].d(s)}}}function el(r){let e,n,l,t;const o=[rl,nl],i=[];function f(s,a){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=q()},l(s){n.l(s),l=q()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let u=e;e=f(s),e===u?i[e].p(s,a):(ne(),M(i[u],1,1,()=>{i[u]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l))},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),i[e].d(s)}}}function Qe(r){let e,n,l;return{c(){e=I("img"),this.h()},l(t){e=C(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){_e(e.src,n=r[0].icon_url)||v(e,"src",n),v(e,"alt",l=r[0].title),v(e,"width","24"),v(e,"height","24"),v(e,"class","inline aspect-square rounded-3xl")},m(t,o){p(t,e,o)},p(t,o){o&1&&!_e(e.src,n=t[0].icon_url)&&v(e,"src",n),o&1&&l!==(l=t[0].title)&&v(e,"alt",l)},d(t){t&&_(e)}}}function Ye(r){let e,n=r[0].title+"",l;return{c(){e=I("h1"),l=E(n),this.h()},l(t){e=C(t,"H1",{class:!0});var o=R(e);l=N(o,n),o.forEach(_),this.h()},h(){v(e,"class","text-gray-600")},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&1&&n!==(n=t[0].title+"")&&B(l,n)},d(t){t&&_(e)}}}function Ze(r){let e,n=r[0].description+"",l;return{c(){e=I("p"),l=E(n)},l(t){e=C(t,"P",{});var o=R(e);l=N(o,n),o.forEach(_)},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&1&&n!==(n=t[0].description+"")&&B(l,n)},d(t){t&&_(e)}}}function tl(r){let e,n,l,t,o;return{c(){e=I("video"),n=I("source"),this.h()},l(i){e=C(i,"VIDEO",{});var f=R(e);n=C(f,"SOURCE",{src:!0,width:!0,height:!0}),f.forEach(_),this.h()},h(){_e(n.src,l=r[0].url)||v(n,"src",l),v(n,"width",t=r[0].width),v(n,"height",o=r[0].height),e.controls=!0},m(i,f){p(i,e,f),k(e,n)},p(i,f){f&1&&!_e(n.src,l=i[0].url)&&v(n,"src",l),f&1&&t!==(t=i[0].width)&&v(n,"width",t),f&1&&o!==(o=i[0].height)&&v(n,"height",o)},i:h,o:h,d(i){i&&_(e)}}}function ll(r){let e,n;return e=new Te({props:{href:r[0].url}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t&1&&(o.href=l[0].url),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function nl(r){let e,n,l,t;return{c(){e=I("img"),this.h()},l(o){e=C(o,"IMG",{src:!0,width:!0,height:!0}),this.h()},h(){_e(e.src,n=r[0].url)||v(e,"src",n),v(e,"width",l=r[0].width),v(e,"height",t=r[0].height)},m(o,i){p(o,e,i)},p(o,i){i&1&&!_e(e.src,n=o[0].url)&&v(e,"src",n),i&1&&l!==(l=o[0].width)&&v(e,"width",l),i&1&&t!==(t=o[0].height)&&v(e,"height",t)},i:h,o:h,d(o){o&&_(e)}}}function rl(r){let e,n;return e=new Te({props:{href:r[0].url}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t&1&&(o.href=l[0].url),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function il(r){let e,n,l,t;const o=[el,xt,Zt,Yt],i=[];function f(s,a){return s[0].type=="Image"?0:s[0].type=="Video"?1:s[0].type=="Text"?2:s[0].type=="Website"?3:-1}return~(e=f(r))&&(n=i[e]=o[e](r)),{c(){n&&n.c(),l=q()},l(s){n&&n.l(s),l=q()},m(s,a){~e&&i[e].m(s,a),p(s,l,a),t=!0},p(s,[a]){let u=e;e=f(s),e===u?~e&&i[e].p(s,a):(n&&(ne(),M(i[u],1,1,()=>{i[u]=null}),re()),~e?(n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l)):n=null)},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),~e&&i[e].d(s)}}}function ol(r,e,n){let l,{embed:t}=e;const o=le(Ce);return te(r,o,i=>n(1,l=i)),r.$$set=i=>{"embed"in i&&n(0,t=i.embed)},[t,l,o]}class sl extends ge{constructor(e){super(),ve(this,e,ol,il,ke,{embed:0})}}function fl(r){let e,n,l,t;const o=[ml,hl],i=[];function f(s,a){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=q()},l(s){n.l(s),l=q()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let u=e;e=f(s),e===u?i[e].p(s,a):(ne(),M(i[u],1,1,()=>{i[u]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l))},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),i[e].d(s)}}}function cl(r){let e,n,l=r[0].filename+"",t,o,i,f;return i=new Te({props:{href:he(r[0])}}),{c(){e=I("span"),n=E("[File "),t=E(l),o=E(`]
			`),oe(i.$$.fragment),this.h()},l(s){e=C(s,"SPAN",{class:!0});var a=R(e);n=N(a,"[File "),t=N(a,l),o=N(a,`]
			`),se(i.$$.fragment,a),a.forEach(_),this.h()},h(){v(e,"class","text-gray-500")},m(s,a){p(s,e,a),k(e,n),k(e,t),k(e,o),fe(i,e,null),f=!0},p(s,a){(!f||a&1)&&l!==(l=s[0].filename+"")&&B(t,l);const u={};a&1&&(u.href=he(s[0])),i.$set(u)},i(s){f||(w(i.$$.fragment,s),f=!0)},o(s){M(i.$$.fragment,s),f=!1},d(s){s&&_(e),ce(i)}}}function al(r){let e,n,l;return{c(){e=I("audio"),n=I("source"),this.h()},l(t){e=C(t,"AUDIO",{});var o=R(e);n=C(o,"SOURCE",{src:!0}),o.forEach(_),this.h()},h(){_e(n.src,l=he(r[0]))||v(n,"src",l),e.controls=!0},m(t,o){p(t,e,o),k(e,n)},p(t,o){o&1&&!_e(n.src,l=he(t[0]))&&v(n,"src",l)},i:h,o:h,d(t){t&&_(e)}}}function ul(r){let e,n,l;return{c(){e=I("video"),n=I("source"),this.h()},l(t){e=C(t,"VIDEO",{});var o=R(e);n=C(o,"SOURCE",{src:!0}),o.forEach(_),this.h()},h(){_e(n.src,l=he(r[0]))||v(n,"src",l),e.controls=!0},m(t,o){p(t,e,o),k(e,n)},p(t,o){o&1&&!_e(n.src,l=he(t[0]))&&v(n,"src",l)},i:h,o:h,d(t){t&&_(e)}}}function _l(r){let e,n,l,t;const o=[wl,$l],i=[];function f(s,a){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=q()},l(s){n.l(s),l=q()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let u=e;e=f(s),e===u?i[e].p(s,a):(ne(),M(i[u],1,1,()=>{i[u]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l))},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),i[e].d(s)}}}function hl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!0,pending:vl,then:pl,catch:dl,value:4,error:6};return ie(n=fetch(he(r[0])),l),{c(){e=q(),l.block.c()},l(t){e=q(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=fetch(he(r[0])))&&ie(n,l)||be(l,r,o)},i:h,o:h,d(t){t&&_(e),l.block.d(t),l.token=null,l=null}}}function ml(r){let e,n,l,t,o;return l=new Te({props:{href:he(r[0])}}),{c(){e=I("span"),n=E("[Text "),oe(l.$$.fragment),t=E("]"),this.h()},l(i){e=C(i,"SPAN",{class:!0});var f=R(e);n=N(f,"[Text "),se(l.$$.fragment,f),t=N(f,"]"),f.forEach(_),this.h()},h(){v(e,"class","text-gray-500")},m(i,f){p(i,e,f),k(e,n),fe(l,e,null),k(e,t),o=!0},p(i,f){const s={};f&1&&(s.href=he(i[0])),l.$set(s)},i(i){o||(w(l.$$.fragment,i),o=!0)},o(i){M(l.$$.fragment,i),o=!1},d(i){i&&_(e),ce(l)}}}function dl(r){let e,n=r[2]("file.download.error")+"",l,t,o=r[0].filename+"",i,f,s=r[6]+"",a;return{c(){e=I("p"),l=E(n),t=j(),i=E(o),f=E(": "),a=E(s)},l(u){e=C(u,"P",{});var c=R(e);l=N(c,n),t=V(c),i=N(c,o),f=N(c,": "),a=N(c,s),c.forEach(_)},m(u,c){p(u,e,c),k(e,l),k(e,t),k(e,i),k(e,f),k(e,a)},p(u,c){c&4&&n!==(n=u[2]("file.download.error")+"")&&B(l,n),c&1&&o!==(o=u[0].filename+"")&&B(i,o),c&1&&s!==(s=u[6]+"")&&B(a,s)},d(u){u&&_(e)}}}function pl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:gl,then:kl,catch:bl,value:5};return ie(n=r[4].text(),l),{c(){e=q(),l.block.c()},l(t){e=q(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=r[4].text())&&ie(n,l)||be(l,r,o)},d(t){t&&_(e),l.block.d(t),l.token=null,l=null}}}function bl(r){return{c:h,l:h,m:h,p:h,d:h}}function kl(r){let e,n=r[5]+"",l;return{c(){e=I("p"),l=E(n)},l(t){e=C(t,"P",{});var o=R(e);l=N(o,n),o.forEach(_)},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&1&&n!==(n=t[5]+"")&&B(l,n)},d(t){t&&_(e)}}}function gl(r){return{c:h,l:h,m:h,p:h,d:h}}function vl(r){return{c:h,l:h,m:h,p:h,d:h}}function $l(r){let e,n,l;return{c(){e=I("img"),this.h()},l(t){e=C(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){_e(e.src,n=he(r[0]))||v(e,"src",n),v(e,"alt",l=r[0].filename),v(e,"class","max-w-xl max-h-xl")},m(t,o){p(t,e,o)},p(t,o){o&1&&!_e(e.src,n=he(t[0]))&&v(e,"src",n),o&1&&l!==(l=t[0].filename)&&v(e,"alt",l)},i:h,o:h,d(t){t&&_(e)}}}function wl(r){let e,n,l,t,o;return l=new Te({props:{href:he(r[0])}}),{c(){e=I("span"),n=E("[Image "),oe(l.$$.fragment),t=E("]"),this.h()},l(i){e=C(i,"SPAN",{class:!0});var f=R(e);n=N(f,"[Image "),se(l.$$.fragment,f),t=N(f,"]"),f.forEach(_),this.h()},h(){v(e,"class","text-gray-500")},m(i,f){p(i,e,f),k(e,n),fe(l,e,null),k(e,t),o=!0},p(i,f){const s={};f&1&&(s.href=he(i[0])),l.$set(s)},i(i){o||(w(l.$$.fragment,i),o=!0)},o(i){M(l.$$.fragment,i),o=!1},d(i){i&&_(e),ce(l)}}}function yl(r){let e,n,l,t;const o=[_l,ul,al,cl,fl],i=[];function f(s,a){return s[0].metadata.type=="Image"?0:s[0].metadata.type=="Video"?1:s[0].metadata.type=="Audio"?2:s[0].metadata.type=="File"?3:s[0].metadata.type=="Text"?4:-1}return~(n=f(r))&&(l=i[n]=o[n](r)),{c(){e=I("div"),l&&l.c()},l(s){e=C(s,"DIV",{});var a=R(e);l&&l.l(a),a.forEach(_)},m(s,a){p(s,e,a),~n&&i[n].m(e,null),t=!0},p(s,[a]){let u=n;n=f(s),n===u?~n&&i[n].p(s,a):(l&&(ne(),M(i[u],1,1,()=>{i[u]=null}),re()),~n?(l=i[n],l?l.p(s,a):(l=i[n]=o[n](s),l.c()),w(l,1),l.m(e,null)):l=null)},i(s){t||(w(l),t=!0)},o(s){M(l),t=!1},d(s){s&&_(e),~n&&i[n].d()}}}function El(r,e,n){let l,t;te(r,De,f=>n(2,t=f));const o=le(Ce);te(r,o,f=>n(1,l=f));let{attachment:i}=e;return r.$$set=f=>{"attachment"in f&&n(0,i=f.attachment)},[i,l,t,o]}class Nl extends ge{constructor(e){super(),ve(this,e,El,yl,ke,{attachment:0})}}function xe(r){const e=me(r[4]);r[5]=e}function et(r){r[6]=r[8][0],r[7]=r[8][1]}function tt(r){const e=me(r[4]);r[5]=e}function Ml(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Vl,then:Al,catch:Tl,value:4,blocks:[,,,]};return ie(n=r[2].api.fetchUser(r[0].id),t),{c(){e=q(),t.block.c()},l(o){e=q(),t.block.l(o)},m(o,i){p(o,e,i),t.block.m(o,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,i){r=o,t.ctx=r,i&1&&n!==(n=r[2].api.fetchUser(r[0].id))&&ie(n,t)||be(t,r,i)},i(o){l||(w(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];M(f)}l=!1},d(o){o&&_(e),t.block.d(o),t.token=null,t=null}}}function Il(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Bl,then:Rl,catch:Pl,value:8};return ie(n=Promise.all([r[0].from,r[0].to].map(r[3])),l),{c(){e=q(),l.block.c()},l(t){e=q(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=Promise.all([r[0].from,r[0].to].map(r[3])))&&ie(n,l)||be(l,r,o)},i:h,o:h,d(t){t&&_(e),l.block.d(t),l.token=null,l=null}}}function Cl(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Yl,then:Kl,catch:Ll,value:4,blocks:[,,,]};return ie(n=r[2].api.fetchUser(r[0].by),t),{c(){e=q(),t.block.c()},l(o){e=q(),t.block.l(o)},m(o,i){p(o,e,i),t.block.m(o,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,i){r=o,t.ctx=r,i&1&&n!==(n=r[2].api.fetchUser(r[0].by))&&ie(n,t)||be(t,r,i)},i(o){l||(w(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];M(f)}l=!1},d(o){o&&_(e),t.block.d(o),t.token=null,t=null}}}function Dl(r){let e=r[0].content+"",n;return{c(){n=E(e)},l(l){n=N(l,e)},m(l,t){p(l,n,t)},p(l,t){t&1&&e!==(e=l[0].content+"")&&B(n,e)},i:h,o:h,d(l){l&&_(n)}}}function Tl(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Al(r){xe(r);let e,n,l=r[5]+"",t,o,i,f;e=new Ee({props:{src:pe(r[4]),width:24,height:24,name:r[5]}});function s(c,m){if(c[0].type=="user_banned")return jl;if(c[0].type=="user_joined")return Ol;if(c[0].type=="user_kicked")return Sl;if(c[0].type=="user_left")return Ul}let a=s(r),u=a&&a(r);return{c(){oe(e.$$.fragment),n=j(),t=E(l),o=j(),u&&u.c(),i=q()},l(c){se(e.$$.fragment,c),n=V(c),t=N(c,l),o=V(c),u&&u.l(c),i=q()},m(c,m){fe(e,c,m),p(c,n,m),p(c,t,m),p(c,o,m),u&&u.m(c,m),p(c,i,m),f=!0},p(c,m){xe(c);const T={};m&1&&(T.src=pe(c[4])),m&1&&(T.name=c[5]),e.$set(T),(!f||m&1)&&l!==(l=c[5]+"")&&B(t,l),a===(a=s(c))&&u?u.p(c,m):(u&&u.d(1),u=a&&a(c),u&&(u.c(),u.m(i.parentNode,i)))},i(c){f||(w(e.$$.fragment,c),f=!0)},o(c){M(e.$$.fragment,c),f=!1},d(c){c&&(_(n),_(t),_(o),_(i)),ce(e,c),u&&u.d(c)}}}function Ul(r){let e=r[1]("user.chat.left")+"",n,l;return{c(){n=E(e),l=E(".")},l(t){n=N(t,e),l=N(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.chat.left")+"")&&B(n,e)},d(t){t&&(_(n),_(l))}}}function Sl(r){let e=r[1]("user.was-kicked")+"",n,l;return{c(){n=E(e),l=E(".")},l(t){n=N(t,e),l=N(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.was-kicked")+"")&&B(n,e)},d(t){t&&(_(n),_(l))}}}function Ol(r){let e=r[1]("user.chat.joined")+"",n,l;return{c(){n=E(e),l=E(".")},l(t){n=N(t,e),l=N(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.chat.joined")+"")&&B(n,e)},d(t){t&&(_(n),_(l))}}}function jl(r){let e=r[1]("user.was-banned")+"",n,l;return{c(){n=E(e),l=E(".")},l(t){n=N(t,e),l=N(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.was-banned")+"")&&B(n,e)},d(t){t&&(_(n),_(l))}}}function Vl(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Pl(r){return{c:h,l:h,m:h,p:h,d:h}}function Rl(r){et(r);let e=r[1]("channel.ownership.changed-from")+"",n,l,t=me(r[6])+"",o,i,f=me(r[7])+"",s,a;return{c(){n=E(e),l=j(),o=E(t),i=E(" to "),s=E(f),a=E(".")},l(u){n=N(u,e),l=V(u),o=N(u,t),i=N(u," to "),s=N(u,f),a=N(u,".")},m(u,c){p(u,n,c),p(u,l,c),p(u,o,c),p(u,i,c),p(u,s,c),p(u,a,c)},p(u,c){et(u),c&2&&e!==(e=u[1]("channel.ownership.changed-from")+"")&&B(n,e),c&1&&t!==(t=me(u[6])+"")&&B(o,t),c&1&&f!==(f=me(u[7])+"")&&B(s,f)},d(u){u&&(_(n),_(l),_(o),_(i),_(s),_(a))}}}function Bl(r){return{c:h,l:h,m:h,p:h,d:h}}function Ll(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Kl(r){tt(r);let e,n,l=r[5]+"",t,o,i,f;e=new Ee({props:{src:pe(r[4]),width:24,height:24,name:r[5]}});function s(c,m){if(c[0].type=="channel_description_changed")return ql;if(c[0].type=="channel_icon_changed")return Hl;if(c[0].type=="channel_renamed")return Gl;if(c[0].type=="user_added"||c[0].type=="user_remove")return Fl}let a=s(r),u=a&&a(r);return{c(){oe(e.$$.fragment),n=j(),t=E(l),o=j(),u&&u.c(),i=q()},l(c){se(e.$$.fragment,c),n=V(c),t=N(c,l),o=V(c),u&&u.l(c),i=q()},m(c,m){fe(e,c,m),p(c,n,m),p(c,t,m),p(c,o,m),u&&u.m(c,m),p(c,i,m),f=!0},p(c,m){tt(c);const T={};m&1&&(T.src=pe(c[4])),m&1&&(T.name=c[5]),e.$set(T),(!f||m&1)&&l!==(l=c[5]+"")&&B(t,l),a===(a=s(c))&&u?u.p(c,m):(u&&u.d(1),u=a&&a(c),u&&(u.c(),u.m(i.parentNode,i)))},i(c){f||(w(e.$$.fragment,c),f=!0)},o(c){M(e.$$.fragment,c),f=!1},d(c){c&&(_(n),_(t),_(o),_(i)),ce(e,c),u&&u.d(c)}}}function Fl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Ql,then:Xl,catch:zl,value:4};return ie(n=r[2].api.fetchUser(r[0].id),l),{c(){e=q(),l.block.c()},l(t){e=q(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=r[2].api.fetchUser(r[0].id))&&ie(n,l)||be(l,r,o)},d(t){t&&_(e),l.block.d(t),l.token=null,l=null}}}function Gl(r){let e=r[1]("channel.rename-to")+"",n,l,t=r[0].name+"",o,i;return{c(){n=E(e),l=j(),o=E(t),i=E(".")},l(f){n=N(f,e),l=V(f),o=N(f,t),i=N(f,".")},m(f,s){p(f,n,s),p(f,l,s),p(f,o,s),p(f,i,s)},p(f,s){s&2&&e!==(e=f[1]("channel.rename-to")+"")&&B(n,e),s&1&&t!==(t=f[0].name+"")&&B(o,t)},d(f){f&&(_(n),_(l),_(o),_(i))}}}function Hl(r){let e=r[1]("channel.icon.change")+"",n,l;return{c(){n=E(e),l=E(".")},l(t){n=N(t,e),l=N(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("channel.icon.change")+"")&&B(n,e)},d(t){t&&(_(n),_(l))}}}function ql(r){let e=r[1]("channel.description.change")+"",n,l;return{c(){n=E(e),l=E(".")},l(t){n=N(t,e),l=N(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("channel.description.change")+"")&&B(n,e)},d(t){t&&(_(n),_(l))}}}function zl(r){return{c:h,l:h,m:h,p:h,d:h}}function Xl(r){let e,n=me(r[4])+"",l,t;function o(s,a){if(s[0].type=="user_added")return Jl;if(s[0].type=="user_remove")return Wl}let i=o(r),f=i&&i(r);return{c(){f&&f.c(),e=j(),l=E(n),t=E(".")},l(s){f&&f.l(s),e=V(s),l=N(s,n),t=N(s,".")},m(s,a){f&&f.m(s,a),p(s,e,a),p(s,l,a),p(s,t,a)},p(s,a){i===(i=o(s))&&f?f.p(s,a):(f&&f.d(1),f=i&&i(s),f&&(f.c(),f.m(e.parentNode,e))),a&1&&n!==(n=me(s[4])+"")&&B(l,n)},d(s){s&&(_(e),_(l),_(t)),f&&f.d(s)}}}function Wl(r){let e=r[1]("removed")+"",n;return{c(){n=E(e)},l(l){n=N(l,e)},m(l,t){p(l,n,t)},p(l,t){t&2&&e!==(e=l[1]("removed")+"")&&B(n,e)},d(l){l&&_(n)}}}function Jl(r){let e=r[1]("added")+"",n;return{c(){n=E(e)},l(l){n=N(l,e)},m(l,t){p(l,n,t)},p(l,t){t&2&&e!==(e=l[1]("added")+"")&&B(n,e)},d(l){l&&_(n)}}}function Ql(r){return{c:h,l:h,m:h,p:h,d:h}}function Yl(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Zl(r){let e,n,l,t;const o=[Dl,Cl,Il,Ml],i=[];function f(s,a){return s[0].type=="text"?0:s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove"?1:s[0].type=="channel_ownership_changed"?2:s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left"?3:-1}return~(e=f(r))&&(n=i[e]=o[e](r)),{c(){n&&n.c(),l=q()},l(s){n&&n.l(s),l=q()},m(s,a){~e&&i[e].m(s,a),p(s,l,a),t=!0},p(s,[a]){let u=e;e=f(s),e===u?~e&&i[e].p(s,a):(n&&(ne(),M(i[u],1,1,()=>{i[u]=null}),re()),~e?(n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),w(n,1),n.m(l.parentNode,l)):n=null)},i(s){t||(w(n),t=!0)},o(s){M(n),t=!1},d(s){s&&_(l),~e&&i[e].d(s)}}}function xl(r,e,n){let l;te(r,De,f=>n(1,l=f));const t=le(je);let{system:o}=e;const i=f=>t.api.fetchUser(f);return r.$$set=f=>{"system"in f&&n(0,o=f.system)},[o,l,t,i]}class en extends ge{constructor(e){super(),ve(this,e,xl,Zl,ke,{system:0})}}function ye(r){var e=new Error(r);return e.source="ulid",e}var Ve="0123456789ABCDEFGHJKMNPQRSTVWXYZ",Me=Ve.length,Be=Math.pow(2,48)-1,Le=10,jt=16;function tn(r){var e=Math.floor(r()*Me);return e===Me&&(e=Me-1),Ve.charAt(e)}function ln(r,e){if(isNaN(r))throw new Error(r+" must be a number");if(r>Be)throw ye("cannot encode time greater than "+Be);if(r<0)throw ye("time must be positive");if(Number.isInteger(r)===!1)throw ye("time must be an integer");for(var n=void 0,l="";e>0;e--)n=r%Me,l=Ve.charAt(n)+l,r=(r-n)/Me;return l}function nn(r,e){for(var n="";r>0;r--)n=tn(e)+n;return n}function rn(r){if(r.length!==Le+jt)throw ye("malformed ulid");var e=r.substr(0,Le).split("").reverse().reduce(function(n,l,t){var o=Ve.indexOf(l);if(o===-1)throw ye("invalid character found: "+l);return n+=o*Math.pow(Me,t)},0);if(e>Be)throw ye("malformed ulid, timestamp too large");return e}function on(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=arguments[1];e||(e=typeof window<"u"?window:null);var n=e&&(e.crypto||e.msCrypto);if(n)return function(){var t=new Uint8Array(1);return n.getRandomValues(t),t[0]/255};try{var l=require("crypto");return function(){return l.randomBytes(1).readUInt8()/255}}catch{}if(r){try{console.error("secure crypto unusable, falling back to insecure Math.random()!")}catch{}return function(){return Math.random()}}throw ye("secure crypto unusable, insecure Math.random not allowed")}function sn(r){return r||(r=on()),function(n){return isNaN(n)&&(n=Date.now()),ln(n,Le)+nn(jt,r)}}sn();function lt(r){const e=me(r[14]);r[15]=e}function nt(r){var o;let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:hn,then:cn,catch:fn,value:13,blocks:[,,,]};return ie(n=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),t),{c(){e=q(),t.block.c()},l(i){e=q(),t.block.l(i)},m(i,f){p(i,e,f),t.block.m(i,t.anchor=f),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(i,f){var s;r=i,t.ctx=r,f&13&&n!==(n=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&ie(n,t)||be(t,r,f)},i(i){l||(w(t.block),l=!0)},o(i){for(let f=0;f<3;f+=1){const s=t.blocks[f];M(s)}l=!1},d(i){i&&_(e),t.block.d(i),t.token=null,t=null}}}function fn(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function cn(r){let e,n,l,t=!r[4]["jolt:low-data-mode"]&&rt(r),o=r[13].content!=null&&it(r);return{c(){t&&t.c(),e=j(),o&&o.c(),n=q()},l(i){t&&t.l(i),e=V(i),o&&o.l(i),n=q()},m(i,f){t&&t.m(i,f),p(i,e,f),o&&o.m(i,f),p(i,n,f),l=!0},p(i,f){i[4]["jolt:low-data-mode"]?t&&(ne(),M(t,1,1,()=>{t=null}),re()):t?(t.p(i,f),f&16&&w(t,1)):(t=rt(i),t.c(),w(t,1),t.m(e.parentNode,e)),i[13].content!=null?o?o.p(i,f):(o=it(i),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i(i){l||(w(t),l=!0)},o(i){M(t),l=!1},d(i){i&&(_(e),_(n)),t&&t.d(i),o&&o.d(i)}}}function rt(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:_n,then:un,catch:an,value:14,blocks:[,,,]};return ie(e=Re(r[6].api,r[5]??[],r[13].author),t),{c(){t.block.c(),n=E(":")},l(o){t.block.l(o),n=N(o,":")},m(o,i){t.block.m(o,t.anchor=i),t.mount=()=>n.parentNode,t.anchor=n,p(o,n,i),l=!0},p(o,i){r=o,t.ctx=r,i&45&&e!==(e=Re(r[6].api,r[5]??[],r[13].author))&&ie(e,t)||be(t,r,i)},i(o){l||(w(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];M(f)}l=!1},d(o){o&&_(n),t.block.d(o),t.token=null,t=null}}}function an(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function un(r){lt(r);let e,n,l=r[15]+"",t,o,i;return e=new Ee({props:{src:pe(r[14]),name:r[15],width:24,height:24}}),{c(){oe(e.$$.fragment),n=j(),t=E(l),o=j()},l(f){se(e.$$.fragment,f),n=V(f),t=N(f,l),o=V(f)},m(f,s){fe(e,f,s),p(f,n,s),p(f,t,s),p(f,o,s),i=!0},p(f,s){lt(f);const a={};s&45&&(a.src=pe(f[14])),s&45&&(a.name=f[15]),e.$set(a),(!i||s&45)&&l!==(l=f[15]+"")&&B(t,l)},i(f){i||(w(e.$$.fragment,f),i=!0)},o(f){M(e.$$.fragment,f),i=!1},d(f){f&&(_(n),_(t),_(o)),ce(e,f)}}}function _n(r){let e;return{c(){e=E(`<Unknown User>
				`)},l(n){e=N(n,`<Unknown User>
				`)},m(n,l){p(n,e,l)},p:h,i:h,o:h,d(n){n&&_(e)}}}function it(r){let e,n=r[13].content+"",l;return{c(){e=I("span"),l=E(n),this.h()},l(t){e=C(t,"SPAN",{class:!0});var o=R(e);l=N(o,n),o.forEach(_),this.h()},h(){v(e,"class","text-gray-600")},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&13&&n!==(n=t[13].content+"")&&B(l,n)},d(t){t&&_(e)}}}function hn(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function mn(r){let e,n,l,t=r[2]!=null&&nt(r);return{c(){e=I("a"),t&&t.c(),this.h()},l(o){e=C(o,"A",{href:!0});var i=R(e);t&&t.l(i),i.forEach(_),this.h()},h(){v(e,"href",n=r[1]==null?`/channels/${r[2]}#${r[0]}`:`/servers/${r[1]}/channels/${r[2]}#${r[0]}`)},m(o,i){p(o,e,i),t&&t.m(e,null),l=!0},p(o,[i]){o[2]!=null?t?(t.p(o,i),i&4&&w(t,1)):(t=nt(o),t.c(),w(t,1),t.m(e,null)):t&&(ne(),M(t,1,1,()=>{t=null}),re()),(!l||i&7&&n!==(n=o[1]==null?`/channels/${o[2]}#${o[0]}`:`/servers/${o[1]}/channels/${o[2]}#${o[0]}`))&&v(e,"href",n)},i(o){l||(w(t),l=!0)},o(o){M(t),l=!1},d(o){o&&_(e),t&&t.d()}}}function dn(r,e,n){let l,t,o,i,f;const s=le(je),a=le(Ce);te(r,a,U=>n(4,i=U));const u=le(At);te(r,u,U=>n(1,l=U));const c=le(Ut);te(r,c,U=>n(2,t=U));const m=le(Fe);te(r,m,U=>n(3,o=U));const T=le(Ge);te(r,T,U=>n(5,f=U));let{id:X}=e;const F=({_id:U})=>X==U;return r.$$set=U=>{"id"in U&&n(0,X=U.id)},[X,l,t,o,i,f,s,a,u,c,m,T,F]}class pn extends ge{constructor(e){super(),ve(this,e,dn,mn,ke,{id:0})}}function ot(r,e,n){const l=r.slice();return l[31]=e[n],l}function st(r,e,n){const l=r.slice();return l[34]=e[n],l}function ft(r,e,n){const l=r.slice();return l[37]=e[n].src,l[38]=e[n].alt,l[39]=e[n].onclick,l[40]=e[n].showIf,l}function Pe(r){const e=r.slice(),n=new Date(e[0].edited);return e[8]=n,e}function ct(r,e,n){const l=r.slice();return l[43]=e[n],l}function at(r){let e,n,l=ue(r[0].replies),t=[];for(let i=0;i<l.length;i+=1)t[i]=ut(ct(r,l,i));const o=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){e=I("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=C(i,"DIV",{class:!0});var f=R(e);for(let s=0;s<t.length;s+=1)t[s].l(f);f.forEach(_),this.h()},h(){v(e,"class","flex flex-col")},m(i,f){p(i,e,f);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null);n=!0},p(i,f){if(f[0]&1){l=ue(i[0].replies);let s;for(s=0;s<l.length;s+=1){const a=ct(i,l,s);t[s]?(t[s].p(a,f),w(t[s],1)):(t[s]=ut(a),t[s].c(),w(t[s],1),t[s].m(e,null))}for(ne(),s=l.length;s<t.length;s+=1)o(s);re()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)w(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)M(t[f]);n=!1},d(i){i&&_(e),we(t,i)}}}function ut(r){let e,n;return e=new pn({props:{id:r[43]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.id=l[43]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function _t(r){let e,n;return e=new Ee({props:{name:r[4],src:r[3],width:40,height:40}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&16&&(o.name=l[4]),t[0]&8&&(o.src=l[3]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function ht(r){let e,n=r[5]("message.edited")+"",l,t,o=r[6](r[8])+"",i,f,s=r[7](r[8])+"",a,u;return{c(){e=E("["),l=E(n),t=j(),i=E(o),f=j(),a=E(s),u=E("]")},l(c){e=N(c,"["),l=N(c,n),t=V(c),i=N(c,o),f=V(c),a=N(c,s),u=N(c,"]")},m(c,m){p(c,e,m),p(c,l,m),p(c,t,m),p(c,i,m),p(c,f,m),p(c,a,m),p(c,u,m)},p(c,m){m[0]&32&&n!==(n=c[5]("message.edited")+"")&&B(l,n),m[0]&65&&o!==(o=c[6](c[8])+"")&&B(i,o),m[0]&129&&s!==(s=c[7](c[8])+"")&&B(a,s)},d(c){c&&(_(e),_(l),_(t),_(i),_(f),_(a),_(u))}}}function mt(r){let e,n,l,t,o,i;function f(){return r[21](r[39])}return{c(){e=I("button"),n=I("img"),t=j(),this.h()},l(s){e=C(s,"BUTTON",{class:!0,"aria-label":!0});var a=R(e);n=C(a,"IMG",{width:!0,height:!0,src:!0,alt:!0}),t=V(a),a.forEach(_),this.h()},h(){v(n,"width","16"),v(n,"height","16"),_e(n.src,l=r[37])||v(n,"src",l),v(n,"alt",r[38]),v(e,"class","ml-2"),v(e,"aria-label",r[38])},m(s,a){p(s,e,a),k(e,n),k(e,t),o||(i=de(e,"click",f),o=!0)},p(s,a){r=s},d(s){s&&_(e),o=!1,i()}}}function dt(r){var t;let e=((t=r[40])==null?void 0:t.call(r,r[0]))??!0,n,l=e&&mt(r);return{c(){l&&l.c(),n=q()},l(o){l&&l.l(o),n=q()},m(o,i){l&&l.m(o,i),p(o,n,i)},p(o,i){var f;i[0]&1&&(e=((f=o[40])==null?void 0:f.call(o,o[0]))??!0),e?l?l.p(o,i):(l=mt(o),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(o){o&&_(n),l&&l.d(o)}}}function bn(r){let e,n=r[0].content+"",l;return{c(){e=I("span"),l=E(n),this.h()},l(t){e=C(t,"SPAN",{style:!0,class:!0});var o=R(e);l=N(o,n),o.forEach(_),this.h()},h(){Se(e,"overflow-wrap","break-word"),v(e,"class","whitespace-pre-wrap")},m(t,o){p(t,e,o),k(e,l)},p(t,o){o[0]&1&&n!==(n=t[0].content+"")&&B(l,n)},d(t){t&&_(e)}}}function kn(r){let e,n,l,t;return{c(){e=I("form"),n=I("textarea"),this.h()},l(o){e=C(o,"FORM",{class:!0});var i=R(e);n=C(i,"TEXTAREA",{class:!0,placeholder:!0}),R(n).forEach(_),i.forEach(_),this.h()},h(){v(n,"class","outline-none resize-none bg-inherit w-full"),v(n,"placeholder","Edit this message"),v(e,"class","bg-gray-500 rounded-xl px-2 pt-2")},m(o,i){p(o,e,i),k(e,n),We(n,r[2]),l||(t=[de(n,"keydown",r[22]),de(n,"input",r[23]),de(e,"submit",r[16])],l=!0)},p(o,i){i[0]&4&&We(n,o[2])},d(o){o&&_(e),l=!1,Oe(t)}}}function pt(r){let e,n;return e=new en({props:{system:r[0].system}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.system=l[0].system),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function bt(r){let e,n,l=ue(r[0].attachments),t=[];for(let i=0;i<l.length;i+=1)t[i]=kt(st(r,l,i));const o=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=q()},l(i){for(let f=0;f<t.length;f+=1)t[f].l(i);e=q()},m(i,f){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,f);p(i,e,f),n=!0},p(i,f){if(f[0]&1){l=ue(i[0].attachments);let s;for(s=0;s<l.length;s+=1){const a=st(i,l,s);t[s]?(t[s].p(a,f),w(t[s],1)):(t[s]=kt(a),t[s].c(),w(t[s],1),t[s].m(e.parentNode,e))}for(ne(),s=l.length;s<t.length;s+=1)o(s);re()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)w(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)M(t[f]);n=!1},d(i){i&&_(e),we(t,i)}}}function kt(r){let e,n;return e=new Nl({props:{attachment:r[34]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.attachment=l[34]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function gt(r){let e,n,l=ue(r[0].embeds),t=[];for(let i=0;i<l.length;i+=1)t[i]=vt(ot(r,l,i));const o=i=>M(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=q()},l(i){for(let f=0;f<t.length;f+=1)t[f].l(i);e=q()},m(i,f){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,f);p(i,e,f),n=!0},p(i,f){if(f[0]&1){l=ue(i[0].embeds);let s;for(s=0;s<l.length;s+=1){const a=ot(i,l,s);t[s]?(t[s].p(a,f),w(t[s],1)):(t[s]=vt(a),t[s].c(),w(t[s],1),t[s].m(e.parentNode,e))}for(ne(),s=l.length;s<t.length;s+=1)o(s);re()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)w(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)M(t[f]);n=!1},d(i){i&&_(e),we(t,i)}}}function vt(r){let e,n;return e=new sl({props:{embed:r[31]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.embed=l[31]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function gn(r){let e,n,l,t,o,i,f,s,a=r[6](r[8])+"",u,c,m=r[7](r[8])+"",T,X,F,U,A,W,J,L,Y,ee,S,P,b=r[0].replies!=null&&r[0].replies.length!=0&&at(r),g=!r[1]["jolt:compact-mode"]&&_t(r),d=r[0].edited!=null&&ht(Pe(r)),Q=ue(r[15]),$=[];for(let D=0;D<Q.length;D+=1)$[D]=dt(ft(r,Q,D));function H(D,z){if(D[2]!=null)return kn;if(D[0].content!=null)return bn}let G=H(r),Z=G&&G(r),y=r[0].system!=null&&pt(r),K=r[0].attachments!=null&&bt(r),O=r[0].embeds!=null&&gt(r);return{c(){e=I("div"),b&&b.c(),n=j(),l=I("div"),g&&g.c(),t=j(),o=E(r[4]),i=j(),f=I("p"),s=E("["),u=E(a),c=j(),T=E(m),X=E(`]

			`),d&&d.c(),F=j(),U=I("div"),A=j(),W=I("div");for(let D=0;D<$.length;D+=1)$[D].c();J=j(),Z&&Z.c(),L=j(),y&&y.c(),Y=j(),K&&K.c(),ee=j(),O&&O.c(),this.h()},l(D){e=C(D,"DIV",{id:!0,class:!0});var z=R(e);b&&b.l(z),n=V(z),l=C(z,"DIV",{class:!0});var x=R(l);g&&g.l(x),t=V(x),o=N(x,r[4]),i=V(x),f=C(x,"P",{class:!0});var ae=R(f);s=N(ae,"["),u=N(ae,a),c=V(ae),T=N(ae,m),X=N(ae,`]

			`),d&&d.l(ae),ae.forEach(_),F=V(x),U=C(x,"DIV",{class:!0}),R(U).forEach(_),A=V(x),W=C(x,"DIV",{class:!0});var $e=R(W);for(let Ne=0;Ne<$.length;Ne+=1)$[Ne].l($e);$e.forEach(_),x.forEach(_),J=V(z),Z&&Z.l(z),L=V(z),y&&y.l(z),Y=V(z),K&&K.l(z),ee=V(z),O&&O.l(z),z.forEach(_),this.h()},h(){v(f,"class","text-gray-500"),v(U,"class","flex-1"),v(W,"class","hidden group-hover:flex"),v(l,"class","flex"),v(e,"id",S=r[0]._id),v(e,"class","flex flex-col hover:bg-gray-800 group p-4")},m(D,z){p(D,e,z),b&&b.m(e,null),k(e,n),k(e,l),g&&g.m(l,null),k(l,t),k(l,o),k(l,i),k(l,f),k(f,s),k(f,u),k(f,c),k(f,T),k(f,X),d&&d.m(f,null),k(l,F),k(l,U),k(l,A),k(l,W);for(let x=0;x<$.length;x+=1)$[x]&&$[x].m(W,null);k(e,J),Z&&Z.m(e,null),k(e,L),y&&y.m(e,null),k(e,Y),K&&K.m(e,null),k(e,ee),O&&O.m(e,null),P=!0},p(D,z){if(D[0].replies!=null&&D[0].replies.length!=0?b?(b.p(D,z),z[0]&1&&w(b,1)):(b=at(D),b.c(),w(b,1),b.m(e,n)):b&&(ne(),M(b,1,1,()=>{b=null}),re()),D[1]["jolt:compact-mode"]?g&&(ne(),M(g,1,1,()=>{g=null}),re()):g?(g.p(D,z),z[0]&2&&w(g,1)):(g=_t(D),g.c(),w(g,1),g.m(l,t)),(!P||z[0]&16)&&B(o,D[4]),(!P||z[0]&320)&&a!==(a=D[6](D[8])+"")&&B(u,a),(!P||z[0]&384)&&m!==(m=D[7](D[8])+"")&&B(T,m),D[0].edited!=null?d?d.p(Pe(D),z):(d=ht(Pe(D)),d.c(),d.m(f,null)):d&&(d.d(1),d=null),z[0]&32769){Q=ue(D[15]);let x;for(x=0;x<Q.length;x+=1){const ae=ft(D,Q,x);$[x]?$[x].p(ae,z):($[x]=dt(ae),$[x].c(),$[x].m(W,null))}for(;x<$.length;x+=1)$[x].d(1);$.length=Q.length}G===(G=H(D))&&Z?Z.p(D,z):(Z&&Z.d(1),Z=G&&G(D),Z&&(Z.c(),Z.m(e,L))),D[0].system!=null?y?(y.p(D,z),z[0]&1&&w(y,1)):(y=pt(D),y.c(),w(y,1),y.m(e,Y)):y&&(ne(),M(y,1,1,()=>{y=null}),re()),D[0].attachments!=null?K?(K.p(D,z),z[0]&1&&w(K,1)):(K=bt(D),K.c(),w(K,1),K.m(e,ee)):K&&(ne(),M(K,1,1,()=>{K=null}),re()),D[0].embeds!=null?O?(O.p(D,z),z[0]&1&&w(O,1)):(O=gt(D),O.c(),w(O,1),O.m(e,null)):O&&(ne(),M(O,1,1,()=>{O=null}),re()),(!P||z[0]&1&&S!==(S=D[0]._id))&&v(e,"id",S)},i(D){P||(w(b),w(g),w(y),w(K),w(O),P=!0)},o(D){M(b),M(g),M(y),M(K),M(O),P=!1},d(D){D&&_(e),b&&b.d(),g&&g.d(),d&&d.d(),we($,D),Z&&Z.d(),y&&y.d(),K&&K.d(),O&&O.d()}}}function vn(r,e,n){let l,t,o,i,f,s,a,u,c,m,T,X;te(r,De,y=>n(5,c=y)),te(r,Kt,y=>n(6,T=y)),te(r,Ft,y=>n(7,X=y));let{message:F}=e,U,A,W;const J=le(Tt);te(r,J,y=>n(25,u=y));const L=le(Ce);te(r,L,y=>n(1,i=y));const Y=le(je),ee=le(At);te(r,ee,y=>n(19,f=y)),le(Ut);const S=le(Fe),P=le(Ge);te(r,P,y=>n(20,s=y));const b=le(St);te(r,b,y=>n(24,a=y));const g=le(Ot);te(r,g,y=>n(26,m=y));const d=[{src:"/reply.svg",alt:c("message.reply"),onclick(){m!=null&&m.some(y=>y.message._id==F._id)||g==null||g.update(y=>(y.push({message:F,mention:!0}),y))}},{src:"/note.svg",alt:c("message.edit"),showIf:y=>y.author==u.user_id,onclick:y=>n(2,U=U==null?y.content??"":void 0)},{src:"/trash.svg",alt:c("message.delete"),showIf:y=>y.author==u.user_id,onclick:y=>Y.api.deleteMessage(y.channel,y._id)}];async function Q(y,K){n(18,W=a==null?void 0:a.find(O=>O._id.server==y&&O._id.user==K))}async function $(){const y=await Y.api.editMessage(F.channel,F._id,{content:U});S==null||S.update(K=>(K[K.findIndex(O=>O._id==F._id)]=y,K))}const H=y=>y(F),G=y=>{if(!y.defaultPrevented){if(y.key=="Escape"){y.preventDefault(),n(2,U=void 0);return}y.shiftKey||y.key!="Enter"||(y.preventDefault(),$(),n(2,U=void 0))}};function Z(){U=this.value,n(2,U)}return r.$$set=y=>{"message"in y&&n(0,F=y.message)},r.$$.update=()=>{r.$$.dirty[0]&1048577&&Re(Y.api,s??[],F.author).then(y=>n(17,A=y)),r.$$.dirty[0]&524289&&(f==null||Q(f,F.author)),r.$$.dirty[0]&393217&&n(4,l=me(A,W,F)),r.$$.dirty[0]&393219&&n(3,t=i["jolt:low-data-mode"]?"/user.svg":pe(A,W,F)),r.$$.dirty[0]&1&&n(8,o=rn(F._id))},[F,i,U,t,l,c,T,X,o,J,L,ee,P,b,g,d,$,A,W,f,s,H,G,Z]}class $n extends ge{constructor(e){super(),ve(this,e,vn,gn,ke,{message:0},null,[-1,-1])}}function $t(r,e,n){const l=r.slice();l[24]=e[n],l[26]=e,l[27]=n;const t=l[11].api.fetchUser(l[24].message.author);return l[25]=t,l}function wt(r){const e=`<${r[6]("user.unknown")}>`;r[28]=e}function yt(r){const e=me(r[25]);r[28]=e}function Et(r,e,n){const l=r.slice();l[25]=e[n];const t=me(l[25]);return l[28]=t,l}function Nt(r,e,n){const l=r.slice();return l[31]=e[n],l}function Mt(r){let e,n;return e=new $n({props:{message:r[31]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&256&&(o.message=l[31]),e.$set(o)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){M(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function It(r){let e,n,l,t=r[28]+"",o,i,f=r[6]("user.is-typing")+"",s,a,u;return n=new Ee({props:{src:r[2]["jolt:low-data-mode"]?"/user.svg":pe(r[25]),width:16,height:16,name:r[28]}}),{c(){e=I("div"),oe(n.$$.fragment),l=j(),o=E(t),i=j(),s=E(f),a=E("...")},l(c){e=C(c,"DIV",{});var m=R(e);se(n.$$.fragment,m),l=V(m),o=N(m,t),i=V(m),s=N(m,f),a=N(m,"..."),m.forEach(_)},m(c,m){p(c,e,m),fe(n,e,null),k(e,l),k(e,o),k(e,i),k(e,s),k(e,a),u=!0},p(c,m){const T={};m[0]&20&&(T.src=c[2]["jolt:low-data-mode"]?"/user.svg":pe(c[25])),m[0]&16&&(T.name=c[28]),n.$set(T),(!u||m[0]&16)&&t!==(t=c[28]+"")&&B(o,t),(!u||m[0]&64)&&f!==(f=c[6]("user.is-typing")+"")&&B(s,f)},i(c){u||(w(n.$$.fragment,c),u=!0)},o(c){M(n.$$.fragment,c),u=!1},d(c){c&&_(e),ce(n)}}}function wn(r){wt(r);let e,n,l=r[28]+"",t,o;return e=new Ee({props:{src:"/user.svg",name:r[28]}}),{c(){oe(e.$$.fragment),n=j(),t=E(l)},l(i){se(e.$$.fragment,i),n=V(i),t=N(i,l)},m(i,f){fe(e,i,f),p(i,n,f),p(i,t,f),o=!0},p(i,f){wt(i);const s={};f[0]&64&&(s.name=i[28]),e.$set(s),(!o||f[0]&64)&&l!==(l=i[28]+"")&&B(t,l)},i(i){o||(w(e.$$.fragment,i),o=!0)},o(i){M(e.$$.fragment,i),o=!1},d(i){i&&(_(n),_(t)),ce(e,i)}}}function yn(r){yt(r);let e,n,l=r[28]+"",t,o;return e=new Ee({props:{src:pe(r[25]),name:r[28]}}),{c(){oe(e.$$.fragment),n=j(),t=E(l)},l(i){se(e.$$.fragment,i),n=V(i),t=N(i,l)},m(i,f){fe(e,i,f),p(i,n,f),p(i,t,f),o=!0},p(i,f){yt(i);const s={};f[0]&128&&(s.src=pe(i[25])),f[0]&128&&(s.name=i[28]),e.$set(s),(!o||f[0]&128)&&l!==(l=i[28]+"")&&B(t,l)},i(i){o||(w(e.$$.fragment,i),o=!0)},o(i){M(e.$$.fragment,i),o=!1},d(i){i&&(_(n),_(t)),ce(e,i)}}}function En(r){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Ct(r){let e,n,l=r[6]("message.replying-to")+"",t,o,i,f,s,a,u=r[24].message.content+"",c,m,T,X,F,U,A,W,J,L,Y,ee=r[24].mention?"ON":"OFF",S,P,b,g,d='<img src="/circle-x.svg" alt="Cancel mention"/>',Q,$,H,G={ctx:r,current:null,token:null,hasCatch:!0,pending:En,then:yn,catch:wn,value:25,blocks:[,,,]};ie(f=r[25],G);function Z(){r[14].call(U,r[26],r[27])}function y(){return r[15](r[24])}return{c(){e=I("div"),n=I("p"),t=E(l),o=j(),i=I("strong"),G.block.c(),s=j(),a=I("p"),c=E(u),m=j(),T=I("div"),X=j(),F=I("div"),U=I("input"),A=j(),W=I("label"),J=I("img"),Y=j(),S=E(ee),P=j(),b=I("div"),g=I("button"),g.innerHTML=d,this.h()},l(K){e=C(K,"DIV",{class:!0});var O=R(e);n=C(O,"P",{});var D=R(n);t=N(D,l),o=V(D),i=C(D,"STRONG",{});var z=R(i);G.block.l(z),z.forEach(_),D.forEach(_),s=V(O),a=C(O,"P",{class:!0});var x=R(a);c=N(x,u),x.forEach(_),m=V(O),T=C(O,"DIV",{class:!0}),R(T).forEach(_),X=V(O),F=C(O,"DIV",{class:!0});var ae=R(F);U=C(ae,"INPUT",{id:!0,style:!0,type:!0}),A=V(ae),W=C(ae,"LABEL",{class:!0,for:!0});var $e=R(W);J=C($e,"IMG",{src:!0,class:!0,alt:!0}),Y=V($e),S=N($e,ee),$e.forEach(_),ae.forEach(_),P=V(O),b=C(O,"DIV",{class:!0});var Ne=R(b);g=C(Ne,"BUTTON",{"data-svelte-h":!0}),Ie(g)!=="svelte-wqsbkb"&&(g.innerHTML=d),Ne.forEach(_),O.forEach(_),this.h()},h(){v(a,"class","pl-1 text-gray-600 overflow-ellipsis"),v(T,"class","flex-1"),v(U,"id","mention"),Se(U,"display","none"),v(U,"type","checkbox"),_e(J.src,L="/at.svg")||v(J,"src",L),v(J,"class","inline"),v(J,"alt","mention"),v(W,"class","cursor-pointer"),v(W,"for","mention"),v(F,"class","pr-2"),v(b,"class","pr-2"),v(e,"class","flex")},m(K,O){p(K,e,O),k(e,n),k(n,t),k(n,o),k(n,i),G.block.m(i,G.anchor=null),G.mount=()=>i,G.anchor=null,k(e,s),k(e,a),k(a,c),k(e,m),k(e,T),k(e,X),k(e,F),k(F,U),U.checked=r[24].mention,k(F,A),k(F,W),k(W,J),k(W,Y),k(W,S),k(e,P),k(e,b),k(b,g),Q=!0,$||(H=[de(U,"change",Z),de(g,"click",y)],$=!0)},p(K,O){r=K,(!Q||O[0]&64)&&l!==(l=r[6]("message.replying-to")+"")&&B(t,l),G.ctx=r,O[0]&128&&f!==(f=r[25])&&ie(f,G)||be(G,r,O),(!Q||O[0]&128)&&u!==(u=r[24].message.content+"")&&B(c,u),O[0]&128&&(U.checked=r[24].mention),(!Q||O[0]&128)&&ee!==(ee=r[24].mention?"ON":"OFF")&&B(S,ee)},i(K){Q||(w(G.block),Q=!0)},o(K){for(let O=0;O<3;O+=1){const D=G.blocks[O];M(D)}Q=!1},d(K){K&&_(e),G.block.d(),G.token=null,G=null,$=!1,Oe(H)}}}function Nn(r){let e,n,l,t="so um hi this is the start, i should make this text box much further down i think",o,i,f,s,a,u,c,m,T,X,F,U=ue(r[8]),A=[];for(let b=0;b<U.length;b+=1)A[b]=Mt(Nt(r,U,b));const W=b=>M(A[b],1,1,()=>{A[b]=null});let J=ue(r[4]),L=[];for(let b=0;b<J.length;b+=1)L[b]=It(Et(r,J,b));const Y=b=>M(L[b],1,1,()=>{L[b]=null});let ee=ue(r[7]),S=[];for(let b=0;b<ee.length;b+=1)S[b]=Ct($t(r,ee,b));const P=b=>M(S[b],1,1,()=>{S[b]=null});return{c(){e=I("main"),n=I("div"),l=I("p"),l.textContent=t,o=j();for(let b=0;b<A.length;b+=1)A[b].c();i=j();for(let b=0;b<L.length;b+=1)L[b].c();f=j();for(let b=0;b<S.length;b+=1)S[b].c();s=j(),a=I("form"),u=I("div"),c=I("textarea"),this.h()},l(b){e=C(b,"MAIN",{class:!0});var g=R(e);n=C(g,"DIV",{class:!0});var d=R(n);l=C(d,"P",{"data-svelte-h":!0}),Ie(l)!=="svelte-1kz18j0"&&(l.textContent=t),o=V(d);for(let H=0;H<A.length;H+=1)A[H].l(d);i=V(d);for(let H=0;H<L.length;H+=1)L[H].l(d);f=V(d);for(let H=0;H<S.length;H+=1)S[H].l(d);s=V(d),a=C(d,"FORM",{class:!0});var Q=R(a);u=C(Q,"DIV",{class:!0});var $=R(u);c=C($,"TEXTAREA",{class:!0,placeholder:!0}),R(c).forEach(_),$.forEach(_),Q.forEach(_),d.forEach(_),g.forEach(_),this.h()},h(){v(c,"class","outline-none resize-none bg-inherit w-full"),v(c,"placeholder",m=r[6]("send-message-in")+" "+r[5]),v(u,"class","bg-gray-500 rounded-xl px-2 pt-2"),v(a,"class","m-4"),v(n,"class","flex flex-col h-full overflow-x-hidden overflow-y-scroll"),v(e,"class","main-content-container")},m(b,g){p(b,e,g),k(e,n),k(n,l),k(n,o);for(let d=0;d<A.length;d+=1)A[d]&&A[d].m(n,null);k(n,i);for(let d=0;d<L.length;d+=1)L[d]&&L[d].m(n,null);k(n,f);for(let d=0;d<S.length;d+=1)S[d]&&S[d].m(n,null);k(n,s),k(n,a),k(a,u),k(u,c),r[18](c),T=!0,X||(F=[de(c,"input",r[16]),de(c,"keydown",r[17]),de(a,"submit",Dt(r[13]))],X=!0)},p(b,g){if(g[0]&256){U=ue(b[8]);let d;for(d=0;d<U.length;d+=1){const Q=Nt(b,U,d);A[d]?(A[d].p(Q,g),w(A[d],1)):(A[d]=Mt(Q),A[d].c(),w(A[d],1),A[d].m(n,i))}for(ne(),d=U.length;d<A.length;d+=1)W(d);re()}if(g[0]&84){J=ue(b[4]);let d;for(d=0;d<J.length;d+=1){const Q=Et(b,J,d);L[d]?(L[d].p(Q,g),w(L[d],1)):(L[d]=It(Q),L[d].c(),w(L[d],1),L[d].m(n,f))}for(ne(),d=J.length;d<L.length;d+=1)Y(d);re()}if(g[0]&2242){ee=ue(b[7]);let d;for(d=0;d<ee.length;d+=1){const Q=$t(b,ee,d);S[d]?(S[d].p(Q,g),w(S[d],1)):(S[d]=Ct(Q),S[d].c(),w(S[d],1),S[d].m(n,s))}for(ne(),d=ee.length;d<S.length;d+=1)P(d);re()}(!T||g[0]&96&&m!==(m=b[6]("send-message-in")+" "+b[5]))&&v(c,"placeholder",m)},i(b){if(!T){for(let g=0;g<U.length;g+=1)w(A[g]);for(let g=0;g<J.length;g+=1)w(L[g]);for(let g=0;g<ee.length;g+=1)w(S[g]);T=!0}},o(b){A=A.filter(Boolean);for(let g=0;g<A.length;g+=1)M(A[g]);L=L.filter(Boolean);for(let g=0;g<L.length;g+=1)M(L[g]);S=S.filter(Boolean);for(let g=0;g<S.length;g+=1)M(S[g]);T=!1},d(b){b&&_(e),we(A,b),we(L,b),we(S,b),r[18](null),X=!1,Oe(F)}}}function Mn(r,e,n){let l,t,o,i=h,f=()=>(i(),i=Bt(A,$=>n(7,o=$)),A),s,a;te(r,De,$=>n(6,t=$)),r.$$.on_destroy.push(()=>i());let{channel:u}=e;const c=le(Tt);te(r,c,$=>n(19,l=$));const m=le(Ce);te(r,m,$=>n(2,s=$));const T=le(je);let X=Ue([]);te(r,X,$=>n(8,a=$));let F=Ue([]),U=Ue([]);const A=Ue([]);f(),Ae(Fe,X),Ae(St,F),Ae(Ge,U),Ae(Ot,A);let W,J=[];async function L($){if(!$){T.removeAllListeners("ChannelStartTyping"),T.removeAllListeners("ChannelStopTyping");return}T.on("ChannelStartTyping",async({id:H,user:G})=>{if(!(G==l.user_id||H!=u._id)){for(const{_id:Z}of J)if(G==Z)return;n(4,J[J.length]=await T.api.fetchUser(G),J)}}),T.on("ChannelStopTyping",({id:H,user:G})=>{H==u._id&&n(4,J=J.filter(Z=>Z._id!=G))})}Rt(()=>{T.on("Message",$=>{$.channel==u._id&&(T.api.ackMessage(u._id,$._id),X.update(H=>(H.push($),H)))}),T.on("MessageDelete",({id:$,channel:H})=>{H==u._id&&X.update(G=>G.filter(Z=>Z._id!=$))}),T.on("MessageUpdate",({id:$,channel:H,data:G})=>{H==u._id&&X.update(Z=>{const y=Z.findIndex(O=>O._id==$),K=Z[y];return G.content!=null&&(K.content=G.content),G.embeds!=null&&(K.embeds=G.embeds),K.edited=G.edited,Z[y]=K,Z})})});async function Y(){await T.api.sendMessage(u._id,{content:W.value.trim(),replies:o.map(({message:{_id:$},mention:H})=>({id:$,mention:H}))}),A.set([]),n(3,W.value="",W)}let ee;async function S($){if($.channel_type=="TextChannel"||$.channel_type=="VoiceChannel"||$.channel_type=="Group"){n(5,ee=`#${$.name}`);return}if($.channel_type=="SavedMessages"){n(5,ee=t("channel.notes"));return}n(5,ee=`@${me(await T.api.fetchUser($.recipients[0]==l.user_id?$.recipients[1]:$.recipients[0]))}`)}function P($,H){$[H].mention=this.checked,A.set(o)}const b=$=>A.update(H=>(H=H.filter(G=>G.message._id!=$.message._id),H)),g=()=>{s["jolt:send-typing-indicators"]&&T.websocket.send({type:"BeginTyping",channel:u._id})},d=$=>{$.shiftKey||$.key!="Enter"||($.preventDefault(),Y())};function Q($){Ke[$?"unshift":"push"](()=>{W=$,n(3,W)})}return r.$$set=$=>{"channel"in $&&n(0,u=$.channel)},r.$$.update=()=>{r.$$.dirty[0]&1&&(T.api.queryMessages(u._id,{sort:"Latest",include_users:!0}).then($=>{Array.isArray($)?X.set($.reverse()):(X.set($.messages.reverse()??[]),U.set($.users),F.set($.members??[]))}),A.set([]),n(4,J=[])),r.$$.dirty[0]&4&&L(s["jolt:receive-typing-indicators"]),r.$$.dirty[0]&1&&S(u)},[u,A,s,W,J,ee,t,o,a,c,m,T,X,Y,P,b,g,d,Q]}class Vn extends ge{constructor(e){super(),ve(this,e,Mn,Nn,ke,{channel:0},null,[-1,-1])}}export{Vn as C};
