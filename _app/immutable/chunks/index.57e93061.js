import{s as be,d as Ge,u as He,g as qe,e as ze,r as Se,c as le,h as Vt,b as Le,i as Pt,n as m,f as _e,j as Ae,o as Rt,k as Bt}from"./scheduler.a21a5cad.js";import{S as ke,i as ge,g as M,s as O,m as y,h as I,j as L,c as j,n as E,f as h,k as g,a as p,x as k,z as me,o as K,d as $,t as N,C as Lt,r as oe,u as se,v as fe,D as Dt,w as ce,A as Me,e as H,p as ne,b as re,l as Ue,y as $e,E as Xe}from"./index.4419476b.js";import{h as ie,u as pe}from"./await_block.7ed97119.js";import{e as ue}from"./each.e59479a4.js";import{g as te,a as Ie,c as Oe,b as At}from"./context.898bb4a8.js";import{a as Kt,g as de,b as he}from"./util.c62b600d.js";import{U as ye}from"./UserProfilePicture.f3e5cd2d.js";import{X as Ce,e as Ft,Y as Gt}from"./runtime.esm.252c27a7.js";import{w as Te}from"./index.d8292243.js";import{a as Tt,s as Ut}from"./context.fa34f1f8.js";import{b as We}from"./paths.360ae9bd.js";function Pe(r,e,n){return new Promise((l,t)=>{n=="0".repeat(26)&&l(void 0);const o=e.find(i=>i._id==n);o==null&&r.fetchUser(n).then(l).catch(t),l(o)})}const Ke=Symbol(),St=Symbol(),Fe=Symbol(),Ot=Symbol(),Ht=r=>({}),Ye=r=>({});function qt(r){let e,n,l,t,o,i,f,s,a,_,c=r[2]("confirm")+"",d,V,G,F=r[2]("cancel")+"",A,D,x,X;const R=r[4].header,J=Ge(R,r,r[3],Ye),ee=r[4].default,T=Ge(ee,r,r[3],null);return{c(){e=M("dialog"),n=M("div"),J&&J.c(),l=O(),t=M("hr"),o=O(),T&&T.c(),i=O(),f=M("hr"),s=O(),a=M("form"),_=M("button"),d=y(c),V=O(),G=M("button"),A=y(F),this.h()},l(S){e=I(S,"DIALOG",{});var b=L(e);n=I(b,"DIV",{});var v=L(n);J&&J.l(v),l=j(v),t=I(v,"HR",{}),o=j(v),T&&T.l(v),i=j(v),f=I(v,"HR",{}),s=j(v),a=I(v,"FORM",{method:!0});var u=L(a);_=I(u,"BUTTON",{type:!0});var U=L(_);d=E(U,c),U.forEach(h),V=j(u),G=I(u,"BUTTON",{type:!0});var P=L(G);A=E(P,F),P.forEach(h),u.forEach(h),v.forEach(h),b.forEach(h),this.h()},h(){g(_,"type","submit"),g(G,"type","reset"),g(a,"method","dialog")},m(S,b){p(S,e,b),k(e,n),J&&J.m(n,null),k(n,l),k(n,t),k(n,o),T&&T.m(n,null),k(n,i),k(n,f),k(n,s),k(n,a),k(a,_),k(_,d),k(a,V),k(a,G),k(G,A),r[7](e),D=!0,x||(X=[me(G,"click",r[6]),me(a,"submit",r[5]),me(e,"close",r[8])],x=!0)},p(S,[b]){J&&J.p&&(!D||b&8)&&He(J,R,S,S[3],D?ze(R,S[3],b,Ht):qe(S[3]),Ye),T&&T.p&&(!D||b&8)&&He(T,ee,S,S[3],D?ze(ee,S[3],b,null):qe(S[3]),null),(!D||b&4)&&c!==(c=S[2]("confirm")+"")&&K(d,c),(!D||b&4)&&F!==(F=S[2]("cancel")+"")&&K(A,F)},i(S){D||($(J,S),$(T,S),D=!0)},o(S){N(J,S),N(T,S),D=!1},d(S){S&&h(e),J&&J.d(S),T&&T.d(S),r[7](null),x=!1,Se(X)}}}function zt(r,e,n){let l;le(r,Ce,d=>n(2,l=d));let{$$slots:t={},$$scope:o}=e,{showModal:i}=e,f;function s(d){Vt.call(this,r,d)}const a=()=>n(0,i=!1);function _(d){Le[d?"unshift":"push"](()=>{f=d,n(1,f)})}const c=()=>n(0,i=!1);return r.$$set=d=>{"showModal"in d&&n(0,i=d.showModal),"$$scope"in d&&n(3,o=d.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(i?f==null||f.showModal():f==null||f.close())},[i,f,l,o,t,s,a,_,c]}class Xt extends ke{constructor(e){super(),ge(this,e,zt,qt,be,{showModal:0})}}function Wt(r){let e,n="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=M("p"),e.textContent=n},l(l){e=I(l,"P",{"data-svelte-h":!0}),Me(e)!=="svelte-os1rtp"&&(e.textContent=n)},m(l,t){p(l,e,t)},p:m,d(l){l&&h(e)}}}function Yt(r){let e,n="External Link";return{c(){e=M("h1"),e.textContent=n,this.h()},l(l){e=I(l,"H1",{class:!0,slot:!0,"data-svelte-h":!0}),Me(e)!=="svelte-3ozcvb"&&(e.textContent=n),this.h()},h(){g(e,"class","text-3xl"),g(e,"slot","header")},m(l,t){p(l,e,t)},p:m,d(l){l&&h(e)}}}function Jt(r){let e,n,l,t,o,i,f,s;function a(c){r[2](c)}let _={$$slots:{header:[Yt],default:[Wt]},$$scope:{ctx:r}};return r[1]!==void 0&&(_.showModal=r[1]),e=new Xt({props:_}),Le.push(()=>Lt(e,"showModal",a)),e.$on("submit",r[3]),{c(){oe(e.$$.fragment),l=O(),t=M("a"),o=y(r[0]),this.h()},l(c){se(e.$$.fragment,c),l=j(c),t=I(c,"A",{href:!0,target:!0,rel:!0});var d=L(t);o=E(d,r[0]),d.forEach(h),this.h()},h(){g(t,"href",r[0]),g(t,"target","_blank"),g(t,"rel","noreferrer")},m(c,d){fe(e,c,d),p(c,l,d),p(c,t,d),k(t,o),i=!0,f||(s=me(t,"click",Dt(r[4])),f=!0)},p(c,[d]){const V={};d&32&&(V.$$scope={dirty:d,ctx:c}),!n&&d&2&&(n=!0,V.showModal=c[1],Pt(()=>n=!1)),e.$set(V),(!i||d&1)&&K(o,c[0]),(!i||d&1)&&g(t,"href",c[0])},i(c){i||($(e.$$.fragment,c),i=!0)},o(c){N(e.$$.fragment,c),i=!1},d(c){c&&(h(l),h(t)),ce(e,c),f=!1,s()}}}function Qt(r,e,n){let{href:l}=e,t=!1;function o(s){t=s,n(1,t)}const i=()=>window.open(l),f=()=>n(1,t=!0);return r.$$set=s=>{"href"in s&&n(0,l=s.href)},[l,t,o,i,f]}class De extends ke{constructor(e){super(),ge(this,e,Qt,Jt,be,{href:0})}}function Zt(r){let e,n="oop website embed, can't handle that :(";return{c(){e=M("span"),e.textContent=n,this.h()},l(l){e=I(l,"SPAN",{class:!0,"data-svelte-h":!0}),Me(e)!=="svelte-1exisih"&&(e.textContent=n),this.h()},h(){g(e,"class","text-gray-600")},m(l,t){p(l,e,t)},p:m,i:m,o:m,d(l){l&&h(e)}}}function xt(r){let e,n,l,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&Je(r),o=r[0].title&&Qe(r),i=r[0].description&&Ze(r);return{c(){e=M("div"),t&&t.c(),n=O(),o&&o.c(),l=O(),i&&i.c(),this.h()},l(f){e=I(f,"DIV",{style:!0});var s=L(e);t&&t.l(s),n=j(s),o&&o.l(s),l=j(s),i&&i.l(s),s.forEach(h),this.h()},h(){Ue(e,"background-color",r[0].colour)},m(f,s){p(f,e,s),t&&t.m(e,null),k(e,n),o&&o.m(e,null),k(e,l),i&&i.m(e,null)},p(f,s){f[0].icon_url&&!f[1]["jolt:low-data-mode"]?t?t.p(f,s):(t=Je(f),t.c(),t.m(e,n)):t&&(t.d(1),t=null),f[0].title?o?o.p(f,s):(o=Qe(f),o.c(),o.m(e,l)):o&&(o.d(1),o=null),f[0].description?i?i.p(f,s):(i=Ze(f),i.c(),i.m(e,null)):i&&(i.d(1),i=null),s&1&&Ue(e,"background-color",f[0].colour)},i:m,o:m,d(f){f&&h(e),t&&t.d(),o&&o.d(),i&&i.d()}}}function el(r){let e,n,l,t;const o=[nl,ll],i=[];function f(s,a){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=H()},l(s){n.l(s),l=H()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let _=e;e=f(s),e===_?i[e].p(s,a):(ne(),N(i[_],1,1,()=>{i[_]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l))},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),i[e].d(s)}}}function tl(r){let e,n,l,t;const o=[il,rl],i=[];function f(s,a){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=H()},l(s){n.l(s),l=H()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let _=e;e=f(s),e===_?i[e].p(s,a):(ne(),N(i[_],1,1,()=>{i[_]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l))},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),i[e].d(s)}}}function Je(r){let e,n,l;return{c(){e=M("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){_e(e.src,n=r[0].icon_url)||g(e,"src",n),g(e,"alt",l=r[0].title),g(e,"width","24"),g(e,"height","24"),g(e,"class","inline rounded-3xl")},m(t,o){p(t,e,o)},p(t,o){o&1&&!_e(e.src,n=t[0].icon_url)&&g(e,"src",n),o&1&&l!==(l=t[0].title)&&g(e,"alt",l)},d(t){t&&h(e)}}}function Qe(r){let e,n=r[0].title+"",l;return{c(){e=M("h1"),l=y(n),this.h()},l(t){e=I(t,"H1",{class:!0});var o=L(e);l=E(o,n),o.forEach(h),this.h()},h(){g(e,"class","text-gray-600")},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&1&&n!==(n=t[0].title+"")&&K(l,n)},d(t){t&&h(e)}}}function Ze(r){let e,n=r[0].description+"",l;return{c(){e=M("p"),l=y(n)},l(t){e=I(t,"P",{});var o=L(e);l=E(o,n),o.forEach(h)},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&1&&n!==(n=t[0].description+"")&&K(l,n)},d(t){t&&h(e)}}}function ll(r){let e,n,l,t,o;return{c(){e=M("video"),n=M("source"),this.h()},l(i){e=I(i,"VIDEO",{});var f=L(e);n=I(f,"SOURCE",{src:!0,width:!0,height:!0}),f.forEach(h),this.h()},h(){_e(n.src,l=r[0].url)||g(n,"src",l),g(n,"width",t=r[0].width),g(n,"height",o=r[0].height),e.controls=!0},m(i,f){p(i,e,f),k(e,n)},p(i,f){f&1&&!_e(n.src,l=i[0].url)&&g(n,"src",l),f&1&&t!==(t=i[0].width)&&g(n,"width",t),f&1&&o!==(o=i[0].height)&&g(n,"height",o)},i:m,o:m,d(i){i&&h(e)}}}function nl(r){let e,n;return e=new De({props:{href:r[0].url}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t&1&&(o.href=l[0].url),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function rl(r){let e,n,l,t;return{c(){e=M("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,width:!0,height:!0}),this.h()},h(){_e(e.src,n=r[0].url)||g(e,"src",n),g(e,"width",l=r[0].width),g(e,"height",t=r[0].height)},m(o,i){p(o,e,i)},p(o,i){i&1&&!_e(e.src,n=o[0].url)&&g(e,"src",n),i&1&&l!==(l=o[0].width)&&g(e,"width",l),i&1&&t!==(t=o[0].height)&&g(e,"height",t)},i:m,o:m,d(o){o&&h(e)}}}function il(r){let e,n;return e=new De({props:{href:r[0].url}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t&1&&(o.href=l[0].url),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function ol(r){let e,n,l,t;const o=[tl,el,xt,Zt],i=[];function f(s,a){return s[0].type=="Image"?0:s[0].type=="Video"?1:s[0].type=="Text"?2:s[0].type=="Website"?3:-1}return~(e=f(r))&&(n=i[e]=o[e](r)),{c(){n&&n.c(),l=H()},l(s){n&&n.l(s),l=H()},m(s,a){~e&&i[e].m(s,a),p(s,l,a),t=!0},p(s,[a]){let _=e;e=f(s),e===_?~e&&i[e].p(s,a):(n&&(ne(),N(i[_],1,1,()=>{i[_]=null}),re()),~e?(n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l)):n=null)},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),~e&&i[e].d(s)}}}function sl(r,e,n){let l,{embed:t}=e;const o=te(Ie);return le(r,o,i=>n(1,l=i)),r.$$set=i=>{"embed"in i&&n(0,t=i.embed)},[t,l,o]}class fl extends ke{constructor(e){super(),ge(this,e,sl,ol,be,{embed:0})}}function cl(r){let e,n,l,t;const o=[dl,ml],i=[];function f(s,a){return s[2]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=H()},l(s){n.l(s),l=H()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let _=e;e=f(s),e===_?i[e].p(s,a):(ne(),N(i[_],1,1,()=>{i[_]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l))},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),i[e].d(s)}}}function al(r){let e,n,l=r[0].filename+"",t,o,i,f;return i=new De({props:{href:r[1]}}),{c(){e=M("span"),n=y("[File "),t=y(l),o=y(`]
			`),oe(i.$$.fragment),this.h()},l(s){e=I(s,"SPAN",{class:!0});var a=L(e);n=E(a,"[File "),t=E(a,l),o=E(a,`]
			`),se(i.$$.fragment,a),a.forEach(h),this.h()},h(){g(e,"class","text-gray-500")},m(s,a){p(s,e,a),k(e,n),k(e,t),k(e,o),fe(i,e,null),f=!0},p(s,a){(!f||a&1)&&l!==(l=s[0].filename+"")&&K(t,l);const _={};a&2&&(_.href=s[1]),i.$set(_)},i(s){f||($(i.$$.fragment,s),f=!0)},o(s){N(i.$$.fragment,s),f=!1},d(s){s&&h(e),ce(i)}}}function ul(r){let e,n,l;return{c(){e=M("audio"),n=M("source"),this.h()},l(t){e=I(t,"AUDIO",{});var o=L(e);n=I(o,"SOURCE",{src:!0}),o.forEach(h),this.h()},h(){_e(n.src,l=r[1])||g(n,"src",l),e.controls=!0},m(t,o){p(t,e,o),k(e,n)},p(t,o){o&2&&!_e(n.src,l=t[1])&&g(n,"src",l)},i:m,o:m,d(t){t&&h(e)}}}function _l(r){let e,n,l;return{c(){e=M("video"),n=M("source"),this.h()},l(t){e=I(t,"VIDEO",{});var o=L(e);n=I(o,"SOURCE",{src:!0}),o.forEach(h),this.h()},h(){_e(n.src,l=r[1])||g(n,"src",l),e.controls=!0},m(t,o){p(t,e,o),k(e,n)},p(t,o){o&2&&!_e(n.src,l=t[1])&&g(n,"src",l)},i:m,o:m,d(t){t&&h(e)}}}function hl(r){let e,n,l,t;const o=[yl,wl],i=[];function f(s,a){return s[2]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=H()},l(s){n.l(s),l=H()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let _=e;e=f(s),e===_?i[e].p(s,a):(ne(),N(i[_],1,1,()=>{i[_]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l))},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),i[e].d(s)}}}function ml(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!0,pending:$l,then:bl,catch:pl,value:5,error:7};return ie(n=fetch(r[1]),l),{c(){e=H(),l.block.c()},l(t){e=H(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&2&&n!==(n=fetch(r[1]))&&ie(n,l)||pe(l,r,o)},i:m,o:m,d(t){t&&h(e),l.block.d(t),l.token=null,l=null}}}function dl(r){let e,n,l,t,o;return l=new De({props:{href:r[1]}}),{c(){e=M("span"),n=y("[Text "),oe(l.$$.fragment),t=y("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var f=L(e);n=E(f,"[Text "),se(l.$$.fragment,f),t=E(f,"]"),f.forEach(h),this.h()},h(){g(e,"class","text-gray-500")},m(i,f){p(i,e,f),k(e,n),fe(l,e,null),k(e,t),o=!0},p(i,f){const s={};f&2&&(s.href=i[1]),l.$set(s)},i(i){o||($(l.$$.fragment,i),o=!0)},o(i){N(l.$$.fragment,i),o=!1},d(i){i&&h(e),ce(l)}}}function pl(r){let e,n=r[3]("file.download.error")+"",l,t,o=r[0].filename+"",i,f,s=r[7]+"",a;return{c(){e=M("p"),l=y(n),t=O(),i=y(o),f=y(": "),a=y(s)},l(_){e=I(_,"P",{});var c=L(e);l=E(c,n),t=j(c),i=E(c,o),f=E(c,": "),a=E(c,s),c.forEach(h)},m(_,c){p(_,e,c),k(e,l),k(e,t),k(e,i),k(e,f),k(e,a)},p(_,c){c&8&&n!==(n=_[3]("file.download.error")+"")&&K(l,n),c&1&&o!==(o=_[0].filename+"")&&K(i,o),c&2&&s!==(s=_[7]+"")&&K(a,s)},d(_){_&&h(e)}}}function bl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:vl,then:gl,catch:kl,value:6};return ie(n=r[5].text(),l),{c(){e=H(),l.block.c()},l(t){e=H(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&2&&n!==(n=r[5].text())&&ie(n,l)||pe(l,r,o)},d(t){t&&h(e),l.block.d(t),l.token=null,l=null}}}function kl(r){return{c:m,l:m,m,p:m,d:m}}function gl(r){let e,n=r[6]+"",l;return{c(){e=M("p"),l=y(n)},l(t){e=I(t,"P",{});var o=L(e);l=E(o,n),o.forEach(h)},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&2&&n!==(n=t[6]+"")&&K(l,n)},d(t){t&&h(e)}}}function vl(r){return{c:m,l:m,m,p:m,d:m}}function $l(r){return{c:m,l:m,m,p:m,d:m}}function wl(r){let e,n,l;return{c(){e=M("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){_e(e.src,n=r[1])||g(e,"src",n),g(e,"alt",l=r[0].filename),g(e,"class","max-w-xl max-h-xl")},m(t,o){p(t,e,o)},p(t,o){o&2&&!_e(e.src,n=t[1])&&g(e,"src",n),o&1&&l!==(l=t[0].filename)&&g(e,"alt",l)},i:m,o:m,d(t){t&&h(e)}}}function yl(r){let e,n,l,t,o;return l=new De({props:{href:r[1]}}),{c(){e=M("span"),n=y("[Image "),oe(l.$$.fragment),t=y("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var f=L(e);n=E(f,"[Image "),se(l.$$.fragment,f),t=E(f,"]"),f.forEach(h),this.h()},h(){g(e,"class","text-gray-500")},m(i,f){p(i,e,f),k(e,n),fe(l,e,null),k(e,t),o=!0},p(i,f){const s={};f&2&&(s.href=i[1]),l.$set(s)},i(i){o||($(l.$$.fragment,i),o=!0)},o(i){N(l.$$.fragment,i),o=!1},d(i){i&&h(e),ce(l)}}}function El(r){let e,n,l,t;const o=[hl,_l,ul,al,cl],i=[];function f(s,a){return s[0].metadata.type=="Image"?0:s[0].metadata.type=="Video"?1:s[0].metadata.type=="Audio"?2:s[0].metadata.type=="File"?3:s[0].metadata.type=="Text"?4:-1}return~(n=f(r))&&(l=i[n]=o[n](r)),{c(){e=M("div"),l&&l.c()},l(s){e=I(s,"DIV",{});var a=L(e);l&&l.l(a),a.forEach(h)},m(s,a){p(s,e,a),~n&&i[n].m(e,null),t=!0},p(s,[a]){let _=n;n=f(s),n===_?~n&&i[n].p(s,a):(l&&(ne(),N(i[_],1,1,()=>{i[_]=null}),re()),~n?(l=i[n],l?l.p(s,a):(l=i[n]=o[n](s),l.c()),$(l,1),l.m(e,null)):l=null)},i(s){t||($(l),t=!0)},o(s){N(l),t=!1},d(s){s&&h(e),~n&&i[n].d()}}}function Nl(r,e,n){let l,t,o;le(r,Ce,s=>n(3,o=s));const i=te(Ie);le(r,i,s=>n(2,t=s));let{attachment:f}=e;return r.$$set=s=>{"attachment"in s&&n(0,f=s.attachment)},r.$$.update=()=>{r.$$.dirty&1&&n(1,l=Kt(f))},[f,l,t,o,i]}class Ml extends ke{constructor(e){super(),ge(this,e,Nl,El,be,{attachment:0})}}function xe(r){const e=he(r[4]);r[5]=e}function et(r){r[6]=r[8][0],r[7]=r[8][1]}function tt(r){const e=he(r[4]);r[5]=e}function Il(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Pl,then:Ul,catch:Tl,value:4,blocks:[,,,]};return ie(n=r[2].api.fetchUser(r[0].id),t),{c(){e=H(),t.block.c()},l(o){e=H(),t.block.l(o)},m(o,i){p(o,e,i),t.block.m(o,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,i){r=o,t.ctx=r,i&1&&n!==(n=r[2].api.fetchUser(r[0].id))&&ie(n,t)||pe(t,r,i)},i(o){l||($(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];N(f)}l=!1},d(o){o&&h(e),t.block.d(o),t.token=null,t=null}}}function Cl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Ll,then:Bl,catch:Rl,value:8};return ie(n=Promise.all([r[0].from,r[0].to].map(r[3])),l),{c(){e=H(),l.block.c()},l(t){e=H(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=Promise.all([r[0].from,r[0].to].map(r[3])))&&ie(n,l)||pe(l,r,o)},i:m,o:m,d(t){t&&h(e),l.block.d(t),l.token=null,l=null}}}function Dl(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Zl,then:Fl,catch:Kl,value:4,blocks:[,,,]};return ie(n=r[2].api.fetchUser(r[0].by),t),{c(){e=H(),t.block.c()},l(o){e=H(),t.block.l(o)},m(o,i){p(o,e,i),t.block.m(o,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,i){r=o,t.ctx=r,i&1&&n!==(n=r[2].api.fetchUser(r[0].by))&&ie(n,t)||pe(t,r,i)},i(o){l||($(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];N(f)}l=!1},d(o){o&&h(e),t.block.d(o),t.token=null,t=null}}}function Al(r){let e=r[0].content+"",n;return{c(){n=y(e)},l(l){n=E(l,e)},m(l,t){p(l,n,t)},p(l,t){t&1&&e!==(e=l[0].content+"")&&K(n,e)},i:m,o:m,d(l){l&&h(n)}}}function Tl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Ul(r){xe(r);let e,n,l=r[5]+"",t,o,i,f;e=new ye({props:{src:de(r[4]),width:24,height:24,name:r[5]}});function s(c,d){if(c[0].type=="user_banned")return Vl;if(c[0].type=="user_joined")return jl;if(c[0].type=="user_kicked")return Ol;if(c[0].type=="user_left")return Sl}let a=s(r),_=a&&a(r);return{c(){oe(e.$$.fragment),n=O(),t=y(l),o=O(),_&&_.c(),i=H()},l(c){se(e.$$.fragment,c),n=j(c),t=E(c,l),o=j(c),_&&_.l(c),i=H()},m(c,d){fe(e,c,d),p(c,n,d),p(c,t,d),p(c,o,d),_&&_.m(c,d),p(c,i,d),f=!0},p(c,d){xe(c);const V={};d&1&&(V.src=de(c[4])),d&1&&(V.name=c[5]),e.$set(V),(!f||d&1)&&l!==(l=c[5]+"")&&K(t,l),a===(a=s(c))&&_?_.p(c,d):(_&&_.d(1),_=a&&a(c),_&&(_.c(),_.m(i.parentNode,i)))},i(c){f||($(e.$$.fragment,c),f=!0)},o(c){N(e.$$.fragment,c),f=!1},d(c){c&&(h(n),h(t),h(o),h(i)),ce(e,c),_&&_.d(c)}}}function Sl(r){let e=r[1]("user.chat.left")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.chat.left")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Ol(r){let e=r[1]("user.was-kicked")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.was-kicked")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function jl(r){let e=r[1]("user.chat.joined")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.chat.joined")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Vl(r){let e=r[1]("user.was-banned")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.was-banned")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Pl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Rl(r){return{c:m,l:m,m,p:m,d:m}}function Bl(r){et(r);let e=r[1]("channel.ownership.changed-from")+"",n,l,t=he(r[6])+"",o,i,f=he(r[7])+"",s,a;return{c(){n=y(e),l=O(),o=y(t),i=y(" to "),s=y(f),a=y(".")},l(_){n=E(_,e),l=j(_),o=E(_,t),i=E(_," to "),s=E(_,f),a=E(_,".")},m(_,c){p(_,n,c),p(_,l,c),p(_,o,c),p(_,i,c),p(_,s,c),p(_,a,c)},p(_,c){et(_),c&2&&e!==(e=_[1]("channel.ownership.changed-from")+"")&&K(n,e),c&1&&t!==(t=he(_[6])+"")&&K(o,t),c&1&&f!==(f=he(_[7])+"")&&K(s,f)},d(_){_&&(h(n),h(l),h(o),h(i),h(s),h(a))}}}function Ll(r){return{c:m,l:m,m,p:m,d:m}}function Kl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Fl(r){tt(r);let e,n,l=r[5]+"",t,o,i,f;e=new ye({props:{src:de(r[4]),width:24,height:24,name:r[5]}});function s(c,d){if(c[0].type=="channel_description_changed")return zl;if(c[0].type=="channel_icon_changed")return ql;if(c[0].type=="channel_renamed")return Hl;if(c[0].type=="user_added"||c[0].type=="user_remove")return Gl}let a=s(r),_=a&&a(r);return{c(){oe(e.$$.fragment),n=O(),t=y(l),o=O(),_&&_.c(),i=H()},l(c){se(e.$$.fragment,c),n=j(c),t=E(c,l),o=j(c),_&&_.l(c),i=H()},m(c,d){fe(e,c,d),p(c,n,d),p(c,t,d),p(c,o,d),_&&_.m(c,d),p(c,i,d),f=!0},p(c,d){tt(c);const V={};d&1&&(V.src=de(c[4])),d&1&&(V.name=c[5]),e.$set(V),(!f||d&1)&&l!==(l=c[5]+"")&&K(t,l),a===(a=s(c))&&_?_.p(c,d):(_&&_.d(1),_=a&&a(c),_&&(_.c(),_.m(i.parentNode,i)))},i(c){f||($(e.$$.fragment,c),f=!0)},o(c){N(e.$$.fragment,c),f=!1},d(c){c&&(h(n),h(t),h(o),h(i)),ce(e,c),_&&_.d(c)}}}function Gl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Ql,then:Wl,catch:Xl,value:4};return ie(n=r[2].api.fetchUser(r[0].id),l),{c(){e=H(),l.block.c()},l(t){e=H(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=r[2].api.fetchUser(r[0].id))&&ie(n,l)||pe(l,r,o)},d(t){t&&h(e),l.block.d(t),l.token=null,l=null}}}function Hl(r){let e=r[1]("channel.rename-to")+"",n,l,t=r[0].name+"",o,i;return{c(){n=y(e),l=O(),o=y(t),i=y(".")},l(f){n=E(f,e),l=j(f),o=E(f,t),i=E(f,".")},m(f,s){p(f,n,s),p(f,l,s),p(f,o,s),p(f,i,s)},p(f,s){s&2&&e!==(e=f[1]("channel.rename-to")+"")&&K(n,e),s&1&&t!==(t=f[0].name+"")&&K(o,t)},d(f){f&&(h(n),h(l),h(o),h(i))}}}function ql(r){let e=r[1]("channel.icon.change")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("channel.icon.change")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function zl(r){let e=r[1]("channel.description.change")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("channel.description.change")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Xl(r){return{c:m,l:m,m,p:m,d:m}}function Wl(r){let e,n=he(r[4])+"",l,t;function o(s,a){if(s[0].type=="user_added")return Jl;if(s[0].type=="user_remove")return Yl}let i=o(r),f=i&&i(r);return{c(){f&&f.c(),e=O(),l=y(n),t=y(".")},l(s){f&&f.l(s),e=j(s),l=E(s,n),t=E(s,".")},m(s,a){f&&f.m(s,a),p(s,e,a),p(s,l,a),p(s,t,a)},p(s,a){i===(i=o(s))&&f?f.p(s,a):(f&&f.d(1),f=i&&i(s),f&&(f.c(),f.m(e.parentNode,e))),a&1&&n!==(n=he(s[4])+"")&&K(l,n)},d(s){s&&(h(e),h(l),h(t)),f&&f.d(s)}}}function Yl(r){let e=r[1]("removed")+"",n;return{c(){n=y(e)},l(l){n=E(l,e)},m(l,t){p(l,n,t)},p(l,t){t&2&&e!==(e=l[1]("removed")+"")&&K(n,e)},d(l){l&&h(n)}}}function Jl(r){let e=r[1]("added")+"",n;return{c(){n=y(e)},l(l){n=E(l,e)},m(l,t){p(l,n,t)},p(l,t){t&2&&e!==(e=l[1]("added")+"")&&K(n,e)},d(l){l&&h(n)}}}function Ql(r){return{c:m,l:m,m,p:m,d:m}}function Zl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function xl(r){let e,n,l,t;const o=[Al,Dl,Cl,Il],i=[];function f(s,a){return s[0].type=="text"?0:s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove"?1:s[0].type=="channel_ownership_changed"?2:s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left"?3:-1}return~(e=f(r))&&(n=i[e]=o[e](r)),{c(){n&&n.c(),l=H()},l(s){n&&n.l(s),l=H()},m(s,a){~e&&i[e].m(s,a),p(s,l,a),t=!0},p(s,[a]){let _=e;e=f(s),e===_?~e&&i[e].p(s,a):(n&&(ne(),N(i[_],1,1,()=>{i[_]=null}),re()),~e?(n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l)):n=null)},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),~e&&i[e].d(s)}}}function en(r,e,n){let l;le(r,Ce,f=>n(1,l=f));const t=te(Oe);let{system:o}=e;const i=f=>t.api.fetchUser(f);return r.$$set=f=>{"system"in f&&n(0,o=f.system)},[o,l,t,i]}class tn extends ke{constructor(e){super(),ge(this,e,en,xl,be,{system:0})}}function we(r){var e=new Error(r);return e.source="ulid",e}var je="0123456789ABCDEFGHJKMNPQRSTVWXYZ",Ne=je.length,Re=Math.pow(2,48)-1,Be=10,jt=16;function ln(r){var e=Math.floor(r()*Ne);return e===Ne&&(e=Ne-1),je.charAt(e)}function nn(r,e){if(isNaN(r))throw new Error(r+" must be a number");if(r>Re)throw we("cannot encode time greater than "+Re);if(r<0)throw we("time must be positive");if(Number.isInteger(r)===!1)throw we("time must be an integer");for(var n=void 0,l="";e>0;e--)n=r%Ne,l=je.charAt(n)+l,r=(r-n)/Ne;return l}function rn(r,e){for(var n="";r>0;r--)n=ln(e)+n;return n}function on(r){if(r.length!==Be+jt)throw we("malformed ulid");var e=r.substr(0,Be).split("").reverse().reduce(function(n,l,t){var o=je.indexOf(l);if(o===-1)throw we("invalid character found: "+l);return n+=o*Math.pow(Ne,t)},0);if(e>Re)throw we("malformed ulid, timestamp too large");return e}function sn(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=arguments[1];e||(e=typeof window<"u"?window:null);var n=e&&(e.crypto||e.msCrypto);if(n)return function(){var t=new Uint8Array(1);return n.getRandomValues(t),t[0]/255};try{var l=require("crypto");return function(){return l.randomBytes(1).readUInt8()/255}}catch{}if(r){try{console.error("secure crypto unusable, falling back to insecure Math.random()!")}catch{}return function(){return Math.random()}}throw we("secure crypto unusable, insecure Math.random not allowed")}function fn(r){return r||(r=sn()),function(n){return isNaN(n)&&(n=Date.now()),nn(n,Be)+rn(jt,r)}}fn();function lt(r){const e=he(r[14]);r[15]=e}function nt(r){var o;let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:mn,then:an,catch:cn,value:13,blocks:[,,,]};return ie(n=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),t),{c(){e=H(),t.block.c()},l(i){e=H(),t.block.l(i)},m(i,f){p(i,e,f),t.block.m(i,t.anchor=f),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(i,f){var s;r=i,t.ctx=r,f&13&&n!==(n=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&ie(n,t)||pe(t,r,f)},i(i){l||($(t.block),l=!0)},o(i){for(let f=0;f<3;f+=1){const s=t.blocks[f];N(s)}l=!1},d(i){i&&h(e),t.block.d(i),t.token=null,t=null}}}function cn(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function an(r){let e,n,l,t=!r[4]["jolt:low-data-mode"]&&rt(r),o=r[13].content!=null&&it(r);return{c(){t&&t.c(),e=O(),o&&o.c(),n=H()},l(i){t&&t.l(i),e=j(i),o&&o.l(i),n=H()},m(i,f){t&&t.m(i,f),p(i,e,f),o&&o.m(i,f),p(i,n,f),l=!0},p(i,f){i[4]["jolt:low-data-mode"]?t&&(ne(),N(t,1,1,()=>{t=null}),re()):t?(t.p(i,f),f&16&&$(t,1)):(t=rt(i),t.c(),$(t,1),t.m(e.parentNode,e)),i[13].content!=null?o?o.p(i,f):(o=it(i),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i(i){l||($(t),l=!0)},o(i){N(t),l=!1},d(i){i&&(h(e),h(n)),t&&t.d(i),o&&o.d(i)}}}function rt(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:hn,then:_n,catch:un,value:14,blocks:[,,,]};return ie(e=Pe(r[6].api,r[5]??[],r[13].author),t),{c(){t.block.c(),n=y(":")},l(o){t.block.l(o),n=E(o,":")},m(o,i){t.block.m(o,t.anchor=i),t.mount=()=>n.parentNode,t.anchor=n,p(o,n,i),l=!0},p(o,i){r=o,t.ctx=r,i&45&&e!==(e=Pe(r[6].api,r[5]??[],r[13].author))&&ie(e,t)||pe(t,r,i)},i(o){l||($(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];N(f)}l=!1},d(o){o&&h(n),t.block.d(o),t.token=null,t=null}}}function un(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function _n(r){lt(r);let e,n,l=r[15]+"",t,o,i;return e=new ye({props:{src:de(r[14]),name:r[15],width:24,height:24}}),{c(){oe(e.$$.fragment),n=O(),t=y(l),o=O()},l(f){se(e.$$.fragment,f),n=j(f),t=E(f,l),o=j(f)},m(f,s){fe(e,f,s),p(f,n,s),p(f,t,s),p(f,o,s),i=!0},p(f,s){lt(f);const a={};s&45&&(a.src=de(f[14])),s&45&&(a.name=f[15]),e.$set(a),(!i||s&45)&&l!==(l=f[15]+"")&&K(t,l)},i(f){i||($(e.$$.fragment,f),i=!0)},o(f){N(e.$$.fragment,f),i=!1},d(f){f&&(h(n),h(t),h(o)),ce(e,f)}}}function hn(r){let e;return{c(){e=y(`<Unknown User>
				`)},l(n){e=E(n,`<Unknown User>
				`)},m(n,l){p(n,e,l)},p:m,i:m,o:m,d(n){n&&h(e)}}}function it(r){let e,n=r[13].content+"",l;return{c(){e=M("span"),l=y(n),this.h()},l(t){e=I(t,"SPAN",{class:!0});var o=L(e);l=E(o,n),o.forEach(h),this.h()},h(){g(e,"class","text-gray-600")},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&13&&n!==(n=t[13].content+"")&&K(l,n)},d(t){t&&h(e)}}}function mn(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function dn(r){let e,n,l,t=r[2]!=null&&nt(r);return{c(){e=M("a"),t&&t.c(),this.h()},l(o){e=I(o,"A",{href:!0});var i=L(e);t&&t.l(i),i.forEach(h),this.h()},h(){g(e,"href",n=We+"/"+(r[1]==null?`channels/${r[2]}#${r[0]}`:`servers/${r[1]}/channels/${r[2]}#${r[0]}`))},m(o,i){p(o,e,i),t&&t.m(e,null),l=!0},p(o,[i]){o[2]!=null?t?(t.p(o,i),i&4&&$(t,1)):(t=nt(o),t.c(),$(t,1),t.m(e,null)):t&&(ne(),N(t,1,1,()=>{t=null}),re()),(!l||i&7&&n!==(n=We+"/"+(o[1]==null?`channels/${o[2]}#${o[0]}`:`servers/${o[1]}/channels/${o[2]}#${o[0]}`)))&&g(e,"href",n)},i(o){l||($(t),l=!0)},o(o){N(t),l=!1},d(o){o&&h(e),t&&t.d()}}}function pn(r,e,n){let l,t,o,i,f;const s=te(Oe),a=te(Ie);le(r,a,A=>n(4,i=A));const _=te(Tt);le(r,_,A=>n(1,l=A));const c=te(Ut);le(r,c,A=>n(2,t=A));const d=te(Ke);le(r,d,A=>n(3,o=A));const V=te(Fe);le(r,V,A=>n(5,f=A));let{id:G}=e;const F=({_id:A})=>G==A;return r.$$set=A=>{"id"in A&&n(0,G=A.id)},[G,l,t,o,i,f,s,a,_,c,d,V,F]}class bn extends ke{constructor(e){super(),ge(this,e,pn,dn,be,{id:0})}}function ot(r,e,n){const l=r.slice();return l[30]=e[n],l}function st(r,e,n){const l=r.slice();return l[33]=e[n],l}function ft(r,e,n){const l=r.slice();return l[36]=e[n].src,l[37]=e[n].alt,l[38]=e[n].onclick,l[39]=e[n].showIf,l}function Ve(r){const e=r.slice(),n=new Date(e[0].edited);return e[8]=n,e}function ct(r,e,n){const l=r.slice();return l[42]=e[n],l}function at(r){let e,n,l=ue(r[0].replies),t=[];for(let i=0;i<l.length;i+=1)t[i]=ut(ct(r,l,i));const o=i=>N(t[i],1,1,()=>{t[i]=null});return{c(){e=M("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var f=L(e);for(let s=0;s<t.length;s+=1)t[s].l(f);f.forEach(h),this.h()},h(){g(e,"class","flex flex-col")},m(i,f){p(i,e,f);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null);n=!0},p(i,f){if(f[0]&1){l=ue(i[0].replies);let s;for(s=0;s<l.length;s+=1){const a=ct(i,l,s);t[s]?(t[s].p(a,f),$(t[s],1)):(t[s]=ut(a),t[s].c(),$(t[s],1),t[s].m(e,null))}for(ne(),s=l.length;s<t.length;s+=1)o(s);re()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)$(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)N(t[f]);n=!1},d(i){i&&h(e),$e(t,i)}}}function ut(r){let e,n;return e=new bn({props:{id:r[42]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.id=l[42]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function _t(r){let e,n;return e=new ye({props:{name:r[4],src:r[3],width:40,height:40}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&16&&(o.name=l[4]),t[0]&8&&(o.src=l[3]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function ht(r){let e,n=r[5]("message.edited")+"",l,t,o=r[6](r[8])+"",i,f,s=r[7](r[8])+"",a,_;return{c(){e=y("["),l=y(n),t=O(),i=y(o),f=O(),a=y(s),_=y("]")},l(c){e=E(c,"["),l=E(c,n),t=j(c),i=E(c,o),f=j(c),a=E(c,s),_=E(c,"]")},m(c,d){p(c,e,d),p(c,l,d),p(c,t,d),p(c,i,d),p(c,f,d),p(c,a,d),p(c,_,d)},p(c,d){d[0]&32&&n!==(n=c[5]("message.edited")+"")&&K(l,n),d[0]&65&&o!==(o=c[6](c[8])+"")&&K(i,o),d[0]&129&&s!==(s=c[7](c[8])+"")&&K(a,s)},d(c){c&&(h(e),h(l),h(t),h(i),h(f),h(a),h(_))}}}function mt(r){let e,n,l,t,o,i;function f(){return r[20](r[38])}return{c(){e=M("button"),n=M("img"),t=O(),this.h()},l(s){e=I(s,"BUTTON",{class:!0,"aria-label":!0});var a=L(e);n=I(a,"IMG",{width:!0,height:!0,src:!0,alt:!0}),t=j(a),a.forEach(h),this.h()},h(){g(n,"width","16"),g(n,"height","16"),_e(n.src,l=r[36])||g(n,"src",l),g(n,"alt",r[37]),g(e,"class","ml-2"),g(e,"aria-label",r[37])},m(s,a){p(s,e,a),k(e,n),k(e,t),o||(i=me(e,"click",f),o=!0)},p(s,a){r=s},d(s){s&&h(e),o=!1,i()}}}function dt(r){var t;let e=((t=r[39])==null?void 0:t.call(r,r[0]))??!0,n,l=e&&mt(r);return{c(){l&&l.c(),n=H()},l(o){l&&l.l(o),n=H()},m(o,i){l&&l.m(o,i),p(o,n,i)},p(o,i){var f;i[0]&1&&(e=((f=o[39])==null?void 0:f.call(o,o[0]))??!0),e?l?l.p(o,i):(l=mt(o),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(o){o&&h(n),l&&l.d(o)}}}function kn(r){let e,n=r[0].content+"",l;return{c(){e=M("span"),l=y(n),this.h()},l(t){e=I(t,"SPAN",{style:!0,class:!0});var o=L(e);l=E(o,n),o.forEach(h),this.h()},h(){Ue(e,"overflow-wrap","break-word"),g(e,"class","whitespace-pre-wrap")},m(t,o){p(t,e,o),k(e,l)},p(t,o){o[0]&1&&n!==(n=t[0].content+"")&&K(l,n)},d(t){t&&h(e)}}}function gn(r){let e,n,l,t;return{c(){e=M("form"),n=M("textarea"),this.h()},l(o){e=I(o,"FORM",{class:!0});var i=L(e);n=I(i,"TEXTAREA",{class:!0,placeholder:!0}),L(n).forEach(h),i.forEach(h),this.h()},h(){g(n,"class","outline-none resize-none bg-inherit w-full"),g(n,"placeholder","Edit this message"),g(e,"class","bg-gray-500 rounded-xl px-2 pt-2")},m(o,i){p(o,e,i),k(e,n),Xe(n,r[2]),l||(t=[me(n,"keydown",r[21]),me(n,"input",r[22]),me(e,"submit",r[15])],l=!0)},p(o,i){i[0]&4&&Xe(n,o[2])},d(o){o&&h(e),l=!1,Se(t)}}}function pt(r){let e,n;return e=new tn({props:{system:r[0].system}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.system=l[0].system),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function bt(r){let e,n,l=ue(r[0].attachments),t=[];for(let i=0;i<l.length;i+=1)t[i]=kt(st(r,l,i));const o=i=>N(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=H()},l(i){for(let f=0;f<t.length;f+=1)t[f].l(i);e=H()},m(i,f){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,f);p(i,e,f),n=!0},p(i,f){if(f[0]&1){l=ue(i[0].attachments);let s;for(s=0;s<l.length;s+=1){const a=st(i,l,s);t[s]?(t[s].p(a,f),$(t[s],1)):(t[s]=kt(a),t[s].c(),$(t[s],1),t[s].m(e.parentNode,e))}for(ne(),s=l.length;s<t.length;s+=1)o(s);re()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)$(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)N(t[f]);n=!1},d(i){i&&h(e),$e(t,i)}}}function kt(r){let e,n;return e=new Ml({props:{attachment:r[33]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.attachment=l[33]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function gt(r){let e,n,l=ue(r[0].embeds),t=[];for(let i=0;i<l.length;i+=1)t[i]=vt(ot(r,l,i));const o=i=>N(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=H()},l(i){for(let f=0;f<t.length;f+=1)t[f].l(i);e=H()},m(i,f){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,f);p(i,e,f),n=!0},p(i,f){if(f[0]&1){l=ue(i[0].embeds);let s;for(s=0;s<l.length;s+=1){const a=ot(i,l,s);t[s]?(t[s].p(a,f),$(t[s],1)):(t[s]=vt(a),t[s].c(),$(t[s],1),t[s].m(e.parentNode,e))}for(ne(),s=l.length;s<t.length;s+=1)o(s);re()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)$(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)N(t[f]);n=!1},d(i){i&&h(e),$e(t,i)}}}function vt(r){let e,n;return e=new fl({props:{embed:r[30]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.embed=l[30]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function vn(r){let e,n,l,t,o,i,f,s,a=r[6](r[8])+"",_,c,d=r[7](r[8])+"",V,G,F,A,D,x,X,R,J,ee,T,S,b=r[0].replies!=null&&r[0].replies.length!=0&&at(r),v=!r[1]["jolt:compact-mode"]&&_t(r),u=r[0].edited!=null&&ht(Ve(r)),U=ue(r[14]),P=[];for(let C=0;C<U.length;C+=1)P[C]=dt(ft(r,U,C));function W(C,q){if(C[2]!=null)return gn;if(C[0].content!=null)return kn}let w=W(r),z=w&&w(r),Z=r[0].system!=null&&pt(r),Q=r[0].attachments!=null&&bt(r),B=r[0].embeds!=null&&gt(r);return{c(){e=M("div"),b&&b.c(),n=O(),l=M("div"),v&&v.c(),t=O(),o=y(r[4]),i=O(),f=M("p"),s=y("["),_=y(a),c=O(),V=y(d),G=y(`]

			`),u&&u.c(),F=O(),A=M("div"),D=O(),x=M("div");for(let C=0;C<P.length;C+=1)P[C].c();X=O(),z&&z.c(),R=O(),Z&&Z.c(),J=O(),Q&&Q.c(),ee=O(),B&&B.c(),this.h()},l(C){e=I(C,"DIV",{id:!0,class:!0});var q=L(e);b&&b.l(q),n=j(q),l=I(q,"DIV",{class:!0});var Y=L(l);v&&v.l(Y),t=j(Y),o=E(Y,r[4]),i=j(Y),f=I(Y,"P",{class:!0});var ae=L(f);s=E(ae,"["),_=E(ae,a),c=j(ae),V=E(ae,d),G=E(ae,`]

			`),u&&u.l(ae),ae.forEach(h),F=j(Y),A=I(Y,"DIV",{class:!0}),L(A).forEach(h),D=j(Y),x=I(Y,"DIV",{class:!0});var ve=L(x);for(let Ee=0;Ee<P.length;Ee+=1)P[Ee].l(ve);ve.forEach(h),Y.forEach(h),X=j(q),z&&z.l(q),R=j(q),Z&&Z.l(q),J=j(q),Q&&Q.l(q),ee=j(q),B&&B.l(q),q.forEach(h),this.h()},h(){g(f,"class","text-gray-500"),g(A,"class","flex-1"),g(x,"class","hidden group-hover:flex"),g(l,"class","flex"),g(e,"id",T=r[0]._id),g(e,"class","flex flex-col hover:bg-gray-800 group p-4")},m(C,q){p(C,e,q),b&&b.m(e,null),k(e,n),k(e,l),v&&v.m(l,null),k(l,t),k(l,o),k(l,i),k(l,f),k(f,s),k(f,_),k(f,c),k(f,V),k(f,G),u&&u.m(f,null),k(l,F),k(l,A),k(l,D),k(l,x);for(let Y=0;Y<P.length;Y+=1)P[Y]&&P[Y].m(x,null);k(e,X),z&&z.m(e,null),k(e,R),Z&&Z.m(e,null),k(e,J),Q&&Q.m(e,null),k(e,ee),B&&B.m(e,null),S=!0},p(C,q){if(C[0].replies!=null&&C[0].replies.length!=0?b?(b.p(C,q),q[0]&1&&$(b,1)):(b=at(C),b.c(),$(b,1),b.m(e,n)):b&&(ne(),N(b,1,1,()=>{b=null}),re()),C[1]["jolt:compact-mode"]?v&&(ne(),N(v,1,1,()=>{v=null}),re()):v?(v.p(C,q),q[0]&2&&$(v,1)):(v=_t(C),v.c(),$(v,1),v.m(l,t)),(!S||q[0]&16)&&K(o,C[4]),(!S||q[0]&320)&&a!==(a=C[6](C[8])+"")&&K(_,a),(!S||q[0]&384)&&d!==(d=C[7](C[8])+"")&&K(V,d),C[0].edited!=null?u?u.p(Ve(C),q):(u=ht(Ve(C)),u.c(),u.m(f,null)):u&&(u.d(1),u=null),q[0]&16385){U=ue(C[14]);let Y;for(Y=0;Y<U.length;Y+=1){const ae=ft(C,U,Y);P[Y]?P[Y].p(ae,q):(P[Y]=dt(ae),P[Y].c(),P[Y].m(x,null))}for(;Y<P.length;Y+=1)P[Y].d(1);P.length=U.length}w===(w=W(C))&&z?z.p(C,q):(z&&z.d(1),z=w&&w(C),z&&(z.c(),z.m(e,R))),C[0].system!=null?Z?(Z.p(C,q),q[0]&1&&$(Z,1)):(Z=pt(C),Z.c(),$(Z,1),Z.m(e,J)):Z&&(ne(),N(Z,1,1,()=>{Z=null}),re()),C[0].attachments!=null?Q?(Q.p(C,q),q[0]&1&&$(Q,1)):(Q=bt(C),Q.c(),$(Q,1),Q.m(e,ee)):Q&&(ne(),N(Q,1,1,()=>{Q=null}),re()),C[0].embeds!=null?B?(B.p(C,q),q[0]&1&&$(B,1)):(B=gt(C),B.c(),$(B,1),B.m(e,null)):B&&(ne(),N(B,1,1,()=>{B=null}),re()),(!S||q[0]&1&&T!==(T=C[0]._id))&&g(e,"id",T)},i(C){S||($(b),$(v),$(Z),$(Q),$(B),S=!0)},o(C){N(b),N(v),N(Z),N(Q),N(B),S=!1},d(C){C&&h(e),b&&b.d(),v&&v.d(),u&&u.d(),$e(P,C),z&&z.d(),Z&&Z.d(),Q&&Q.d(),B&&B.d()}}}function $n(r,e,n){let l,t,o,i,f,s,a,_,c,d,V;le(r,Ce,w=>n(5,_=w)),le(r,Ft,w=>n(6,d=w)),le(r,Gt,w=>n(7,V=w));let{message:G}=e,F,A,D;te(At);const x=te(Ie);le(r,x,w=>n(1,i=w));const X=te(Oe),R=te(Tt);le(r,R,w=>n(18,f=w)),te(Ut);const J=te(Ke),ee=te(Fe);le(r,ee,w=>n(19,s=w));const T=te(St);le(r,T,w=>n(23,a=w));const S=te(Ot);le(r,S,w=>n(24,c=w));const b=[{src:"/reply.svg",alt:_("message.reply"),onclick(){c!=null&&c.some(w=>w.message._id==G._id)||S==null||S.update(w=>(w.push({message:G,mention:!0}),w))}},{src:"/note.svg",alt:_("message.edit"),showIf:w=>{var z;return w.author==((z=X.user)==null?void 0:z._id)},onclick:w=>n(2,F=F==null?w.content??"":void 0)},{src:"/trash.svg",alt:_("message.delete"),showIf:w=>{var z;return w.author==((z=X.user)==null?void 0:z._id)},onclick:w=>X.api.deleteMessage(w.channel,w._id)}];async function v(w,z){n(17,D=a==null?void 0:a.find(Z=>Z._id.server==w&&Z._id.user==z))}async function u(){const w=await X.api.editMessage(G.channel,G._id,{content:F});J==null||J.update(z=>(z[z.findIndex(Z=>Z._id==G._id)]=w,z))}const U=w=>w(G),P=w=>{if(!w.defaultPrevented){if(w.key=="Escape"){w.preventDefault(),n(2,F=void 0);return}w.shiftKey||w.key!="Enter"||(w.preventDefault(),u(),n(2,F=void 0))}};function W(){F=this.value,n(2,F)}return r.$$set=w=>{"message"in w&&n(0,G=w.message)},r.$$.update=()=>{r.$$.dirty[0]&524289&&Pe(X.api,s??[],G.author).then(w=>n(16,A=w)),r.$$.dirty[0]&262145&&(f==null||v(f,G.author)),r.$$.dirty[0]&196609&&n(4,l=he(A,D,G)),r.$$.dirty[0]&196611&&n(3,t=i["jolt:low-data-mode"]?"/user.svg":de(A,D,G)),r.$$.dirty[0]&1&&n(8,o=on(G._id))},[G,i,F,t,l,_,d,V,o,x,R,ee,T,S,b,u,A,D,f,s,U,P,W]}class wn extends ke{constructor(e){super(),ge(this,e,$n,vn,be,{message:0},null,[-1,-1])}}function $t(r,e,n){const l=r.slice();l[23]=e[n],l[25]=e,l[26]=n;const t=l[10].api.fetchUser(l[23].message.author);return l[24]=t,l}function wt(r){const e=`<${r[6]("user.unknown")}>`;r[27]=e}function yt(r){const e=he(r[24]);r[27]=e}function Et(r,e,n){const l=r.slice();l[24]=e[n];const t=he(l[24]);return l[27]=t,l}function Nt(r,e,n){const l=r.slice();return l[30]=e[n],l}function Mt(r){let e,n;return e=new wn({props:{message:r[30]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&256&&(o.message=l[30]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function It(r){let e,n,l,t=r[27]+"",o,i,f=r[6]("user.is-typing")+"",s,a,_;return n=new ye({props:{src:r[2]["jolt:low-data-mode"]?"/user.svg":de(r[24]),width:16,height:16,name:r[27]}}),{c(){e=M("div"),oe(n.$$.fragment),l=O(),o=y(t),i=O(),s=y(f),a=y("...")},l(c){e=I(c,"DIV",{});var d=L(e);se(n.$$.fragment,d),l=j(d),o=E(d,t),i=j(d),s=E(d,f),a=E(d,"..."),d.forEach(h)},m(c,d){p(c,e,d),fe(n,e,null),k(e,l),k(e,o),k(e,i),k(e,s),k(e,a),_=!0},p(c,d){const V={};d[0]&20&&(V.src=c[2]["jolt:low-data-mode"]?"/user.svg":de(c[24])),d[0]&16&&(V.name=c[27]),n.$set(V),(!_||d[0]&16)&&t!==(t=c[27]+"")&&K(o,t),(!_||d[0]&64)&&f!==(f=c[6]("user.is-typing")+"")&&K(s,f)},i(c){_||($(n.$$.fragment,c),_=!0)},o(c){N(n.$$.fragment,c),_=!1},d(c){c&&h(e),ce(n)}}}function yn(r){wt(r);let e,n,l=r[27]+"",t,o;return e=new ye({props:{src:"/user.svg",name:r[27]}}),{c(){oe(e.$$.fragment),n=O(),t=y(l)},l(i){se(e.$$.fragment,i),n=j(i),t=E(i,l)},m(i,f){fe(e,i,f),p(i,n,f),p(i,t,f),o=!0},p(i,f){wt(i);const s={};f[0]&64&&(s.name=i[27]),e.$set(s),(!o||f[0]&64)&&l!==(l=i[27]+"")&&K(t,l)},i(i){o||($(e.$$.fragment,i),o=!0)},o(i){N(e.$$.fragment,i),o=!1},d(i){i&&(h(n),h(t)),ce(e,i)}}}function En(r){yt(r);let e,n,l=r[27]+"",t,o;return e=new ye({props:{src:de(r[24]),name:r[27]}}),{c(){oe(e.$$.fragment),n=O(),t=y(l)},l(i){se(e.$$.fragment,i),n=j(i),t=E(i,l)},m(i,f){fe(e,i,f),p(i,n,f),p(i,t,f),o=!0},p(i,f){yt(i);const s={};f[0]&128&&(s.src=de(i[24])),f[0]&128&&(s.name=i[27]),e.$set(s),(!o||f[0]&128)&&l!==(l=i[27]+"")&&K(t,l)},i(i){o||($(e.$$.fragment,i),o=!0)},o(i){N(e.$$.fragment,i),o=!1},d(i){i&&(h(n),h(t)),ce(e,i)}}}function Nn(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Ct(r){let e,n,l=r[6]("message.replying-to")+"",t,o,i,f,s,a,_=r[23].message.content+"",c,d,V,G,F,A,D,x,X,R,J,ee=r[23].mention?"ON":"OFF",T,S,b,v,u='<img src="/circle-x.svg" alt="Cancel mention"/>',U,P,W,w={ctx:r,current:null,token:null,hasCatch:!0,pending:Nn,then:En,catch:yn,value:24,blocks:[,,,]};ie(f=r[24],w);function z(){r[13].call(A,r[25],r[26])}function Z(){return r[14](r[23])}return{c(){e=M("div"),n=M("p"),t=y(l),o=O(),i=M("strong"),w.block.c(),s=O(),a=M("p"),c=y(_),d=O(),V=M("div"),G=O(),F=M("div"),A=M("input"),D=O(),x=M("label"),X=M("img"),J=O(),T=y(ee),S=O(),b=M("div"),v=M("button"),v.innerHTML=u,this.h()},l(Q){e=I(Q,"DIV",{class:!0});var B=L(e);n=I(B,"P",{});var C=L(n);t=E(C,l),o=j(C),i=I(C,"STRONG",{});var q=L(i);w.block.l(q),q.forEach(h),C.forEach(h),s=j(B),a=I(B,"P",{class:!0});var Y=L(a);c=E(Y,_),Y.forEach(h),d=j(B),V=I(B,"DIV",{class:!0}),L(V).forEach(h),G=j(B),F=I(B,"DIV",{class:!0});var ae=L(F);A=I(ae,"INPUT",{id:!0,style:!0,type:!0}),D=j(ae),x=I(ae,"LABEL",{class:!0,for:!0});var ve=L(x);X=I(ve,"IMG",{src:!0,class:!0,alt:!0}),J=j(ve),T=E(ve,ee),ve.forEach(h),ae.forEach(h),S=j(B),b=I(B,"DIV",{class:!0});var Ee=L(b);v=I(Ee,"BUTTON",{"data-svelte-h":!0}),Me(v)!=="svelte-wqsbkb"&&(v.innerHTML=u),Ee.forEach(h),B.forEach(h),this.h()},h(){g(a,"class","pl-1 text-gray-600 overflow-ellipsis"),g(V,"class","flex-1"),g(A,"id","mention"),Ue(A,"display","none"),g(A,"type","checkbox"),_e(X.src,R="/at.svg")||g(X,"src",R),g(X,"class","inline"),g(X,"alt","mention"),g(x,"class","cursor-pointer"),g(x,"for","mention"),g(F,"class","pr-2"),g(b,"class","pr-2"),g(e,"class","flex")},m(Q,B){p(Q,e,B),k(e,n),k(n,t),k(n,o),k(n,i),w.block.m(i,w.anchor=null),w.mount=()=>i,w.anchor=null,k(e,s),k(e,a),k(a,c),k(e,d),k(e,V),k(e,G),k(e,F),k(F,A),A.checked=r[23].mention,k(F,D),k(F,x),k(x,X),k(x,J),k(x,T),k(e,S),k(e,b),k(b,v),U=!0,P||(W=[me(A,"change",z),me(v,"click",Z)],P=!0)},p(Q,B){r=Q,(!U||B[0]&64)&&l!==(l=r[6]("message.replying-to")+"")&&K(t,l),w.ctx=r,B[0]&128&&f!==(f=r[24])&&ie(f,w)||pe(w,r,B),(!U||B[0]&128)&&_!==(_=r[23].message.content+"")&&K(c,_),B[0]&128&&(A.checked=r[23].mention),(!U||B[0]&128)&&ee!==(ee=r[23].mention?"ON":"OFF")&&K(T,ee)},i(Q){U||($(w.block),U=!0)},o(Q){for(let B=0;B<3;B+=1){const C=w.blocks[B];N(C)}U=!1},d(Q){Q&&h(e),w.block.d(),w.token=null,w=null,P=!1,Se(W)}}}function Mn(r){let e,n,l,t="so um hi this is the start, i should make this text box much further down i think",o,i,f,s,a,_,c,d,V,G,F,A=ue(r[8]),D=[];for(let b=0;b<A.length;b+=1)D[b]=Mt(Nt(r,A,b));const x=b=>N(D[b],1,1,()=>{D[b]=null});let X=ue(r[4]),R=[];for(let b=0;b<X.length;b+=1)R[b]=It(Et(r,X,b));const J=b=>N(R[b],1,1,()=>{R[b]=null});let ee=ue(r[7]),T=[];for(let b=0;b<ee.length;b+=1)T[b]=Ct($t(r,ee,b));const S=b=>N(T[b],1,1,()=>{T[b]=null});return{c(){e=M("main"),n=M("div"),l=M("p"),l.textContent=t,o=O();for(let b=0;b<D.length;b+=1)D[b].c();i=O();for(let b=0;b<R.length;b+=1)R[b].c();f=O();for(let b=0;b<T.length;b+=1)T[b].c();s=O(),a=M("form"),_=M("div"),c=M("textarea"),this.h()},l(b){e=I(b,"MAIN",{class:!0});var v=L(e);n=I(v,"DIV",{class:!0});var u=L(n);l=I(u,"P",{"data-svelte-h":!0}),Me(l)!=="svelte-1kz18j0"&&(l.textContent=t),o=j(u);for(let W=0;W<D.length;W+=1)D[W].l(u);i=j(u);for(let W=0;W<R.length;W+=1)R[W].l(u);f=j(u);for(let W=0;W<T.length;W+=1)T[W].l(u);s=j(u),a=I(u,"FORM",{class:!0});var U=L(a);_=I(U,"DIV",{class:!0});var P=L(_);c=I(P,"TEXTAREA",{class:!0,placeholder:!0}),L(c).forEach(h),P.forEach(h),U.forEach(h),u.forEach(h),v.forEach(h),this.h()},h(){g(c,"class","outline-none resize-none bg-inherit w-full"),g(c,"placeholder",d=r[6]("send-message-in")+" "+r[5]),g(_,"class","bg-gray-500 rounded-xl px-2 pt-2"),g(a,"class","m-4"),g(n,"class","flex flex-col h-full overflow-x-hidden overflow-y-scroll"),g(e,"class","main-content-container")},m(b,v){p(b,e,v),k(e,n),k(n,l),k(n,o);for(let u=0;u<D.length;u+=1)D[u]&&D[u].m(n,null);k(n,i);for(let u=0;u<R.length;u+=1)R[u]&&R[u].m(n,null);k(n,f);for(let u=0;u<T.length;u+=1)T[u]&&T[u].m(n,null);k(n,s),k(n,a),k(a,_),k(_,c),r[17](c),V=!0,G||(F=[me(c,"input",r[15]),me(c,"keydown",r[16]),me(a,"submit",Dt(r[12]))],G=!0)},p(b,v){if(v[0]&256){A=ue(b[8]);let u;for(u=0;u<A.length;u+=1){const U=Nt(b,A,u);D[u]?(D[u].p(U,v),$(D[u],1)):(D[u]=Mt(U),D[u].c(),$(D[u],1),D[u].m(n,i))}for(ne(),u=A.length;u<D.length;u+=1)x(u);re()}if(v[0]&84){X=ue(b[4]);let u;for(u=0;u<X.length;u+=1){const U=Et(b,X,u);R[u]?(R[u].p(U,v),$(R[u],1)):(R[u]=It(U),R[u].c(),$(R[u],1),R[u].m(n,f))}for(ne(),u=X.length;u<R.length;u+=1)J(u);re()}if(v[0]&1218){ee=ue(b[7]);let u;for(u=0;u<ee.length;u+=1){const U=$t(b,ee,u);T[u]?(T[u].p(U,v),$(T[u],1)):(T[u]=Ct(U),T[u].c(),$(T[u],1),T[u].m(n,s))}for(ne(),u=ee.length;u<T.length;u+=1)S(u);re()}(!V||v[0]&96&&d!==(d=b[6]("send-message-in")+" "+b[5]))&&g(c,"placeholder",d)},i(b){if(!V){for(let v=0;v<A.length;v+=1)$(D[v]);for(let v=0;v<X.length;v+=1)$(R[v]);for(let v=0;v<ee.length;v+=1)$(T[v]);V=!0}},o(b){D=D.filter(Boolean);for(let v=0;v<D.length;v+=1)N(D[v]);R=R.filter(Boolean);for(let v=0;v<R.length;v+=1)N(R[v]);T=T.filter(Boolean);for(let v=0;v<T.length;v+=1)N(T[v]);V=!1},d(b){b&&h(e),$e(D,b),$e(R,b),$e(T,b),r[17](null),G=!1,Se(F)}}}function In(r,e,n){let l,t,o=m,i=()=>(o(),o=Bt(F,u=>n(7,t=u)),F),f,s;le(r,Ce,u=>n(6,l=u)),r.$$.on_destroy.push(()=>o());let{channel:a}=e;te(At);const _=te(Ie);le(r,_,u=>n(2,f=u));const c=te(Oe);let d=Te([]);le(r,d,u=>n(8,s=u));let V=Te([]),G=Te([]);const F=Te([]);i(),Ae(Ke,d),Ae(St,V),Ae(Fe,G),Ae(Ot,F);let A,D=[];async function x(u){if(!u){c.removeAllListeners("ChannelStartTyping"),c.removeAllListeners("ChannelStopTyping");return}c.on("ChannelStartTyping",async({id:U,user:P})=>{var W;if(!(P==((W=c.user)==null?void 0:W._id)||U!=a._id)){for(const{_id:w}of D)if(P==w)return;n(4,D[D.length]=await c.api.fetchUser(P),D)}}),c.on("ChannelStopTyping",({id:U,user:P})=>{U==a._id&&n(4,D=D.filter(W=>W._id!=P))})}Rt(()=>{c.on("Message",u=>{u.channel==a._id&&(c.api.ackMessage(a._id,u._id),d.update(U=>(U.push(u),U)))}),c.on("MessageDelete",({id:u,channel:U})=>{U==a._id&&d.update(P=>P.filter(W=>W._id!=u))}),c.on("MessageUpdate",({id:u,channel:U,data:P})=>{U==a._id&&d.update(W=>{const w=W.findIndex(Z=>Z._id==u),z=W[w];return P.content!=null&&(z.content=P.content),P.embeds!=null&&(z.embeds=P.embeds),z.edited=P.edited,W[w]=z,W})})});async function X(){await c.api.sendMessage(a._id,{content:A.value.trim(),replies:t.map(({message:{_id:u},mention:U})=>({id:u,mention:U}))}),F.set([]),n(3,A.value="",A)}let R;async function J(u){var U;if(u.channel_type=="TextChannel"||u.channel_type=="VoiceChannel"||u.channel_type=="Group"){n(5,R=`#${u.name}`);return}if(u.channel_type=="SavedMessages"){n(5,R=l("channel.notes"));return}n(5,R=`@${he(await c.api.fetchUser(u.recipients[0]==((U=c.user)==null?void 0:U._id)?u.recipients[1]:u.recipients[0]))}`)}function ee(u,U){u[U].mention=this.checked,F.set(t)}const T=u=>F.update(U=>(U=U.filter(P=>P.message._id!=u.message._id),U)),S=()=>{f["jolt:send-typing-indicators"]&&c.websocket.send({type:"BeginTyping",channel:a._id})},b=u=>{u.shiftKey||u.key!="Enter"||(u.preventDefault(),X())};function v(u){Le[u?"unshift":"push"](()=>{A=u,n(3,A)})}return r.$$set=u=>{"channel"in u&&n(0,a=u.channel)},r.$$.update=()=>{r.$$.dirty[0]&1&&(c.api.queryMessages(a._id,{sort:"Latest",include_users:!0}).then(u=>{Array.isArray(u)?d.set(u.reverse()):(d.set(u.messages.reverse()??[]),G.set(u.users),V.set(u.members??[]))}),F.set([]),n(4,D=[])),r.$$.dirty[0]&4&&x(f["jolt:receive-typing-indicators"]),r.$$.dirty[0]&1&&J(a)},[a,F,f,A,D,R,l,t,s,_,c,d,X,ee,T,S,b,v]}class Bn extends ke{constructor(e){super(),ge(this,e,In,Mn,be,{channel:0},null,[-1,-1])}}export{Bn as C};
