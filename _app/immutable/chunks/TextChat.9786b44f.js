import{s as pe,f as E,g as I,h as D,d as u,j as a,i as g,r as _e,e as F,u as m,a as q,c as L,l as C,m as N,z as v,n as J,G as Y,C as ye,D as $e,v as At,I as Te,J as he,w as jt,x as Ot,y as Pt,L as Se,M as Bt,p as Ie,N as qt,O as Le,k as Me,P as He,Q as Lt,F as Ee,A as Vt,q as ze,R as Ue,S as Rt,t as Ft}from"./scheduler.e5faf66b.js";import{h as ce,u as we}from"./await_block.61db03c9.js";import{e as de}from"./each.e59479a4.js";import{S as ge,i as be,a as k,g as Q,t as y,c as W,b as x,d as ne,m as ee,e as te,f as Ve}from"./index.fd37aab3.js";import{g as le,c as Ce,a as De}from"./context.634f79ee.js";import{g as ve,b as ke,a as Gt}from"./util.650f29ea.js";import{w as Oe}from"./index.586d49f4.js";import{b as Xe}from"./paths.16ac5fdf.js";import{a as Nt,s as Kt}from"./context.fa34f1f8.js";import{U as Ae}from"./UserIcon.b7da56f9.js";import{e as Ht,Y as zt}from"./runtime.esm.f23bcf25.js";import{d as Xt}from"./index.esm.4b6e8736.js";import{P as Jt}from"./PencilSquareIcon.e3b6c7ad.js";import{t as Qt,P as Wt}from"./PlusIcon.9f49faf8.js";async function qe(r,e,n){if(n=="0".repeat(26))return;let l;return Array.isArray(e)?l=e.find(t=>t._id==n):l=e.get(n),l??await r.fetchUser(n)}const Ut=Symbol(),Re=Symbol(),Tt=Symbol(),Fe=Symbol(),Ge=Symbol();function Yt(r){const e=r.slice(),n=ke(e[14]);return e[15]=n,e}function Je(r){var s;let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:il,then:xt,catch:Zt,value:13,blocks:[,,,]};return ce(n=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),t),{c(){e=F(),t.block.c()},l(i){e=F(),t.block.l(i)},m(i,c){g(i,e,c),t.block.m(i,t.anchor=c),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(i,c){var o;r=i,t.ctx=r,c&13&&n!==(n=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&ce(n,t)||we(t,r,c)},i(i){l||(k(t.block),l=!0)},o(i){for(let c=0;c<3;c+=1){const o=t.blocks[c];y(o)}l=!1},d(i){i&&u(e),t.block.d(i),t.token=null,t=null}}}function Zt(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function xt(r){let e,n,l,t=!r[4]["jolt:low-data-mode"]&&Qe(r),s=r[13].content!=null&&We(r);return{c(){t&&t.c(),e=q(),s&&s.c(),n=F()},l(i){t&&t.l(i),e=L(i),s&&s.l(i),n=F()},m(i,c){t&&t.m(i,c),g(i,e,c),s&&s.m(i,c),g(i,n,c),l=!0},p(i,c){i[4]["jolt:low-data-mode"]?t&&(Q(),y(t,1,1,()=>{t=null}),W()):t?(t.p(i,c),c&16&&k(t,1)):(t=Qe(i),t.c(),k(t,1),t.m(e.parentNode,e)),i[13].content!=null?s?s.p(i,c):(s=We(i),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(i){l||(k(t),l=!0)},o(i){y(t),l=!1},d(i){i&&(u(e),u(n)),t&&t.d(i),s&&s.d(i)}}}function Qe(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:rl,then:tl,catch:el,value:14,blocks:[,,,]};return ce(e=qe(r[6].api,r[5]??r[6].api.cache.users,r[13].author),t),{c(){t.block.c(),n=C(":")},l(s){t.block.l(s),n=N(s,":")},m(s,i){t.block.m(s,t.anchor=i),t.mount=()=>n.parentNode,t.anchor=n,g(s,n,i),l=!0},p(s,i){r=s,t.ctx=r,i&45&&e!==(e=qe(r[6].api,r[5]??r[6].api.cache.users,r[13].author))&&ce(e,t)||we(t,r,i)},i(s){l||(k(t.block),l=!0)},o(s){for(let i=0;i<3;i+=1){const c=t.blocks[i];y(c)}l=!1},d(s){s&&u(n),t.block.d(s),t.token=null,t=null}}}function el(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function tl(r){let e,n,l,t;const s=[nl,ll],i=[];function c(f,p){return f[14]!=null?0:1}function o(f,p){return p===0?Yt(f):f}return e=c(r),n=i[e]=s[e](o(r,e)),{c(){n.c(),l=q()},l(f){n.l(f),l=L(f)},m(f,p){i[e].m(f,p),g(f,l,p),t=!0},p(f,p){let d=e;e=c(f),e===d?i[e].p(o(f,e),p):(Q(),y(i[d],1,1,()=>{i[d]=null}),W(),n=i[e],n?n.p(o(f,e),p):(n=i[e]=s[e](o(f,e)),n.c()),k(n,1),n.m(l.parentNode,l))},i(f){t||(k(n),t=!0)},o(f){y(n),t=!1},d(f){f&&u(l),i[e].d(f)}}}function ll(r){let e,n,l;return e=new Ae({}),{c(){x(e.$$.fragment),n=C(`

						Unknown User`)},l(t){ne(e.$$.fragment,t),n=N(t,`

						Unknown User`)},m(t,s){ee(e,t,s),g(t,n,s),l=!0},p:m,i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){t&&u(n),te(e,t)}}}function nl(r){let e,n,l,t,s=r[15]+"",i;return{c(){e=E("img"),t=q(),i=C(s),this.h()},l(c){e=I(c,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),t=L(c),i=N(c,s),this.h()},h(){a(e,"class","cover"),Y(e.src,n=ve(r[14]))||a(e,"src",n),a(e,"alt",l=r[15]),a(e,"width","24px"),a(e,"height","24px")},m(c,o){g(c,e,o),g(c,t,o),g(c,i,o)},p(c,o){o&45&&!Y(e.src,n=ve(c[14]))&&a(e,"src",n),o&45&&l!==(l=c[15])&&a(e,"alt",l),o&45&&s!==(s=c[15]+"")&&J(i,s)},i:m,o:m,d(c){c&&(u(e),u(t),u(i))}}}function rl(r){let e;return{c(){e=C(`<Unknown User>
				`)},l(n){e=N(n,`<Unknown User>
				`)},m(n,l){g(n,e,l)},p:m,i:m,o:m,d(n){n&&u(e)}}}function We(r){let e,n=r[13].content+"",l;return{c(){e=E("span"),l=C(n),this.h()},l(t){e=I(t,"SPAN",{class:!0});var s=D(e);l=N(s,n),s.forEach(u),this.h()},h(){a(e,"class","text-gray-600")},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&13&&n!==(n=t[13].content+"")&&J(l,n)},d(t){t&&u(e)}}}function il(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function sl(r){let e,n,l,t=r[2]!=null&&Je(r);return{c(){e=E("a"),t&&t.c(),this.h()},l(s){e=I(s,"A",{href:!0});var i=D(e);t&&t.l(i),i.forEach(u),this.h()},h(){a(e,"href",n=Xe+"/"+(r[1]==null?`channels/${r[2]}#${r[0]}`:`servers/${r[1]}/channels/${r[2]}#${r[0]}`))},m(s,i){g(s,e,i),t&&t.m(e,null),l=!0},p(s,[i]){s[2]!=null?t?(t.p(s,i),i&4&&k(t,1)):(t=Je(s),t.c(),k(t,1),t.m(e,null)):t&&(Q(),y(t,1,1,()=>{t=null}),W()),(!l||i&7&&n!==(n=Xe+"/"+(s[1]==null?`channels/${s[2]}#${s[0]}`:`servers/${s[1]}/channels/${s[2]}#${s[0]}`)))&&a(e,"href",n)},i(s){l||(k(t),l=!0)},o(s){y(t),l=!1},d(s){s&&u(e),t&&t.d()}}}function ol(r,e,n){let l,t,s,i,c;const o=le(Ce),f=le(De);_e(r,f,M=>n(4,i=M));const p=le(Nt);_e(r,p,M=>n(1,l=M));const d=le(Kt);_e(r,d,M=>n(2,t=M));const h=le(Re);_e(r,h,M=>n(3,s=M));const b=le(Fe);_e(r,b,M=>n(5,c=M));let{id:j}=e;const G=({_id:M})=>j==M;return r.$$set=M=>{"id"in M&&n(0,j=M.id)},[j,l,t,s,i,c,o,f,p,d,h,b,G]}class cl extends ge{constructor(e){super(),be(this,e,ol,sl,pe,{id:0})}}function fl(r){let e,n;return{c(){e=ye("svg"),n=ye("path"),this.h()},l(l){e=$e(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=D(e);n=$e(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),D(n).forEach(u),t.forEach(u),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"stroke-linejoin","round"),a(n,"d","M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(l,t){g(l,e,t),v(e,n)},p:m,i:m,o:m,d(l){l&&u(e)}}}class al extends ge{constructor(e){super(),be(this,e,null,fl,pe,{})}}function ul(r){let e,n;return{c(){e=ye("svg"),n=ye("path"),this.h()},l(l){e=$e(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=D(e);n=$e(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),D(n).forEach(u),t.forEach(u),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"stroke-linejoin","round"),a(n,"d","M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(l,t){g(l,e,t),v(e,n)},p:m,i:m,o:m,d(l){l&&u(e)}}}class _l extends ge{constructor(e){super(),be(this,e,null,ul,pe,{})}}function Ye(r){const e=ke(r[3]);r[4]=e}function Ze(r){r[5]=r[7][0],r[6]=r[7][1]}function xe(r){const e=ke(r[3]);r[4]=e}function hl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:$l,then:bl,catch:gl,value:3};return ce(n=r[1].api.fetchUser(r[0].id),l),{c(){e=F(),l.block.c()},l(t){e=F(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&ce(n,l)||we(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function ml(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Ml,then:Il,catch:El,value:7};return ce(n=Promise.all([r[0].from,r[0].to].map(r[2])),l),{c(){e=F(),l.block.c()},l(t){e=F(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=Promise.all([r[0].from,r[0].to].map(r[2])))&&ce(n,l)||we(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function dl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:ql,then:Nl,catch:Cl,value:3};return ce(n=r[1].api.fetchUser(r[0].by),l),{c(){e=F(),l.block.c()},l(t){e=F(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].by))&&ce(n,l)||we(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function pl(r){let e=r[0].content+"",n;return{c(){n=C(e)},l(l){n=N(l,e)},m(l,t){g(l,n,t)},p(l,t){t&1&&e!==(e=l[0].content+"")&&J(n,e)},d(l){l&&u(n)}}}function gl(r){return{c:m,l:m,m,p:m,d:m}}function bl(r){Ye(r);let e,n,l,t,s=r[4]+"",i,c,o;function f(h,b){if(h[0].type=="user_banned")return yl;if(h[0].type=="user_joined")return wl;if(h[0].type=="user_kicked")return vl;if(h[0].type=="user_left")return kl}let p=f(r),d=p&&p(r);return{c(){e=E("img"),t=q(),i=C(s),c=q(),d&&d.c(),o=F(),this.h()},l(h){e=I(h,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=L(h),i=N(h,s),c=L(h),d&&d.l(h),o=F(),this.h()},h(){a(e,"class","cover"),Y(e.src,n=ve(r[3]))||a(e,"src",n),a(e,"width","24px"),a(e,"height","24px"),a(e,"alt",l=r[4])},m(h,b){g(h,e,b),g(h,t,b),g(h,i,b),g(h,c,b),d&&d.m(h,b),g(h,o,b)},p(h,b){Ye(h),b&1&&!Y(e.src,n=ve(h[3]))&&a(e,"src",n),b&1&&l!==(l=h[4])&&a(e,"alt",l),b&1&&s!==(s=h[4]+"")&&J(i,s),p!==(p=f(h))&&(d&&d.d(1),d=p&&p(h),d&&(d.c(),d.m(o.parentNode,o)))},d(h){h&&(u(e),u(t),u(i),u(c),u(o)),d&&d.d(h)}}}function kl(r){let e;return{c(){e=C("left the chat.")},l(n){e=N(n,"left the chat.")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function vl(r){let e;return{c(){e=C("was kicked.")},l(n){e=N(n,"was kicked.")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function wl(r){let e;return{c(){e=C("has joined the chat.")},l(n){e=N(n,"has joined the chat.")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function yl(r){let e;return{c(){e=C("was banned.")},l(n){e=N(n,"was banned.")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function $l(r){return{c:m,l:m,m,p:m,d:m}}function El(r){return{c:m,l:m,m,p:m,d:m}}function Il(r){Ze(r);let e,n=ke(r[5])+"",l,t,s=ke(r[6])+"",i,c;return{c(){e=C("Channel ownership changed from "),l=C(n),t=C(" to "),i=C(s),c=C(".")},l(o){e=N(o,"Channel ownership changed from "),l=N(o,n),t=N(o," to "),i=N(o,s),c=N(o,".")},m(o,f){g(o,e,f),g(o,l,f),g(o,t,f),g(o,i,f),g(o,c,f)},p(o,f){Ze(o),f&1&&n!==(n=ke(o[5])+"")&&J(l,n),f&1&&s!==(s=ke(o[6])+"")&&J(i,s)},d(o){o&&(u(e),u(l),u(t),u(i),u(c))}}}function Ml(r){return{c:m,l:m,m,p:m,d:m}}function Cl(r){return{c:m,l:m,m,p:m,d:m}}function Nl(r){xe(r);let e,n,l,t,s=r[4]+"",i,c,o;function f(h,b){if(h[0].type=="channel_description_changed")return Dl;if(h[0].type=="channel_icon_changed")return Sl;if(h[0].type=="channel_renamed")return Tl;if(h[0].type=="user_added"||h[0].type=="user_remove")return Ul}let p=f(r),d=p&&p(r);return{c(){e=E("img"),t=q(),i=C(s),c=q(),d&&d.c(),o=F(),this.h()},l(h){e=I(h,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=L(h),i=N(h,s),c=L(h),d&&d.l(h),o=F(),this.h()},h(){a(e,"class","cover"),Y(e.src,n=ve(r[3]))||a(e,"src",n),a(e,"width","24px"),a(e,"height","24px"),a(e,"alt",l=r[4])},m(h,b){g(h,e,b),g(h,t,b),g(h,i,b),g(h,c,b),d&&d.m(h,b),g(h,o,b)},p(h,b){xe(h),b&1&&!Y(e.src,n=ve(h[3]))&&a(e,"src",n),b&1&&l!==(l=h[4])&&a(e,"alt",l),b&1&&s!==(s=h[4]+"")&&J(i,s),p===(p=f(h))&&d?d.p(h,b):(d&&d.d(1),d=p&&p(h),d&&(d.c(),d.m(o.parentNode,o)))},d(h){h&&(u(e),u(t),u(i),u(c),u(o)),d&&d.d(h)}}}function Ul(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Bl,then:jl,catch:Al,value:3};return ce(n=r[1].api.fetchUser(r[0].id),l),{c(){e=F(),l.block.c()},l(t){e=F(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&1&&n!==(n=r[1].api.fetchUser(r[0].id))&&ce(n,l)||we(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function Tl(r){let e,n=r[0].name+"",l,t;return{c(){e=C("renamed this channel to "),l=C(n),t=C(".")},l(s){e=N(s,"renamed this channel to "),l=N(s,n),t=N(s,".")},m(s,i){g(s,e,i),g(s,l,i),g(s,t,i)},p(s,i){i&1&&n!==(n=s[0].name+"")&&J(l,n)},d(s){s&&(u(e),u(l),u(t))}}}function Sl(r){let e;return{c(){e=C("changes this channel icon.")},l(n){e=N(n,"changes this channel icon.")},m(n,l){g(n,e,l)},p:m,d(n){n&&u(e)}}}function Dl(r){let e;return{c(){e=C("changed this channel's description.")},l(n){e=N(n,"changed this channel's description.")},m(n,l){g(n,e,l)},p:m,d(n){n&&u(e)}}}function Al(r){return{c:m,l:m,m,p:m,d:m}}function jl(r){let e,n=ke(r[3])+"",l,t;function s(o,f){if(o[0].type=="user_added")return Pl;if(o[0].type=="user_remove")return Ol}let i=s(r),c=i&&i(r);return{c(){c&&c.c(),e=q(),l=C(n),t=C(".")},l(o){c&&c.l(o),e=L(o),l=N(o,n),t=N(o,".")},m(o,f){c&&c.m(o,f),g(o,e,f),g(o,l,f),g(o,t,f)},p(o,f){i!==(i=s(o))&&(c&&c.d(1),c=i&&i(o),c&&(c.c(),c.m(e.parentNode,e))),f&1&&n!==(n=ke(o[3])+"")&&J(l,n)},d(o){o&&(u(e),u(l),u(t)),c&&c.d(o)}}}function Ol(r){let e;return{c(){e=C("removed")},l(n){e=N(n,"removed")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function Pl(r){let e;return{c(){e=C("added")},l(n){e=N(n,"added")},m(n,l){g(n,e,l)},d(n){n&&u(e)}}}function Bl(r){return{c:m,l:m,m,p:m,d:m}}function ql(r){return{c:m,l:m,m,p:m,d:m}}function Ll(r){let e;function n(s,i){if(s[0].type=="text")return pl;if(s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove")return dl;if(s[0].type=="channel_ownership_changed")return ml;if(s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left")return hl}let l=n(r),t=l&&l(r);return{c(){t&&t.c(),e=F()},l(s){t&&t.l(s),e=F()},m(s,i){t&&t.m(s,i),g(s,e,i)},p(s,[i]){l===(l=n(s))&&t?t.p(s,i):(t&&t.d(1),t=l&&l(s),t&&(t.c(),t.m(e.parentNode,e)))},i:m,o:m,d(s){s&&u(e),t&&t.d(s)}}}function Vl(r,e,n){const l=le(Ce);let{system:t}=e;const s=i=>l.api.fetchUser(i);return r.$$set=i=>{"system"in i&&n(0,t=i.system)},[t,l,s]}class Rl extends ge{constructor(e){super(),be(this,e,Vl,Ll,pe,{system:0})}}function Fl(r){let e,n,l,t,s,i,c,o="Ok",f,p,d="Cancel",h,b,j;const G=r[3].default,M=At(G,r,r[2],null);return{c(){e=E("dialog"),n=E("div"),M&&M.c(),l=q(),t=E("hr"),s=q(),i=E("form"),c=E("button"),c.textContent=o,f=q(),p=E("button"),p.textContent=d,this.h()},l(P){e=I(P,"DIALOG",{});var H=D(e);n=I(H,"DIV",{});var R=D(n);M&&M.l(R),l=L(R),t=I(R,"HR",{}),s=L(R),i=I(R,"FORM",{id:!0,method:!0});var U=D(i);c=I(U,"BUTTON",{type:!0,"data-svelte-h":!0}),Te(c)!=="svelte-fdbbw9"&&(c.textContent=o),f=L(U),p=I(U,"BUTTON",{type:!0,"data-svelte-h":!0}),Te(p)!=="svelte-1gqjcfl"&&(p.textContent=d),U.forEach(u),R.forEach(u),H.forEach(u),this.h()},h(){a(c,"type","submit"),a(p,"type","reset"),a(i,"id","modal-form"),a(i,"method","dialog")},m(P,H){g(P,e,H),v(e,n),M&&M.m(n,null),v(n,l),v(n,t),v(n,s),v(n,i),v(i,c),v(i,f),v(i,p),r[6](e),h=!0,b||(j=[he(p,"click",r[5]),he(i,"submit",r[4]),he(e,"close",r[7])],b=!0)},p(P,[H]){M&&M.p&&(!h||H&4)&&jt(M,G,P,P[2],h?Pt(G,P[2],H,null):Ot(P[2]),null)},i(P){h||(k(M,P),h=!0)},o(P){y(M,P),h=!1},d(P){P&&u(e),M&&M.d(P),r[6](null),b=!1,Se(j)}}}function Gl(r,e,n){let{$$slots:l={},$$scope:t}=e,{showModal:s}=e,i;function c(d){Bt.call(this,r,d)}const o=()=>n(0,s=!1);function f(d){Ie[d?"unshift":"push"](()=>{i=d,n(1,i)})}const p=()=>n(0,s=!1);return r.$$set=d=>{"showModal"in d&&n(0,s=d.showModal),"$$scope"in d&&n(2,t=d.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(s?i==null||i.showModal():i==null||i.close())},[s,i,t,l,c,o,f,p]}class Kl extends ge{constructor(e){super(),be(this,e,Gl,Fl,pe,{showModal:0})}}function Hl(r){let e,n="External Link",l,t,s,i,c="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=E("h1"),e.textContent=n,l=q(),t=E("hr"),s=q(),i=E("p"),i.textContent=c,this.h()},l(o){e=I(o,"H1",{class:!0,"data-svelte-h":!0}),Te(e)!=="svelte-qkxu7n"&&(e.textContent=n),l=L(o),t=I(o,"HR",{}),s=L(o),i=I(o,"P",{"data-svelte-h":!0}),Te(i)!=="svelte-os1rtp"&&(i.textContent=c),this.h()},h(){a(e,"class","text-3xl")},m(o,f){g(o,e,f),g(o,l,f),g(o,t,f),g(o,s,f),g(o,i,f)},p:m,d(o){o&&(u(e),u(l),u(t),u(s),u(i))}}}function zl(r){let e,n,l,t,s,i,c,o;function f(d){r[2](d)}let p={$$slots:{default:[Hl]},$$scope:{ctx:r}};return r[1]!==void 0&&(p.showModal=r[1]),e=new Kl({props:p}),Ie.push(()=>Ve(e,"showModal",f)),e.$on("submit",r[3]),{c(){x(e.$$.fragment),l=q(),t=E("a"),s=C(r[0]),this.h()},l(d){ne(e.$$.fragment,d),l=L(d),t=I(d,"A",{href:!0,target:!0,rel:!0});var h=D(t);s=N(h,r[0]),h.forEach(u),this.h()},h(){a(t,"href",r[0]),a(t,"target","_blank"),a(t,"rel","noreferrer")},m(d,h){ee(e,d,h),g(d,l,h),g(d,t,h),v(t,s),i=!0,c||(o=he(t,"click",qt(r[4])),c=!0)},p(d,[h]){const b={};h&32&&(b.$$scope={dirty:h,ctx:d}),!n&&h&2&&(n=!0,b.showModal=d[1],Le(()=>n=!1)),e.$set(b),(!i||h&1)&&J(s,d[0]),(!i||h&1)&&a(t,"href",d[0])},i(d){i||(k(e.$$.fragment,d),i=!0)},o(d){y(e.$$.fragment,d),i=!1},d(d){d&&(u(l),u(t)),te(e,d),c=!1,o()}}}function Xl(r,e,n){let{href:l}=e,t=!1;function s(o){t=o,n(1,t)}const i=()=>window.open(l),c=()=>n(1,t=!0);return r.$$set=o=>{"href"in o&&n(0,l=o.href)},[l,t,s,i,c]}class Ke extends ge{constructor(e){super(),be(this,e,Xl,zl,pe,{href:0})}}function Jl(r){let e,n,l,t;const s=[en,xl],i=[];function c(o,f){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=F()},l(o){n.l(o),l=F()},m(o,f){i[e].m(o,f),g(o,l,f),t=!0},p(o,f){let p=e;e=c(o),e===p?i[e].p(o,f):(Q(),y(i[p],1,1,()=>{i[p]=null}),W(),n=i[e],n?n.p(o,f):(n=i[e]=s[e](o),n.c()),k(n,1),n.m(l.parentNode,l))},i(o){t||(k(n),t=!0)},o(o){y(n),t=!1},d(o){o&&u(l),i[e].d(o)}}}function Ql(r){let e,n,l=r[0].filename+"",t,s,i,c;return i=new Ke({props:{href:r[1]}}),{c(){e=E("span"),n=C("[File "),t=C(l),s=C(`]
			`),x(i.$$.fragment),this.h()},l(o){e=I(o,"SPAN",{class:!0});var f=D(e);n=N(f,"[File "),t=N(f,l),s=N(f,`]
			`),ne(i.$$.fragment,f),f.forEach(u),this.h()},h(){a(e,"class","text-gray-500")},m(o,f){g(o,e,f),v(e,n),v(e,t),v(e,s),ee(i,e,null),c=!0},p(o,f){(!c||f&1)&&l!==(l=o[0].filename+"")&&J(t,l);const p={};f&2&&(p.href=o[1]),i.$set(p)},i(o){c||(k(i.$$.fragment,o),c=!0)},o(o){y(i.$$.fragment,o),c=!1},d(o){o&&u(e),te(i)}}}function Wl(r){let e,n,l;return{c(){e=E("audio"),n=E("source"),this.h()},l(t){e=I(t,"AUDIO",{});var s=D(e);n=I(s,"SOURCE",{src:!0}),s.forEach(u),this.h()},h(){Y(n.src,l=r[1])||a(n,"src",l),e.controls=!0},m(t,s){g(t,e,s),v(e,n)},p(t,s){s&2&&!Y(n.src,l=t[1])&&a(n,"src",l)},i:m,o:m,d(t){t&&u(e)}}}function Yl(r){let e,n,l;return{c(){e=E("video"),n=E("source"),this.h()},l(t){e=I(t,"VIDEO",{});var s=D(e);n=I(s,"SOURCE",{src:!0}),s.forEach(u),this.h()},h(){Y(n.src,l=r[1])||a(n,"src",l),e.controls=!0},m(t,s){g(t,e,s),v(e,n)},p(t,s){s&2&&!Y(n.src,l=t[1])&&a(n,"src",l)},i:m,o:m,d(t){t&&u(e)}}}function Zl(r){let e,n,l,t;const s=[fn,cn],i=[];function c(o,f){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=F()},l(o){n.l(o),l=F()},m(o,f){i[e].m(o,f),g(o,l,f),t=!0},p(o,f){let p=e;e=c(o),e===p?i[e].p(o,f):(Q(),y(i[p],1,1,()=>{i[p]=null}),W(),n=i[e],n?n.p(o,f):(n=i[e]=s[e](o),n.c()),k(n,1),n.m(l.parentNode,l))},i(o){t||(k(n),t=!0)},o(o){y(n),t=!1},d(o){o&&u(l),i[e].d(o)}}}function xl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!0,pending:on,then:ln,catch:tn,value:4,error:6};return ce(n=fetch(r[1]),l),{c(){e=F(),l.block.c()},l(t){e=F(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&2&&n!==(n=fetch(r[1]))&&ce(n,l)||we(l,r,s)},i:m,o:m,d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function en(r){let e,n,l,t,s;return l=new Ke({props:{href:r[1]}}),{c(){e=E("span"),n=C("[Text "),x(l.$$.fragment),t=C("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var c=D(e);n=N(c,"[Text "),ne(l.$$.fragment,c),t=N(c,"]"),c.forEach(u),this.h()},h(){a(e,"class","text-gray-500")},m(i,c){g(i,e,c),v(e,n),ee(l,e,null),v(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),l.$set(o)},i(i){s||(k(l.$$.fragment,i),s=!0)},o(i){y(l.$$.fragment,i),s=!1},d(i){i&&u(e),te(l)}}}function tn(r){let e,n,l=r[0].filename+"",t,s,i=r[6]+"",c;return{c(){e=E("p"),n=C("Unable to download "),t=C(l),s=C(": "),c=C(i)},l(o){e=I(o,"P",{});var f=D(e);n=N(f,"Unable to download "),t=N(f,l),s=N(f,": "),c=N(f,i),f.forEach(u)},m(o,f){g(o,e,f),v(e,n),v(e,t),v(e,s),v(e,c)},p(o,f){f&1&&l!==(l=o[0].filename+"")&&J(t,l),f&2&&i!==(i=o[6]+"")&&J(c,i)},d(o){o&&u(e)}}}function ln(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:sn,then:rn,catch:nn,value:5};return ce(n=r[4].text(),l),{c(){e=F(),l.block.c()},l(t){e=F(),l.block.l(t)},m(t,s){g(t,e,s),l.block.m(t,l.anchor=s),l.mount=()=>e.parentNode,l.anchor=e},p(t,s){r=t,l.ctx=r,s&2&&n!==(n=r[4].text())&&ce(n,l)||we(l,r,s)},d(t){t&&u(e),l.block.d(t),l.token=null,l=null}}}function nn(r){return{c:m,l:m,m,p:m,d:m}}function rn(r){let e,n=r[5]+"",l;return{c(){e=E("p"),l=C(n)},l(t){e=I(t,"P",{});var s=D(e);l=N(s,n),s.forEach(u)},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&2&&n!==(n=t[5]+"")&&J(l,n)},d(t){t&&u(e)}}}function sn(r){return{c:m,l:m,m,p:m,d:m}}function on(r){return{c:m,l:m,m,p:m,d:m}}function cn(r){let e,n,l;return{c(){e=E("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Y(e.src,n=r[1])||a(e,"src",n),a(e,"alt",l=r[0].filename),a(e,"class","max-w-xl max-h-xl")},m(t,s){g(t,e,s)},p(t,s){s&2&&!Y(e.src,n=t[1])&&a(e,"src",n),s&1&&l!==(l=t[0].filename)&&a(e,"alt",l)},i:m,o:m,d(t){t&&u(e)}}}function fn(r){let e,n,l,t,s;return l=new Ke({props:{href:r[1]}}),{c(){e=E("span"),n=C("[Image "),x(l.$$.fragment),t=C("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var c=D(e);n=N(c,"[Image "),ne(l.$$.fragment,c),t=N(c,"]"),c.forEach(u),this.h()},h(){a(e,"class","text-gray-500")},m(i,c){g(i,e,c),v(e,n),ee(l,e,null),v(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),l.$set(o)},i(i){s||(k(l.$$.fragment,i),s=!0)},o(i){y(l.$$.fragment,i),s=!1},d(i){i&&u(e),te(l)}}}function an(r){let e,n,l,t;const s=[Zl,Yl,Wl,Ql,Jl],i=[];function c(o,f){return o[0].metadata.type=="Image"?0:o[0].metadata.type=="Video"?1:o[0].metadata.type=="Audio"?2:o[0].metadata.type=="File"?3:o[0].metadata.type=="Text"?4:-1}return~(n=c(r))&&(l=i[n]=s[n](r)),{c(){e=E("div"),l&&l.c()},l(o){e=I(o,"DIV",{});var f=D(e);l&&l.l(f),f.forEach(u)},m(o,f){g(o,e,f),~n&&i[n].m(e,null),t=!0},p(o,[f]){let p=n;n=c(o),n===p?~n&&i[n].p(o,f):(l&&(Q(),y(i[p],1,1,()=>{i[p]=null}),W()),~n?(l=i[n],l?l.p(o,f):(l=i[n]=s[n](o),l.c()),k(l,1),l.m(e,null)):l=null)},i(o){t||(k(l),t=!0)},o(o){y(l),t=!1},d(o){o&&u(e),~n&&i[n].d()}}}function un(r,e,n){let l,t;const s=le(De);_e(r,s,c=>n(2,t=c));let{attachment:i}=e;return r.$$set=c=>{"attachment"in c&&n(0,i=c.attachment)},r.$$.update=()=>{r.$$.dirty&1&&n(1,l=Gt(i))},[i,l,t,s]}class _n extends ge{constructor(e){super(),be(this,e,un,an,pe,{attachment:0})}}function hn(r){let e,n="oop website embed, can't handle that :(";return{c(){e=E("span"),e.textContent=n,this.h()},l(l){e=I(l,"SPAN",{style:!0,"data-svelte-h":!0}),Te(e)!=="svelte-rjpnkw"&&(e.textContent=n),this.h()},h(){Me(e,"color","var(--secondary-foreground)")},m(l,t){g(l,e,t)},p:m,d(l){l&&u(e)}}}function mn(r){let e,n,l,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&et(r),s=r[0].title&&tt(r),i=r[0].description&&lt(r);return{c(){e=E("div"),t&&t.c(),n=q(),s&&s.c(),l=q(),i&&i.c(),this.h()},l(c){e=I(c,"DIV",{class:!0,style:!0});var o=D(e);t&&t.l(o),n=L(o),s&&s.l(o),l=L(o),i&&i.l(o),o.forEach(u),this.h()},h(){a(e,"class","text-embed svelte-467pqv"),Me(e,"border-left","solid "+r[0].colour)},m(c,o){g(c,e,o),t&&t.m(e,null),v(e,n),s&&s.m(e,null),v(e,l),i&&i.m(e,null)},p(c,o){c[0].icon_url&&!c[1]["jolt:low-data-mode"]?t?t.p(c,o):(t=et(c),t.c(),t.m(e,n)):t&&(t.d(1),t=null),c[0].title?s?s.p(c,o):(s=tt(c),s.c(),s.m(e,l)):s&&(s.d(1),s=null),c[0].description?i?i.p(c,o):(i=lt(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null),o&1&&Me(e,"border-left","solid "+c[0].colour)},d(c){c&&u(e),t&&t.d(),s&&s.d(),i&&i.d()}}}function dn(r){let e,n,l,t,s;return{c(){e=E("video"),n=E("source"),this.h()},l(i){e=I(i,"VIDEO",{});var c=D(e);n=I(c,"SOURCE",{src:!0,width:!0,height:!0}),c.forEach(u),this.h()},h(){Y(n.src,l=r[0].url)||a(n,"src",l),a(n,"width",t=r[0].width),a(n,"height",s=r[0].height),e.controls=!0},m(i,c){g(i,e,c),v(e,n)},p(i,c){c&1&&!Y(n.src,l=i[0].url)&&a(n,"src",l),c&1&&t!==(t=i[0].width)&&a(n,"width",t),c&1&&s!==(s=i[0].height)&&a(n,"height",s)},d(i){i&&u(e)}}}function pn(r){let e,n,l,t;return{c(){e=E("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,width:!0,height:!0}),this.h()},h(){Y(e.src,n=r[0].url)||a(e,"src",n),a(e,"width",l=r[0].width),a(e,"height",t=r[0].height)},m(s,i){g(s,e,i)},p(s,i){i&1&&!Y(e.src,n=s[0].url)&&a(e,"src",n),i&1&&l!==(l=s[0].width)&&a(e,"width",l),i&1&&t!==(t=s[0].height)&&a(e,"height",t)},d(s){s&&u(e)}}}function et(r){let e,n,l;return{c(){e=E("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){Y(e.src,n=r[0].icon_url)||a(e,"src",n),a(e,"alt",l=r[0].title),a(e,"width","24"),a(e,"height","24"),a(e,"class","svelte-467pqv")},m(t,s){g(t,e,s)},p(t,s){s&1&&!Y(e.src,n=t[0].icon_url)&&a(e,"src",n),s&1&&l!==(l=t[0].title)&&a(e,"alt",l)},d(t){t&&u(e)}}}function tt(r){let e,n=r[0].title+"",l;return{c(){e=E("h1"),l=C(n)},l(t){e=I(t,"H1",{});var s=D(e);l=N(s,n),s.forEach(u)},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&1&&n!==(n=t[0].title+"")&&J(l,n)},d(t){t&&u(e)}}}function lt(r){let e,n=r[0].description+"",l;return{c(){e=E("p"),l=C(n)},l(t){e=I(t,"P",{});var s=D(e);l=N(s,n),s.forEach(u)},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&1&&n!==(n=t[0].description+"")&&J(l,n)},d(t){t&&u(e)}}}function gn(r){let e;function n(s,i){if(s[0].type=="Image"&&!s[1]["jolt:low-data-mode"])return pn;if(s[0].type=="Video"&&!s[1]["jolt:low-data-mode"])return dn;if(s[0].type=="Text")return mn;if(s[0].type=="Website")return hn}let l=n(r),t=l&&l(r);return{c(){t&&t.c(),e=F()},l(s){t&&t.l(s),e=F()},m(s,i){t&&t.m(s,i),g(s,e,i)},p(s,[i]){l===(l=n(s))&&t?t.p(s,i):(t&&t.d(1),t=l&&l(s),t&&(t.c(),t.m(e.parentNode,e)))},i:m,o:m,d(s){s&&u(e),t&&t.d(s)}}}function bn(r,e,n){let l,{embed:t}=e;const s=le(De);return _e(r,s,i=>n(1,l=i)),r.$$set=i=>{"embed"in i&&n(0,t=i.embed)},[t,l,s]}class kn extends ge{constructor(e){super(),be(this,e,bn,gn,pe,{embed:0})}}function vn(r){let e,n,l;return{c(){e=E("textarea"),this.h()},l(t){e=I(t,"TEXTAREA",{maxlength:!0,placeholder:!0,class:!0}),D(e).forEach(u),this.h()},h(){a(e,"maxlength","2000"),a(e,"placeholder",r[1]),a(e,"class","svelte-kqfcqt")},m(t,s){g(t,e,s),He(e,r[0]),n||(l=[he(e,"blur",r[3]),he(e,"input",r[4]),he(e,"keydown",r[6]),he(e,"input",r[7])],n=!0)},p(t,[s]){s&2&&a(e,"placeholder",t[1]),s&1&&He(e,t[0])},i:m,o:m,d(t){t&&u(e),n=!1,Se(l)}}}function wn(r,e,n){const l=le(Ce),t=le(Ut);let{placeholder:s=void 0}=e,{value:i=""}=e,{sendTypingEvents:c}=e;const o=Lt();function f(){c&&l.websocket.send({type:"EndTyping",channel:t._id})}function p(){if(c){if(i==""){l.websocket.send({type:"EndTyping",channel:t._id});return}l.websocket.send({type:"BeginTyping",channel:t._id})}}const d=b=>{var j;o("keydown",b),!(b.shiftKey||b.key!="Enter")&&(b.preventDefault(),(j=b.currentTarget.form)==null||j.requestSubmit())};function h(){i=this.value,n(0,i)}return r.$$set=b=>{"placeholder"in b&&n(1,s=b.placeholder),"value"in b&&n(0,i=b.value),"sendTypingEvents"in b&&n(5,c=b.sendTypingEvents)},[i,s,o,f,p,c,d,h]}class St extends ge{constructor(e){super(),be(this,e,wn,vn,pe,{placeholder:1,value:0,sendTypingEvents:5})}}function nt(r,e,n){const l=r.slice();return l[26]=e[n],l}function rt(r,e,n){const l=r.slice();return l[29]=e[n],l}function it(r,e,n){const l=r.slice();return l[32]=e[n].src,l[33]=e[n].name,l[34]=e[n].onclick,l[35]=e[n].showIf,l}function Be(r){const e=r.slice(),n=new Date(e[0].edited);return e[8]=n,e}function yn(r){const e=r.slice(),n=ve(e[1],e[2],e[0]);return e[38]=n,e}function st(r,e,n){const l=r.slice();return l[39]=e[n],l}function ot(r){let e,n,l=de(r[0].replies),t=[];for(let i=0;i<l.length;i+=1)t[i]=ct(st(r,l,i));const s=i=>y(t[i],1,1,()=>{t[i]=null});return{c(){e=E("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var c=D(e);for(let o=0;o<t.length;o+=1)t[o].l(c);c.forEach(u),this.h()},h(){a(e,"class","reply-base svelte-1f6fxpx")},m(i,c){g(i,e,c);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null);n=!0},p(i,c){if(c[0]&1){l=de(i[0].replies);let o;for(o=0;o<l.length;o+=1){const f=st(i,l,o);t[o]?(t[o].p(f,c),k(t[o],1)):(t[o]=ct(f),t[o].c(),k(t[o],1),t[o].m(e,null))}for(Q(),o=l.length;o<t.length;o+=1)s(o);W()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)k(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)y(t[c]);n=!1},d(i){i&&u(e),Ee(t,i)}}}function ct(r){let e,n;return e=new cl({props:{id:r[39]}}),{c(){x(e.$$.fragment)},l(l){ne(e.$$.fragment,l)},m(l,t){ee(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.id=l[39]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function ft(r){let e,n,l,t;const s=[En,$n],i=[];function c(f,p){return f[5]["jolt:low-data-mode"]||f[1]==null?0:1}function o(f,p){return p===1?yn(f):f}return e=c(r),n=i[e]=s[e](o(r,e)),{c(){n.c(),l=F()},l(f){n.l(f),l=F()},m(f,p){i[e].m(f,p),g(f,l,p),t=!0},p(f,p){let d=e;e=c(f),e===d?i[e].p(o(f,e),p):(Q(),y(i[d],1,1,()=>{i[d]=null}),W(),n=i[e],n?n.p(o(f,e),p):(n=i[e]=s[e](o(f,e)),n.c()),k(n,1),n.m(l.parentNode,l))},i(f){t||(k(n),t=!0)},o(f){y(n),t=!1},d(f){f&&u(l),i[e].d(f)}}}function $n(r){let e,n,l,t;const s=[Mn,In],i=[];function c(o,f){return o[38]==null?0:1}return e=c(r),n=i[e]=s[e](r),{c(){n.c(),l=F()},l(o){n.l(o),l=F()},m(o,f){i[e].m(o,f),g(o,l,f),t=!0},p(o,f){let p=e;e=c(o),e===p?i[e].p(o,f):(Q(),y(i[p],1,1,()=>{i[p]=null}),W(),n=i[e],n?n.p(o,f):(n=i[e]=s[e](o),n.c()),k(n,1),n.m(l.parentNode,l))},i(o){t||(k(n),t=!0)},o(o){y(n),t=!1},d(o){o&&u(l),i[e].d(o)}}}function En(r){let e,n;return e=new Ae({}),{c(){x(e.$$.fragment)},l(l){ne(e.$$.fragment,l)},m(l,t){ee(e,l,t),n=!0},p:m,i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function In(r){let e,n;return{c(){e=E("img"),this.h()},l(l){e=I(l,"IMG",{class:!0,alt:!0,src:!0,width:!0,height:!0}),this.h()},h(){a(e,"class","cover"),a(e,"alt",r[4]),Y(e.src,n=r[38])||a(e,"src",n),a(e,"width","40px"),a(e,"height","40px")},m(l,t){g(l,e,t)},p(l,t){t[0]&16&&a(e,"alt",l[4]),t[0]&7&&!Y(e.src,n=l[38])&&a(e,"src",n)},i:m,o:m,d(l){l&&u(e)}}}function Mn(r){let e,n;return e=new Ae({}),{c(){x(e.$$.fragment)},l(l){ne(e.$$.fragment,l)},m(l,t){ee(e,l,t),n=!0},p:m,i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function at(r){let e,n=r[6](r[8])+"",l,t,s=r[7](r[8])+"",i,c;return{c(){e=C(`[edited
				`),l=C(n),t=q(),i=C(s),c=C("]")},l(o){e=N(o,`[edited
				`),l=N(o,n),t=L(o),i=N(o,s),c=N(o,"]")},m(o,f){g(o,e,f),g(o,l,f),g(o,t,f),g(o,i,f),g(o,c,f)},p(o,f){f[0]&65&&n!==(n=o[6](o[8])+"")&&J(l,n),f[0]&129&&s!==(s=o[7](o[8])+"")&&J(i,s)},d(o){o&&(u(e),u(l),u(t),u(i),u(c))}}}function ut(r){let e,n,l,t,s,i,c;const o=[Nn,Cn],f=[];function p(h,b){return typeof h[32]=="string"?0:1}n=p(r),l=f[n]=o[n](r);function d(){return r[18](r[34])}return{c(){e=E("button"),l.c(),t=q(),this.h()},l(h){e=I(h,"BUTTON",{"aria-label":!0,class:!0});var b=D(e);l.l(b),t=L(b),b.forEach(u),this.h()},h(){a(e,"aria-label",r[33]),a(e,"class","svelte-1f6fxpx")},m(h,b){g(h,e,b),f[n].m(e,null),v(e,t),s=!0,i||(c=[he(e,"click",d),Vt(Qt.call(null,e,{placement:"top",content:r[33],theme:"message-controls",animation:"shift-away-subtle",duration:100}))],i=!0)},p(h,b){r=h,l.p(r,b)},i(h){s||(k(l),s=!0)},o(h){y(l),s=!1},d(h){h&&u(e),f[n].d(),i=!1,Se(c)}}}function Cn(r){let e,n,l;var t=r[32];function s(i){return{}}return t&&(e=ze(t,s())),{c(){e&&x(e.$$.fragment),n=F()},l(i){e&&ne(e.$$.fragment,i),n=F()},m(i,c){e&&ee(e,i,c),g(i,n,c),l=!0},p(i,c){if(t!==(t=i[32])){if(e){Q();const o=e;y(o.$$.fragment,1,0,()=>{te(o,1)}),W()}t?(e=ze(t,s()),x(e.$$.fragment),k(e.$$.fragment,1),ee(e,n.parentNode,n)):e=null}},i(i){l||(e&&k(e.$$.fragment,i),l=!0)},o(i){e&&y(e.$$.fragment,i),l=!1},d(i){i&&u(n),e&&te(e,i)}}}function Nn(r){let e,n;return{c(){e=E("img"),this.h()},l(l){e=I(l,"IMG",{width:!0,height:!0,src:!0,alt:!0}),this.h()},h(){a(e,"width","16px"),a(e,"height","16px"),Y(e.src,n=r[32])||a(e,"src",n),a(e,"alt",r[33])},m(l,t){g(l,e,t)},p:m,i:m,o:m,d(l){l&&u(e)}}}function _t(r){var s;let e=((s=r[35])==null?void 0:s.call(r,r[0]))??!0,n,l,t=e&&ut(r);return{c(){t&&t.c(),n=F()},l(i){t&&t.l(i),n=F()},m(i,c){t&&t.m(i,c),g(i,n,c),l=!0},p(i,c){var o;c[0]&1&&(e=((o=i[35])==null?void 0:o.call(i,i[0]))??!0),e?t?(t.p(i,c),c[0]&1&&k(t,1)):(t=ut(i),t.c(),k(t,1),t.m(n.parentNode,n)):t&&(Q(),y(t,1,1,()=>{t=null}),W())},i(i){l||(k(t),l=!0)},o(i){y(t),l=!1},d(i){i&&u(n),t&&t.d(i)}}}function Un(r){let e,n=r[0].content+"",l;return{c(){e=E("span"),l=C(n),this.h()},l(t){e=I(t,"SPAN",{style:!0,class:!0});var s=D(e);l=N(s,n),s.forEach(u),this.h()},h(){Me(e,"overflow-wrap","break-word"),a(e,"class","whitespace-pre-wrap")},m(t,s){g(t,e,s),v(e,l)},p(t,s){s[0]&1&&n!==(n=t[0].content+"")&&J(l,n)},i:m,o:m,d(t){t&&u(e)}}}function Tn(r){let e,n,l,t,s,i;function c(f){r[19](f)}let o={placeholder:"Edit this message",sendTypingEvents:!1};return r[3]!==void 0&&(o.value=r[3]),n=new St({props:o}),Ie.push(()=>Ve(n,"value",c)),n.$on("keydown",r[20]),{c(){e=E("form"),x(n.$$.fragment),this.h()},l(f){e=I(f,"FORM",{style:!0,id:!0,class:!0});var p=D(e);ne(n.$$.fragment,p),p.forEach(u),this.h()},h(){Me(e,"padding-left","8px"),a(e,"id","message-edit-form"),a(e,"class","message-form")},m(f,p){g(f,e,p),ee(n,e,null),t=!0,s||(i=he(e,"submit",r[15]),s=!0)},p(f,p){const d={};!l&&p[0]&8&&(l=!0,d.value=f[3],Le(()=>l=!1)),n.$set(d)},i(f){t||(k(n.$$.fragment,f),t=!0)},o(f){y(n.$$.fragment,f),t=!1},d(f){f&&u(e),te(n),s=!1,i()}}}function ht(r){let e,n;return e=new Rl({props:{system:r[0].system}}),{c(){x(e.$$.fragment)},l(l){ne(e.$$.fragment,l)},m(l,t){ee(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.system=l[0].system),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function mt(r){let e,n,l=de(r[0].attachments),t=[];for(let i=0;i<l.length;i+=1)t[i]=dt(rt(r,l,i));const s=i=>y(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=F()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=F()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),n=!0},p(i,c){if(c[0]&1){l=de(i[0].attachments);let o;for(o=0;o<l.length;o+=1){const f=rt(i,l,o);t[o]?(t[o].p(f,c),k(t[o],1)):(t[o]=dt(f),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(Q(),o=l.length;o<t.length;o+=1)s(o);W()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)k(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)y(t[c]);n=!1},d(i){i&&u(e),Ee(t,i)}}}function dt(r){let e,n;return e=new _n({props:{attachment:r[29]}}),{c(){x(e.$$.fragment)},l(l){ne(e.$$.fragment,l)},m(l,t){ee(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.attachment=l[29]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function pt(r){let e,n,l=de(r[0].embeds),t=[];for(let i=0;i<l.length;i+=1)t[i]=gt(nt(r,l,i));const s=i=>y(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=F()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=F()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),n=!0},p(i,c){if(c[0]&1){l=de(i[0].embeds);let o;for(o=0;o<l.length;o+=1){const f=nt(i,l,o);t[o]?(t[o].p(f,c),k(t[o],1)):(t[o]=gt(f),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(Q(),o=l.length;o<t.length;o+=1)s(o);W()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)k(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)y(t[c]);n=!1},d(i){i&&u(e),Ee(t,i)}}}function gt(r){let e,n;return e=new kn({props:{embed:r[26]}}),{c(){x(e.$$.fragment)},l(l){ne(e.$$.fragment,l)},m(l,t){ee(e,l,t),n=!0},p(l,t){const s={};t[0]&1&&(s.embed=l[26]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function Sn(r){let e,n,l,t,s,i,c,o,f=r[6](r[8])+"",p,d,h=r[7](r[8])+"",b,j,G,M,P,H,R,U,z,B,me,fe,O,X,K=r[0].replies!=null&&r[0].replies.length!=0&&ot(r),A=!r[5]["jolt:compact-mode"]&&ft(r),_=r[0].edited!=null&&at(Be(r)),w=de(r[14]),$=[];for(let S=0;S<w.length;S+=1)$[S]=_t(it(r,w,S));const T=S=>y($[S],1,1,()=>{$[S]=null}),ae=[Tn,Un],re=[];function je(S,V){return S[3]!=null?0:S[0].content!=null?1:-1}~(U=je(r))&&(z=re[U]=ae[U](r));let ie=r[0].system!=null&&ht(r),se=r[0].attachments!=null&&mt(r),oe=r[0].embeds!=null&&pt(r);return{c(){e=E("div"),K&&K.c(),n=q(),l=E("div"),A&&A.c(),t=q(),s=C(r[4]),i=q(),c=E("p"),o=C("["),p=C(f),d=q(),b=C(h),j=C(`]

			`),_&&_.c(),G=q(),M=E("div"),P=q(),H=E("div");for(let S=0;S<$.length;S+=1)$[S].c();R=q(),z&&z.c(),B=q(),ie&&ie.c(),me=q(),se&&se.c(),fe=q(),oe&&oe.c(),this.h()},l(S){e=I(S,"DIV",{id:!0,class:!0});var V=D(e);K&&K.l(V),n=L(V),l=I(V,"DIV",{class:!0});var ue=D(l);A&&A.l(ue),t=L(ue),s=N(ue,r[4]),i=L(ue),c=I(ue,"P",{class:!0});var Z=D(c);o=N(Z,"["),p=N(Z,f),d=L(Z),b=N(Z,h),j=N(Z,`]

			`),_&&_.l(Z),Z.forEach(u),G=L(ue),M=I(ue,"DIV",{class:!0}),D(M).forEach(u),P=L(ue),H=I(ue,"DIV",{class:!0});var Ne=D(H);for(let Pe=0;Pe<$.length;Pe+=1)$[Pe].l(Ne);Ne.forEach(u),ue.forEach(u),R=L(V),z&&z.l(V),B=L(V),ie&&ie.l(V),me=L(V),se&&se.l(V),fe=L(V),oe&&oe.l(V),V.forEach(u),this.h()},h(){a(c,"class","timestamp svelte-1f6fxpx"),a(M,"class","flex-divider"),a(H,"class","message-controls svelte-1f6fxpx"),a(l,"class","user-detail svelte-1f6fxpx"),a(e,"id",O=r[0]._id),a(e,"class","container svelte-1f6fxpx")},m(S,V){g(S,e,V),K&&K.m(e,null),v(e,n),v(e,l),A&&A.m(l,null),v(l,t),v(l,s),v(l,i),v(l,c),v(c,o),v(c,p),v(c,d),v(c,b),v(c,j),_&&_.m(c,null),v(l,G),v(l,M),v(l,P),v(l,H);for(let ue=0;ue<$.length;ue+=1)$[ue]&&$[ue].m(H,null);v(e,R),~U&&re[U].m(e,null),v(e,B),ie&&ie.m(e,null),v(e,me),se&&se.m(e,null),v(e,fe),oe&&oe.m(e,null),X=!0},p(S,V){if(S[0].replies!=null&&S[0].replies.length!=0?K?(K.p(S,V),V[0]&1&&k(K,1)):(K=ot(S),K.c(),k(K,1),K.m(e,n)):K&&(Q(),y(K,1,1,()=>{K=null}),W()),S[5]["jolt:compact-mode"]?A&&(Q(),y(A,1,1,()=>{A=null}),W()):A?(A.p(S,V),V[0]&32&&k(A,1)):(A=ft(S),A.c(),k(A,1),A.m(l,t)),(!X||V[0]&16)&&J(s,S[4]),(!X||V[0]&320)&&f!==(f=S[6](S[8])+"")&&J(p,f),(!X||V[0]&384)&&h!==(h=S[7](S[8])+"")&&J(b,h),S[0].edited!=null?_?_.p(Be(S),V):(_=at(Be(S)),_.c(),_.m(c,null)):_&&(_.d(1),_=null),V[0]&16385){w=de(S[14]);let Z;for(Z=0;Z<w.length;Z+=1){const Ne=it(S,w,Z);$[Z]?($[Z].p(Ne,V),k($[Z],1)):($[Z]=_t(Ne),$[Z].c(),k($[Z],1),$[Z].m(H,null))}for(Q(),Z=w.length;Z<$.length;Z+=1)T(Z);W()}let ue=U;U=je(S),U===ue?~U&&re[U].p(S,V):(z&&(Q(),y(re[ue],1,1,()=>{re[ue]=null}),W()),~U?(z=re[U],z?z.p(S,V):(z=re[U]=ae[U](S),z.c()),k(z,1),z.m(e,B)):z=null),S[0].system!=null?ie?(ie.p(S,V),V[0]&1&&k(ie,1)):(ie=ht(S),ie.c(),k(ie,1),ie.m(e,me)):ie&&(Q(),y(ie,1,1,()=>{ie=null}),W()),S[0].attachments!=null?se?(se.p(S,V),V[0]&1&&k(se,1)):(se=mt(S),se.c(),k(se,1),se.m(e,fe)):se&&(Q(),y(se,1,1,()=>{se=null}),W()),S[0].embeds!=null?oe?(oe.p(S,V),V[0]&1&&k(oe,1)):(oe=pt(S),oe.c(),k(oe,1),oe.m(e,null)):oe&&(Q(),y(oe,1,1,()=>{oe=null}),W()),(!X||V[0]&1&&O!==(O=S[0]._id))&&a(e,"id",O)},i(S){if(!X){k(K),k(A);for(let V=0;V<w.length;V+=1)k($[V]);k(z),k(ie),k(se),k(oe),X=!0}},o(S){y(K),y(A),$=$.filter(Boolean);for(let V=0;V<$.length;V+=1)y($[V]);y(z),y(ie),y(se),y(oe),X=!1},d(S){S&&u(e),K&&K.d(),A&&A.d(),_&&_.d(),Ee($,S),~U&&re[U].d(),ie&&ie.d(),se&&se.d(),oe&&oe.d()}}}function Dn(r,e,n){let l,t,s,i,c,o,f,p,d;_e(r,Ht,_=>n(6,p=_)),_e(r,zt,_=>n(7,d=_));let{message:h}=e,b,j,G,M=le(De);_e(r,M,_=>n(5,f=_));let P=le(Ce),H=le(Nt);_e(r,H,_=>n(16,s=_));let R=le(Re),U=le(Fe);_e(r,U,_=>n(17,i=_));let z=le(Tt);_e(r,z,_=>n(21,c=_));let B=le(Ge);_e(r,B,_=>n(22,o=_));const me=[{src:_l,name:"Reply",onclick(){o!=null&&o.some(_=>_.message._id==h._id)||B==null||B.update(_=>(_.push({message:h,mention:!0}),_))}},{src:Jt,name:"Edit",showIf:_=>{var w;return _.author==((w=P.user)==null?void 0:w._id)},onclick:_=>n(3,b=b==null?_.content??"":void 0)},{src:al,name:"Delete",showIf:_=>{var w;return _.author==((w=P.user)==null?void 0:w._id)},onclick:_=>P.api.deleteMessage(_.channel,_._id)}];async function fe(_,w){n(2,G=c==null?void 0:c.find($=>$._id.server==_&&$._id.user==w))}async function O(){const _=await P.api.editMessage(h.channel,h._id,{content:b});R==null||R.update(w=>(w[w.findIndex($=>$._id==h._id)]=_,w))}const X=_=>_(h);function K(_){b=_,n(3,b)}const A=_=>{console.log(_),_.detail.key=="Escape"&&n(3,b=void 0)};return r.$$set=_=>{"message"in _&&n(0,h=_.message)},r.$$.update=()=>{r.$$.dirty[0]&131073&&qe(P.api,i??P.api.cache.users,h.author).then(_=>n(1,j=_)),r.$$.dirty[0]&65537&&(s==null||fe(s,h.author)),r.$$.dirty[0]&7&&n(4,l=ke(j,G,h)),r.$$.dirty[0]&1&&n(8,t=Xt(h._id))},[h,j,G,b,l,f,p,d,t,M,H,U,z,B,me,O,s,i,X,K,A]}class An extends ge{constructor(e){super(),be(this,e,Dn,Sn,pe,{message:0},null,[-1,-1])}}function jn(r){let e,n;return{c(){e=ye("svg"),n=ye("path"),this.h()},l(l){e=$e(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=D(e);n=$e(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),D(n).forEach(u),t.forEach(u),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"stroke-linejoin","round"),a(n,"d","M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(l,t){g(l,e,t),v(e,n)},p:m,i:m,o:m,d(l){l&&u(e)}}}class Dt extends ge{constructor(e){super(),be(this,e,null,jn,pe,{})}}function On(r){let e,n;return{c(){e=ye("svg"),n=ye("path"),this.h()},l(l){e=$e(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=D(e);n=$e(t,"path",{"stroke-linecap":!0,d:!0}),D(n).forEach(u),t.forEach(u),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"d","M16.5 12a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(l,t){g(l,e,t),v(e,n)},p:m,i:m,o:m,d(l){l&&u(e)}}}class Pn extends ge{constructor(e){super(),be(this,e,null,On,pe,{})}}function bt(r){const e=ke(r[5]);r[6]=e}function Bn(r){let e,n,l;return e=new Ae({}),{c(){x(e.$$.fragment),n=C(`
				<UnknownUser>`)},l(t){ne(e.$$.fragment,t),n=N(t,`
				<UnknownUser>`)},m(t,s){ee(e,t,s),g(t,n,s),l=!0},p:m,i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){y(e.$$.fragment,t),l=!1},d(t){t&&u(n),te(e,t)}}}function qn(r){bt(r);let e,n,l,t,s=r[6]+"",i;return{c(){e=E("img"),t=q(),i=C(s),this.h()},l(c){e=I(c,"IMG",{class:!0,src:!0,alt:!0}),t=L(c),i=N(c,s),this.h()},h(){a(e,"class","cover svelte-zbyf5q"),Y(e.src,n=ve(r[5]))||a(e,"src",n),a(e,"alt",l=r[6])},m(c,o){g(c,e,o),g(c,t,o),g(c,i,o)},p(c,o){bt(c),o&1&&!Y(e.src,n=ve(c[5]))&&a(e,"src",n),o&1&&l!==(l=c[6])&&a(e,"alt",l),o&1&&s!==(s=c[6]+"")&&J(i,s)},i:m,o:m,d(c){c&&(u(e),u(t),u(i))}}}function Ln(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function kt(r){let e,n=r[0].message.content+"",l;return{c(){e=E("p"),l=C(n),this.h()},l(t){e=I(t,"P",{class:!0});var s=D(e);l=N(s,n),s.forEach(u),this.h()},h(){a(e,"class","message-content svelte-zbyf5q")},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&1&&n!==(n=t[0].message.content+"")&&J(l,n)},d(t){t&&u(e)}}}function Vn(r){let e,n,l,t,s,i,c,o,f,p,d,h,b,j,G=r[0].mention?"ON":"OFF",M,P,H,R,U,z,B,me,fe,O={ctx:r,current:null,token:null,hasCatch:!0,pending:Ln,then:qn,catch:Bn,value:5,blocks:[,,,]};ce(s=r[2].api.fetchUser(r[0].message.author),O);let X=r[0].message.content&&kt(r);return b=new Pn({}),z=new Dt({}),{c(){e=E("div"),n=E("p"),l=C(`Replying to
		`),t=E("strong"),O.block.c(),i=q(),X&&X.c(),c=q(),o=E("div"),f=q(),p=E("label"),d=E("input"),h=q(),x(b.$$.fragment),j=q(),M=C(G),H=q(),R=E("div"),U=E("button"),x(z.$$.fragment),this.h()},l(K){e=I(K,"DIV",{class:!0});var A=D(e);n=I(A,"P",{});var _=D(n);l=N(_,`Replying to
		`),t=I(_,"STRONG",{});var w=D(t);O.block.l(w),w.forEach(u),_.forEach(u),i=L(A),X&&X.l(A),c=L(A),o=I(A,"DIV",{class:!0}),D(o).forEach(u),f=L(A),p=I(A,"LABEL",{class:!0,"aria-label":!0});var $=D(p);d=I($,"INPUT",{id:!0,style:!0,type:!0}),h=L($),ne(b.$$.fragment,$),j=L($),M=N($,G),$.forEach(u),H=L(A),R=I(A,"DIV",{});var T=D(R);U=I(T,"BUTTON",{});var ae=D(U);ne(z.$$.fragment,ae),ae.forEach(u),T.forEach(u),A.forEach(u),this.h()},h(){a(o,"class","flex-divider"),a(d,"id","mention"),Me(d,"display","none"),a(d,"type","checkbox"),a(p,"class","mention-button svelte-zbyf5q"),a(p,"aria-label",P="Mention author "+(r[0].mention?"ON":"OFF")),a(e,"class","container svelte-zbyf5q")},m(K,A){g(K,e,A),v(e,n),v(n,l),v(n,t),O.block.m(t,O.anchor=null),O.mount=()=>t,O.anchor=null,v(e,i),X&&X.m(e,null),v(e,c),v(e,o),v(e,f),v(e,p),v(p,d),d.checked=r[0].mention,v(p,h),ee(b,p,null),v(p,j),v(p,M),v(e,H),v(e,R),v(R,U),ee(z,U,null),B=!0,me||(fe=[he(d,"change",r[3]),he(U,"click",r[4])],me=!0)},p(K,[A]){r=K,O.ctx=r,A&1&&s!==(s=r[2].api.fetchUser(r[0].message.author))&&ce(s,O)||we(O,r,A),r[0].message.content?X?X.p(r,A):(X=kt(r),X.c(),X.m(e,c)):X&&(X.d(1),X=null),A&1&&(d.checked=r[0].mention),(!B||A&1)&&G!==(G=r[0].mention?"ON":"OFF")&&J(M,G),(!B||A&1&&P!==(P="Mention author "+(r[0].mention?"ON":"OFF")))&&a(p,"aria-label",P)},i(K){B||(k(O.block),k(b.$$.fragment,K),k(z.$$.fragment,K),B=!0)},o(K){for(let A=0;A<3;A+=1){const _=O.blocks[A];y(_)}y(b.$$.fragment,K),y(z.$$.fragment,K),B=!1},d(K){K&&u(e),O.block.d(),O.token=null,O=null,X&&X.d(),te(b),te(z),me=!1,Se(fe)}}}function Rn(r,e,n){let{reply:l}=e;const t=le(Ce),s=le(Ge);function i(){l.mention=this.checked,n(0,l)}const c=()=>s.update(o=>(o=o.filter(f=>f.message._id!=l.message._id),o));return r.$$set=o=>{"reply"in o&&n(0,l=o.reply)},[l,s,t,i,c]}class Fn extends ge{constructor(e){super(),be(this,e,Rn,Vn,pe,{reply:0})}}function vt(r,e,n){const l=r.slice();return l[26]=e[n],l}function wt(r,e,n){const l=r.slice();l[29]=e[n];const t=ke(l[29]);return l[30]=t,l}function yt(r,e,n){const l=r.slice();return l[33]=e[n],l}function Gn(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Kn(r){let e,n,l=de(r[9]),t=[];for(let i=0;i<l.length;i+=1)t[i]=$t(yt(r,l,i));const s=i=>y(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=F()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=F()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),n=!0},p(i,c){if(c[0]&512){l=de(i[9]);let o;for(o=0;o<l.length;o+=1){const f=yt(i,l,o);t[o]?(t[o].p(f,c),k(t[o],1)):(t[o]=$t(f),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(Q(),o=l.length;o<t.length;o+=1)s(o);W()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)k(t[c]);n=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)y(t[c]);n=!1},d(i){i&&u(e),Ee(t,i)}}}function $t(r){let e,n;return e=new An({props:{message:r[33]}}),{c(){x(e.$$.fragment)},l(l){ne(e.$$.fragment,l)},m(l,t){ee(e,l,t),n=!0},p(l,t){const s={};t[0]&512&&(s.message=l[33]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function Hn(r){let e;return{c(){e=C("Loading...")},l(n){e=N(n,"Loading...")},m(n,l){g(n,e,l)},p:m,i:m,o:m,d(n){n&&u(e)}}}function Et(r){let e,n,l,t=Array.from(r[1]).map(Ct).join(", ")+"",s,i,c,o,f,p,d,h,b;return p=new Dt({}),{c(){e=E("div"),n=E("p"),l=C(`Uploading
				`),s=C(t),i=q(),c=E("div"),o=q(),f=E("button"),x(p.$$.fragment),this.h()},l(j){e=I(j,"DIV",{class:!0});var G=D(e);n=I(G,"P",{});var M=D(n);l=N(M,`Uploading
				`),s=N(M,t),M.forEach(u),i=L(G),c=I(G,"DIV",{class:!0}),D(c).forEach(u),o=L(G),f=I(G,"BUTTON",{});var P=D(f);ne(p.$$.fragment,P),P.forEach(u),G.forEach(u),this.h()},h(){a(c,"class","flex-divider"),a(e,"class","file-uploads svelte-1swq2l3")},m(j,G){g(j,e,G),v(e,n),v(n,l),v(n,s),v(e,i),v(e,c),v(e,o),v(e,f),ee(p,f,null),d=!0,h||(b=he(f,"click",r[17]),h=!0)},p(j,G){(!d||G[0]&2)&&t!==(t=Array.from(j[1]).map(Ct).join(", ")+"")&&J(s,t)},i(j){d||(k(p.$$.fragment,j),d=!0)},o(j){y(p.$$.fragment,j),d=!1},d(j){j&&u(e),te(p),h=!1,b()}}}function zn(r){let e,n,l;return{c(){e=E("img"),this.h()},l(t){e=I(t,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),this.h()},h(){a(e,"class","cover"),Y(e.src,n=ve(r[29]))||a(e,"src",n),a(e,"width","16px"),a(e,"height","16px"),a(e,"alt",l=r[30])},m(t,s){g(t,e,s)},p(t,s){s[0]&16&&!Y(e.src,n=ve(t[29]))&&a(e,"src",n),s[0]&16&&l!==(l=t[30])&&a(e,"alt",l)},i:m,o:m,d(t){t&&u(e)}}}function Xn(r){let e,n;return e=new Ae({}),{c(){x(e.$$.fragment)},l(l){ne(e.$$.fragment,l)},m(l,t){ee(e,l,t),n=!0},p:m,i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function It(r){let e,n,l,t,s=r[30]+"",i,c,o;const f=[Xn,zn],p=[];function d(h,b){return h[2]["jolt:low-data-mode"]?0:1}return n=d(r),l=p[n]=f[n](r),{c(){e=E("div"),l.c(),t=q(),i=C(s),c=C(" is typing..."),this.h()},l(h){e=I(h,"DIV",{class:!0});var b=D(e);l.l(b),t=L(b),i=N(b,s),c=N(b," is typing..."),b.forEach(u),this.h()},h(){a(e,"class","typing-indicator svelte-1swq2l3")},m(h,b){g(h,e,b),p[n].m(e,null),v(e,t),v(e,i),v(e,c),o=!0},p(h,b){let j=n;n=d(h),n===j?p[n].p(h,b):(Q(),y(p[j],1,1,()=>{p[j]=null}),W(),l=p[n],l?l.p(h,b):(l=p[n]=f[n](h),l.c()),k(l,1),l.m(e,t)),(!o||b[0]&16)&&s!==(s=h[30]+"")&&J(i,s)},i(h){o||(k(l),o=!0)},o(h){y(l),o=!1},d(h){h&&u(e),p[n].d()}}}function Mt(r){let e,n;return e=new Fn({props:{reply:r[26]}}),{c(){x(e.$$.fragment)},l(l){ne(e.$$.fragment,l)},m(l,t){ee(e,l,t),n=!0},p(l,t){const s={};t[0]&256&&(s.reply=l[26]),e.$set(s)},i(l){n||(k(e.$$.fragment,l),n=!0)},o(l){y(e.$$.fragment,l),n=!1},d(l){te(e,l)}}}function Jn(r){let e,n,l,t,s,i,c,o,f,p,d,h,b,j,G,M,P,H,R={ctx:r,current:null,token:null,hasCatch:!1,pending:Hn,then:Kn,catch:Gn,blocks:[,,,]};ce(l=r[7],R);let U=r[1]!=null&&r[1].length!=0&&Et(r),z=de(r[4]),B=[];for(let _=0;_<z.length;_+=1)B[_]=It(wt(r,z,_));const me=_=>y(B[_],1,1,()=>{B[_]=null});let fe=de(r[8]),O=[];for(let _=0;_<fe.length;_+=1)O[_]=Mt(vt(r,fe,_));const X=_=>y(O[_],1,1,()=>{O[_]=null});p=new Wt({});function K(_){r[20](_)}let A={sendTypingEvents:r[2]["jolt:send-typing-indicators"],placeholder:"Send message in "+r[6]};return r[0]!==void 0&&(A.value=r[0]),j=new St({props:A}),Ie.push(()=>Ve(j,"value",K)),{c(){e=E("main"),n=E("div"),R.block.c(),t=q(),U&&U.c(),s=q();for(let _=0;_<B.length;_+=1)B[_].c();i=q();for(let _=0;_<O.length;_+=1)O[_].c();c=q(),o=E("form"),f=E("label"),x(p.$$.fragment),d=q(),h=E("input"),b=q(),x(j.$$.fragment),this.h()},l(_){e=I(_,"MAIN",{class:!0});var w=D(e);n=I(w,"DIV",{class:!0});var $=D(n);R.block.l($),$.forEach(u),t=L(w),U&&U.l(w),s=L(w);for(let re=0;re<B.length;re+=1)B[re].l(w);i=L(w);for(let re=0;re<O.length;re+=1)O[re].l(w);c=L(w),o=I(w,"FORM",{class:!0,id:!0});var T=D(o);f=I(T,"LABEL",{for:!0,class:!0});var ae=D(f);ne(p.$$.fragment,ae),ae.forEach(u),d=L(T),h=I(T,"INPUT",{type:!0,id:!0,max:!0,class:!0}),b=L(T),ne(j.$$.fragment,T),T.forEach(u),w.forEach(u),this.h()},h(){a(n,"class","messages-list svelte-1swq2l3"),a(f,"for","file-upload"),a(f,"class","svelte-1swq2l3"),a(h,"type","file"),a(h,"id","file-upload"),a(h,"max","5"),a(h,"class","svelte-1swq2l3"),a(o,"class","message-form"),a(o,"id","send-message-form"),a(e,"class","main-content-container svelte-1swq2l3")},m(_,w){g(_,e,w),v(e,n),R.block.m(n,R.anchor=null),R.mount=()=>n,R.anchor=null,r[16](n),v(e,t),U&&U.m(e,null),v(e,s);for(let $=0;$<B.length;$+=1)B[$]&&B[$].m(e,null);v(e,i);for(let $=0;$<O.length;$+=1)O[$]&&O[$].m(e,null);v(e,c),v(e,o),v(o,f),ee(p,f,null),v(o,d),v(o,h),r[19](h),v(o,b),ee(j,o,null),M=!0,P||(H=[he(h,"change",r[18]),he(o,"submit",r[13])],P=!0)},p(_,w){if(r=_,R.ctx=r,w[0]&128&&l!==(l=r[7])&&ce(l,R)||we(R,r,w),r[1]!=null&&r[1].length!=0?U?(U.p(r,w),w[0]&2&&k(U,1)):(U=Et(r),U.c(),k(U,1),U.m(e,s)):U&&(Q(),y(U,1,1,()=>{U=null}),W()),w[0]&20){z=de(r[4]);let T;for(T=0;T<z.length;T+=1){const ae=wt(r,z,T);B[T]?(B[T].p(ae,w),k(B[T],1)):(B[T]=It(ae),B[T].c(),k(B[T],1),B[T].m(e,i))}for(Q(),T=z.length;T<B.length;T+=1)me(T);W()}if(w[0]&256){fe=de(r[8]);let T;for(T=0;T<fe.length;T+=1){const ae=vt(r,fe,T);O[T]?(O[T].p(ae,w),k(O[T],1)):(O[T]=Mt(ae),O[T].c(),k(O[T],1),O[T].m(e,c))}for(Q(),T=fe.length;T<O.length;T+=1)X(T);W()}const $={};w[0]&4&&($.sendTypingEvents=r[2]["jolt:send-typing-indicators"]),w[0]&64&&($.placeholder="Send message in "+r[6]),!G&&w[0]&1&&(G=!0,$.value=r[0],Le(()=>G=!1)),j.$set($)},i(_){if(!M){k(R.block),k(U);for(let w=0;w<z.length;w+=1)k(B[w]);for(let w=0;w<fe.length;w+=1)k(O[w]);k(p.$$.fragment,_),k(j.$$.fragment,_),M=!0}},o(_){for(let w=0;w<3;w+=1){const $=R.blocks[w];y($)}y(U),B=B.filter(Boolean);for(let w=0;w<B.length;w+=1)y(B[w]);O=O.filter(Boolean);for(let w=0;w<O.length;w+=1)y(O[w]);y(p.$$.fragment,_),y(j.$$.fragment,_),M=!1},d(_){_&&u(e),R.block.d(),R.token=null,R=null,r[16](null),U&&U.d(),Ee(B,_),Ee(O,_),te(p),r[19](null),te(j),P=!1,Se(H)}}}const Ct=r=>r.name;function Qn(r,e,n){let l,t,s,{channel:i}=e,{replies:c=[]}=e,{messageInput:o=""}=e,{files:f=null}=e;const p=le(De);_e(r,p,_=>n(2,t=_));const d=le(Ce),h=Oe([]);_e(r,h,_=>n(9,s=_));const b=Oe([]),j=Oe([]),G=Oe(c);_e(r,G,_=>n(8,l=_)),Ue(Re,h),Ue(Tt,b),Ue(Fe,j),Ue(Ge,G),Ue(Ut,i);let M,P=[],H,R="Unknown Channel",U=Promise.resolve();Rt(()=>{M&&M.offsetHeight+M.scrollTop>M.scrollHeight-20&&Ft().then(()=>{M.scrollTo(0,M.scrollHeight)})});async function z(_){if(!_){d.removeAllListeners("ChannelStartTyping"),d.removeAllListeners("ChannelStopTyping");return}d.on("ChannelStartTyping",async({id:w,user:$})=>{var T;if(!($==((T=d.user)==null?void 0:T._id)||w!=i._id)){for(const{_id:ae}of P)if($==ae)return;n(4,P[P.length]=await d.api.fetchUser($),P)}}),d.on("ChannelStopTyping",({id:w,user:$})=>{w==i._id&&n(4,P=P.filter(T=>T._id!=$))})}async function B(){let _=[];(H==null?void 0:H.files)!=null&&(_=await Promise.all(Array.from(H.files).map(w=>d.autumn.uploadFile(w))),n(5,H.value="",H),n(1,f=null)),await d.api.sendMessage(i._id,{content:o.trim(),replies:l.map(({message:{_id:w},mention:$})=>({id:w,mention:$})),attachments:_}),G.set([]),n(0,o="")}d.on("Message",_=>{_.channel==i._id&&(d.api.ackMessage(i._id,_._id),h.update(w=>(w.push(_),w)))}),d.on("MessageDelete",({id:_,channel:w})=>{w==i._id&&h.update($=>$.filter(T=>T._id!=_))}),d.on("MessageUpdate",({id:_,channel:w,data:$})=>{w==i._id&&h.update(T=>{const ae=T.findIndex(je=>je._id==_),re=T[ae];return $.content!=null&&(re.content=$.content),$.embeds!=null&&(re.embeds=$.embeds),re.edited=$.edited,T[ae]=re,T})});async function me(_){var w;if(_.channel_type=="TextChannel"||_.channel_type=="Group"){n(6,R=`#${_.name}`);return}if(_.channel_type=="SavedMessages"){n(6,R="Saved Notes");return}try{n(6,R=`@${ke(await d.api.fetchUser(_.recipients[0]==((w=d.user)==null?void 0:w._id)?_.recipients[1]:_.recipients[0]))}`)}catch{n(6,R="Unknown Channel")}}function fe(_){Ie[_?"unshift":"push"](()=>{M=_,n(3,M)})}const O=()=>{H!=null&&(n(5,H.value="",H),n(1,f=null))};function X(){f=this.files,n(1,f)}function K(_){Ie[_?"unshift":"push"](()=>{H=_,n(5,H)})}function A(_){o=_,n(0,o)}return r.$$set=_=>{"channel"in _&&n(14,i=_.channel),"replies"in _&&n(15,c=_.replies),"messageInput"in _&&n(0,o=_.messageInput),"files"in _&&n(1,f=_.files)},r.$$.update=()=>{r.$$.dirty[0]&16384&&(n(7,U=d.api.queryMessages(i._id,{sort:"Latest",include_users:!0}).then(_=>{if(Array.isArray(_)){const w=_.reverse();h.set(w)}else{const w=_.messages.reverse();h.set(w),j.set(_.users),b.set(_.members??[])}})),G.set([]),n(4,P=[])),r.$$.dirty[0]&4&&z(t["jolt:receive-typing-indicators"]),r.$$.dirty[0]&16384&&me(i)},[o,f,t,M,P,H,R,U,l,s,p,h,G,B,i,c,fe,O,X,K,A]}class ar extends ge{constructor(e){super(),be(this,e,Qn,Jn,pe,{channel:14,replies:15,messageInput:0,files:1},null,[-1,-1])}}export{ar as T};
