import{s as ge,d as Xe,u as qe,g as We,e as Ye,r as Se,c as le,h as Rt,b as Ke,i as Bt,n as m,f as ae,j as Ae,o as Gt,k as Kt}from"./scheduler.a21a5cad.js";import{S as ve,i as $e,g as M,s as V,m as y,h as C,j as B,c as P,n as E,f as h,k as g,a as p,x as k,z as me,o as K,d as $,t as N,C as Lt,r as oe,u as se,v as fe,D as Ut,w as ce,A as Oe,e as H,p as ne,b as re,l as Te,y as ye,E as Je}from"./index.4419476b.js";import{h as ie,u as be}from"./await_block.7ed97119.js";import{e as ue}from"./each.e59479a4.js";import{g as te,a as Me,c as je,b as Tt}from"./context.898bb4a8.js";import{a as Ft,g as pe,b as he}from"./util.7ba69813.js";import{U as Ne}from"./UserProfilePicture.c4845e79.js";import{X as Ce,e as zt,Y as Ht}from"./runtime.esm.252c27a7.js";import{w as Ue}from"./index.d8292243.js";import{a as St,s as Ot}from"./context.fa34f1f8.js";import{b as de}from"./paths.097c22aa.js";function Re(r,e,n){return new Promise((l,t)=>{n=="0".repeat(26)&&l(void 0);const o=e.find(i=>i._id==n);o==null&&r.fetchUser(n).then(l).catch(t),l(o)})}const Le=Symbol(),jt=Symbol(),Fe=Symbol(),Vt=Symbol(),Xt=r=>({}),Qe=r=>({});function qt(r){let e,n,l,t,o,i,f,s,a,_,c=r[2]("confirm")+"",d,R,z,L=r[2]("cancel")+"",A,D,Z,q;const G=r[4].header,Y=Xe(G,r,r[3],Qe),x=r[4].default,U=Xe(x,r,r[3],null);return{c(){e=M("dialog"),n=M("div"),Y&&Y.c(),l=V(),t=M("hr"),o=V(),U&&U.c(),i=V(),f=M("hr"),s=V(),a=M("form"),_=M("button"),d=y(c),R=V(),z=M("button"),A=y(L),this.h()},l(j){e=C(j,"DIALOG",{});var b=B(e);n=C(b,"DIV",{});var v=B(n);Y&&Y.l(v),l=P(v),t=C(v,"HR",{}),o=P(v),U&&U.l(v),i=P(v),f=C(v,"HR",{}),s=P(v),a=C(v,"FORM",{method:!0});var u=B(a);_=C(u,"BUTTON",{type:!0});var O=B(_);d=E(O,c),O.forEach(h),R=P(u),z=C(u,"BUTTON",{type:!0});var T=B(z);A=E(T,L),T.forEach(h),u.forEach(h),v.forEach(h),b.forEach(h),this.h()},h(){g(_,"type","submit"),g(z,"type","reset"),g(a,"method","dialog")},m(j,b){p(j,e,b),k(e,n),Y&&Y.m(n,null),k(n,l),k(n,t),k(n,o),U&&U.m(n,null),k(n,i),k(n,f),k(n,s),k(n,a),k(a,_),k(_,d),k(a,R),k(a,z),k(z,A),r[7](e),D=!0,Z||(q=[me(z,"click",r[6]),me(a,"submit",r[5]),me(e,"close",r[8])],Z=!0)},p(j,[b]){Y&&Y.p&&(!D||b&8)&&qe(Y,G,j,j[3],D?Ye(G,j[3],b,Xt):We(j[3]),Qe),U&&U.p&&(!D||b&8)&&qe(U,x,j,j[3],D?Ye(x,j[3],b,null):We(j[3]),null),(!D||b&4)&&c!==(c=j[2]("confirm")+"")&&K(d,c),(!D||b&4)&&L!==(L=j[2]("cancel")+"")&&K(A,L)},i(j){D||($(Y,j),$(U,j),D=!0)},o(j){N(Y,j),N(U,j),D=!1},d(j){j&&h(e),Y&&Y.d(j),U&&U.d(j),r[7](null),Z=!1,Se(q)}}}function Wt(r,e,n){let l;le(r,Ce,d=>n(2,l=d));let{$$slots:t={},$$scope:o}=e,{showModal:i}=e,f;function s(d){Rt.call(this,r,d)}const a=()=>n(0,i=!1);function _(d){Ke[d?"unshift":"push"](()=>{f=d,n(1,f)})}const c=()=>n(0,i=!1);return r.$$set=d=>{"showModal"in d&&n(0,i=d.showModal),"$$scope"in d&&n(3,o=d.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(i?f==null||f.showModal():f==null||f.close())},[i,f,l,o,t,s,a,_,c]}class Yt extends ve{constructor(e){super(),$e(this,e,Wt,qt,ge,{showModal:0})}}function Jt(r){let e,n="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=M("p"),e.textContent=n},l(l){e=C(l,"P",{"data-svelte-h":!0}),Oe(e)!=="svelte-os1rtp"&&(e.textContent=n)},m(l,t){p(l,e,t)},p:m,d(l){l&&h(e)}}}function Qt(r){let e,n="External Link";return{c(){e=M("h1"),e.textContent=n,this.h()},l(l){e=C(l,"H1",{class:!0,slot:!0,"data-svelte-h":!0}),Oe(e)!=="svelte-3ozcvb"&&(e.textContent=n),this.h()},h(){g(e,"class","text-3xl"),g(e,"slot","header")},m(l,t){p(l,e,t)},p:m,d(l){l&&h(e)}}}function Zt(r){let e,n,l,t,o,i,f,s;function a(c){r[2](c)}let _={$$slots:{header:[Qt],default:[Jt]},$$scope:{ctx:r}};return r[1]!==void 0&&(_.showModal=r[1]),e=new Yt({props:_}),Ke.push(()=>Lt(e,"showModal",a)),e.$on("submit",r[3]),{c(){oe(e.$$.fragment),l=V(),t=M("a"),o=y(r[0]),this.h()},l(c){se(e.$$.fragment,c),l=P(c),t=C(c,"A",{href:!0,target:!0,rel:!0});var d=B(t);o=E(d,r[0]),d.forEach(h),this.h()},h(){g(t,"href",r[0]),g(t,"target","_blank"),g(t,"rel","noreferrer")},m(c,d){fe(e,c,d),p(c,l,d),p(c,t,d),k(t,o),i=!0,f||(s=me(t,"click",Ut(r[4])),f=!0)},p(c,[d]){const R={};d&32&&(R.$$scope={dirty:d,ctx:c}),!n&&d&2&&(n=!0,R.showModal=c[1],Bt(()=>n=!1)),e.$set(R),(!i||d&1)&&K(o,c[0]),(!i||d&1)&&g(t,"href",c[0])},i(c){i||($(e.$$.fragment,c),i=!0)},o(c){N(e.$$.fragment,c),i=!1},d(c){c&&(h(l),h(t)),ce(e,c),f=!1,s()}}}function xt(r,e,n){let{href:l}=e,t=!1;function o(s){t=s,n(1,t)}const i=()=>window.open(l),f=()=>n(1,t=!0);return r.$$set=s=>{"href"in s&&n(0,l=s.href)},[l,t,o,i,f]}class De extends ve{constructor(e){super(),$e(this,e,xt,Zt,ge,{href:0})}}function el(r){let e,n="oop website embed, can't handle that :(";return{c(){e=M("span"),e.textContent=n,this.h()},l(l){e=C(l,"SPAN",{class:!0,"data-svelte-h":!0}),Oe(e)!=="svelte-1exisih"&&(e.textContent=n),this.h()},h(){g(e,"class","text-gray-600")},m(l,t){p(l,e,t)},p:m,i:m,o:m,d(l){l&&h(e)}}}function tl(r){let e,n,l,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&Ze(r),o=r[0].title&&xe(r),i=r[0].description&&et(r);return{c(){e=M("div"),t&&t.c(),n=V(),o&&o.c(),l=V(),i&&i.c(),this.h()},l(f){e=C(f,"DIV",{style:!0});var s=B(e);t&&t.l(s),n=P(s),o&&o.l(s),l=P(s),i&&i.l(s),s.forEach(h),this.h()},h(){Te(e,"background-color",r[0].colour)},m(f,s){p(f,e,s),t&&t.m(e,null),k(e,n),o&&o.m(e,null),k(e,l),i&&i.m(e,null)},p(f,s){f[0].icon_url&&!f[1]["jolt:low-data-mode"]?t?t.p(f,s):(t=Ze(f),t.c(),t.m(e,n)):t&&(t.d(1),t=null),f[0].title?o?o.p(f,s):(o=xe(f),o.c(),o.m(e,l)):o&&(o.d(1),o=null),f[0].description?i?i.p(f,s):(i=et(f),i.c(),i.m(e,null)):i&&(i.d(1),i=null),s&1&&Te(e,"background-color",f[0].colour)},i:m,o:m,d(f){f&&h(e),t&&t.d(),o&&o.d(),i&&i.d()}}}function ll(r){let e,n,l,t;const o=[il,rl],i=[];function f(s,a){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=H()},l(s){n.l(s),l=H()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let _=e;e=f(s),e===_?i[e].p(s,a):(ne(),N(i[_],1,1,()=>{i[_]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l))},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),i[e].d(s)}}}function nl(r){let e,n,l,t;const o=[sl,ol],i=[];function f(s,a){return s[1]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=H()},l(s){n.l(s),l=H()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let _=e;e=f(s),e===_?i[e].p(s,a):(ne(),N(i[_],1,1,()=>{i[_]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l))},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),i[e].d(s)}}}function Ze(r){let e,n,l;return{c(){e=M("img"),this.h()},l(t){e=C(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){ae(e.src,n=r[0].icon_url)||g(e,"src",n),g(e,"alt",l=r[0].title),g(e,"width","24"),g(e,"height","24"),g(e,"class","inline rounded-3xl")},m(t,o){p(t,e,o)},p(t,o){o&1&&!ae(e.src,n=t[0].icon_url)&&g(e,"src",n),o&1&&l!==(l=t[0].title)&&g(e,"alt",l)},d(t){t&&h(e)}}}function xe(r){let e,n=r[0].title+"",l;return{c(){e=M("h1"),l=y(n),this.h()},l(t){e=C(t,"H1",{class:!0});var o=B(e);l=E(o,n),o.forEach(h),this.h()},h(){g(e,"class","text-gray-600")},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&1&&n!==(n=t[0].title+"")&&K(l,n)},d(t){t&&h(e)}}}function et(r){let e,n=r[0].description+"",l;return{c(){e=M("p"),l=y(n)},l(t){e=C(t,"P",{});var o=B(e);l=E(o,n),o.forEach(h)},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&1&&n!==(n=t[0].description+"")&&K(l,n)},d(t){t&&h(e)}}}function rl(r){let e,n,l,t,o;return{c(){e=M("video"),n=M("source"),this.h()},l(i){e=C(i,"VIDEO",{});var f=B(e);n=C(f,"SOURCE",{src:!0,width:!0,height:!0}),f.forEach(h),this.h()},h(){ae(n.src,l=r[0].url)||g(n,"src",l),g(n,"width",t=r[0].width),g(n,"height",o=r[0].height),e.controls=!0},m(i,f){p(i,e,f),k(e,n)},p(i,f){f&1&&!ae(n.src,l=i[0].url)&&g(n,"src",l),f&1&&t!==(t=i[0].width)&&g(n,"width",t),f&1&&o!==(o=i[0].height)&&g(n,"height",o)},i:m,o:m,d(i){i&&h(e)}}}function il(r){let e,n;return e=new De({props:{href:r[0].url}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t&1&&(o.href=l[0].url),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function ol(r){let e,n,l,t;return{c(){e=M("img"),this.h()},l(o){e=C(o,"IMG",{src:!0,width:!0,height:!0}),this.h()},h(){ae(e.src,n=r[0].url)||g(e,"src",n),g(e,"width",l=r[0].width),g(e,"height",t=r[0].height)},m(o,i){p(o,e,i)},p(o,i){i&1&&!ae(e.src,n=o[0].url)&&g(e,"src",n),i&1&&l!==(l=o[0].width)&&g(e,"width",l),i&1&&t!==(t=o[0].height)&&g(e,"height",t)},i:m,o:m,d(o){o&&h(e)}}}function sl(r){let e,n;return e=new De({props:{href:r[0].url}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t&1&&(o.href=l[0].url),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function fl(r){let e,n,l,t;const o=[nl,ll,tl,el],i=[];function f(s,a){return s[0].type=="Image"?0:s[0].type=="Video"?1:s[0].type=="Text"?2:s[0].type=="Website"?3:-1}return~(e=f(r))&&(n=i[e]=o[e](r)),{c(){n&&n.c(),l=H()},l(s){n&&n.l(s),l=H()},m(s,a){~e&&i[e].m(s,a),p(s,l,a),t=!0},p(s,[a]){let _=e;e=f(s),e===_?~e&&i[e].p(s,a):(n&&(ne(),N(i[_],1,1,()=>{i[_]=null}),re()),~e?(n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l)):n=null)},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),~e&&i[e].d(s)}}}function cl(r,e,n){let l,{embed:t}=e;const o=te(Me);return le(r,o,i=>n(1,l=i)),r.$$set=i=>{"embed"in i&&n(0,t=i.embed)},[t,l,o]}class al extends ve{constructor(e){super(),$e(this,e,cl,fl,ge,{embed:0})}}function ul(r){let e,n,l,t;const o=[bl,pl],i=[];function f(s,a){return s[2]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=H()},l(s){n.l(s),l=H()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let _=e;e=f(s),e===_?i[e].p(s,a):(ne(),N(i[_],1,1,()=>{i[_]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l))},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),i[e].d(s)}}}function _l(r){let e,n,l=r[0].filename+"",t,o,i,f;return i=new De({props:{href:r[1]}}),{c(){e=M("span"),n=y("[File "),t=y(l),o=y(`]
			`),oe(i.$$.fragment),this.h()},l(s){e=C(s,"SPAN",{class:!0});var a=B(e);n=E(a,"[File "),t=E(a,l),o=E(a,`]
			`),se(i.$$.fragment,a),a.forEach(h),this.h()},h(){g(e,"class","text-gray-500")},m(s,a){p(s,e,a),k(e,n),k(e,t),k(e,o),fe(i,e,null),f=!0},p(s,a){(!f||a&1)&&l!==(l=s[0].filename+"")&&K(t,l);const _={};a&2&&(_.href=s[1]),i.$set(_)},i(s){f||($(i.$$.fragment,s),f=!0)},o(s){N(i.$$.fragment,s),f=!1},d(s){s&&h(e),ce(i)}}}function hl(r){let e,n,l;return{c(){e=M("audio"),n=M("source"),this.h()},l(t){e=C(t,"AUDIO",{});var o=B(e);n=C(o,"SOURCE",{src:!0}),o.forEach(h),this.h()},h(){ae(n.src,l=r[1])||g(n,"src",l),e.controls=!0},m(t,o){p(t,e,o),k(e,n)},p(t,o){o&2&&!ae(n.src,l=t[1])&&g(n,"src",l)},i:m,o:m,d(t){t&&h(e)}}}function ml(r){let e,n,l;return{c(){e=M("video"),n=M("source"),this.h()},l(t){e=C(t,"VIDEO",{});var o=B(e);n=C(o,"SOURCE",{src:!0}),o.forEach(h),this.h()},h(){ae(n.src,l=r[1])||g(n,"src",l),e.controls=!0},m(t,o){p(t,e,o),k(e,n)},p(t,o){o&2&&!ae(n.src,l=t[1])&&g(n,"src",l)},i:m,o:m,d(t){t&&h(e)}}}function dl(r){let e,n,l,t;const o=[Nl,El],i=[];function f(s,a){return s[2]["jolt:low-data-mode"]?0:1}return e=f(r),n=i[e]=o[e](r),{c(){n.c(),l=H()},l(s){n.l(s),l=H()},m(s,a){i[e].m(s,a),p(s,l,a),t=!0},p(s,a){let _=e;e=f(s),e===_?i[e].p(s,a):(ne(),N(i[_],1,1,()=>{i[_]=null}),re(),n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l))},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),i[e].d(s)}}}function pl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!0,pending:yl,then:gl,catch:kl,value:5,error:7};return ie(n=fetch(r[1]),l),{c(){e=H(),l.block.c()},l(t){e=H(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&2&&n!==(n=fetch(r[1]))&&ie(n,l)||be(l,r,o)},i:m,o:m,d(t){t&&h(e),l.block.d(t),l.token=null,l=null}}}function bl(r){let e,n,l,t,o;return l=new De({props:{href:r[1]}}),{c(){e=M("span"),n=y("[Text "),oe(l.$$.fragment),t=y("]"),this.h()},l(i){e=C(i,"SPAN",{class:!0});var f=B(e);n=E(f,"[Text "),se(l.$$.fragment,f),t=E(f,"]"),f.forEach(h),this.h()},h(){g(e,"class","text-gray-500")},m(i,f){p(i,e,f),k(e,n),fe(l,e,null),k(e,t),o=!0},p(i,f){const s={};f&2&&(s.href=i[1]),l.$set(s)},i(i){o||($(l.$$.fragment,i),o=!0)},o(i){N(l.$$.fragment,i),o=!1},d(i){i&&h(e),ce(l)}}}function kl(r){let e,n=r[3]("file.download.error")+"",l,t,o=r[0].filename+"",i,f,s=r[7]+"",a;return{c(){e=M("p"),l=y(n),t=V(),i=y(o),f=y(": "),a=y(s)},l(_){e=C(_,"P",{});var c=B(e);l=E(c,n),t=P(c),i=E(c,o),f=E(c,": "),a=E(c,s),c.forEach(h)},m(_,c){p(_,e,c),k(e,l),k(e,t),k(e,i),k(e,f),k(e,a)},p(_,c){c&8&&n!==(n=_[3]("file.download.error")+"")&&K(l,n),c&1&&o!==(o=_[0].filename+"")&&K(i,o),c&2&&s!==(s=_[7]+"")&&K(a,s)},d(_){_&&h(e)}}}function gl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:wl,then:$l,catch:vl,value:6};return ie(n=r[5].text(),l),{c(){e=H(),l.block.c()},l(t){e=H(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&2&&n!==(n=r[5].text())&&ie(n,l)||be(l,r,o)},d(t){t&&h(e),l.block.d(t),l.token=null,l=null}}}function vl(r){return{c:m,l:m,m,p:m,d:m}}function $l(r){let e,n=r[6]+"",l;return{c(){e=M("p"),l=y(n)},l(t){e=C(t,"P",{});var o=B(e);l=E(o,n),o.forEach(h)},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&2&&n!==(n=t[6]+"")&&K(l,n)},d(t){t&&h(e)}}}function wl(r){return{c:m,l:m,m,p:m,d:m}}function yl(r){return{c:m,l:m,m,p:m,d:m}}function El(r){let e,n,l;return{c(){e=M("img"),this.h()},l(t){e=C(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ae(e.src,n=r[1])||g(e,"src",n),g(e,"alt",l=r[0].filename),g(e,"class","max-w-xl max-h-xl")},m(t,o){p(t,e,o)},p(t,o){o&2&&!ae(e.src,n=t[1])&&g(e,"src",n),o&1&&l!==(l=t[0].filename)&&g(e,"alt",l)},i:m,o:m,d(t){t&&h(e)}}}function Nl(r){let e,n,l,t,o;return l=new De({props:{href:r[1]}}),{c(){e=M("span"),n=y("[Image "),oe(l.$$.fragment),t=y("]"),this.h()},l(i){e=C(i,"SPAN",{class:!0});var f=B(e);n=E(f,"[Image "),se(l.$$.fragment,f),t=E(f,"]"),f.forEach(h),this.h()},h(){g(e,"class","text-gray-500")},m(i,f){p(i,e,f),k(e,n),fe(l,e,null),k(e,t),o=!0},p(i,f){const s={};f&2&&(s.href=i[1]),l.$set(s)},i(i){o||($(l.$$.fragment,i),o=!0)},o(i){N(l.$$.fragment,i),o=!1},d(i){i&&h(e),ce(l)}}}function Il(r){let e,n,l,t;const o=[dl,ml,hl,_l,ul],i=[];function f(s,a){return s[0].metadata.type=="Image"?0:s[0].metadata.type=="Video"?1:s[0].metadata.type=="Audio"?2:s[0].metadata.type=="File"?3:s[0].metadata.type=="Text"?4:-1}return~(n=f(r))&&(l=i[n]=o[n](r)),{c(){e=M("div"),l&&l.c()},l(s){e=C(s,"DIV",{});var a=B(e);l&&l.l(a),a.forEach(h)},m(s,a){p(s,e,a),~n&&i[n].m(e,null),t=!0},p(s,[a]){let _=n;n=f(s),n===_?~n&&i[n].p(s,a):(l&&(ne(),N(i[_],1,1,()=>{i[_]=null}),re()),~n?(l=i[n],l?l.p(s,a):(l=i[n]=o[n](s),l.c()),$(l,1),l.m(e,null)):l=null)},i(s){t||($(l),t=!0)},o(s){N(l),t=!1},d(s){s&&h(e),~n&&i[n].d()}}}function Ml(r,e,n){let l,t,o;le(r,Ce,s=>n(3,o=s));const i=te(Me);le(r,i,s=>n(2,t=s));let{attachment:f}=e;return r.$$set=s=>{"attachment"in s&&n(0,f=s.attachment)},r.$$.update=()=>{r.$$.dirty&1&&n(1,l=Ft(f))},[f,l,t,o,i]}class Cl extends ve{constructor(e){super(),$e(this,e,Ml,Il,ge,{attachment:0})}}function tt(r){const e=he(r[4]);r[5]=e}function lt(r){r[6]=r[8][0],r[7]=r[8][1]}function nt(r){const e=he(r[4]);r[5]=e}function Dl(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Bl,then:Ol,catch:Sl,value:4,blocks:[,,,]};return ie(n=r[2].api.fetchUser(r[0].id),t),{c(){e=H(),t.block.c()},l(o){e=H(),t.block.l(o)},m(o,i){p(o,e,i),t.block.m(o,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,i){r=o,t.ctx=r,i&1&&n!==(n=r[2].api.fetchUser(r[0].id))&&ie(n,t)||be(t,r,i)},i(o){l||($(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];N(f)}l=!1},d(o){o&&h(e),t.block.d(o),t.token=null,t=null}}}function Al(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:Ll,then:Kl,catch:Gl,value:8};return ie(n=Promise.all([r[0].from,r[0].to].map(r[3])),l),{c(){e=H(),l.block.c()},l(t){e=H(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=Promise.all([r[0].from,r[0].to].map(r[3])))&&ie(n,l)||be(l,r,o)},i:m,o:m,d(t){t&&h(e),l.block.d(t),l.token=null,l=null}}}function Ul(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:en,then:zl,catch:Fl,value:4,blocks:[,,,]};return ie(n=r[2].api.fetchUser(r[0].by),t),{c(){e=H(),t.block.c()},l(o){e=H(),t.block.l(o)},m(o,i){p(o,e,i),t.block.m(o,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,i){r=o,t.ctx=r,i&1&&n!==(n=r[2].api.fetchUser(r[0].by))&&ie(n,t)||be(t,r,i)},i(o){l||($(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];N(f)}l=!1},d(o){o&&h(e),t.block.d(o),t.token=null,t=null}}}function Tl(r){let e=r[0].content+"",n;return{c(){n=y(e)},l(l){n=E(l,e)},m(l,t){p(l,n,t)},p(l,t){t&1&&e!==(e=l[0].content+"")&&K(n,e)},i:m,o:m,d(l){l&&h(n)}}}function Sl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Ol(r){tt(r);let e,n,l=r[5]+"",t,o,i,f;e=new Ne({props:{src:pe(r[4]),width:24,height:24,name:r[5]}});function s(c,d){if(c[0].type=="user_banned")return Rl;if(c[0].type=="user_joined")return Pl;if(c[0].type=="user_kicked")return Vl;if(c[0].type=="user_left")return jl}let a=s(r),_=a&&a(r);return{c(){oe(e.$$.fragment),n=V(),t=y(l),o=V(),_&&_.c(),i=H()},l(c){se(e.$$.fragment,c),n=P(c),t=E(c,l),o=P(c),_&&_.l(c),i=H()},m(c,d){fe(e,c,d),p(c,n,d),p(c,t,d),p(c,o,d),_&&_.m(c,d),p(c,i,d),f=!0},p(c,d){tt(c);const R={};d&1&&(R.src=pe(c[4])),d&1&&(R.name=c[5]),e.$set(R),(!f||d&1)&&l!==(l=c[5]+"")&&K(t,l),a===(a=s(c))&&_?_.p(c,d):(_&&_.d(1),_=a&&a(c),_&&(_.c(),_.m(i.parentNode,i)))},i(c){f||($(e.$$.fragment,c),f=!0)},o(c){N(e.$$.fragment,c),f=!1},d(c){c&&(h(n),h(t),h(o),h(i)),ce(e,c),_&&_.d(c)}}}function jl(r){let e=r[1]("user.chat.left")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.chat.left")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Vl(r){let e=r[1]("user.was-kicked")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.was-kicked")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Pl(r){let e=r[1]("user.chat.joined")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.chat.joined")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Rl(r){let e=r[1]("user.was-banned")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("user.was-banned")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Bl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Gl(r){return{c:m,l:m,m,p:m,d:m}}function Kl(r){lt(r);let e=r[1]("channel.ownership.changed-from")+"",n,l,t=he(r[6])+"",o,i,f=he(r[7])+"",s,a;return{c(){n=y(e),l=V(),o=y(t),i=y(" to "),s=y(f),a=y(".")},l(_){n=E(_,e),l=P(_),o=E(_,t),i=E(_," to "),s=E(_,f),a=E(_,".")},m(_,c){p(_,n,c),p(_,l,c),p(_,o,c),p(_,i,c),p(_,s,c),p(_,a,c)},p(_,c){lt(_),c&2&&e!==(e=_[1]("channel.ownership.changed-from")+"")&&K(n,e),c&1&&t!==(t=he(_[6])+"")&&K(o,t),c&1&&f!==(f=he(_[7])+"")&&K(s,f)},d(_){_&&(h(n),h(l),h(o),h(i),h(s),h(a))}}}function Ll(r){return{c:m,l:m,m,p:m,d:m}}function Fl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function zl(r){nt(r);let e,n,l=r[5]+"",t,o,i,f;e=new Ne({props:{src:pe(r[4]),width:24,height:24,name:r[5]}});function s(c,d){if(c[0].type=="channel_description_changed")return Wl;if(c[0].type=="channel_icon_changed")return ql;if(c[0].type=="channel_renamed")return Xl;if(c[0].type=="user_added"||c[0].type=="user_remove")return Hl}let a=s(r),_=a&&a(r);return{c(){oe(e.$$.fragment),n=V(),t=y(l),o=V(),_&&_.c(),i=H()},l(c){se(e.$$.fragment,c),n=P(c),t=E(c,l),o=P(c),_&&_.l(c),i=H()},m(c,d){fe(e,c,d),p(c,n,d),p(c,t,d),p(c,o,d),_&&_.m(c,d),p(c,i,d),f=!0},p(c,d){nt(c);const R={};d&1&&(R.src=pe(c[4])),d&1&&(R.name=c[5]),e.$set(R),(!f||d&1)&&l!==(l=c[5]+"")&&K(t,l),a===(a=s(c))&&_?_.p(c,d):(_&&_.d(1),_=a&&a(c),_&&(_.c(),_.m(i.parentNode,i)))},i(c){f||($(e.$$.fragment,c),f=!0)},o(c){N(e.$$.fragment,c),f=!1},d(c){c&&(h(n),h(t),h(o),h(i)),ce(e,c),_&&_.d(c)}}}function Hl(r){let e,n,l={ctx:r,current:null,token:null,hasCatch:!1,pending:xl,then:Jl,catch:Yl,value:4};return ie(n=r[2].api.fetchUser(r[0].id),l),{c(){e=H(),l.block.c()},l(t){e=H(),l.block.l(t)},m(t,o){p(t,e,o),l.block.m(t,l.anchor=o),l.mount=()=>e.parentNode,l.anchor=e},p(t,o){r=t,l.ctx=r,o&1&&n!==(n=r[2].api.fetchUser(r[0].id))&&ie(n,l)||be(l,r,o)},d(t){t&&h(e),l.block.d(t),l.token=null,l=null}}}function Xl(r){let e=r[1]("channel.rename-to")+"",n,l,t=r[0].name+"",o,i;return{c(){n=y(e),l=V(),o=y(t),i=y(".")},l(f){n=E(f,e),l=P(f),o=E(f,t),i=E(f,".")},m(f,s){p(f,n,s),p(f,l,s),p(f,o,s),p(f,i,s)},p(f,s){s&2&&e!==(e=f[1]("channel.rename-to")+"")&&K(n,e),s&1&&t!==(t=f[0].name+"")&&K(o,t)},d(f){f&&(h(n),h(l),h(o),h(i))}}}function ql(r){let e=r[1]("channel.icon.change")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("channel.icon.change")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Wl(r){let e=r[1]("channel.description.change")+"",n,l;return{c(){n=y(e),l=y(".")},l(t){n=E(t,e),l=E(t,".")},m(t,o){p(t,n,o),p(t,l,o)},p(t,o){o&2&&e!==(e=t[1]("channel.description.change")+"")&&K(n,e)},d(t){t&&(h(n),h(l))}}}function Yl(r){return{c:m,l:m,m,p:m,d:m}}function Jl(r){let e,n=he(r[4])+"",l,t;function o(s,a){if(s[0].type=="user_added")return Zl;if(s[0].type=="user_remove")return Ql}let i=o(r),f=i&&i(r);return{c(){f&&f.c(),e=V(),l=y(n),t=y(".")},l(s){f&&f.l(s),e=P(s),l=E(s,n),t=E(s,".")},m(s,a){f&&f.m(s,a),p(s,e,a),p(s,l,a),p(s,t,a)},p(s,a){i===(i=o(s))&&f?f.p(s,a):(f&&f.d(1),f=i&&i(s),f&&(f.c(),f.m(e.parentNode,e))),a&1&&n!==(n=he(s[4])+"")&&K(l,n)},d(s){s&&(h(e),h(l),h(t)),f&&f.d(s)}}}function Ql(r){let e=r[1]("removed")+"",n;return{c(){n=y(e)},l(l){n=E(l,e)},m(l,t){p(l,n,t)},p(l,t){t&2&&e!==(e=l[1]("removed")+"")&&K(n,e)},d(l){l&&h(n)}}}function Zl(r){let e=r[1]("added")+"",n;return{c(){n=y(e)},l(l){n=E(l,e)},m(l,t){p(l,n,t)},p(l,t){t&2&&e!==(e=l[1]("added")+"")&&K(n,e)},d(l){l&&h(n)}}}function xl(r){return{c:m,l:m,m,p:m,d:m}}function en(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function tn(r){let e,n,l,t;const o=[Tl,Ul,Al,Dl],i=[];function f(s,a){return s[0].type=="text"?0:s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove"?1:s[0].type=="channel_ownership_changed"?2:s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left"?3:-1}return~(e=f(r))&&(n=i[e]=o[e](r)),{c(){n&&n.c(),l=H()},l(s){n&&n.l(s),l=H()},m(s,a){~e&&i[e].m(s,a),p(s,l,a),t=!0},p(s,[a]){let _=e;e=f(s),e===_?~e&&i[e].p(s,a):(n&&(ne(),N(i[_],1,1,()=>{i[_]=null}),re()),~e?(n=i[e],n?n.p(s,a):(n=i[e]=o[e](s),n.c()),$(n,1),n.m(l.parentNode,l)):n=null)},i(s){t||($(n),t=!0)},o(s){N(n),t=!1},d(s){s&&h(l),~e&&i[e].d(s)}}}function ln(r,e,n){let l;le(r,Ce,f=>n(1,l=f));const t=te(je);let{system:o}=e;const i=f=>t.api.fetchUser(f);return r.$$set=f=>{"system"in f&&n(0,o=f.system)},[o,l,t,i]}class nn extends ve{constructor(e){super(),$e(this,e,ln,tn,ge,{system:0})}}function Ee(r){var e=new Error(r);return e.source="ulid",e}var Ve="0123456789ABCDEFGHJKMNPQRSTVWXYZ",Ie=Ve.length,Be=Math.pow(2,48)-1,Ge=10,Pt=16;function rn(r){var e=Math.floor(r()*Ie);return e===Ie&&(e=Ie-1),Ve.charAt(e)}function on(r,e){if(isNaN(r))throw new Error(r+" must be a number");if(r>Be)throw Ee("cannot encode time greater than "+Be);if(r<0)throw Ee("time must be positive");if(Number.isInteger(r)===!1)throw Ee("time must be an integer");for(var n=void 0,l="";e>0;e--)n=r%Ie,l=Ve.charAt(n)+l,r=(r-n)/Ie;return l}function sn(r,e){for(var n="";r>0;r--)n=rn(e)+n;return n}function fn(r){if(r.length!==Ge+Pt)throw Ee("malformed ulid");var e=r.substr(0,Ge).split("").reverse().reduce(function(n,l,t){var o=Ve.indexOf(l);if(o===-1)throw Ee("invalid character found: "+l);return n+=o*Math.pow(Ie,t)},0);if(e>Be)throw Ee("malformed ulid, timestamp too large");return e}function cn(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=arguments[1];e||(e=typeof window<"u"?window:null);var n=e&&(e.crypto||e.msCrypto);if(n)return function(){var t=new Uint8Array(1);return n.getRandomValues(t),t[0]/255};try{var l=require("crypto");return function(){return l.randomBytes(1).readUInt8()/255}}catch{}if(r){try{console.error("secure crypto unusable, falling back to insecure Math.random()!")}catch{}return function(){return Math.random()}}throw Ee("secure crypto unusable, insecure Math.random not allowed")}function an(r){return r||(r=cn()),function(n){return isNaN(n)&&(n=Date.now()),on(n,Ge)+sn(Pt,r)}}an();function rt(r){const e=he(r[14]);r[15]=e}function it(r){var o;let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:pn,then:_n,catch:un,value:13,blocks:[,,,]};return ie(n=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),t),{c(){e=H(),t.block.c()},l(i){e=H(),t.block.l(i)},m(i,f){p(i,e,f),t.block.m(i,t.anchor=f),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(i,f){var s;r=i,t.ctx=r,f&13&&n!==(n=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&ie(n,t)||be(t,r,f)},i(i){l||($(t.block),l=!0)},o(i){for(let f=0;f<3;f+=1){const s=t.blocks[f];N(s)}l=!1},d(i){i&&h(e),t.block.d(i),t.token=null,t=null}}}function un(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function _n(r){let e,n,l,t=!r[4]["jolt:low-data-mode"]&&ot(r),o=r[13].content!=null&&st(r);return{c(){t&&t.c(),e=V(),o&&o.c(),n=H()},l(i){t&&t.l(i),e=P(i),o&&o.l(i),n=H()},m(i,f){t&&t.m(i,f),p(i,e,f),o&&o.m(i,f),p(i,n,f),l=!0},p(i,f){i[4]["jolt:low-data-mode"]?t&&(ne(),N(t,1,1,()=>{t=null}),re()):t?(t.p(i,f),f&16&&$(t,1)):(t=ot(i),t.c(),$(t,1),t.m(e.parentNode,e)),i[13].content!=null?o?o.p(i,f):(o=st(i),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i(i){l||($(t),l=!0)},o(i){N(t),l=!1},d(i){i&&(h(e),h(n)),t&&t.d(i),o&&o.d(i)}}}function ot(r){let e,n,l,t={ctx:r,current:null,token:null,hasCatch:!1,pending:dn,then:mn,catch:hn,value:14,blocks:[,,,]};return ie(e=Re(r[6].api,r[5]??[],r[13].author),t),{c(){t.block.c(),n=y(":")},l(o){t.block.l(o),n=E(o,":")},m(o,i){t.block.m(o,t.anchor=i),t.mount=()=>n.parentNode,t.anchor=n,p(o,n,i),l=!0},p(o,i){r=o,t.ctx=r,i&45&&e!==(e=Re(r[6].api,r[5]??[],r[13].author))&&ie(e,t)||be(t,r,i)},i(o){l||($(t.block),l=!0)},o(o){for(let i=0;i<3;i+=1){const f=t.blocks[i];N(f)}l=!1},d(o){o&&h(n),t.block.d(o),t.token=null,t=null}}}function hn(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function mn(r){rt(r);let e,n,l=r[15]+"",t,o,i;return e=new Ne({props:{src:pe(r[14]),name:r[15],width:24,height:24}}),{c(){oe(e.$$.fragment),n=V(),t=y(l),o=V()},l(f){se(e.$$.fragment,f),n=P(f),t=E(f,l),o=P(f)},m(f,s){fe(e,f,s),p(f,n,s),p(f,t,s),p(f,o,s),i=!0},p(f,s){rt(f);const a={};s&45&&(a.src=pe(f[14])),s&45&&(a.name=f[15]),e.$set(a),(!i||s&45)&&l!==(l=f[15]+"")&&K(t,l)},i(f){i||($(e.$$.fragment,f),i=!0)},o(f){N(e.$$.fragment,f),i=!1},d(f){f&&(h(n),h(t),h(o)),ce(e,f)}}}function dn(r){let e;return{c(){e=y(`<Unknown User>
				`)},l(n){e=E(n,`<Unknown User>
				`)},m(n,l){p(n,e,l)},p:m,i:m,o:m,d(n){n&&h(e)}}}function st(r){let e,n=r[13].content+"",l;return{c(){e=M("span"),l=y(n),this.h()},l(t){e=C(t,"SPAN",{class:!0});var o=B(e);l=E(o,n),o.forEach(h),this.h()},h(){g(e,"class","text-gray-600")},m(t,o){p(t,e,o),k(e,l)},p(t,o){o&13&&n!==(n=t[13].content+"")&&K(l,n)},d(t){t&&h(e)}}}function pn(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function bn(r){let e,n,l,t=r[2]!=null&&it(r);return{c(){e=M("a"),t&&t.c(),this.h()},l(o){e=C(o,"A",{href:!0});var i=B(e);t&&t.l(i),i.forEach(h),this.h()},h(){g(e,"href",n=de+"/"+(r[1]==null?`channels/${r[2]}#${r[0]}`:`servers/${r[1]}/channels/${r[2]}#${r[0]}`))},m(o,i){p(o,e,i),t&&t.m(e,null),l=!0},p(o,[i]){o[2]!=null?t?(t.p(o,i),i&4&&$(t,1)):(t=it(o),t.c(),$(t,1),t.m(e,null)):t&&(ne(),N(t,1,1,()=>{t=null}),re()),(!l||i&7&&n!==(n=de+"/"+(o[1]==null?`channels/${o[2]}#${o[0]}`:`servers/${o[1]}/channels/${o[2]}#${o[0]}`)))&&g(e,"href",n)},i(o){l||($(t),l=!0)},o(o){N(t),l=!1},d(o){o&&h(e),t&&t.d()}}}function kn(r,e,n){let l,t,o,i,f;const s=te(je),a=te(Me);le(r,a,A=>n(4,i=A));const _=te(St);le(r,_,A=>n(1,l=A));const c=te(Ot);le(r,c,A=>n(2,t=A));const d=te(Le);le(r,d,A=>n(3,o=A));const R=te(Fe);le(r,R,A=>n(5,f=A));let{id:z}=e;const L=({_id:A})=>z==A;return r.$$set=A=>{"id"in A&&n(0,z=A.id)},[z,l,t,o,i,f,s,a,_,c,d,R,L]}class gn extends ve{constructor(e){super(),$e(this,e,kn,bn,ge,{id:0})}}function ft(r,e,n){const l=r.slice();return l[30]=e[n],l}function ct(r,e,n){const l=r.slice();return l[33]=e[n],l}function at(r,e,n){const l=r.slice();return l[36]=e[n].src,l[37]=e[n].alt,l[38]=e[n].onclick,l[39]=e[n].showIf,l}function Pe(r){const e=r.slice(),n=new Date(e[0].edited);return e[8]=n,e}function ut(r,e,n){const l=r.slice();return l[42]=e[n],l}function _t(r){let e,n,l=ue(r[0].replies),t=[];for(let i=0;i<l.length;i+=1)t[i]=ht(ut(r,l,i));const o=i=>N(t[i],1,1,()=>{t[i]=null});return{c(){e=M("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=C(i,"DIV",{class:!0});var f=B(e);for(let s=0;s<t.length;s+=1)t[s].l(f);f.forEach(h),this.h()},h(){g(e,"class","flex flex-col")},m(i,f){p(i,e,f);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null);n=!0},p(i,f){if(f[0]&1){l=ue(i[0].replies);let s;for(s=0;s<l.length;s+=1){const a=ut(i,l,s);t[s]?(t[s].p(a,f),$(t[s],1)):(t[s]=ht(a),t[s].c(),$(t[s],1),t[s].m(e,null))}for(ne(),s=l.length;s<t.length;s+=1)o(s);re()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)$(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)N(t[f]);n=!1},d(i){i&&h(e),ye(t,i)}}}function ht(r){let e,n;return e=new gn({props:{id:r[42]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.id=l[42]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function mt(r){let e,n;return e=new Ne({props:{name:r[4],src:r[3],width:40,height:40}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&16&&(o.name=l[4]),t[0]&8&&(o.src=l[3]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function dt(r){let e,n=r[5]("message.edited")+"",l,t,o=r[6](r[8])+"",i,f,s=r[7](r[8])+"",a,_;return{c(){e=y("["),l=y(n),t=V(),i=y(o),f=V(),a=y(s),_=y("]")},l(c){e=E(c,"["),l=E(c,n),t=P(c),i=E(c,o),f=P(c),a=E(c,s),_=E(c,"]")},m(c,d){p(c,e,d),p(c,l,d),p(c,t,d),p(c,i,d),p(c,f,d),p(c,a,d),p(c,_,d)},p(c,d){d[0]&32&&n!==(n=c[5]("message.edited")+"")&&K(l,n),d[0]&65&&o!==(o=c[6](c[8])+"")&&K(i,o),d[0]&129&&s!==(s=c[7](c[8])+"")&&K(a,s)},d(c){c&&(h(e),h(l),h(t),h(i),h(f),h(a),h(_))}}}function pt(r){let e,n,l,t,o,i;function f(){return r[20](r[38])}return{c(){e=M("button"),n=M("img"),t=V(),this.h()},l(s){e=C(s,"BUTTON",{class:!0,"aria-label":!0});var a=B(e);n=C(a,"IMG",{width:!0,height:!0,src:!0,alt:!0}),t=P(a),a.forEach(h),this.h()},h(){g(n,"width","16"),g(n,"height","16"),ae(n.src,l=r[36])||g(n,"src",l),g(n,"alt",r[37]),g(e,"class","ml-2"),g(e,"aria-label",r[37])},m(s,a){p(s,e,a),k(e,n),k(e,t),o||(i=me(e,"click",f),o=!0)},p(s,a){r=s},d(s){s&&h(e),o=!1,i()}}}function bt(r){var t;let e=((t=r[39])==null?void 0:t.call(r,r[0]))??!0,n,l=e&&pt(r);return{c(){l&&l.c(),n=H()},l(o){l&&l.l(o),n=H()},m(o,i){l&&l.m(o,i),p(o,n,i)},p(o,i){var f;i[0]&1&&(e=((f=o[39])==null?void 0:f.call(o,o[0]))??!0),e?l?l.p(o,i):(l=pt(o),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(o){o&&h(n),l&&l.d(o)}}}function vn(r){let e,n=r[0].content+"",l;return{c(){e=M("span"),l=y(n),this.h()},l(t){e=C(t,"SPAN",{style:!0,class:!0});var o=B(e);l=E(o,n),o.forEach(h),this.h()},h(){Te(e,"overflow-wrap","break-word"),g(e,"class","whitespace-pre-wrap")},m(t,o){p(t,e,o),k(e,l)},p(t,o){o[0]&1&&n!==(n=t[0].content+"")&&K(l,n)},d(t){t&&h(e)}}}function $n(r){let e,n,l,t;return{c(){e=M("form"),n=M("textarea"),this.h()},l(o){e=C(o,"FORM",{class:!0});var i=B(e);n=C(i,"TEXTAREA",{class:!0,placeholder:!0}),B(n).forEach(h),i.forEach(h),this.h()},h(){g(n,"class","outline-none resize-none bg-inherit w-full"),g(n,"placeholder","Edit this message"),g(e,"class","bg-gray-500 rounded-xl px-2 pt-2")},m(o,i){p(o,e,i),k(e,n),Je(n,r[2]),l||(t=[me(n,"keydown",r[21]),me(n,"input",r[22]),me(e,"submit",r[15])],l=!0)},p(o,i){i[0]&4&&Je(n,o[2])},d(o){o&&h(e),l=!1,Se(t)}}}function kt(r){let e,n;return e=new nn({props:{system:r[0].system}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.system=l[0].system),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function gt(r){let e,n,l=ue(r[0].attachments),t=[];for(let i=0;i<l.length;i+=1)t[i]=vt(ct(r,l,i));const o=i=>N(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=H()},l(i){for(let f=0;f<t.length;f+=1)t[f].l(i);e=H()},m(i,f){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,f);p(i,e,f),n=!0},p(i,f){if(f[0]&1){l=ue(i[0].attachments);let s;for(s=0;s<l.length;s+=1){const a=ct(i,l,s);t[s]?(t[s].p(a,f),$(t[s],1)):(t[s]=vt(a),t[s].c(),$(t[s],1),t[s].m(e.parentNode,e))}for(ne(),s=l.length;s<t.length;s+=1)o(s);re()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)$(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)N(t[f]);n=!1},d(i){i&&h(e),ye(t,i)}}}function vt(r){let e,n;return e=new Cl({props:{attachment:r[33]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.attachment=l[33]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function $t(r){let e,n,l=ue(r[0].embeds),t=[];for(let i=0;i<l.length;i+=1)t[i]=wt(ft(r,l,i));const o=i=>N(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=H()},l(i){for(let f=0;f<t.length;f+=1)t[f].l(i);e=H()},m(i,f){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,f);p(i,e,f),n=!0},p(i,f){if(f[0]&1){l=ue(i[0].embeds);let s;for(s=0;s<l.length;s+=1){const a=ft(i,l,s);t[s]?(t[s].p(a,f),$(t[s],1)):(t[s]=wt(a),t[s].c(),$(t[s],1),t[s].m(e.parentNode,e))}for(ne(),s=l.length;s<t.length;s+=1)o(s);re()}},i(i){if(!n){for(let f=0;f<l.length;f+=1)$(t[f]);n=!0}},o(i){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)N(t[f]);n=!1},d(i){i&&h(e),ye(t,i)}}}function wt(r){let e,n;return e=new al({props:{embed:r[30]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&1&&(o.embed=l[30]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function wn(r){let e,n,l,t,o,i,f,s,a=r[6](r[8])+"",_,c,d=r[7](r[8])+"",R,z,L,A,D,Z,q,G,Y,x,U,j,b=r[0].replies!=null&&r[0].replies.length!=0&&_t(r),v=!r[1]["jolt:compact-mode"]&&mt(r),u=r[0].edited!=null&&dt(Pe(r)),O=ue(r[14]),T=[];for(let w=0;w<O.length;w+=1)T[w]=bt(at(r,O,w));function X(w,F){if(w[2]!=null)return $n;if(w[0].content!=null)return vn}let I=X(r),S=I&&I(r),Q=r[0].system!=null&&kt(r),ee=r[0].attachments!=null&&gt(r),J=r[0].embeds!=null&&$t(r);return{c(){e=M("div"),b&&b.c(),n=V(),l=M("div"),v&&v.c(),t=V(),o=y(r[4]),i=V(),f=M("p"),s=y("["),_=y(a),c=V(),R=y(d),z=y(`]

			`),u&&u.c(),L=V(),A=M("div"),D=V(),Z=M("div");for(let w=0;w<T.length;w+=1)T[w].c();q=V(),S&&S.c(),G=V(),Q&&Q.c(),Y=V(),ee&&ee.c(),x=V(),J&&J.c(),this.h()},l(w){e=C(w,"DIV",{id:!0,class:!0});var F=B(e);b&&b.l(F),n=P(F),l=C(F,"DIV",{class:!0});var W=B(l);v&&v.l(W),t=P(W),o=E(W,r[4]),i=P(W),f=C(W,"P",{class:!0});var _e=B(f);s=E(_e,"["),_=E(_e,a),c=P(_e),R=E(_e,d),z=E(_e,`]

			`),u&&u.l(_e),_e.forEach(h),L=P(W),A=C(W,"DIV",{class:!0}),B(A).forEach(h),D=P(W),Z=C(W,"DIV",{class:!0});var we=B(Z);for(let ke=0;ke<T.length;ke+=1)T[ke].l(we);we.forEach(h),W.forEach(h),q=P(F),S&&S.l(F),G=P(F),Q&&Q.l(F),Y=P(F),ee&&ee.l(F),x=P(F),J&&J.l(F),F.forEach(h),this.h()},h(){g(f,"class","text-gray-500"),g(A,"class","flex-1"),g(Z,"class","hidden group-hover:flex"),g(l,"class","flex"),g(e,"id",U=r[0]._id),g(e,"class","flex flex-col hover:bg-gray-800 group p-4")},m(w,F){p(w,e,F),b&&b.m(e,null),k(e,n),k(e,l),v&&v.m(l,null),k(l,t),k(l,o),k(l,i),k(l,f),k(f,s),k(f,_),k(f,c),k(f,R),k(f,z),u&&u.m(f,null),k(l,L),k(l,A),k(l,D),k(l,Z);for(let W=0;W<T.length;W+=1)T[W]&&T[W].m(Z,null);k(e,q),S&&S.m(e,null),k(e,G),Q&&Q.m(e,null),k(e,Y),ee&&ee.m(e,null),k(e,x),J&&J.m(e,null),j=!0},p(w,F){if(w[0].replies!=null&&w[0].replies.length!=0?b?(b.p(w,F),F[0]&1&&$(b,1)):(b=_t(w),b.c(),$(b,1),b.m(e,n)):b&&(ne(),N(b,1,1,()=>{b=null}),re()),w[1]["jolt:compact-mode"]?v&&(ne(),N(v,1,1,()=>{v=null}),re()):v?(v.p(w,F),F[0]&2&&$(v,1)):(v=mt(w),v.c(),$(v,1),v.m(l,t)),(!j||F[0]&16)&&K(o,w[4]),(!j||F[0]&320)&&a!==(a=w[6](w[8])+"")&&K(_,a),(!j||F[0]&384)&&d!==(d=w[7](w[8])+"")&&K(R,d),w[0].edited!=null?u?u.p(Pe(w),F):(u=dt(Pe(w)),u.c(),u.m(f,null)):u&&(u.d(1),u=null),F[0]&16385){O=ue(w[14]);let W;for(W=0;W<O.length;W+=1){const _e=at(w,O,W);T[W]?T[W].p(_e,F):(T[W]=bt(_e),T[W].c(),T[W].m(Z,null))}for(;W<T.length;W+=1)T[W].d(1);T.length=O.length}I===(I=X(w))&&S?S.p(w,F):(S&&S.d(1),S=I&&I(w),S&&(S.c(),S.m(e,G))),w[0].system!=null?Q?(Q.p(w,F),F[0]&1&&$(Q,1)):(Q=kt(w),Q.c(),$(Q,1),Q.m(e,Y)):Q&&(ne(),N(Q,1,1,()=>{Q=null}),re()),w[0].attachments!=null?ee?(ee.p(w,F),F[0]&1&&$(ee,1)):(ee=gt(w),ee.c(),$(ee,1),ee.m(e,x)):ee&&(ne(),N(ee,1,1,()=>{ee=null}),re()),w[0].embeds!=null?J?(J.p(w,F),F[0]&1&&$(J,1)):(J=$t(w),J.c(),$(J,1),J.m(e,null)):J&&(ne(),N(J,1,1,()=>{J=null}),re()),(!j||F[0]&1&&U!==(U=w[0]._id))&&g(e,"id",U)},i(w){j||($(b),$(v),$(Q),$(ee),$(J),j=!0)},o(w){N(b),N(v),N(Q),N(ee),N(J),j=!1},d(w){w&&h(e),b&&b.d(),v&&v.d(),u&&u.d(),ye(T,w),S&&S.d(),Q&&Q.d(),ee&&ee.d(),J&&J.d()}}}function yn(r,e,n){let l,t,o,i,f,s,a,_,c,d,R;le(r,Ce,I=>n(5,_=I)),le(r,zt,I=>n(6,d=I)),le(r,Ht,I=>n(7,R=I));let{message:z}=e,L,A,D;te(Tt);const Z=te(Me);le(r,Z,I=>n(1,i=I));const q=te(je),G=te(St);le(r,G,I=>n(18,f=I)),te(Ot);const Y=te(Le),x=te(Fe);le(r,x,I=>n(19,s=I));const U=te(jt);le(r,U,I=>n(23,a=I));const j=te(Vt);le(r,j,I=>n(24,c=I));const b=[{src:`${de}/reply.svg`,alt:_("message.reply"),onclick(){c!=null&&c.some(I=>I.message._id==z._id)||j==null||j.update(I=>(I.push({message:z,mention:!0}),I))}},{src:`${de}/note.svg`,alt:_("message.edit"),showIf:I=>{var S;return I.author==((S=q.user)==null?void 0:S._id)},onclick:I=>n(2,L=L==null?I.content??"":void 0)},{src:`${de}/trash.svg`,alt:_("message.delete"),showIf:I=>{var S;return I.author==((S=q.user)==null?void 0:S._id)},onclick:I=>q.api.deleteMessage(I.channel,I._id)}];async function v(I,S){n(17,D=a==null?void 0:a.find(Q=>Q._id.server==I&&Q._id.user==S))}async function u(){const I=await q.api.editMessage(z.channel,z._id,{content:L});Y==null||Y.update(S=>(S[S.findIndex(Q=>Q._id==z._id)]=I,S))}const O=I=>I(z),T=I=>{if(!I.defaultPrevented){if(I.key=="Escape"){I.preventDefault(),n(2,L=void 0);return}I.shiftKey||I.key!="Enter"||(I.preventDefault(),u(),n(2,L=void 0))}};function X(){L=this.value,n(2,L)}return r.$$set=I=>{"message"in I&&n(0,z=I.message)},r.$$.update=()=>{r.$$.dirty[0]&524289&&Re(q.api,s??[],z.author).then(I=>n(16,A=I)),r.$$.dirty[0]&262145&&(f==null||v(f,z.author)),r.$$.dirty[0]&196609&&n(4,l=he(A,D,z)),r.$$.dirty[0]&196611&&n(3,t=i["jolt:low-data-mode"]?`${de}/user.svg`:pe(A,D,z)),r.$$.dirty[0]&1&&n(8,o=fn(z._id))},[z,i,L,t,l,_,d,R,o,Z,G,x,U,j,b,u,A,D,f,s,O,T,X]}class En extends ve{constructor(e){super(),$e(this,e,yn,wn,ge,{message:0},null,[-1,-1])}}function yt(r,e,n){const l=r.slice();l[23]=e[n],l[25]=e,l[26]=n;const t=l[10].api.fetchUser(l[23].message.author);return l[24]=t,l}function Et(r){const e=`<${r[6]("user.unknown")}>`;r[27]=e}function Nt(r){const e=he(r[24]);r[27]=e}function It(r,e,n){const l=r.slice();l[24]=e[n];const t=he(l[24]);return l[27]=t,l}function Mt(r,e,n){const l=r.slice();return l[30]=e[n],l}function Ct(r){let e,n;return e=new En({props:{message:r[30]}}),{c(){oe(e.$$.fragment)},l(l){se(e.$$.fragment,l)},m(l,t){fe(e,l,t),n=!0},p(l,t){const o={};t[0]&256&&(o.message=l[30]),e.$set(o)},i(l){n||($(e.$$.fragment,l),n=!0)},o(l){N(e.$$.fragment,l),n=!1},d(l){ce(e,l)}}}function Dt(r){let e,n,l,t=r[27]+"",o,i,f=r[6]("user.is-typing")+"",s,a,_;return n=new Ne({props:{src:r[2]["jolt:low-data-mode"]?`${de}/user.svg`:pe(r[24]),width:16,height:16,name:r[27]}}),{c(){e=M("div"),oe(n.$$.fragment),l=V(),o=y(t),i=V(),s=y(f),a=y("...")},l(c){e=C(c,"DIV",{});var d=B(e);se(n.$$.fragment,d),l=P(d),o=E(d,t),i=P(d),s=E(d,f),a=E(d,"..."),d.forEach(h)},m(c,d){p(c,e,d),fe(n,e,null),k(e,l),k(e,o),k(e,i),k(e,s),k(e,a),_=!0},p(c,d){const R={};d[0]&20&&(R.src=c[2]["jolt:low-data-mode"]?`${de}/user.svg`:pe(c[24])),d[0]&16&&(R.name=c[27]),n.$set(R),(!_||d[0]&16)&&t!==(t=c[27]+"")&&K(o,t),(!_||d[0]&64)&&f!==(f=c[6]("user.is-typing")+"")&&K(s,f)},i(c){_||($(n.$$.fragment,c),_=!0)},o(c){N(n.$$.fragment,c),_=!1},d(c){c&&h(e),ce(n)}}}function Nn(r){Et(r);let e,n,l=r[27]+"",t,o;return e=new Ne({props:{src:de+"/user.svg",name:r[27]}}),{c(){oe(e.$$.fragment),n=V(),t=y(l)},l(i){se(e.$$.fragment,i),n=P(i),t=E(i,l)},m(i,f){fe(e,i,f),p(i,n,f),p(i,t,f),o=!0},p(i,f){Et(i);const s={};f[0]&64&&(s.name=i[27]),e.$set(s),(!o||f[0]&64)&&l!==(l=i[27]+"")&&K(t,l)},i(i){o||($(e.$$.fragment,i),o=!0)},o(i){N(e.$$.fragment,i),o=!1},d(i){i&&(h(n),h(t)),ce(e,i)}}}function In(r){Nt(r);let e,n,l=r[27]+"",t,o;return e=new Ne({props:{src:pe(r[24]),name:r[27]}}),{c(){oe(e.$$.fragment),n=V(),t=y(l)},l(i){se(e.$$.fragment,i),n=P(i),t=E(i,l)},m(i,f){fe(e,i,f),p(i,n,f),p(i,t,f),o=!0},p(i,f){Nt(i);const s={};f[0]&128&&(s.src=pe(i[24])),f[0]&128&&(s.name=i[27]),e.$set(s),(!o||f[0]&128)&&l!==(l=i[27]+"")&&K(t,l)},i(i){o||($(e.$$.fragment,i),o=!0)},o(i){N(e.$$.fragment,i),o=!1},d(i){i&&(h(n),h(t)),ce(e,i)}}}function Mn(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function At(r){let e,n,l=r[6]("message.replying-to")+"",t,o,i,f,s,a,_=r[23].message.content+"",c,d,R,z,L,A,D,Z,q,G,Y,x=r[23].mention?"ON":"OFF",U,j,b,v,u,O,T,X,I,S={ctx:r,current:null,token:null,hasCatch:!0,pending:Mn,then:In,catch:Nn,value:24,blocks:[,,,]};ie(f=r[24],S);function Q(){r[13].call(A,r[25],r[26])}function ee(){return r[14](r[23])}return{c(){e=M("div"),n=M("p"),t=y(l),o=V(),i=M("strong"),S.block.c(),s=V(),a=M("p"),c=y(_),d=V(),R=M("div"),z=V(),L=M("div"),A=M("input"),D=V(),Z=M("label"),q=M("img"),Y=V(),U=y(x),j=V(),b=M("div"),v=M("button"),u=M("img"),this.h()},l(J){e=C(J,"DIV",{class:!0});var w=B(e);n=C(w,"P",{});var F=B(n);t=E(F,l),o=P(F),i=C(F,"STRONG",{});var W=B(i);S.block.l(W),W.forEach(h),F.forEach(h),s=P(w),a=C(w,"P",{class:!0});var _e=B(a);c=E(_e,_),_e.forEach(h),d=P(w),R=C(w,"DIV",{class:!0}),B(R).forEach(h),z=P(w),L=C(w,"DIV",{class:!0});var we=B(L);A=C(we,"INPUT",{id:!0,style:!0,type:!0}),D=P(we),Z=C(we,"LABEL",{class:!0,for:!0});var ke=B(Z);q=C(ke,"IMG",{src:!0,class:!0,alt:!0}),Y=P(ke),U=E(ke,x),ke.forEach(h),we.forEach(h),j=P(w),b=C(w,"DIV",{class:!0});var ze=B(b);v=C(ze,"BUTTON",{});var He=B(v);u=C(He,"IMG",{src:!0,alt:!0}),He.forEach(h),ze.forEach(h),w.forEach(h),this.h()},h(){g(a,"class","pl-1 text-gray-600 overflow-ellipsis"),g(R,"class","flex-1"),g(A,"id","mention"),Te(A,"display","none"),g(A,"type","checkbox"),ae(q.src,G=de+"/at.svg")||g(q,"src",G),g(q,"class","inline"),g(q,"alt","mention"),g(Z,"class","cursor-pointer"),g(Z,"for","mention"),g(L,"class","pr-2"),ae(u.src,O=de+"/circle-x.svg")||g(u,"src",O),g(u,"alt","Cancel mention"),g(b,"class","pr-2"),g(e,"class","flex")},m(J,w){p(J,e,w),k(e,n),k(n,t),k(n,o),k(n,i),S.block.m(i,S.anchor=null),S.mount=()=>i,S.anchor=null,k(e,s),k(e,a),k(a,c),k(e,d),k(e,R),k(e,z),k(e,L),k(L,A),A.checked=r[23].mention,k(L,D),k(L,Z),k(Z,q),k(Z,Y),k(Z,U),k(e,j),k(e,b),k(b,v),k(v,u),T=!0,X||(I=[me(A,"change",Q),me(v,"click",ee)],X=!0)},p(J,w){r=J,(!T||w[0]&64)&&l!==(l=r[6]("message.replying-to")+"")&&K(t,l),S.ctx=r,w[0]&128&&f!==(f=r[24])&&ie(f,S)||be(S,r,w),(!T||w[0]&128)&&_!==(_=r[23].message.content+"")&&K(c,_),w[0]&128&&(A.checked=r[23].mention),(!T||w[0]&128)&&x!==(x=r[23].mention?"ON":"OFF")&&K(U,x)},i(J){T||($(S.block),T=!0)},o(J){for(let w=0;w<3;w+=1){const F=S.blocks[w];N(F)}T=!1},d(J){J&&h(e),S.block.d(),S.token=null,S=null,X=!1,Se(I)}}}function Cn(r){let e,n,l,t="so um hi this is the start, i should make this text box much further down i think",o,i,f,s,a,_,c,d,R,z,L,A=ue(r[8]),D=[];for(let b=0;b<A.length;b+=1)D[b]=Ct(Mt(r,A,b));const Z=b=>N(D[b],1,1,()=>{D[b]=null});let q=ue(r[4]),G=[];for(let b=0;b<q.length;b+=1)G[b]=Dt(It(r,q,b));const Y=b=>N(G[b],1,1,()=>{G[b]=null});let x=ue(r[7]),U=[];for(let b=0;b<x.length;b+=1)U[b]=At(yt(r,x,b));const j=b=>N(U[b],1,1,()=>{U[b]=null});return{c(){e=M("main"),n=M("div"),l=M("p"),l.textContent=t,o=V();for(let b=0;b<D.length;b+=1)D[b].c();i=V();for(let b=0;b<G.length;b+=1)G[b].c();f=V();for(let b=0;b<U.length;b+=1)U[b].c();s=V(),a=M("form"),_=M("div"),c=M("textarea"),this.h()},l(b){e=C(b,"MAIN",{class:!0});var v=B(e);n=C(v,"DIV",{class:!0});var u=B(n);l=C(u,"P",{"data-svelte-h":!0}),Oe(l)!=="svelte-1kz18j0"&&(l.textContent=t),o=P(u);for(let X=0;X<D.length;X+=1)D[X].l(u);i=P(u);for(let X=0;X<G.length;X+=1)G[X].l(u);f=P(u);for(let X=0;X<U.length;X+=1)U[X].l(u);s=P(u),a=C(u,"FORM",{class:!0});var O=B(a);_=C(O,"DIV",{class:!0});var T=B(_);c=C(T,"TEXTAREA",{class:!0,placeholder:!0}),B(c).forEach(h),T.forEach(h),O.forEach(h),u.forEach(h),v.forEach(h),this.h()},h(){g(c,"class","outline-none resize-none bg-inherit w-full"),g(c,"placeholder",d=r[6]("send-message-in")+" "+r[5]),g(_,"class","bg-gray-500 rounded-xl px-2 pt-2"),g(a,"class","m-4"),g(n,"class","flex flex-col h-full overflow-x-hidden overflow-y-scroll"),g(e,"class","main-content-container")},m(b,v){p(b,e,v),k(e,n),k(n,l),k(n,o);for(let u=0;u<D.length;u+=1)D[u]&&D[u].m(n,null);k(n,i);for(let u=0;u<G.length;u+=1)G[u]&&G[u].m(n,null);k(n,f);for(let u=0;u<U.length;u+=1)U[u]&&U[u].m(n,null);k(n,s),k(n,a),k(a,_),k(_,c),r[17](c),R=!0,z||(L=[me(c,"input",r[15]),me(c,"keydown",r[16]),me(a,"submit",Ut(r[12]))],z=!0)},p(b,v){if(v[0]&256){A=ue(b[8]);let u;for(u=0;u<A.length;u+=1){const O=Mt(b,A,u);D[u]?(D[u].p(O,v),$(D[u],1)):(D[u]=Ct(O),D[u].c(),$(D[u],1),D[u].m(n,i))}for(ne(),u=A.length;u<D.length;u+=1)Z(u);re()}if(v[0]&84){q=ue(b[4]);let u;for(u=0;u<q.length;u+=1){const O=It(b,q,u);G[u]?(G[u].p(O,v),$(G[u],1)):(G[u]=Dt(O),G[u].c(),$(G[u],1),G[u].m(n,f))}for(ne(),u=q.length;u<G.length;u+=1)Y(u);re()}if(v[0]&1218){x=ue(b[7]);let u;for(u=0;u<x.length;u+=1){const O=yt(b,x,u);U[u]?(U[u].p(O,v),$(U[u],1)):(U[u]=At(O),U[u].c(),$(U[u],1),U[u].m(n,s))}for(ne(),u=x.length;u<U.length;u+=1)j(u);re()}(!R||v[0]&96&&d!==(d=b[6]("send-message-in")+" "+b[5]))&&g(c,"placeholder",d)},i(b){if(!R){for(let v=0;v<A.length;v+=1)$(D[v]);for(let v=0;v<q.length;v+=1)$(G[v]);for(let v=0;v<x.length;v+=1)$(U[v]);R=!0}},o(b){D=D.filter(Boolean);for(let v=0;v<D.length;v+=1)N(D[v]);G=G.filter(Boolean);for(let v=0;v<G.length;v+=1)N(G[v]);U=U.filter(Boolean);for(let v=0;v<U.length;v+=1)N(U[v]);R=!1},d(b){b&&h(e),ye(D,b),ye(G,b),ye(U,b),r[17](null),z=!1,Se(L)}}}function Dn(r,e,n){let l,t,o=m,i=()=>(o(),o=Kt(L,u=>n(7,t=u)),L),f,s;le(r,Ce,u=>n(6,l=u)),r.$$.on_destroy.push(()=>o());let{channel:a}=e;te(Tt);const _=te(Me);le(r,_,u=>n(2,f=u));const c=te(je);let d=Ue([]);le(r,d,u=>n(8,s=u));let R=Ue([]),z=Ue([]);const L=Ue([]);i(),Ae(Le,d),Ae(jt,R),Ae(Fe,z),Ae(Vt,L);let A,D=[];async function Z(u){if(!u){c.removeAllListeners("ChannelStartTyping"),c.removeAllListeners("ChannelStopTyping");return}c.on("ChannelStartTyping",async({id:O,user:T})=>{var X;if(!(T==((X=c.user)==null?void 0:X._id)||O!=a._id)){for(const{_id:I}of D)if(T==I)return;n(4,D[D.length]=await c.api.fetchUser(T),D)}}),c.on("ChannelStopTyping",({id:O,user:T})=>{O==a._id&&n(4,D=D.filter(X=>X._id!=T))})}Gt(()=>{c.on("Message",u=>{u.channel==a._id&&(c.api.ackMessage(a._id,u._id),d.update(O=>(O.push(u),O)))}),c.on("MessageDelete",({id:u,channel:O})=>{O==a._id&&d.update(T=>T.filter(X=>X._id!=u))}),c.on("MessageUpdate",({id:u,channel:O,data:T})=>{O==a._id&&d.update(X=>{const I=X.findIndex(Q=>Q._id==u),S=X[I];return T.content!=null&&(S.content=T.content),T.embeds!=null&&(S.embeds=T.embeds),S.edited=T.edited,X[I]=S,X})})});async function q(){await c.api.sendMessage(a._id,{content:A.value.trim(),replies:t.map(({message:{_id:u},mention:O})=>({id:u,mention:O}))}),L.set([]),n(3,A.value="",A)}let G;async function Y(u){var O;if(u.channel_type=="TextChannel"||u.channel_type=="VoiceChannel"||u.channel_type=="Group"){n(5,G=`#${u.name}`);return}if(u.channel_type=="SavedMessages"){n(5,G=l("channel.notes"));return}n(5,G=`@${he(await c.api.fetchUser(u.recipients[0]==((O=c.user)==null?void 0:O._id)?u.recipients[1]:u.recipients[0]))}`)}function x(u,O){u[O].mention=this.checked,L.set(t)}const U=u=>L.update(O=>(O=O.filter(T=>T.message._id!=u.message._id),O)),j=()=>{f["jolt:send-typing-indicators"]&&c.websocket.send({type:"BeginTyping",channel:a._id})},b=u=>{u.shiftKey||u.key!="Enter"||(u.preventDefault(),q())};function v(u){Ke[u?"unshift":"push"](()=>{A=u,n(3,A)})}return r.$$set=u=>{"channel"in u&&n(0,a=u.channel)},r.$$.update=()=>{r.$$.dirty[0]&1&&(c.api.queryMessages(a._id,{sort:"Latest",include_users:!0}).then(u=>{Array.isArray(u)?d.set(u.reverse()):(d.set(u.messages.reverse()??[]),z.set(u.users),R.set(u.members??[]))}),L.set([]),n(4,D=[])),r.$$.dirty[0]&4&&Z(f["jolt:receive-typing-indicators"]),r.$$.dirty[0]&1&&Y(a)},[a,L,f,A,D,G,l,t,s,_,c,d,q,x,U,j,b,v]}class Kn extends ve{constructor(e){super(),$e(this,e,Dn,Cn,ge,{channel:0},null,[-1,-1])}}export{Kn as C};
