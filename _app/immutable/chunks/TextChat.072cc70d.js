import{s as be,c as oe,n as d,j as ne,d as ol,u as cl,g as al,e as ul,r as Fe,k as fl,b as Ge,l as et,f as Zt,i as hl,h as Je,m as Be,o as _l,p as ml,t as ct}from"./scheduler.0beedca7.js";import{S as ke,i as ve,g as M,h as I,j as S,f as m,k as f,a as g,d as b,p as Y,t as w,b as Z,e as F,s as B,c as P,m as A,n as q,x as v,o as se,r as x,u as le,v as ee,w as te,z as Ee,A as Me,C as Ve,y as ue,E as tt,F as dl,l as je,G as Te,B as Se,H as at,q as ut}from"./index.433d2ede.js";import{h as he,u as Ue}from"./await_block.05af08bd.js";import{e as ge}from"./each.e59479a4.js";import{g as Q,c as Oe,a as He}from"./context.62a025aa.js";import{b as Ce,a as ye,g as pl}from"./util.68b48a6c.js";import{w as Pe}from"./index.2a8de96f.js";import{m as lt,u as nt,a as rt,g as xe,b as xt,r as it,c as el,s as gl,n as bl}from"./index.6c106917.js";import{e as ft}from"./singletons.e88a5f6c.js";import{G as Ke}from"./GenericUserCircleIcon.e3ed4165.js";import{s as st,a as tl}from"./context.4d0298a0.js";import{d as Qe,u as kl}from"./index.esm.4b6e8736.js";import{P as vl}from"./PencilSquareIcon.0e1e2bf6.js";import{t as ll,P as wl}from"./PlusIcon.cd0b51e5.js";import{d as Re,c as yl}from"./calendar.5942d46b.js";import{p as $l}from"./stores.72bfa3f6.js";import{C as El}from"./ChatBubbleBottomCenterTextIcon.9d6eadeb.js";function Ml(r){var t;const e=r.slice(),l=(t=e[6])==null?void 0:t.find(function(...i){return r[15](e[17],...i)});e[18]=l;const n=ye(e[17],e[18],e[16]);return e[19]=n,e}function Ye(r){var n;const e=r.slice(),l=(n=e[3])==null?void 0:n.find(({_id:t})=>e[0]==t);return e[16]=l,e}function ht(r){let e,l,n,t;const s=[Cl,Il],i=[];function c(o,a){return o[16]==null?0:1}return e=c(r),l=i[e]=s[e](r),{c(){l.c(),n=F()},l(o){l.l(o),n=F()},m(o,a){i[e].m(o,a),g(o,n,a),t=!0},p(o,a){let _=e;e=c(o),e===_?i[e].p(o,a):(Y(),w(i[_],1,1,()=>{i[_]=null}),Z(),l=i[e],l?l.p(o,a):(l=i[e]=s[e](o),l.c()),b(l,1),l.m(n.parentNode,n))},i(o){t||(b(l),t=!0)},o(o){w(l),t=!1},d(o){o&&m(n),i[e].d(o)}}}function Il(r){let e,l,n,t=!r[4]["jolt:low-data-mode"]&&_t(r),s=r[16].content!=null&&mt(r);return{c(){t&&t.c(),e=B(),s&&s.c(),l=F()},l(i){t&&t.l(i),e=P(i),s&&s.l(i),l=F()},m(i,c){t&&t.m(i,c),g(i,e,c),s&&s.m(i,c),g(i,l,c),n=!0},p(i,c){i[4]["jolt:low-data-mode"]?t&&(Y(),w(t,1,1,()=>{t=null}),Z()):t?(t.p(i,c),c&16&&b(t,1)):(t=_t(i),t.c(),b(t,1),t.m(e.parentNode,e)),i[16].content!=null?s?s.p(i,c):(s=mt(i),s.c(),s.m(l.parentNode,l)):s&&(s.d(1),s=null)},i(i){n||(b(t),n=!0)},o(i){w(t),n=!1},d(i){i&&(m(e),m(l)),t&&t.d(i),s&&s.d(i)}}}function Cl(r){let e;return{c(){e=A("Could not resolve message.")},l(l){e=q(l,"Could not resolve message.")},m(l,n){g(l,e,n)},p:d,i:d,o:d,d(l){l&&m(e)}}}function _t(r){let e,l,n,t={ctx:r,current:null,token:null,hasCatch:!1,pending:Sl,then:Nl,catch:Ul,value:17,blocks:[,,,]};return he(l=xe(r[5]??r[7].cache.users,r[16].author,r[14]),t),{c(){e=F(),t.block.c()},l(s){e=F(),t.block.l(s)},m(s,i){g(s,e,i),t.block.m(s,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,n=!0},p(s,i){r=s,t.ctx=r,i&41&&l!==(l=xe(r[5]??r[7].cache.users,r[16].author,r[14]))&&he(l,t)||Ue(t,r,i)},i(s){n||(b(t.block),n=!0)},o(s){for(let i=0;i<3;i+=1){const c=t.blocks[i];w(c)}n=!1},d(s){s&&m(e),t.block.d(s),t.token=null,t=null}}}function Ul(r){return{c:d,l:d,m:d,p:d,i:d,o:d,d}}function Nl(r){let e,l,n,t;const s=[jl,Tl],i=[];function c(a,_){return a[17]!=null?0:1}function o(a,_){return _===0?Ml(a):a}return e=c(r),l=i[e]=s[e](o(r,e)),{c(){l.c(),n=F()},l(a){l.l(a),n=F()},m(a,_){i[e].m(a,_),g(a,n,_),t=!0},p(a,_){let h=e;e=c(a),e===h?i[e].p(o(a,e),_):(Y(),w(i[h],1,1,()=>{i[h]=null}),Z(),l=i[e],l?l.p(o(a,e),_):(l=i[e]=s[e](o(a,e)),l.c()),b(l,1),l.m(n.parentNode,n))},i(a){t||(b(l),t=!0)},o(a){w(l),t=!1},d(a){a&&m(n),i[e].d(a)}}}function Tl(r){let e,l,n;return e=new Ke({}),{c(){x(e.$$.fragment),l=A(`

						<Unknown User>`)},l(t){le(e.$$.fragment,t),l=q(t,`

						<Unknown User>`)},m(t,s){ee(e,t,s),g(t,l,s),n=!0},p:d,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){t&&m(l),te(e,t)}}}function jl(r){let e,l,n,t,s=r[19]+"",i;return{c(){e=M("img"),t=B(),i=A(s),this.h()},l(c){e=I(c,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),t=P(c),i=q(c,s),this.h()},h(){f(e,"class","cover"),ne(e.src,l=Ce(r[17],r[18],r[16]))||f(e,"src",l),f(e,"alt",n=r[19]),f(e,"width","24px"),f(e,"height","24px")},m(c,o){g(c,e,o),g(c,t,o),g(c,i,o)},p(c,o){o&105&&!ne(e.src,l=Ce(c[17],c[18],c[16]))&&f(e,"src",l),o&105&&n!==(n=c[19])&&f(e,"alt",n),o&105&&s!==(s=c[19]+"")&&se(i,s)},i:d,o:d,d(c){c&&(m(e),m(t),m(i))}}}function Sl(r){let e,l,n;return e=new Ke({}),{c(){x(e.$$.fragment),l=A(`

					<Unknown User>`)},l(t){le(e.$$.fragment,t),l=q(t,`

					<Unknown User>`)},m(t,s){ee(e,t,s),g(t,l,s),n=!0},p:d,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){t&&m(l),te(e,t)}}}function mt(r){let e,l=r[16].content+"",n;return{c(){e=M("span"),n=A(l),this.h()},l(t){e=I(t,"SPAN",{class:!0});var s=S(e);n=q(s,l),s.forEach(m),this.h()},h(){f(e,"class","message-content svelte-pdgjwp")},m(t,s){g(t,e,s),v(e,n)},p(t,s){s&9&&l!==(l=t[16].content+"")&&se(n,l)},d(t){t&&m(e)}}}function Al(r){let e,l,n,t=r[2]!=null&&ht(Ye(r));return{c(){e=M("a"),t&&t.c(),this.h()},l(s){e=I(s,"A",{href:!0,class:!0});var i=S(e);t&&t.l(i),i.forEach(m),this.h()},h(){var s,i,c;f(e,"href",l=ft+"/"+(r[1]==null?`channels/${(s=r[2])==null?void 0:s._id}/${r[0]}`:`servers/${(i=r[1])==null?void 0:i._id}/channels/${(c=r[2])==null?void 0:c._id}/${r[0]}`)),f(e,"class","svelte-pdgjwp")},m(s,i){g(s,e,i),t&&t.m(e,null),n=!0},p(s,[i]){var c,o,a;s[2]!=null?t?(t.p(Ye(s),i),i&4&&b(t,1)):(t=ht(Ye(s)),t.c(),b(t,1),t.m(e,null)):t&&(Y(),w(t,1,1,()=>{t=null}),Z()),(!n||i&7&&l!==(l=ft+"/"+(s[1]==null?`channels/${(c=s[2])==null?void 0:c._id}/${s[0]}`:`servers/${(o=s[1])==null?void 0:o._id}/channels/${(a=s[2])==null?void 0:a._id}/${s[0]}`)))&&f(e,"href",l)},i(s){n||(b(t),n=!0)},o(s){w(t),n=!1},d(s){s&&m(e),t&&t.d()}}}function ql(r,e,l){let n,t,s,i,c,o;const a=Q(Oe),_=Q(He);oe(r,_,k=>l(4,i=k));const h=Q(st);oe(r,h,k=>l(2,t=k));const u=Q(tl);oe(r,u,k=>l(1,n=k));const p=Q(lt);oe(r,p,k=>l(3,s=k));const N=Q(nt);oe(r,N,k=>l(5,c=k));const T=Q(rt);oe(r,T,k=>l(6,o=k));let{id:C}=e;const y=k=>a.fetchUser(k),D=(k,O)=>O._id.user==k._id;return r.$$set=k=>{"id"in k&&l(0,C=k.id)},[C,n,t,s,i,c,o,a,_,h,u,p,N,T,y,D]}class Dl extends ke{constructor(e){super(),ve(this,e,ql,Al,be,{id:0})}}function Bl(r){let e,l;return{c(){e=Ee("svg"),l=Ee("path"),this.h()},l(n){e=Me(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=S(e);l=Me(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),t.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","1.5"),f(e,"stroke","currentColor"),f(e,"width",r[0]),f(e,"height",r[1])},m(n,t){g(n,e,t),v(e,l)},p(n,[t]){t&1&&f(e,"width",n[0]),t&2&&f(e,"height",n[1])},i:d,o:d,d(n){n&&m(e)}}}function Pl(r,e,l){let{width:n="24px"}=e,{height:t="24px"}=e;return r.$$set=s=>{"width"in s&&l(0,n=s.width),"height"in s&&l(1,t=s.height)},[n,t]}class Ol extends ke{constructor(e){super(),ve(this,e,Pl,Bl,be,{width:0,height:1})}}function Vl(r){let e,l;return{c(){e=Ee("svg"),l=Ee("path"),this.h()},l(n){e=Me(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=S(e);l=Me(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),t.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","1.5"),f(e,"stroke","currentColor"),f(e,"width",r[0]),f(e,"height",r[1])},m(n,t){g(n,e,t),v(e,l)},p(n,[t]){t&1&&f(e,"width",n[0]),t&2&&f(e,"height",n[1])},i:d,o:d,d(n){n&&m(e)}}}function Fl(r,e,l){let{width:n="24px"}=e,{height:t="24px"}=e;return r.$$set=s=>{"width"in s&&l(0,n=s.width),"height"in s&&l(1,t=s.height)},[n,t]}class Ll extends ke{constructor(e){super(),ve(this,e,Fl,Vl,be,{width:0,height:1})}}function dt(r){const e=ye(r[3]);r[4]=e}function pt(r){r[5]=r[7][0],r[6]=r[7][1]}function gt(r){const e=ye(r[3]);r[4]=e}function Rl(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:Zl,then:Wl,catch:zl,value:3};return he(l=r[1].fetchUser(r[0].id),n),{c(){e=F(),n.block.c()},l(t){e=F(),n.block.l(t)},m(t,s){g(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&1&&l!==(l=r[1].fetchUser(r[0].id))&&he(l,n)||Ue(n,r,s)},d(t){t&&m(e),n.block.d(t),n.token=null,n=null}}}function Gl(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:tn,then:en,catch:xl,value:7};return he(l=Promise.all([r[0].from,r[0].to].map(r[2])),n),{c(){e=F(),n.block.c()},l(t){e=F(),n.block.l(t)},m(t,s){g(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&1&&l!==(l=Promise.all([r[0].from,r[0].to].map(r[2])))&&he(l,n)||Ue(n,r,s)},d(t){t&&m(e),n.block.d(t),n.token=null,n=null}}}function Hl(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:mn,then:nn,catch:ln,value:3};return he(l=r[1].fetchUser(r[0].by),n),{c(){e=F(),n.block.c()},l(t){e=F(),n.block.l(t)},m(t,s){g(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&1&&l!==(l=r[1].fetchUser(r[0].by))&&he(l,n)||Ue(n,r,s)},d(t){t&&m(e),n.block.d(t),n.token=null,n=null}}}function Kl(r){let e=r[0].content+"",l;return{c(){l=A(e)},l(n){l=q(n,e)},m(n,t){g(n,l,t)},p(n,t){t&1&&e!==(e=n[0].content+"")&&se(l,e)},d(n){n&&m(l)}}}function zl(r){return{c:d,l:d,m:d,p:d,d}}function Wl(r){dt(r);let e,l,n,t,s=r[4]+"",i,c,o;function a(u,p){if(u[0].type=="user_banned")return Yl;if(u[0].type=="user_joined")return Ql;if(u[0].type=="user_kicked")return Jl;if(u[0].type=="user_left")return Xl}let _=a(r),h=_&&_(r);return{c(){e=M("img"),t=B(),i=A(s),c=B(),h&&h.c(),o=F(),this.h()},l(u){e=I(u,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=P(u),i=q(u,s),c=P(u),h&&h.l(u),o=F(),this.h()},h(){f(e,"class","cover"),ne(e.src,l=Ce(r[3]))||f(e,"src",l),f(e,"width","24px"),f(e,"height","24px"),f(e,"alt",n=r[4])},m(u,p){g(u,e,p),g(u,t,p),g(u,i,p),g(u,c,p),h&&h.m(u,p),g(u,o,p)},p(u,p){dt(u),p&1&&!ne(e.src,l=Ce(u[3]))&&f(e,"src",l),p&1&&n!==(n=u[4])&&f(e,"alt",n),p&1&&s!==(s=u[4]+"")&&se(i,s),_!==(_=a(u))&&(h&&h.d(1),h=_&&_(u),h&&(h.c(),h.m(o.parentNode,o)))},d(u){u&&(m(e),m(t),m(i),m(c),m(o)),h&&h.d(u)}}}function Xl(r){let e;return{c(){e=A("left the chat.")},l(l){e=q(l,"left the chat.")},m(l,n){g(l,e,n)},d(l){l&&m(e)}}}function Jl(r){let e;return{c(){e=A("was kicked.")},l(l){e=q(l,"was kicked.")},m(l,n){g(l,e,n)},d(l){l&&m(e)}}}function Ql(r){let e;return{c(){e=A("has joined the chat.")},l(l){e=q(l,"has joined the chat.")},m(l,n){g(l,e,n)},d(l){l&&m(e)}}}function Yl(r){let e;return{c(){e=A("was banned.")},l(l){e=q(l,"was banned.")},m(l,n){g(l,e,n)},d(l){l&&m(e)}}}function Zl(r){return{c:d,l:d,m:d,p:d,d}}function xl(r){return{c:d,l:d,m:d,p:d,d}}function en(r){pt(r);let e,l=ye(r[5])+"",n,t,s=ye(r[6])+"",i,c;return{c(){e=A("Channel ownership changed from "),n=A(l),t=A(" to "),i=A(s),c=A(".")},l(o){e=q(o,"Channel ownership changed from "),n=q(o,l),t=q(o," to "),i=q(o,s),c=q(o,".")},m(o,a){g(o,e,a),g(o,n,a),g(o,t,a),g(o,i,a),g(o,c,a)},p(o,a){pt(o),a&1&&l!==(l=ye(o[5])+"")&&se(n,l),a&1&&s!==(s=ye(o[6])+"")&&se(i,s)},d(o){o&&(m(e),m(n),m(t),m(i),m(c))}}}function tn(r){return{c:d,l:d,m:d,p:d,d}}function ln(r){return{c:d,l:d,m:d,p:d,d}}function nn(r){gt(r);let e,l,n,t,s=r[4]+"",i,c,o;function a(u,p){if(u[0].type=="channel_description_changed")return cn;if(u[0].type=="channel_icon_changed")return on;if(u[0].type=="channel_renamed")return sn;if(u[0].type=="user_added"||u[0].type=="user_remove")return rn}let _=a(r),h=_&&_(r);return{c(){e=M("img"),t=B(),i=A(s),c=B(),h&&h.c(),o=F(),this.h()},l(u){e=I(u,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=P(u),i=q(u,s),c=P(u),h&&h.l(u),o=F(),this.h()},h(){f(e,"class","cover"),ne(e.src,l=Ce(r[3]))||f(e,"src",l),f(e,"width","24px"),f(e,"height","24px"),f(e,"alt",n=r[4])},m(u,p){g(u,e,p),g(u,t,p),g(u,i,p),g(u,c,p),h&&h.m(u,p),g(u,o,p)},p(u,p){gt(u),p&1&&!ne(e.src,l=Ce(u[3]))&&f(e,"src",l),p&1&&n!==(n=u[4])&&f(e,"alt",n),p&1&&s!==(s=u[4]+"")&&se(i,s),_===(_=a(u))&&h?h.p(u,p):(h&&h.d(1),h=_&&_(u),h&&(h.c(),h.m(o.parentNode,o)))},d(u){u&&(m(e),m(t),m(i),m(c),m(o)),h&&h.d(u)}}}function rn(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:_n,then:un,catch:an,value:3};return he(l=r[1].fetchUser(r[0].id),n),{c(){e=F(),n.block.c()},l(t){e=F(),n.block.l(t)},m(t,s){g(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&1&&l!==(l=r[1].fetchUser(r[0].id))&&he(l,n)||Ue(n,r,s)},d(t){t&&m(e),n.block.d(t),n.token=null,n=null}}}function sn(r){let e,l=r[0].name+"",n,t;return{c(){e=A("renamed this channel to "),n=A(l),t=A(".")},l(s){e=q(s,"renamed this channel to "),n=q(s,l),t=q(s,".")},m(s,i){g(s,e,i),g(s,n,i),g(s,t,i)},p(s,i){i&1&&l!==(l=s[0].name+"")&&se(n,l)},d(s){s&&(m(e),m(n),m(t))}}}function on(r){let e;return{c(){e=A("changes this channel icon.")},l(l){e=q(l,"changes this channel icon.")},m(l,n){g(l,e,n)},p:d,d(l){l&&m(e)}}}function cn(r){let e;return{c(){e=A("changed this channel's description.")},l(l){e=q(l,"changed this channel's description.")},m(l,n){g(l,e,n)},p:d,d(l){l&&m(e)}}}function an(r){return{c:d,l:d,m:d,p:d,d}}function un(r){let e,l=ye(r[3])+"",n,t;function s(o,a){if(o[0].type=="user_added")return hn;if(o[0].type=="user_remove")return fn}let i=s(r),c=i&&i(r);return{c(){c&&c.c(),e=B(),n=A(l),t=A(".")},l(o){c&&c.l(o),e=P(o),n=q(o,l),t=q(o,".")},m(o,a){c&&c.m(o,a),g(o,e,a),g(o,n,a),g(o,t,a)},p(o,a){i!==(i=s(o))&&(c&&c.d(1),c=i&&i(o),c&&(c.c(),c.m(e.parentNode,e))),a&1&&l!==(l=ye(o[3])+"")&&se(n,l)},d(o){o&&(m(e),m(n),m(t)),c&&c.d(o)}}}function fn(r){let e;return{c(){e=A("removed")},l(l){e=q(l,"removed")},m(l,n){g(l,e,n)},d(l){l&&m(e)}}}function hn(r){let e;return{c(){e=A("added")},l(l){e=q(l,"added")},m(l,n){g(l,e,n)},d(l){l&&m(e)}}}function _n(r){return{c:d,l:d,m:d,p:d,d}}function mn(r){return{c:d,l:d,m:d,p:d,d}}function dn(r){let e;function l(s,i){if(s[0].type=="text")return Kl;if(s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove")return Hl;if(s[0].type=="channel_ownership_changed")return Gl;if(s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left")return Rl}let n=l(r),t=n&&n(r);return{c(){e=M("span"),t&&t.c(),this.h()},l(s){e=I(s,"SPAN",{class:!0});var i=S(e);t&&t.l(i),i.forEach(m),this.h()},h(){f(e,"class","container svelte-qj8q6t")},m(s,i){g(s,e,i),t&&t.m(e,null)},p(s,[i]){n===(n=l(s))&&t?t.p(s,i):(t&&t.d(1),t=n&&n(s),t&&(t.c(),t.m(e,null)))},i:d,o:d,d(s){s&&m(e),t&&t.d()}}}function pn(r,e,l){const n=Q(Oe);let{system:t}=e;const s=i=>n.fetchUser(i);return r.$$set=i=>{"system"in i&&l(0,t=i.system)},[t,n,s]}class gn extends ke{constructor(e){super(),ve(this,e,pn,dn,be,{system:0})}}function bn(r){let e,l,n,t,s,i,c,o="Ok",a,_,h="Cancel",u,p,N;const T=r[3].default,C=ol(T,r,r[2],null);return{c(){e=M("dialog"),l=M("div"),C&&C.c(),n=B(),t=M("hr"),s=B(),i=M("form"),c=M("button"),c.textContent=o,a=B(),_=M("button"),_.textContent=h,this.h()},l(y){e=I(y,"DIALOG",{});var D=S(e);l=I(D,"DIV",{});var k=S(l);C&&C.l(k),n=P(k),t=I(k,"HR",{}),s=P(k),i=I(k,"FORM",{id:!0,method:!0});var O=S(i);c=I(O,"BUTTON",{type:!0,"data-svelte-h":!0}),Ve(c)!=="svelte-fdbbw9"&&(c.textContent=o),a=P(O),_=I(O,"BUTTON",{type:!0,"data-svelte-h":!0}),Ve(_)!=="svelte-1gqjcfl"&&(_.textContent=h),O.forEach(m),k.forEach(m),D.forEach(m),this.h()},h(){f(c,"type","submit"),f(_,"type","reset"),f(i,"id","modal-form"),f(i,"method","dialog")},m(y,D){g(y,e,D),v(e,l),C&&C.m(l,null),v(l,n),v(l,t),v(l,s),v(l,i),v(i,c),v(i,a),v(i,_),r[6](e),u=!0,p||(N=[ue(_,"click",r[5]),ue(i,"submit",r[4]),ue(e,"close",r[7])],p=!0)},p(y,[D]){C&&C.p&&(!u||D&4)&&cl(C,T,y,y[2],u?ul(T,y[2],D,null):al(y[2]),null)},i(y){u||(b(C,y),u=!0)},o(y){w(C,y),u=!1},d(y){y&&m(e),C&&C.d(y),r[6](null),p=!1,Fe(N)}}}function kn(r,e,l){let{$$slots:n={},$$scope:t}=e,{showModal:s}=e,i;function c(h){fl.call(this,r,h)}const o=()=>l(0,s=!1);function a(h){Ge[h?"unshift":"push"](()=>{i=h,l(1,i)})}const _=()=>l(0,s=!1);return r.$$set=h=>{"showModal"in h&&l(0,s=h.showModal),"$$scope"in h&&l(2,t=h.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(s?i==null||i.showModal():i==null||i.close())},[s,i,t,n,c,o,a,_]}class vn extends ke{constructor(e){super(),ve(this,e,kn,bn,be,{showModal:0})}}function wn(r){let e,l="External Link",n,t,s,i,c="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=M("h1"),e.textContent=l,n=B(),t=M("hr"),s=B(),i=M("p"),i.textContent=c,this.h()},l(o){e=I(o,"H1",{class:!0,"data-svelte-h":!0}),Ve(e)!=="svelte-qkxu7n"&&(e.textContent=l),n=P(o),t=I(o,"HR",{}),s=P(o),i=I(o,"P",{"data-svelte-h":!0}),Ve(i)!=="svelte-os1rtp"&&(i.textContent=c),this.h()},h(){f(e,"class","text-3xl")},m(o,a){g(o,e,a),g(o,n,a),g(o,t,a),g(o,s,a),g(o,i,a)},p:d,d(o){o&&(m(e),m(n),m(t),m(s),m(i))}}}function yn(r){let e,l,n,t,s,i,c,o;function a(h){r[2](h)}let _={$$slots:{default:[wn]},$$scope:{ctx:r}};return r[1]!==void 0&&(_.showModal=r[1]),e=new vn({props:_}),Ge.push(()=>tt(e,"showModal",a)),e.$on("submit",r[3]),{c(){x(e.$$.fragment),n=B(),t=M("a"),s=A(r[0]),this.h()},l(h){le(e.$$.fragment,h),n=P(h),t=I(h,"A",{href:!0,target:!0,rel:!0});var u=S(t);s=q(u,r[0]),u.forEach(m),this.h()},h(){f(t,"href",r[0]),f(t,"target","_blank"),f(t,"rel","noreferrer")},m(h,u){ee(e,h,u),g(h,n,u),g(h,t,u),v(t,s),i=!0,c||(o=ue(t,"click",dl(r[4])),c=!0)},p(h,[u]){const p={};u&32&&(p.$$scope={dirty:u,ctx:h}),!l&&u&2&&(l=!0,p.showModal=h[1],et(()=>l=!1)),e.$set(p),(!i||u&1)&&se(s,h[0]),(!i||u&1)&&f(t,"href",h[0])},i(h){i||(b(e.$$.fragment,h),i=!0)},o(h){w(e.$$.fragment,h),i=!1},d(h){h&&(m(n),m(t)),te(e,h),c=!1,o()}}}function $n(r,e,l){let{href:n}=e,t=!1;function s(o){t=o,l(1,t)}const i=()=>window.open(n),c=()=>l(1,t=!0);return r.$$set=o=>{"href"in o&&l(0,n=o.href)},[n,t,s,i,c]}class ot extends ke{constructor(e){super(),ve(this,e,$n,yn,be,{href:0})}}function En(r){let e,l,n,t;const s=[Tn,Nn],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),l=i[e]=s[e](r),{c(){l.c(),n=F()},l(o){l.l(o),n=F()},m(o,a){i[e].m(o,a),g(o,n,a),t=!0},p(o,a){let _=e;e=c(o),e===_?i[e].p(o,a):(Y(),w(i[_],1,1,()=>{i[_]=null}),Z(),l=i[e],l?l.p(o,a):(l=i[e]=s[e](o),l.c()),b(l,1),l.m(n.parentNode,n))},i(o){t||(b(l),t=!0)},o(o){w(l),t=!1},d(o){o&&m(n),i[e].d(o)}}}function Mn(r){let e,l,n=r[0].filename+"",t,s,i,c;return i=new ot({props:{href:r[1]}}),{c(){e=M("span"),l=A("[File "),t=A(n),s=A(`]
			`),x(i.$$.fragment),this.h()},l(o){e=I(o,"SPAN",{class:!0});var a=S(e);l=q(a,"[File "),t=q(a,n),s=q(a,`]
			`),le(i.$$.fragment,a),a.forEach(m),this.h()},h(){f(e,"class","text-gray-500")},m(o,a){g(o,e,a),v(e,l),v(e,t),v(e,s),ee(i,e,null),c=!0},p(o,a){(!c||a&1)&&n!==(n=o[0].filename+"")&&se(t,n);const _={};a&2&&(_.href=o[1]),i.$set(_)},i(o){c||(b(i.$$.fragment,o),c=!0)},o(o){w(i.$$.fragment,o),c=!1},d(o){o&&m(e),te(i)}}}function In(r){let e,l,n;return{c(){e=M("audio"),l=M("source"),this.h()},l(t){e=I(t,"AUDIO",{});var s=S(e);l=I(s,"SOURCE",{src:!0}),s.forEach(m),this.h()},h(){ne(l.src,n=r[1])||f(l,"src",n),e.controls=!0},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&2&&!ne(l.src,n=t[1])&&f(l,"src",n)},i:d,o:d,d(t){t&&m(e)}}}function Cn(r){let e,l,n;return{c(){e=M("video"),l=M("source"),this.h()},l(t){e=I(t,"VIDEO",{class:!0});var s=S(e);l=I(s,"SOURCE",{src:!0}),s.forEach(m),this.h()},h(){ne(l.src,n=r[1])||f(l,"src",n),e.controls=!0,f(e,"class","svelte-m38imf")},m(t,s){g(t,e,s),v(e,l)},p(t,s){s&2&&!ne(l.src,n=t[1])&&f(l,"src",n)},i:d,o:d,d(t){t&&m(e)}}}function Un(r){let e,l,n,t;const s=[On,Pn],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),l=i[e]=s[e](r),{c(){l.c(),n=F()},l(o){l.l(o),n=F()},m(o,a){i[e].m(o,a),g(o,n,a),t=!0},p(o,a){let _=e;e=c(o),e===_?i[e].p(o,a):(Y(),w(i[_],1,1,()=>{i[_]=null}),Z(),l=i[e],l?l.p(o,a):(l=i[e]=s[e](o),l.c()),b(l,1),l.m(n.parentNode,n))},i(o){t||(b(l),t=!0)},o(o){w(l),t=!1},d(o){o&&m(n),i[e].d(o)}}}function Nn(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!0,pending:Bn,then:Sn,catch:jn,value:4,error:6};return he(l=fetch(r[1]),n),{c(){e=F(),n.block.c()},l(t){e=F(),n.block.l(t)},m(t,s){g(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&2&&l!==(l=fetch(r[1]))&&he(l,n)||Ue(n,r,s)},i:d,o:d,d(t){t&&m(e),n.block.d(t),n.token=null,n=null}}}function Tn(r){let e,l,n,t,s;return n=new ot({props:{href:r[1]}}),{c(){e=M("span"),l=A("[Text "),x(n.$$.fragment),t=A("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var c=S(e);l=q(c,"[Text "),le(n.$$.fragment,c),t=q(c,"]"),c.forEach(m),this.h()},h(){f(e,"class","text-gray-500")},m(i,c){g(i,e,c),v(e,l),ee(n,e,null),v(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),n.$set(o)},i(i){s||(b(n.$$.fragment,i),s=!0)},o(i){w(n.$$.fragment,i),s=!1},d(i){i&&m(e),te(n)}}}function jn(r){let e,l,n=r[0].filename+"",t,s,i=r[6]+"",c;return{c(){e=M("p"),l=A("Unable to download "),t=A(n),s=A(": "),c=A(i)},l(o){e=I(o,"P",{});var a=S(e);l=q(a,"Unable to download "),t=q(a,n),s=q(a,": "),c=q(a,i),a.forEach(m)},m(o,a){g(o,e,a),v(e,l),v(e,t),v(e,s),v(e,c)},p(o,a){a&1&&n!==(n=o[0].filename+"")&&se(t,n),a&2&&i!==(i=o[6]+"")&&se(c,i)},d(o){o&&m(e)}}}function Sn(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:Dn,then:qn,catch:An,value:5};return he(l=r[4].text(),n),{c(){e=F(),n.block.c()},l(t){e=F(),n.block.l(t)},m(t,s){g(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&2&&l!==(l=r[4].text())&&he(l,n)||Ue(n,r,s)},d(t){t&&m(e),n.block.d(t),n.token=null,n=null}}}function An(r){return{c:d,l:d,m:d,p:d,d}}function qn(r){let e,l=r[5]+"",n;return{c(){e=M("p"),n=A(l)},l(t){e=I(t,"P",{});var s=S(e);n=q(s,l),s.forEach(m)},m(t,s){g(t,e,s),v(e,n)},p(t,s){s&2&&l!==(l=t[5]+"")&&se(n,l)},d(t){t&&m(e)}}}function Dn(r){return{c:d,l:d,m:d,p:d,d}}function Bn(r){return{c:d,l:d,m:d,p:d,d}}function Pn(r){let e,l,n;return{c(){e=M("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ne(e.src,l=r[1])||f(e,"src",l),f(e,"alt",n=r[0].filename),f(e,"class","max-w-xl max-h-xl svelte-m38imf")},m(t,s){g(t,e,s)},p(t,s){s&2&&!ne(e.src,l=t[1])&&f(e,"src",l),s&1&&n!==(n=t[0].filename)&&f(e,"alt",n)},i:d,o:d,d(t){t&&m(e)}}}function On(r){let e,l,n,t,s;return n=new ot({props:{href:r[1]}}),{c(){e=M("span"),l=A("[Image "),x(n.$$.fragment),t=A("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var c=S(e);l=q(c,"[Image "),le(n.$$.fragment,c),t=q(c,"]"),c.forEach(m),this.h()},h(){f(e,"class","text-gray-500")},m(i,c){g(i,e,c),v(e,l),ee(n,e,null),v(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),n.$set(o)},i(i){s||(b(n.$$.fragment,i),s=!0)},o(i){w(n.$$.fragment,i),s=!1},d(i){i&&m(e),te(n)}}}function Vn(r){let e,l,n,t;const s=[Un,Cn,In,Mn,En],i=[];function c(o,a){return o[0].metadata.type=="Image"?0:o[0].metadata.type=="Video"?1:o[0].metadata.type=="Audio"?2:o[0].metadata.type=="File"?3:o[0].metadata.type=="Text"?4:-1}return~(l=c(r))&&(n=i[l]=s[l](r)),{c(){e=M("div"),n&&n.c()},l(o){e=I(o,"DIV",{});var a=S(e);n&&n.l(a),a.forEach(m)},m(o,a){g(o,e,a),~l&&i[l].m(e,null),t=!0},p(o,[a]){let _=l;l=c(o),l===_?~l&&i[l].p(o,a):(n&&(Y(),w(i[_],1,1,()=>{i[_]=null}),Z()),~l?(n=i[l],n?n.p(o,a):(n=i[l]=s[l](o),n.c()),b(n,1),n.m(e,null)):n=null)},i(o){t||(b(n),t=!0)},o(o){w(n),t=!1},d(o){o&&m(e),~l&&i[l].d()}}}function Fn(r,e,l){let n,t;const s=Q(He);oe(r,s,c=>l(2,t=c));let{attachment:i}=e;return r.$$set=c=>{"attachment"in c&&l(0,i=c.attachment)},r.$$.update=()=>{r.$$.dirty&1&&l(1,n=pl(i))},[i,n,t,s]}class Ln extends ke{constructor(e){super(),ve(this,e,Fn,Vn,be,{attachment:0})}}function Rn(r){let e,l="oop website embed, can't handle that :(";return{c(){e=M("span"),e.textContent=l,this.h()},l(n){e=I(n,"SPAN",{style:!0,"data-svelte-h":!0}),Ve(e)!=="svelte-rjpnkw"&&(e.textContent=l),this.h()},h(){je(e,"color","var(--secondary-foreground)")},m(n,t){g(n,e,t)},p:d,d(n){n&&m(e)}}}function Gn(r){let e,l,n,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&bt(r),s=r[0].title&&kt(r),i=r[0].description&&vt(r);return{c(){e=M("div"),t&&t.c(),l=B(),s&&s.c(),n=B(),i&&i.c(),this.h()},l(c){e=I(c,"DIV",{class:!0,style:!0});var o=S(e);t&&t.l(o),l=P(o),s&&s.l(o),n=P(o),i&&i.l(o),o.forEach(m),this.h()},h(){f(e,"class","text-embed svelte-qbtmm9"),je(e,"border-left","solid "+r[0].colour)},m(c,o){g(c,e,o),t&&t.m(e,null),v(e,l),s&&s.m(e,null),v(e,n),i&&i.m(e,null)},p(c,o){c[0].icon_url&&!c[1]["jolt:low-data-mode"]?t?t.p(c,o):(t=bt(c),t.c(),t.m(e,l)):t&&(t.d(1),t=null),c[0].title?s?s.p(c,o):(s=kt(c),s.c(),s.m(e,n)):s&&(s.d(1),s=null),c[0].description?i?i.p(c,o):(i=vt(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null),o&1&&je(e,"border-left","solid "+c[0].colour)},d(c){c&&m(e),t&&t.d(),s&&s.d(),i&&i.d()}}}function Hn(r){let e,l,n,t,s;return{c(){e=M("video"),l=M("source"),this.h()},l(i){e=I(i,"VIDEO",{class:!0});var c=S(e);l=I(c,"SOURCE",{src:!0,width:!0,height:!0}),c.forEach(m),this.h()},h(){ne(l.src,n=r[0].url)||f(l,"src",n),f(l,"width",t=r[0].width),f(l,"height",s=r[0].height),e.controls=!0,f(e,"class","svelte-qbtmm9")},m(i,c){g(i,e,c),v(e,l)},p(i,c){c&1&&!ne(l.src,n=i[0].url)&&f(l,"src",n),c&1&&t!==(t=i[0].width)&&f(l,"width",t),c&1&&s!==(s=i[0].height)&&f(l,"height",s)},d(i){i&&m(e)}}}function Kn(r){let e,l,n,t;return{c(){e=M("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,width:!0,height:!0,class:!0}),this.h()},h(){ne(e.src,l=r[0].url)||f(e,"src",l),f(e,"width",n=r[0].width),f(e,"height",t=r[0].height),f(e,"class","svelte-qbtmm9")},m(s,i){g(s,e,i)},p(s,i){i&1&&!ne(e.src,l=s[0].url)&&f(e,"src",l),i&1&&n!==(n=s[0].width)&&f(e,"width",n),i&1&&t!==(t=s[0].height)&&f(e,"height",t)},d(s){s&&m(e)}}}function bt(r){let e,l,n;return{c(){e=M("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){ne(e.src,l=r[0].icon_url)||f(e,"src",l),f(e,"alt",n=r[0].title),f(e,"width","24"),f(e,"height","24"),f(e,"class","svelte-qbtmm9")},m(t,s){g(t,e,s)},p(t,s){s&1&&!ne(e.src,l=t[0].icon_url)&&f(e,"src",l),s&1&&n!==(n=t[0].title)&&f(e,"alt",n)},d(t){t&&m(e)}}}function kt(r){let e,l=r[0].title+"",n;return{c(){e=M("h1"),n=A(l)},l(t){e=I(t,"H1",{});var s=S(e);n=q(s,l),s.forEach(m)},m(t,s){g(t,e,s),v(e,n)},p(t,s){s&1&&l!==(l=t[0].title+"")&&se(n,l)},d(t){t&&m(e)}}}function vt(r){let e,l=r[0].description+"",n;return{c(){e=M("p"),n=A(l)},l(t){e=I(t,"P",{});var s=S(e);n=q(s,l),s.forEach(m)},m(t,s){g(t,e,s),v(e,n)},p(t,s){s&1&&l!==(l=t[0].description+"")&&se(n,l)},d(t){t&&m(e)}}}function zn(r){let e;function l(s,i){if(s[0].type=="Image"&&!s[1]["jolt:low-data-mode"])return Kn;if(s[0].type=="Video"&&!s[1]["jolt:low-data-mode"])return Hn;if(s[0].type=="Text")return Gn;if(s[0].type=="Website")return Rn}let n=l(r),t=n&&n(r);return{c(){t&&t.c(),e=F()},l(s){t&&t.l(s),e=F()},m(s,i){t&&t.m(s,i),g(s,e,i)},p(s,[i]){n===(n=l(s))&&t?t.p(s,i):(t&&t.d(1),t=n&&n(s),t&&(t.c(),t.m(e.parentNode,e)))},i:d,o:d,d(s){s&&m(e),t&&t.d(s)}}}function Wn(r,e,l){let n,{embed:t}=e;const s=Q(He);return oe(r,s,i=>l(1,n=i)),r.$$set=i=>{"embed"in i&&l(0,t=i.embed)},[t,n,s]}class Xn extends ke{constructor(e){super(),ve(this,e,Wn,zn,be,{embed:0})}}function Jn(r){let e,l,n;return{c(){e=M("textarea"),this.h()},l(t){e=I(t,"TEXTAREA",{maxlength:!0,placeholder:!0,class:!0}),S(e).forEach(m),this.h()},h(){f(e,"maxlength","2000"),f(e,"placeholder",r[1]),f(e,"class","svelte-kqfcqt")},m(t,s){g(t,e,s),Te(e,r[0]),l||(n=[ue(e,"blur",r[3]),ue(e,"input",r[4]),ue(e,"keydown",Qn),ue(e,"input",r[6])],l=!0)},p(t,[s]){s&2&&f(e,"placeholder",t[1]),s&1&&Te(e,t[0])},i:d,o:d,d(t){t&&m(e),l=!1,Fe(n)}}}const Qn=r=>{var e;r.shiftKey||r.key!="Enter"||(r.preventDefault(),(e=r.currentTarget.form)==null||e.requestSubmit())};function Yn(r,e,l){let n;const t=Q(Oe),s=Q(st);oe(r,s,u=>l(7,n=u));let{placeholder:i=void 0}=e,{value:c=""}=e,{sendTypingEvents:o}=e;function a(){!o||n==null||t.websocket.send({type:"EndTyping",channel:n._id})}function _(){if(!(!o||n==null)){if(c==""){a();return}t.websocket.send({type:"BeginTyping",channel:n._id})}}function h(){c=this.value,l(0,c)}return r.$$set=u=>{"placeholder"in u&&l(1,i=u.placeholder),"value"in u&&l(0,c=u.value),"sendTypingEvents"in u&&l(5,o=u.sendTypingEvents)},[c,i,s,a,_,o,h]}class nl extends ke{constructor(e){super(),ve(this,e,Yn,Jn,be,{placeholder:1,value:0,sendTypingEvents:5})}}function wt(r,e,l){const n=r.slice();return n[27]=e[l],n}function yt(r,e,l){const n=r.slice();return n[30]=e[l],n}function Ze(r){const e=r.slice(),l=new Date(e[0].edited);return e[6]=l,e}function Zn(r){const e=r.slice(),l=Ce(e[1],e[2],e[0]);return e[33]=l,e}function $t(r,e,l){const n=r.slice();return n[34]=e[l],n}function Et(r,e,l){const n=r.slice();return n[37]=e[l].name,n[38]=e[l].onclick,n[39]=e[l].src,n[40]=e[l].showIf,n}function Mt(r){let e,l,n=ge(r[12]),t=[];for(let i=0;i<n.length;i+=1)t[i]=Ct(Et(r,n,i));const s=i=>w(t[i],1,1,()=>{t[i]=null});return{c(){e=M("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var c=S(e);for(let o=0;o<t.length;o+=1)t[o].l(c);c.forEach(m),this.h()},h(){f(e,"class","message-controls svelte-ewxr9l")},m(i,c){g(i,e,c);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null);l=!0},p(i,c){if(c[0]&4097){n=ge(i[12]);let o;for(o=0;o<n.length;o+=1){const a=Et(i,n,o);t[o]?(t[o].p(a,c),b(t[o],1)):(t[o]=Ct(a),t[o].c(),b(t[o],1),t[o].m(e,null))}for(Y(),o=n.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!l){for(let c=0;c<n.length;c+=1)b(t[c]);l=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)w(t[c]);l=!1},d(i){i&&m(e),Se(t,i)}}}function It(r){let e,l,n,t,s,i,c;const o=[er,xn],a=[];function _(u,p){return typeof u[39]=="string"?0:1}l=_(r),n=a[l]=o[l](r);function h(){return r[18](r[38])}return{c(){e=M("button"),n.c(),t=B(),this.h()},l(u){e=I(u,"BUTTON",{class:!0});var p=S(e);n.l(p),t=P(p),p.forEach(m),this.h()},h(){f(e,"class","svelte-ewxr9l")},m(u,p){g(u,e,p),a[l].m(e,null),v(e,t),s=!0,i||(c=[ue(e,"click",h),Zt(ll.call(null,e,{placement:"top",content:r[37],theme:"top-tooltip",animation:"shift-away",duration:100}))],i=!0)},p(u,p){r=u,n.p(r,p)},i(u){s||(b(n),s=!0)},o(u){w(n),s=!1},d(u){u&&m(e),a[l].d(),i=!1,Fe(c)}}}function xn(r){let e,l,n;var t=r[39];function s(i){return{props:{width:"18px",height:"18px"}}}return t&&(e=ut(t,s())),{c(){e&&x(e.$$.fragment),l=F()},l(i){e&&le(e.$$.fragment,i),l=F()},m(i,c){e&&ee(e,i,c),g(i,l,c),n=!0},p(i,c){if(t!==(t=i[39])){if(e){Y();const o=e;w(o.$$.fragment,1,0,()=>{te(o,1)}),Z()}t?(e=ut(t,s()),x(e.$$.fragment),b(e.$$.fragment,1),ee(e,l.parentNode,l)):e=null}},i(i){n||(e&&b(e.$$.fragment,i),n=!0)},o(i){e&&w(e.$$.fragment,i),n=!1},d(i){i&&m(l),e&&te(e,i)}}}function er(r){let e,l;return{c(){e=M("img"),this.h()},l(n){e=I(n,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){ne(e.src,l=r[39])||f(e,"src",l),f(e,"alt",r[37]),f(e,"width","18px"),f(e,"height","18px")},m(n,t){g(n,e,t)},p:d,i:d,o:d,d(n){n&&m(e)}}}function Ct(r){var s;let e=((s=r[40])==null?void 0:s.call(r,r[0]))??!0,l,n,t=e&&It(r);return{c(){t&&t.c(),l=F()},l(i){t&&t.l(i),l=F()},m(i,c){t&&t.m(i,c),g(i,l,c),n=!0},p(i,c){var o;c[0]&1&&(e=((o=i[40])==null?void 0:o.call(i,i[0]))??!0),e?t?(t.p(i,c),c[0]&1&&b(t,1)):(t=It(i),t.c(),b(t,1),t.m(l.parentNode,l)):t&&(Y(),w(t,1,1,()=>{t=null}),Z())},i(i){n||(b(t),n=!0)},o(i){w(t),n=!1},d(i){i&&m(l),t&&t.d(i)}}}function Ut(r){let e,l,n=ge(r[0].replies),t=[];for(let i=0;i<n.length;i+=1)t[i]=Nt($t(r,n,i));const s=i=>w(t[i],1,1,()=>{t[i]=null});return{c(){e=M("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var c=S(e);for(let o=0;o<t.length;o+=1)t[o].l(c);c.forEach(m),this.h()},h(){f(e,"class","replies svelte-ewxr9l")},m(i,c){g(i,e,c);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null);l=!0},p(i,c){if(c[0]&1){n=ge(i[0].replies);let o;for(o=0;o<n.length;o+=1){const a=$t(i,n,o);t[o]?(t[o].p(a,c),b(t[o],1)):(t[o]=Nt(a),t[o].c(),b(t[o],1),t[o].m(e,null))}for(Y(),o=n.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!l){for(let c=0;c<n.length;c+=1)b(t[c]);l=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)w(t[c]);l=!1},d(i){i&&m(e),Se(t,i)}}}function Nt(r){let e,l;return e=new Dl({props:{id:r[34]}}),{c(){x(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,t){ee(e,n,t),l=!0},p(n,t){const s={};t[0]&1&&(s.id=n[34]),e.$set(s)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){w(e.$$.fragment,n),l=!1},d(n){te(e,n)}}}function Tt(r){let e,l,n,t,s,i,c,o=Re(r[6]).calendar()+"",a,_,h;const u=[lr,tr],p=[];function N(y,D){return y[5]["jolt:low-data-mode"]||y[1]==null?0:1}function T(y,D){return D===1?Zn(y):y}l=N(r),n=p[l]=u[l](T(r,l));let C="edited"in r[0]&&r[0].edited!=null&&jt(Ze(r));return{c(){e=M("div"),n.c(),t=B(),s=A(r[4]),i=B(),c=M("p"),a=A(o),_=B(),C&&C.c(),this.h()},l(y){e=I(y,"DIV",{class:!0});var D=S(e);n.l(D),t=P(D),s=q(D,r[4]),i=P(D),c=I(D,"P",{class:!0});var k=S(c);a=q(k,o),_=P(k),C&&C.l(k),k.forEach(m),D.forEach(m),this.h()},h(){f(c,"class","timestamp svelte-ewxr9l"),f(e,"class","user-detail svelte-ewxr9l")},m(y,D){g(y,e,D),p[l].m(e,null),v(e,t),v(e,s),v(e,i),v(e,c),v(c,a),v(c,_),C&&C.m(c,null),h=!0},p(y,D){let k=l;l=N(y),l===k?p[l].p(T(y,l),D):(Y(),w(p[k],1,1,()=>{p[k]=null}),Z(),n=p[l],n?n.p(T(y,l),D):(n=p[l]=u[l](T(y,l)),n.c()),b(n,1),n.m(e,t)),(!h||D[0]&16)&&se(s,y[4]),(!h||D[0]&64)&&o!==(o=Re(y[6]).calendar()+"")&&se(a,o),"edited"in y[0]&&y[0].edited!=null?C?C.p(Ze(y),D):(C=jt(Ze(y)),C.c(),C.m(c,null)):C&&(C.d(1),C=null)},i(y){h||(b(n),h=!0)},o(y){w(n),h=!1},d(y){y&&m(e),p[l].d(),C&&C.d()}}}function tr(r){let e,l,n,t;const s=[rr,nr],i=[];function c(o,a){return o[33]==null?0:1}return e=c(r),l=i[e]=s[e](r),{c(){l.c(),n=F()},l(o){l.l(o),n=F()},m(o,a){i[e].m(o,a),g(o,n,a),t=!0},p(o,a){let _=e;e=c(o),e===_?i[e].p(o,a):(Y(),w(i[_],1,1,()=>{i[_]=null}),Z(),l=i[e],l?l.p(o,a):(l=i[e]=s[e](o),l.c()),b(l,1),l.m(n.parentNode,n))},i(o){t||(b(l),t=!0)},o(o){w(l),t=!1},d(o){o&&m(n),i[e].d(o)}}}function lr(r){let e,l;return e=new Ke({}),{c(){x(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,t){ee(e,n,t),l=!0},p:d,i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){w(e.$$.fragment,n),l=!1},d(n){te(e,n)}}}function nr(r){let e,l;return{c(){e=M("img"),this.h()},l(n){e=I(n,"IMG",{class:!0,alt:!0,src:!0,width:!0,height:!0}),this.h()},h(){f(e,"class","cover"),f(e,"alt",r[4]),ne(e.src,l=r[33])||f(e,"src",l),f(e,"width","40px"),f(e,"height","40px")},m(n,t){g(n,e,t)},p(n,t){t[0]&16&&f(e,"alt",n[4]),t[0]&7&&!ne(e.src,l=n[33])&&f(e,"src",l)},i:d,o:d,d(n){n&&m(e)}}}function rr(r){let e,l;return e=new Ke({}),{c(){x(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,t){ee(e,n,t),l=!0},p:d,i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){w(e.$$.fragment,n),l=!1},d(n){te(e,n)}}}function jt(r){let e,l="(edited)",n,t,s;return{c(){e=M("span"),e.textContent=l,this.h()},l(i){e=I(i,"SPAN",{class:!0,"data-svelte-h":!0}),Ve(e)!=="svelte-dy5ue0"&&(e.textContent=l),this.h()},h(){f(e,"class","timestamp svelte-ewxr9l")},m(i,c){g(i,e,c),t||(s=Zt(n=ll.call(null,e,{placement:"top",content:Re(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away",duration:100})),t=!0)},p(i,c){r=i,n&&hl(n.update)&&c[0]&1&&n.update.call(null,{placement:"top",content:Re(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away",duration:100})},d(i){i&&m(e),t=!1,s()}}}function ir(r){let e,l=r[0].content+"",n;return{c(){e=M("span"),n=A(l),this.h()},l(t){e=I(t,"SPAN",{class:!0});var s=S(e);n=q(s,l),s.forEach(m),this.h()},h(){f(e,"class","message-content svelte-ewxr9l"),at(e,"message-not-sent","promise"in r[0])},m(t,s){g(t,e,s),v(e,n)},p(t,s){s[0]&1&&l!==(l=t[0].content+"")&&se(n,l),s[0]&1&&at(e,"message-not-sent","promise"in t[0])},i:d,o:d,d(t){t&&m(e)}}}function sr(r){let e,l,n,t,s,i;function c(a){r[19](a)}let o={placeholder:"Edit this message",sendTypingEvents:!1};return r[3]!==void 0&&(o.value=r[3]),l=new nl({props:o}),Ge.push(()=>tt(l,"value",c)),l.$on("keydown",r[20]),{c(){e=M("form"),x(l.$$.fragment),this.h()},l(a){e=I(a,"FORM",{id:!0,class:!0});var _=S(e);le(l.$$.fragment,_),_.forEach(m),this.h()},h(){f(e,"id","message-edit-form"),f(e,"class","message-form svelte-ewxr9l")},m(a,_){g(a,e,_),ee(l,e,null),t=!0,s||(i=ue(e,"submit",r[13]),s=!0)},p(a,_){const h={};!n&&_[0]&8&&(n=!0,h.value=a[3],et(()=>n=!1)),l.$set(h)},i(a){t||(b(l.$$.fragment,a),t=!0)},o(a){w(l.$$.fragment,a),t=!1},d(a){a&&m(e),te(l),s=!1,i()}}}function St(r){let e,l;return e=new gn({props:{system:r[0].system}}),{c(){x(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,t){ee(e,n,t),l=!0},p(n,t){const s={};t[0]&1&&(s.system=n[0].system),e.$set(s)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){w(e.$$.fragment,n),l=!1},d(n){te(e,n)}}}function At(r){let e,l,n=ge(r[0].attachments),t=[];for(let i=0;i<n.length;i+=1)t[i]=qt(yt(r,n,i));const s=i=>w(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=F()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=F()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),l=!0},p(i,c){if(c[0]&1){n=ge(i[0].attachments);let o;for(o=0;o<n.length;o+=1){const a=yt(i,n,o);t[o]?(t[o].p(a,c),b(t[o],1)):(t[o]=qt(a),t[o].c(),b(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=n.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!l){for(let c=0;c<n.length;c+=1)b(t[c]);l=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)w(t[c]);l=!1},d(i){i&&m(e),Se(t,i)}}}function qt(r){let e,l;return e=new Ln({props:{attachment:r[30]}}),{c(){x(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,t){ee(e,n,t),l=!0},p(n,t){const s={};t[0]&1&&(s.attachment=n[30]),e.$set(s)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){w(e.$$.fragment,n),l=!1},d(n){te(e,n)}}}function Dt(r){let e,l,n=ge(r[0].embeds),t=[];for(let i=0;i<n.length;i+=1)t[i]=Bt(wt(r,n,i));const s=i=>w(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=F()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=F()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);g(i,e,c),l=!0},p(i,c){if(c[0]&1){n=ge(i[0].embeds);let o;for(o=0;o<n.length;o+=1){const a=wt(i,n,o);t[o]?(t[o].p(a,c),b(t[o],1)):(t[o]=Bt(a),t[o].c(),b(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=n.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!l){for(let c=0;c<n.length;c+=1)b(t[c]);l=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)w(t[c]);l=!1},d(i){i&&m(e),Se(t,i)}}}function Bt(r){let e,l;return e=new Xn({props:{embed:r[27]}}),{c(){x(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,t){ee(e,n,t),l=!0},p(n,t){const s={};t[0]&1&&(s.embed=n[27]),e.$set(s)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){w(e.$$.fragment,n),l=!1},d(n){te(e,n)}}}function or(r){let e,l,n,t=r[14](r[0])&&!("system"in r[0]),s,i,c,o,a,_,h,u,p=!("promise"in r[0])&&Mt(r),N=r[0].replies!=null&&r[0].replies.length!=0&&Ut(r),T=t&&Tt(r);const C=[sr,ir],y=[];function D(E,U){return E[3]!=null?0:E[0].content!=null?1:-1}~(i=D(r))&&(c=y[i]=C[i](r));let k="system"in r[0]&&r[0].system!=null&&St(r),O="attachments"in r[0]&&r[0].attachments!=null&&At(r),R="embeds"in r[0]&&r[0].embeds!=null&&Dt(r);return{c(){e=M("div"),p&&p.c(),l=B(),N&&N.c(),n=B(),T&&T.c(),s=B(),c&&c.c(),o=B(),k&&k.c(),a=B(),O&&O.c(),_=B(),R&&R.c(),this.h()},l(E){e=I(E,"DIV",{id:!0,class:!0});var U=S(e);p&&p.l(U),l=P(U),N&&N.l(U),n=P(U),T&&T.l(U),s=P(U),c&&c.l(U),o=P(U),k&&k.l(U),a=P(U),O&&O.l(U),_=P(U),R&&R.l(U),U.forEach(m),this.h()},h(){f(e,"id",h="MESSAGE-"+r[0]._id),f(e,"class","message-container svelte-ewxr9l")},m(E,U){g(E,e,U),p&&p.m(e,null),v(e,l),N&&N.m(e,null),v(e,n),T&&T.m(e,null),v(e,s),~i&&y[i].m(e,null),v(e,o),k&&k.m(e,null),v(e,a),O&&O.m(e,null),v(e,_),R&&R.m(e,null),u=!0},p(E,U){"promise"in E[0]?p&&(Y(),w(p,1,1,()=>{p=null}),Z()):p?(p.p(E,U),U[0]&1&&b(p,1)):(p=Mt(E),p.c(),b(p,1),p.m(e,l)),E[0].replies!=null&&E[0].replies.length!=0?N?(N.p(E,U),U[0]&1&&b(N,1)):(N=Ut(E),N.c(),b(N,1),N.m(e,n)):N&&(Y(),w(N,1,1,()=>{N=null}),Z()),U[0]&1&&(t=E[14](E[0])&&!("system"in E[0])),t?T?(T.p(E,U),U[0]&1&&b(T,1)):(T=Tt(E),T.c(),b(T,1),T.m(e,s)):T&&(Y(),w(T,1,1,()=>{T=null}),Z());let J=i;i=D(E),i===J?~i&&y[i].p(E,U):(c&&(Y(),w(y[J],1,1,()=>{y[J]=null}),Z()),~i?(c=y[i],c?c.p(E,U):(c=y[i]=C[i](E),c.c()),b(c,1),c.m(e,o)):c=null),"system"in E[0]&&E[0].system!=null?k?(k.p(E,U),U[0]&1&&b(k,1)):(k=St(E),k.c(),b(k,1),k.m(e,a)):k&&(Y(),w(k,1,1,()=>{k=null}),Z()),"attachments"in E[0]&&E[0].attachments!=null?O?(O.p(E,U),U[0]&1&&b(O,1)):(O=At(E),O.c(),b(O,1),O.m(e,_)):O&&(Y(),w(O,1,1,()=>{O=null}),Z()),"embeds"in E[0]&&E[0].embeds!=null?R?(R.p(E,U),U[0]&1&&b(R,1)):(R=Dt(E),R.c(),b(R,1),R.m(e,null)):R&&(Y(),w(R,1,1,()=>{R=null}),Z()),(!u||U[0]&1&&h!==(h="MESSAGE-"+E[0]._id))&&f(e,"id",h)},i(E){u||(b(p),b(N),b(T),b(c),b(k),b(O),b(R),u=!0)},o(E){w(p),w(N),w(T),w(c),w(k),w(O),w(R),u=!1},d(E){E&&m(e),p&&p.d(),N&&N.d(),T&&T.d(),~i&&y[i].d(),k&&k.d(),O&&O.d(),R&&R.d()}}}function cr(r,e,l){let n,t,s,i,c,o,a;Re.extend(yl);let{message:_}=e,{messageIndex:h}=e,u,p,N;const T=Q(He);oe(r,T,j=>l(5,a=j));const C=Q(Oe),y=Q(tl);oe(r,y,j=>l(16,s=j));const D=Q(lt),k=Q(xt),O=Q(nt);oe(r,O,j=>l(17,i=j));const R=Q(rt);oe(r,R,j=>l(21,c=j));const E=Q(it);oe(r,E,j=>l(22,o=j));const U=[{src:Ll,name:"Reply",onclick(j){((o==null?void 0:o.length)??0)>=5||o!=null&&o.some(G=>G.message._id==j._id)||E==null||E.update(G=>(G.push({message:j,mention:!0}),G))}},{src:vl,name:"Edit",showIf:j=>{var G;return j.author==((G=C.user)==null?void 0:G._id)},onclick:j=>l(3,u=u==null?j.content??"":void 0)},{src:Ol,name:"Delete",showIf:j=>{var G;return j.author==((G=C.user)==null?void 0:G._id)},onclick:j=>C.deleteMessage(j.channel,j._id)}];async function J(j,G){l(2,N=c==null?void 0:c.find(H=>H._id.server==j&&H._id.user==G))}async function L(){const j=await C.editMessage(_.channel,_._id,{content:u});D==null||D.update(G=>(G[G.findIndex(H=>H._id==_._id)]=j,G)),l(3,u=void 0)}function ce(j){var re,we,X,Ae,qe,De,ae;if(D==null)return!0;const H=Je(D)[h-1];return H==null?!0:j.author!=H.author||("masquerade"in j?((re=j.masquerade)==null?void 0:re.name)!=((we=H.masquerade)==null?void 0:we.name)||((X=j.masquerade)==null?void 0:X.avatar)!=((Ae=H.masquerade)==null?void 0:Ae.avatar)||((qe=j.masquerade)==null?void 0:qe.colour)!=((De=H.masquerade)==null?void 0:De.colour):!1)||Qe(j._id)-Qe(H._id)>=7*60*1e3||(((ae=j.replies)==null?void 0:ae.length)??0)!=0}const fe=j=>j(_);function me(j){u=j,l(3,u)}const $e=j=>{j.detail.key=="Escape"&&l(3,u=void 0)};return r.$$set=j=>{"message"in j&&l(0,_=j.message),"messageIndex"in j&&l(15,h=j.messageIndex)},r.$$.update=()=>{if(r.$$.dirty[0]&1&&"promise"in _){const j=document.querySelector(".messages-list");j!=null&&j.scrollTo(0,j.scrollHeight),_.promise.then(()=>{k==null||k.update(G=>G.filter(H=>H._id!=_._id))})}r.$$.dirty[0]&131073&&xe(i??C.cache.users,_.author,j=>C.fetchUser(j)).then(j=>l(1,p=j)),r.$$.dirty[0]&65537&&s!=null&&J(s==null?void 0:s._id,_.author),r.$$.dirty[0]&7&&l(4,n=p==null?"Unknown User":ye(p,N,"masquerade"in _?_:void 0)),r.$$.dirty[0]&1&&l(6,t=Qe(_._id))},[_,p,N,u,n,a,t,T,y,O,R,E,U,L,ce,h,s,i,fe,me,$e]}class rl extends ke{constructor(e){super(),ve(this,e,cr,or,be,{message:0,messageIndex:15},null,[-1,-1])}}function ar(r){let e,l;return{c(){e=Ee("svg"),l=Ee("path"),this.h()},l(n){e=Me(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=S(e);l=Me(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),t.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","1.5"),f(e,"stroke","currentColor"),f(e,"width","24px"),f(e,"height","24px")},m(n,t){g(n,e,t),v(e,l)},p:d,i:d,o:d,d(n){n&&m(e)}}}class il extends ke{constructor(e){super(),ve(this,e,null,ar,be,{})}}function ur(r){let e,l;return{c(){e=Ee("svg"),l=Ee("path"),this.h()},l(n){e=Me(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=S(e);l=Me(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(l).forEach(m),t.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"d","M15.182 15.182a4.5 4.5 0 01-6.364 0M21 12a9 9 0 11-18 0 9 9 0 0118 0zM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75zm-.375 0h.008v.015h-.008V9.75zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75zm-.375 0h.008v.015h-.008V9.75z"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","1.5"),f(e,"stroke","currentColor"),f(e,"width","24px"),f(e,"height","24px")},m(n,t){g(n,e,t),v(e,l)},p:d,i:d,o:d,d(n){n&&m(e)}}}class fr extends ke{constructor(e){super(),ve(this,e,null,ur,be,{})}}function hr(r){let e,l;return{c(){e=Ee("svg"),l=Ee("path"),this.h()},l(n){e=Me(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=S(e);l=Me(t,"path",{"stroke-linecap":!0,d:!0}),S(l).forEach(m),t.forEach(m),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"d","M16.5 12a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","1.5"),f(e,"stroke","currentColor"),f(e,"width",r[0]),f(e,"height",r[1])},m(n,t){g(n,e,t),v(e,l)},p(n,[t]){t&1&&f(e,"width",n[0]),t&2&&f(e,"height",n[1])},i:d,o:d,d(n){n&&m(e)}}}function _r(r,e,l){let{width:n="24px"}=e,{height:t="24px"}=e;return r.$$set=s=>{"width"in s&&l(0,n=s.width),"height"in s&&l(1,t=s.height)},[n,t]}class mr extends ke{constructor(e){super(),ve(this,e,_r,hr,be,{width:0,height:1})}}function Pt(r){const e=ye(r[5]);r[6]=e}function dr(r){let e,l,n;return e=new Ke({}),{c(){x(e.$$.fragment),l=A(`
		<UnknownUser>`)},l(t){le(e.$$.fragment,t),l=q(t,`
		<UnknownUser>`)},m(t,s){ee(e,t,s),g(t,l,s),n=!0},p:d,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){t&&m(l),te(e,t)}}}function pr(r){Pt(r);let e,l,n,t,s=r[6]+"",i;return{c(){e=M("img"),t=B(),i=A(s),this.h()},l(c){e=I(c,"IMG",{class:!0,src:!0,alt:!0}),t=P(c),i=q(c,s),this.h()},h(){f(e,"class","cover svelte-1aoabln"),ne(e.src,l=Ce(r[5]))||f(e,"src",l),f(e,"alt",n=r[6])},m(c,o){g(c,e,o),g(c,t,o),g(c,i,o)},p(c,o){Pt(c),o&1&&!ne(e.src,l=Ce(c[5]))&&f(e,"src",l),o&1&&n!==(n=c[6])&&f(e,"alt",n),o&1&&s!==(s=c[6]+"")&&se(i,s)},i:d,o:d,d(c){c&&(m(e),m(t),m(i))}}}function gr(r){return{c:d,l:d,m:d,p:d,i:d,o:d,d}}function Ot(r){let e,l=r[0].message.content+"",n;return{c(){e=M("p"),n=A(l),this.h()},l(t){e=I(t,"P",{class:!0});var s=S(e);n=q(s,l),s.forEach(m),this.h()},h(){f(e,"class","message-content svelte-1aoabln")},m(t,s){g(t,e,s),v(e,n)},p(t,s){s&1&&l!==(l=t[0].message.content+"")&&se(n,l)},d(t){t&&m(e)}}}function br(r){let e,l,n,t,s,i,c,o,a,_,h,u,p=r[0].mention?"ON":"OFF",N,T,C,y,D,k,O,R,E={ctx:r,current:null,token:null,hasCatch:!0,pending:gr,then:pr,catch:dr,value:5,blocks:[,,,]};he(n=r[2].fetchUser(r[0].message.author),E);let U=r[0].message.content&&Ot(r);return h=new mr({props:{width:"15",height:"15"}}),D=new il({}),{c(){e=M("div"),l=A(`Replying to
	`),E.block.c(),t=B(),U&&U.c(),s=B(),i=M("div"),c=B(),o=M("label"),a=M("input"),_=B(),x(h.$$.fragment),u=B(),N=A(p),C=B(),y=M("button"),x(D.$$.fragment),this.h()},l(J){e=I(J,"DIV",{class:!0});var L=S(e);l=q(L,`Replying to
	`),E.block.l(L),t=P(L),U&&U.l(L),s=P(L),i=I(L,"DIV",{class:!0}),S(i).forEach(m),c=P(L),o=I(L,"LABEL",{class:!0,"aria-label":!0});var ce=S(o);a=I(ce,"INPUT",{id:!0,style:!0,type:!0}),_=P(ce),le(h.$$.fragment,ce),u=P(ce),N=q(ce,p),ce.forEach(m),C=P(L),y=I(L,"BUTTON",{class:!0});var fe=S(y);le(D.$$.fragment,fe),fe.forEach(m),L.forEach(m),this.h()},h(){f(i,"class","flex-divider"),f(a,"id","mention"),je(a,"display","none"),f(a,"type","checkbox"),f(o,"class","reply-button svelte-1aoabln"),f(o,"aria-label",T="Mention author "+(r[0].mention?"ON":"OFF")),f(y,"class","reply-button default-button svelte-1aoabln"),f(e,"class","container svelte-1aoabln")},m(J,L){g(J,e,L),v(e,l),E.block.m(e,E.anchor=null),E.mount=()=>e,E.anchor=t,v(e,t),U&&U.m(e,null),v(e,s),v(e,i),v(e,c),v(e,o),v(o,a),a.checked=r[0].mention,v(o,_),ee(h,o,null),v(o,u),v(o,N),v(e,C),v(e,y),ee(D,y,null),k=!0,O||(R=[ue(a,"change",r[3]),ue(y,"click",r[4])],O=!0)},p(J,[L]){r=J,E.ctx=r,L&1&&n!==(n=r[2].fetchUser(r[0].message.author))&&he(n,E)||Ue(E,r,L),r[0].message.content?U?U.p(r,L):(U=Ot(r),U.c(),U.m(e,s)):U&&(U.d(1),U=null),L&1&&(a.checked=r[0].mention),(!k||L&1)&&p!==(p=r[0].mention?"ON":"OFF")&&se(N,p),(!k||L&1&&T!==(T="Mention author "+(r[0].mention?"ON":"OFF")))&&f(o,"aria-label",T)},i(J){k||(b(E.block),b(h.$$.fragment,J),b(D.$$.fragment,J),k=!0)},o(J){for(let L=0;L<3;L+=1){const ce=E.blocks[L];w(ce)}w(h.$$.fragment,J),w(D.$$.fragment,J),k=!1},d(J){J&&m(e),E.block.d(),E.token=null,E=null,U&&U.d(),te(h),te(D),O=!1,Fe(R)}}}function kr(r,e,l){let{reply:n}=e;const t=Q(Oe),s=Q(it);function i(){n.mention=this.checked,l(0,n)}const c=()=>s.update(o=>(o=o.filter(a=>a.message._id!=n.message._id),o));return r.$$set=o=>{"reply"in o&&l(0,n=o.reply)},[n,s,t,i,c]}class vr extends ke{constructor(e){super(),ve(this,e,kr,br,be,{reply:0})}}function Vt(r,e,l){const n=r.slice();return n[8]=e[l],n}function Ft(r){let e,l,n,t,s,i,c;function o(){return r[4](r[8])}return{c(){e=M("button"),l=M("img"),s=B(),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var _=S(e);l=I(_,"IMG",{width:!0,height:!0,src:!0,alt:!0}),s=P(_),_.forEach(m),this.h()},h(){f(l,"width","28px"),f(l,"height","28px"),ne(l.src,n="https://autumn.revolt.chat/emojis/"+r[8]._id)||f(l,"src",n),f(l,"alt",t=r[8].name),f(e,"class","svelte-uptso2")},m(a,_){g(a,e,_),v(e,l),v(e,s),i||(c=ue(e,"click",o),i=!0)},p(a,_){r=a,_&2&&!ne(l.src,n="https://autumn.revolt.chat/emojis/"+r[8]._id)&&f(l,"src",n),_&2&&t!==(t=r[8].name)&&f(l,"alt",t)},d(a){a&&m(e),i=!1,c()}}}function wr(r){let e,l,n,t,s,i,c=ge(r[1]),o=[];for(let a=0;a<c.length;a+=1)o[a]=Ft(Vt(r,c,a));return{c(){e=M("div"),l=M("input"),n=B(),t=M("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=I(a,"DIV",{class:!0});var _=S(e);l=I(_,"INPUT",{type:!0,placeholder:!0,class:!0}),n=P(_),t=I(_,"DIV",{});var h=S(t);for(let u=0;u<o.length;u+=1)o[u].l(h);h.forEach(m),_.forEach(m),this.h()},h(){f(l,"type","text"),f(l,"placeholder","Search for emojis"),f(l,"class","svelte-uptso2"),f(e,"class","emoji-container svelte-uptso2")},m(a,_){g(a,e,_),v(e,l),Te(l,r[0]),v(e,n),v(e,t);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(t,null);s||(i=ue(l,"input",r[3]),s=!0)},p(a,[_]){if(_&1&&l.value!==a[0]&&Te(l,a[0]),_&6){c=ge(a[1]);let h;for(h=0;h<c.length;h+=1){const u=Vt(a,c,h);o[h]?o[h].p(u,_):(o[h]=Ft(u),o[h].c(),o[h].m(t,null))}for(;h<o.length;h+=1)o[h].d(1);o.length=c.length}},i:d,o:d,d(a){a&&m(e),Se(o,a),s=!1,i()}}}function Lt(r){const e={};for(const l of r){const n=l.toUpperCase();if(n in e){e[n]++;continue}e[n]=1}return e}function yr(r,e,l){let n;const t=Q(Oe),s=Q(el);let i="",c=Array.from(t.cache.emojis.values());function o(h){if(i.length==0)return h.length;const u=Lt(h);let p=0;for(const[N,T]of Object.entries(u)){const C=n[N];if(C!=null){if(C>T){p=0;continue}p+=Math.min(C,T)}}return p/h.length}function a(){i=this.value,l(0,i)}const _=h=>s.update(u=>u+`:${h._id}:`);return r.$$.update=()=>{r.$$.dirty&1&&(n=Lt(i)),r.$$.dirty&1&&(i.length==0?l(1,c=Array.from(t.cache.emojis.values())):l(1,c=Array.from(t.cache.emojis.values()).flatMap(h=>{const u=o(h.name);return u==0?[]:[[u,h]]}).sort(([h],[u])=>h-u).map(([,h])=>h).reverse()))},[i,c,s,a,_]}class $r extends ke{constructor(e){super(),ve(this,e,yr,wr,be,{})}}function Rt(r,e,l){const n=r.slice();return n[45]=e[l],n}function Gt(r,e,l){const n=r.slice();return n[48]=e[l],n[50]=l,n}function Ht(r,e,l){const n=r.slice();return n[48]=e[l],n[50]=l,n}function Er(r){return{c:d,l:d,m:d,p:d,i:d,o:d,d}}function Mr(r){let e,l,n,t=ge(r[9]),s=[];for(let _=0;_<t.length;_+=1)s[_]=Kt(Ht(r,t,_));const i=_=>w(s[_],1,1,()=>{s[_]=null});let c=ge(r[10]),o=[];for(let _=0;_<c.length;_+=1)o[_]=zt(Gt(r,c,_));const a=_=>w(o[_],1,1,()=>{o[_]=null});return{c(){for(let _=0;_<s.length;_+=1)s[_].c();e=B();for(let _=0;_<o.length;_+=1)o[_].c();l=F()},l(_){for(let h=0;h<s.length;h+=1)s[h].l(_);e=P(_);for(let h=0;h<o.length;h+=1)o[h].l(_);l=F()},m(_,h){for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(_,h);g(_,e,h);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(_,h);g(_,l,h),n=!0},p(_,h){if(h[0]&512){t=ge(_[9]);let u;for(u=0;u<t.length;u+=1){const p=Ht(_,t,u);s[u]?(s[u].p(p,h),b(s[u],1)):(s[u]=Kt(p),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(Y(),u=t.length;u<s.length;u+=1)i(u);Z()}if(h[0]&1024){c=ge(_[10]);let u;for(u=0;u<c.length;u+=1){const p=Gt(_,c,u);o[u]?(o[u].p(p,h),b(o[u],1)):(o[u]=zt(p),o[u].c(),b(o[u],1),o[u].m(l.parentNode,l))}for(Y(),u=c.length;u<o.length;u+=1)a(u);Z()}},i(_){if(!n){for(let h=0;h<t.length;h+=1)b(s[h]);for(let h=0;h<c.length;h+=1)b(o[h]);n=!0}},o(_){s=s.filter(Boolean);for(let h=0;h<s.length;h+=1)w(s[h]);o=o.filter(Boolean);for(let h=0;h<o.length;h+=1)w(o[h]);n=!1},d(_){_&&(m(e),m(l)),Se(s,_),Se(o,_)}}}function Kt(r){let e,l;return e=new rl({props:{message:r[48],messageIndex:r[50]}}),{c(){x(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,t){ee(e,n,t),l=!0},p(n,t){const s={};t[0]&512&&(s.message=n[48]),e.$set(s)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){w(e.$$.fragment,n),l=!1},d(n){te(e,n)}}}function zt(r){let e,l;return e=new rl({props:{message:r[48],messageIndex:r[50]}}),{c(){x(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,t){ee(e,n,t),l=!0},p(n,t){const s={};t[0]&1024&&(s.message=n[48]),e.$set(s)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){w(e.$$.fragment,n),l=!1},d(n){te(e,n)}}}function Ir(r){let e;return{c(){e=A("Loading...")},l(l){e=q(l,"Loading...")},m(l,n){g(l,e,n)},p:d,i:d,o:d,d(l){l&&m(e)}}}function Wt(r){let e,l,n,t=Array.from(r[0]).map(Yt).join(", ")+"",s,i,c,o,a,_,h,u,p;return _=new il({}),{c(){e=M("div"),l=M("p"),n=A(`Uploading
				`),s=A(t),i=B(),c=M("div"),o=B(),a=M("button"),x(_.$$.fragment),this.h()},l(N){e=I(N,"DIV",{class:!0});var T=S(e);l=I(T,"P",{});var C=S(l);n=q(C,`Uploading
				`),s=q(C,t),C.forEach(m),i=P(T),c=I(T,"DIV",{class:!0}),S(c).forEach(m),o=P(T),a=I(T,"BUTTON",{});var y=S(a);le(_.$$.fragment,y),y.forEach(m),T.forEach(m),this.h()},h(){f(c,"class","flex-divider"),f(e,"class","flex-container")},m(N,T){g(N,e,T),v(e,l),v(l,n),v(l,s),v(e,i),v(e,c),v(e,o),v(e,a),ee(_,a,null),h=!0,u||(p=ue(a,"click",r[29]),u=!0)},p(N,T){(!h||T[0]&1)&&t!==(t=Array.from(N[0]).map(Yt).join(", ")+"")&&se(s,t)},i(N){h||(b(_.$$.fragment,N),h=!0)},o(N){w(_.$$.fragment,N),h=!1},d(N){N&&m(e),te(_),u=!1,p()}}}function Xt(r){let e,l,n;return l=new $r({}),{c(){e=M("div"),x(l.$$.fragment),this.h()},l(t){e=I(t,"DIV",{class:!0});var s=S(e);le(l.$$.fragment,s),s.forEach(m),this.h()},h(){f(e,"class","emoji-menu svelte-19gsrll")},m(t,s){g(t,e,s),ee(l,e,null),n=!0},i(t){n||(b(l.$$.fragment,t),n=!0)},o(t){w(l.$$.fragment,t),n=!1},d(t){t&&m(e),te(l)}}}function Jt(r){let e,l;return e=new vr({props:{reply:r[45]}}),{c(){x(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,t){ee(e,n,t),l=!0},p(n,t){const s={};t[0]&4096&&(s.reply=n[45]),e.$set(s)},i(n){l||(b(e.$$.fragment,n),l=!0)},o(n){w(e.$$.fragment,n),l=!1},d(n){te(e,n)}}}function Qt(r){let e,l,n,t,s;return{c(){e=M("input"),l=B(),n=M("input"),this.h()},l(i){e=I(i,"INPUT",{style:!0,placeholder:!0}),l=P(i),n=I(i,"INPUT",{style:!0,placeholder:!0}),this.h()},h(){je(e,"border-radius","0"),je(e,"margin-right","2px"),f(e,"placeholder","Masquerade Name"),je(n,"border-radius","0"),f(n,"placeholder","Masquerade Avatar")},m(i,c){g(i,e,c),Te(e,r[4]),g(i,l,c),g(i,n,c),Te(n,r[5]),t||(s=[ue(e,"input",r[31]),ue(n,"input",r[32])],t=!0)},p(i,c){c[0]&16&&e.value!==i[4]&&Te(e,i[4]),c[0]&32&&n.value!==i[5]&&Te(n,i[5])},d(i){i&&(m(e),m(l),m(n)),t=!1,Fe(s)}}}function Cr(r){let e,l,n,t,s,i,c,o,a,_,h,u,p,N,T,C,y,D,k,O,R,E,U,J,L,ce=r[23](r[7])+"",fe,me,$e,j,G={ctx:r,current:null,token:null,hasCatch:!1,pending:Ir,then:Mr,catch:Er,blocks:[,,,]};he(n=r[2],G);let H=r[0]!=null&&r[0].length!=0&&Wt(r),re=r[11]&&Xt(),we=ge(r[12]),X=[];for(let z=0;z<we.length;z+=1)X[z]=Jt(Rt(r,we,z));const Ae=z=>w(X[z],1,1,()=>{X[z]=null});h=new wl({});function qe(z){r[30](z)}let De={sendTypingEvents:r[3]["jolt:send-typing-indicators"],placeholder:"Send message in "+r[8]};r[13]!==void 0&&(De.value=r[13]),p=new nl({props:De}),Ge.push(()=>tt(p,"value",qe));let ae=r[6]&&Qt(r);return O=new El({}),U=new fr({}),{c(){e=M("main"),l=M("div"),G.block.c(),t=B(),H&&H.c(),s=B(),re&&re.c(),i=B(),c=M("div");for(let z=0;z<X.length;z+=1)X[z].c();o=B(),a=M("form"),_=M("button"),x(h.$$.fragment),u=B(),x(p.$$.fragment),T=B(),C=M("div"),y=B(),ae&&ae.c(),D=B(),k=M("button"),x(O.$$.fragment),R=B(),E=M("button"),x(U.$$.fragment),J=B(),L=M("span"),fe=A(ce),this.h()},l(z){e=I(z,"MAIN",{class:!0});var K=S(e);l=I(K,"DIV",{class:!0});var de=S(l);G.block.l(de),de.forEach(m),t=P(K),H&&H.l(K),s=P(K),re&&re.l(K),i=P(K),c=I(K,"DIV",{class:!0});var ie=S(c);for(let V=0;V<X.length;V+=1)X[V].l(ie);o=P(ie),a=I(ie,"FORM",{class:!0,id:!0});var _e=S(a);_=I(_e,"BUTTON",{class:!0});var ze=S(_);le(h.$$.fragment,ze),ze.forEach(m),u=P(_e),le(p.$$.fragment,_e),T=P(_e),C=I(_e,"DIV",{class:!0}),S(C).forEach(m),y=P(_e),ae&&ae.l(_e),D=P(_e),k=I(_e,"BUTTON",{class:!0});var We=S(k);le(O.$$.fragment,We),We.forEach(m),R=P(_e),E=I(_e,"BUTTON",{style:!0,type:!0,class:!0});var Xe=S(E);le(U.$$.fragment,Xe),Xe.forEach(m),_e.forEach(m),J=P(ie),L=I(ie,"SPAN",{class:!0});var $=S(L);fe=q($,ce),$.forEach(m),ie.forEach(m),K.forEach(m),this.h()},h(){f(l,"class","messages-list svelte-19gsrll"),f(_,"class","default-button"),f(C,"class","flex-divider"),f(k,"class","default-button"),je(E,"margin-left","0"),f(E,"type","button"),f(E,"class","default-button"),f(a,"class","message-form"),f(a,"id","send-message-form"),f(L,"class","typing-indicator svelte-19gsrll"),f(c,"class","message-form-box"),f(e,"class","main-content-container svelte-19gsrll")},m(z,K){g(z,e,K),v(e,l),G.block.m(l,G.anchor=null),G.mount=()=>l,G.anchor=null,r[28](l),v(e,t),H&&H.m(e,null),v(e,s),re&&re.m(e,null),v(e,i),v(e,c);for(let de=0;de<X.length;de+=1)X[de]&&X[de].m(c,null);v(c,o),v(c,a),v(a,_),ee(h,_,null),v(a,u),ee(p,a,null),v(a,T),v(a,C),v(a,y),ae&&ae.m(a,null),v(a,D),v(a,k),ee(O,k,null),v(a,R),v(a,E),ee(U,E,null),v(c,J),v(c,L),v(L,fe),me=!0,$e||(j=[ue(_,"click",r[22]),ue(k,"click",r[33]),ue(E,"click",r[34]),ue(a,"submit",r[21])],$e=!0)},p(z,K){if(r=z,G.ctx=r,K[0]&4&&n!==(n=r[2])&&he(n,G)||Ue(G,r,K),r[0]!=null&&r[0].length!=0?H?(H.p(r,K),K[0]&1&&b(H,1)):(H=Wt(r),H.c(),b(H,1),H.m(e,s)):H&&(Y(),w(H,1,1,()=>{H=null}),Z()),r[11]?re?K[0]&2048&&b(re,1):(re=Xt(),re.c(),b(re,1),re.m(e,i)):re&&(Y(),w(re,1,1,()=>{re=null}),Z()),K[0]&4096){we=ge(r[12]);let ie;for(ie=0;ie<we.length;ie+=1){const _e=Rt(r,we,ie);X[ie]?(X[ie].p(_e,K),b(X[ie],1)):(X[ie]=Jt(_e),X[ie].c(),b(X[ie],1),X[ie].m(c,o))}for(Y(),ie=we.length;ie<X.length;ie+=1)Ae(ie);Z()}const de={};K[0]&8&&(de.sendTypingEvents=r[3]["jolt:send-typing-indicators"]),K[0]&256&&(de.placeholder="Send message in "+r[8]),!N&&K[0]&8192&&(N=!0,de.value=r[13],et(()=>N=!1)),p.$set(de),r[6]?ae?ae.p(r,K):(ae=Qt(r),ae.c(),ae.m(a,D)):ae&&(ae.d(1),ae=null),(!me||K[0]&128)&&ce!==(ce=r[23](r[7])+"")&&se(fe,ce)},i(z){if(!me){b(G.block),b(H),b(re);for(let K=0;K<we.length;K+=1)b(X[K]);b(h.$$.fragment,z),b(p.$$.fragment,z),b(O.$$.fragment,z),b(U.$$.fragment,z),me=!0}},o(z){for(let K=0;K<3;K+=1){const de=G.blocks[K];w(de)}w(H),w(re),X=X.filter(Boolean);for(let K=0;K<X.length;K+=1)w(X[K]);w(h.$$.fragment,z),w(p.$$.fragment,z),w(O.$$.fragment,z),w(U.$$.fragment,z),me=!1},d(z){z&&m(e),G.block.d(),G.token=null,G=null,r[28](null),H&&H.d(),re&&re.d(),Se(X,z),te(h),te(p),ae&&ae.d(),te(O),te(U),$e=!1,Fe(j)}}}const Yt=r=>r.name;function Ur(r,e,l){let n,t,s,i,c,o,a,_;oe(r,$l,$=>l(26,n=$));let{replies:h=[]}=e,{messageInput:u=""}=e,p,N,T=!1;const C=Pe(u);oe(r,C,$=>l(13,_=$)),Be(el,C);let{files:y=[]}=e;const D=Q(He);oe(r,D,$=>l(3,s=$));const k=Q(Oe),O=Q(st);oe(r,O,$=>l(27,t=$));const R=Pe(new Array);oe(r,R,$=>l(9,i=$));const E=Pe(new Array),U=Pe(new Array),J=Pe(!1);oe(r,J,$=>l(11,o=$));const L=Pe(h);oe(r,L,$=>l(12,a=$));const ce=Pe(new Array);oe(r,ce,$=>l(10,c=$)),Be(lt,R),Be(rt,E),Be(nt,U),Be(it,L),Be(gl,J),Be(xt,ce);let fe,me=new Array,$e="Unknown Channel",j=Promise.resolve();async function G({id:$,user:V}){var W;if(!(V==((W=k.user)==null?void 0:W._id)||$!=(t==null?void 0:t._id))){for(const{_id:pe}of me)if(V==pe)return;l(7,me[me.length]=await k.fetchUser(V),me)}}function H({id:$,user:V}){$==(t==null?void 0:t._id)&&l(7,me=me.filter(W=>W._id!=V))}async function re(){const $=Je(C).trim();C.set(""),ce.update(V=>{if(t==null)return V;const W=t;return V.push({_id:kl(),content:$,replies:Je(L).map(({message:{_id:pe}})=>pe),channel:t==null?void 0:t._id,author:k.user._id,promise:new Promise((pe,Ie)=>{Promise.all(y.map(Ne=>k.autumn.uploadFile(Ne))).then(Ne=>{l(0,y=[]),k.sendMessage(W._id,{content:$,replies:Je(L).map(({message:{_id:Le},mention:sl})=>({id:Le,mention:sl})),masquerade:p==""&&N==""?void 0:{name:p==""?void 0:p,avatar:N==""?void 0:N},attachments:Ne}).then(Le=>{L.set([]),pe(Le)}).catch(Ie)}).catch(Ie)})}),V})}function we($){if($.channel!=(t==null?void 0:t._id))return;const V=fe.offsetHeight+fe.scrollTop>fe.scrollHeight-20;document.hasFocus()&&V&&k.ackMessage(t._id,$._id),R.update(W=>(W.push($),W)),V&&ct().then(()=>fe.scrollTo(0,fe.scrollHeight))}function X({id:$,channel:V}){V==(t==null?void 0:t._id)&&R.update(W=>W.filter(pe=>pe._id!=$))}function Ae({id:$,channel:V,data:W}){V==(t==null?void 0:t._id)&&R.update(pe=>{const Ie=pe.findIndex(Le=>Le._id==$),Ne=pe[Ie];return W.content!=null&&(Ne.content=W.content),W.embeds!=null&&(Ne.embeds=W.embeds),Ne.edited=W.edited,pe[Ie]=Ne,pe})}function qe($){var V;if(((V=$.clipboardData)==null?void 0:V.files)!=null&&$.clipboardData.files.length!=0){$.preventDefault();const W=Array.from($.clipboardData.files);l(0,y=(y==null?void 0:y.concat(W))??W)}}function De(){const $=document.createElement("input");$.type="file",$.onchange=V=>{const W=V;W.target.files!=null&&l(0,y=y.concat(Array.from(W.target.files)))},$.click()}_l(()=>{k.on("Message",we),k.on("MessageDelete",X),k.on("MessageUpdate",Ae),document.addEventListener("paste",qe)}),ml(()=>{k.removeListener("Message",we),k.removeListener("MessageDelete",X),k.removeListener("MessageUpdate",Ae),document.removeEventListener("paste",qe)});async function ae($){var V;if($==null){l(8,$e="<Unknown Channel>");return}if($.channel_type!="SavedMessages"&&$.channel_type!="DirectMessage"){l(8,$e=`#${$.name}`);return}if($.channel_type=="SavedMessages"){l(8,$e="Saved Notes");return}try{l(8,$e=`@${ye(await k.fetchUser($.recipients[0]==((V=k.user)==null?void 0:V._id)?$.recipients[1]:$.recipients[0]))}`)}catch{l(8,$e="Unknown Channel")}}function z($){if($.length==0)return"";const V=$.map(W=>ye(W));return V.length==1?`${V[0]} is typing...`:V.length>=5?"Several users are typing...":`${V.slice(0,V.length-1).join(", ")} and ${V[V.length-1]} are typing...`}function K($){Ge[$?"unshift":"push"](()=>{fe=$,l(1,fe)})}const de=()=>l(0,y=[]);function ie($){_=$,C.set(_)}function _e(){p=this.value,l(4,p)}function ze(){N=this.value,l(5,N)}const We=()=>l(6,T=!T),Xe=()=>J.update($=>!$);return r.$$set=$=>{"replies"in $&&l(24,h=$.replies),"messageInput"in $&&l(25,u=$.messageInput),"files"in $&&l(0,y=$.files)},r.$$.update=()=>{if(r.$$.dirty[0]&134217734)if(t==null)l(2,j=Promise.reject());else{const $=Q(bl);l(2,j=k.queryMessages(t._id,{sort:"Latest",include_users:!0,limit:100,nearby:$}).then(V=>{if(Array.isArray(V)){let W;$==null?W=V.reverse():W=V.sort((pe,Ie)=>pe._id.localeCompare(Ie._id)),R.set(W)}else{let W;$==null?W=V.messages.reverse():W=V.messages.sort((pe,Ie)=>pe._id.localeCompare(Ie._id)),R.set(W),U.set(V.users),E.set(V.members??[])}})),L.set([]),l(7,me=[]),j.then(()=>{ct().then(()=>fe.scrollTo(0,fe.scrollHeight))})}if(r.$$.dirty[0]&8&&(k.removeListener("ChannelStartTyping",G),k.removeListener("ChannelStopTyping",H),s["jolt:receive-typing-indicators"]&&(k.on("ChannelStartTyping",G),k.on("ChannelStopTyping",H))),r.$$.dirty[0]&134217728&&ae(t),r.$$.dirty[0]&67108864){const $=document.getElementById(`MESSAGE-${n.url.hash.slice(1)}`);$==null||$.animate([{backgroundColor:"var(--mention)"},{backgroundColor:"var(--mention)",offset:.6},{backgroundColor:"transparent"}],{duration:3e3,iterations:1})}},[y,fe,j,s,p,N,T,me,$e,i,c,o,a,_,C,D,O,R,J,L,ce,re,De,z,h,u,n,t,K,de,ie,_e,ze,We,Xe]}class zr extends ke{constructor(e){super(),ve(this,e,Ur,Cr,be,{replies:24,messageInput:25,files:0},null,[-1,-1])}}export{zr as T};
