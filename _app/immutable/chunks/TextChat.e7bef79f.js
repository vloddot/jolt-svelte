import{s as ue,f as M,g as I,h as D,d as _,j as u,i as b,r as se,e as L,u as m,a as G,c as R,l as V,m as P,z as v,n as Q,I as X,v as Ft,J as Ce,A as oe,w as Bt,x as Gt,y as Rt,D as Pe,M as Lt,p as Se,N as Kt,O as Re,k as Oe,P as Ve,Q as zt,G as $e,B as Ht,C as Wt,H as Xt,E as Te,F as Ne,R as We,S as we,o as Jt,K as Qt,t as Xe}from"./scheduler.7420d6ca.js";import{h as ie,u as ke}from"./await_block.08f6cb26.js";import{e as fe}from"./each.e59479a4.js";import{S as _e,i as he,a as k,g as Y,t as $,c as Z,b as x,d as ee,m as te,e as le,f as Le}from"./index.637134e4.js";import{g as J}from"./context.92045884.js";import{g as ge,b as ae,a as Yt}from"./util.883c3f21.js";import{c as Ee,s as je}from"./context.645f4abc.js";import{w as Ie}from"./index.5b89e149.js";import{m as Ke,u as ze,g as Ge,c as jt,a as Dt,r as At,b as Ot,s as Zt,n as xt}from"./index.45055ce9.js";import{e as Je}from"./singletons.8e1ad945.js";import{s as Vt}from"./context.c622ed87.js";import{s as el}from"./context.9abfb385.js";import{G as De}from"./GenericUserCircleIcon.cf1ebf73.js";import{d as Fe}from"./index.esm.4b6e8736.js";import{t as tl,P as ll}from"./PlusIcon.a9ccaab6.js";import{d as Ue,c as nl}from"./calendar.5942d46b.js";import{p as rl}from"./stores.a6d41ae9.js";function il(r){const e=r.slice(),l=ae(e[14]);return e[15]=l,e}function Qe(r){var s;let e,l,n,t={ctx:r,current:null,token:null,hasCatch:!1,pending:hl,then:ol,catch:sl,value:13,blocks:[,,,]};return ie(l=((s=r[3])==null?void 0:s.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]),t),{c(){e=L(),t.block.c()},l(i){e=L(),t.block.l(i)},m(i,c){b(i,e,c),t.block.m(i,t.anchor=c),t.mount=()=>e.parentNode,t.anchor=e,n=!0},p(i,c){var o;r=i,t.ctx=r,c&13&&l!==(l=((o=r[3])==null?void 0:o.find(r[12]))??r[6].api.fetchMessage(r[2],r[0]))&&ie(l,t)||ke(t,r,c)},i(i){n||(k(t.block),n=!0)},o(i){for(let c=0;c<3;c+=1){const o=t.blocks[c];$(o)}n=!1},d(i){i&&_(e),t.block.d(i),t.token=null,t=null}}}function sl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function ol(r){let e,l,n,t=!r[4]["jolt:low-data-mode"]&&Ye(r),s=r[13].content!=null&&Ze(r);return{c(){t&&t.c(),e=G(),s&&s.c(),l=L()},l(i){t&&t.l(i),e=R(i),s&&s.l(i),l=L()},m(i,c){t&&t.m(i,c),b(i,e,c),s&&s.m(i,c),b(i,l,c),n=!0},p(i,c){i[4]["jolt:low-data-mode"]?t&&(Y(),$(t,1,1,()=>{t=null}),Z()):t?(t.p(i,c),c&16&&k(t,1)):(t=Ye(i),t.c(),k(t,1),t.m(e.parentNode,e)),i[13].content!=null?s?s.p(i,c):(s=Ze(i),s.c(),s.m(l.parentNode,l)):s&&(s.d(1),s=null)},i(i){n||(k(t),n=!0)},o(i){$(t),n=!1},d(i){i&&(_(e),_(l)),t&&t.d(i),s&&s.d(i)}}}function Ye(r){let e,l,n,t={ctx:r,current:null,token:null,hasCatch:!1,pending:_l,then:al,catch:cl,value:14,blocks:[,,,]};return ie(l=Ge(r[6].api,r[5]??r[6].api.cache.users,r[13].author),t),{c(){e=L(),t.block.c()},l(s){e=L(),t.block.l(s)},m(s,i){b(s,e,i),t.block.m(s,t.anchor=i),t.mount=()=>e.parentNode,t.anchor=e,n=!0},p(s,i){r=s,t.ctx=r,i&45&&l!==(l=Ge(r[6].api,r[5]??r[6].api.cache.users,r[13].author))&&ie(l,t)||ke(t,r,i)},i(s){n||(k(t.block),n=!0)},o(s){for(let i=0;i<3;i+=1){const c=t.blocks[i];$(c)}n=!1},d(s){s&&_(e),t.block.d(s),t.token=null,t=null}}}function cl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function al(r){let e,l,n,t;const s=[ul,fl],i=[];function c(a,d){return a[14]!=null?0:1}function o(a,d){return d===0?il(a):a}return e=c(r),l=i[e]=s[e](o(r,e)),{c(){l.c(),n=L()},l(a){l.l(a),n=L()},m(a,d){i[e].m(a,d),b(a,n,d),t=!0},p(a,d){let f=e;e=c(a),e===f?i[e].p(o(a,e),d):(Y(),$(i[f],1,1,()=>{i[f]=null}),Z(),l=i[e],l?l.p(o(a,e),d):(l=i[e]=s[e](o(a,e)),l.c()),k(l,1),l.m(n.parentNode,n))},i(a){t||(k(l),t=!0)},o(a){$(l),t=!1},d(a){a&&_(n),i[e].d(a)}}}function fl(r){let e,l,n;return e=new De({}),{c(){x(e.$$.fragment),l=V(`

						Unknown User`)},l(t){ee(e.$$.fragment,t),l=P(t,`

						Unknown User`)},m(t,s){te(e,t,s),b(t,l,s),n=!0},p:m,i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){t&&_(l),le(e,t)}}}function ul(r){let e,l,n,t,s=r[15]+"",i;return{c(){e=M("img"),t=G(),i=V(s),this.h()},l(c){e=I(c,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),t=R(c),i=P(c,s),this.h()},h(){u(e,"class","cover"),X(e.src,l=ge(r[14]))||u(e,"src",l),u(e,"alt",n=r[15]),u(e,"width","24px"),u(e,"height","24px")},m(c,o){b(c,e,o),b(c,t,o),b(c,i,o)},p(c,o){o&45&&!X(e.src,l=ge(c[14]))&&u(e,"src",l),o&45&&n!==(n=c[15])&&u(e,"alt",n),o&45&&s!==(s=c[15]+"")&&Q(i,s)},i:m,o:m,d(c){c&&(_(e),_(t),_(i))}}}function _l(r){let e;return{c(){e=V("<Unknown User>")},l(l){e=P(l,"<Unknown User>")},m(l,n){b(l,e,n)},p:m,i:m,o:m,d(l){l&&_(e)}}}function Ze(r){let e,l=r[13].content+"",n;return{c(){e=M("span"),n=V(l),this.h()},l(t){e=I(t,"SPAN",{class:!0});var s=D(e);n=P(s,l),s.forEach(_),this.h()},h(){u(e,"class","message-content svelte-pdgjwp")},m(t,s){b(t,e,s),v(e,n)},p(t,s){s&13&&l!==(l=t[13].content+"")&&Q(n,l)},d(t){t&&_(e)}}}function hl(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function ml(r){let e,l,n,t=r[2]!=null&&Qe(r);return{c(){e=M("a"),t&&t.c(),this.h()},l(s){e=I(s,"A",{href:!0,class:!0});var i=D(e);t&&t.l(i),i.forEach(_),this.h()},h(){u(e,"href",l=Je+"/"+(r[1]==null?`channels/${r[2]}/${r[0]}`:`servers/${r[1]}/channels/${r[2]}/${r[0]}`)),u(e,"class","svelte-pdgjwp")},m(s,i){b(s,e,i),t&&t.m(e,null),n=!0},p(s,[i]){s[2]!=null?t?(t.p(s,i),i&4&&k(t,1)):(t=Qe(s),t.c(),k(t,1),t.m(e,null)):t&&(Y(),$(t,1,1,()=>{t=null}),Z()),(!n||i&7&&l!==(l=Je+"/"+(s[1]==null?`channels/${s[2]}/${s[0]}`:`servers/${s[1]}/channels/${s[2]}/${s[0]}`)))&&u(e,"href",l)},i(s){n||(k(t),n=!0)},o(s){$(t),n=!1},d(s){s&&_(e),t&&t.d()}}}function dl(r,e,l){let n,t,s,i,c;const o=J(Ee),a=J(je);se(r,a,w=>l(4,i=w));const d=J(Vt);se(r,d,w=>l(1,n=w));const f=J(el);se(r,f,w=>l(2,t=w));const h=J(Ke);se(r,h,w=>l(3,s=w));const g=J(ze);se(r,g,w=>l(5,c=w));let{id:B}=e;const C=({_id:w})=>B==w;return r.$$set=w=>{"id"in w&&l(0,B=w.id)},[B,n,t,s,i,c,o,a,d,f,h,g,C]}class pl extends _e{constructor(e){super(),he(this,e,dl,ml,ue,{id:0})}}function xe(r){const e=ae(r[3]);r[4]=e}function et(r){r[5]=r[7][0],r[6]=r[7][1]}function tt(r){const e=ae(r[3]);r[4]=e}function gl(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:Cl,then:wl,catch:yl,value:3};return ie(l=r[1].api.fetchUser(r[0].id),n),{c(){e=L(),n.block.c()},l(t){e=L(),n.block.l(t)},m(t,s){b(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&1&&l!==(l=r[1].api.fetchUser(r[0].id))&&ie(l,n)||ke(n,r,s)},d(t){t&&_(e),n.block.d(t),n.token=null,n=null}}}function bl(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:Ul,then:Nl,catch:Tl,value:7};return ie(l=Promise.all([r[0].from,r[0].to].map(r[2])),n),{c(){e=L(),n.block.c()},l(t){e=L(),n.block.l(t)},m(t,s){b(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&1&&l!==(l=Promise.all([r[0].from,r[0].to].map(r[2])))&&ie(l,n)||ke(n,r,s)},d(t){t&&_(e),n.block.d(t),n.token=null,n=null}}}function kl(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:Rl,then:jl,catch:Sl,value:3};return ie(l=r[1].api.fetchUser(r[0].by),n),{c(){e=L(),n.block.c()},l(t){e=L(),n.block.l(t)},m(t,s){b(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&1&&l!==(l=r[1].api.fetchUser(r[0].by))&&ie(l,n)||ke(n,r,s)},d(t){t&&_(e),n.block.d(t),n.token=null,n=null}}}function vl(r){let e=r[0].content+"",l;return{c(){l=V(e)},l(n){l=P(n,e)},m(n,t){b(n,l,t)},p(n,t){t&1&&e!==(e=n[0].content+"")&&Q(l,e)},d(n){n&&_(l)}}}function yl(r){return{c:m,l:m,m,p:m,d:m}}function wl(r){xe(r);let e,l,n,t,s=r[4]+"",i,c,o;function a(h,g){if(h[0].type=="user_banned")return Il;if(h[0].type=="user_joined")return Ml;if(h[0].type=="user_kicked")return El;if(h[0].type=="user_left")return $l}let d=a(r),f=d&&d(r);return{c(){e=M("img"),t=G(),i=V(s),c=G(),f&&f.c(),o=L(),this.h()},l(h){e=I(h,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=R(h),i=P(h,s),c=R(h),f&&f.l(h),o=L(),this.h()},h(){u(e,"class","cover"),X(e.src,l=ge(r[3]))||u(e,"src",l),u(e,"width","24px"),u(e,"height","24px"),u(e,"alt",n=r[4])},m(h,g){b(h,e,g),b(h,t,g),b(h,i,g),b(h,c,g),f&&f.m(h,g),b(h,o,g)},p(h,g){xe(h),g&1&&!X(e.src,l=ge(h[3]))&&u(e,"src",l),g&1&&n!==(n=h[4])&&u(e,"alt",n),g&1&&s!==(s=h[4]+"")&&Q(i,s),d!==(d=a(h))&&(f&&f.d(1),f=d&&d(h),f&&(f.c(),f.m(o.parentNode,o)))},d(h){h&&(_(e),_(t),_(i),_(c),_(o)),f&&f.d(h)}}}function $l(r){let e;return{c(){e=V("left the chat.")},l(l){e=P(l,"left the chat.")},m(l,n){b(l,e,n)},d(l){l&&_(e)}}}function El(r){let e;return{c(){e=V("was kicked.")},l(l){e=P(l,"was kicked.")},m(l,n){b(l,e,n)},d(l){l&&_(e)}}}function Ml(r){let e;return{c(){e=V("has joined the chat.")},l(l){e=P(l,"has joined the chat.")},m(l,n){b(l,e,n)},d(l){l&&_(e)}}}function Il(r){let e;return{c(){e=V("was banned.")},l(l){e=P(l,"was banned.")},m(l,n){b(l,e,n)},d(l){l&&_(e)}}}function Cl(r){return{c:m,l:m,m,p:m,d:m}}function Tl(r){return{c:m,l:m,m,p:m,d:m}}function Nl(r){et(r);let e,l=ae(r[5])+"",n,t,s=ae(r[6])+"",i,c;return{c(){e=V("Channel ownership changed from "),n=V(l),t=V(" to "),i=V(s),c=V(".")},l(o){e=P(o,"Channel ownership changed from "),n=P(o,l),t=P(o," to "),i=P(o,s),c=P(o,".")},m(o,a){b(o,e,a),b(o,n,a),b(o,t,a),b(o,i,a),b(o,c,a)},p(o,a){et(o),a&1&&l!==(l=ae(o[5])+"")&&Q(n,l),a&1&&s!==(s=ae(o[6])+"")&&Q(i,s)},d(o){o&&(_(e),_(n),_(t),_(i),_(c))}}}function Ul(r){return{c:m,l:m,m,p:m,d:m}}function Sl(r){return{c:m,l:m,m,p:m,d:m}}function jl(r){tt(r);let e,l,n,t,s=r[4]+"",i,c,o;function a(h,g){if(h[0].type=="channel_description_changed")return Vl;if(h[0].type=="channel_icon_changed")return Ol;if(h[0].type=="channel_renamed")return Al;if(h[0].type=="user_added"||h[0].type=="user_remove")return Dl}let d=a(r),f=d&&d(r);return{c(){e=M("img"),t=G(),i=V(s),c=G(),f&&f.c(),o=L(),this.h()},l(h){e=I(h,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),t=R(h),i=P(h,s),c=R(h),f&&f.l(h),o=L(),this.h()},h(){u(e,"class","cover"),X(e.src,l=ge(r[3]))||u(e,"src",l),u(e,"width","24px"),u(e,"height","24px"),u(e,"alt",n=r[4])},m(h,g){b(h,e,g),b(h,t,g),b(h,i,g),b(h,c,g),f&&f.m(h,g),b(h,o,g)},p(h,g){tt(h),g&1&&!X(e.src,l=ge(h[3]))&&u(e,"src",l),g&1&&n!==(n=h[4])&&u(e,"alt",n),g&1&&s!==(s=h[4]+"")&&Q(i,s),d===(d=a(h))&&f?f.p(h,g):(f&&f.d(1),f=d&&d(h),f&&(f.c(),f.m(o.parentNode,o)))},d(h){h&&(_(e),_(t),_(i),_(c),_(o)),f&&f.d(h)}}}function Dl(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:Gl,then:ql,catch:Pl,value:3};return ie(l=r[1].api.fetchUser(r[0].id),n),{c(){e=L(),n.block.c()},l(t){e=L(),n.block.l(t)},m(t,s){b(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&1&&l!==(l=r[1].api.fetchUser(r[0].id))&&ie(l,n)||ke(n,r,s)},d(t){t&&_(e),n.block.d(t),n.token=null,n=null}}}function Al(r){let e,l=r[0].name+"",n,t;return{c(){e=V("renamed this channel to "),n=V(l),t=V(".")},l(s){e=P(s,"renamed this channel to "),n=P(s,l),t=P(s,".")},m(s,i){b(s,e,i),b(s,n,i),b(s,t,i)},p(s,i){i&1&&l!==(l=s[0].name+"")&&Q(n,l)},d(s){s&&(_(e),_(n),_(t))}}}function Ol(r){let e;return{c(){e=V("changes this channel icon.")},l(l){e=P(l,"changes this channel icon.")},m(l,n){b(l,e,n)},p:m,d(l){l&&_(e)}}}function Vl(r){let e;return{c(){e=V("changed this channel's description.")},l(l){e=P(l,"changed this channel's description.")},m(l,n){b(l,e,n)},p:m,d(l){l&&_(e)}}}function Pl(r){return{c:m,l:m,m,p:m,d:m}}function ql(r){let e,l=ae(r[3])+"",n,t;function s(o,a){if(o[0].type=="user_added")return Bl;if(o[0].type=="user_remove")return Fl}let i=s(r),c=i&&i(r);return{c(){c&&c.c(),e=G(),n=V(l),t=V(".")},l(o){c&&c.l(o),e=R(o),n=P(o,l),t=P(o,".")},m(o,a){c&&c.m(o,a),b(o,e,a),b(o,n,a),b(o,t,a)},p(o,a){i!==(i=s(o))&&(c&&c.d(1),c=i&&i(o),c&&(c.c(),c.m(e.parentNode,e))),a&1&&l!==(l=ae(o[3])+"")&&Q(n,l)},d(o){o&&(_(e),_(n),_(t)),c&&c.d(o)}}}function Fl(r){let e;return{c(){e=V("removed")},l(l){e=P(l,"removed")},m(l,n){b(l,e,n)},d(l){l&&_(e)}}}function Bl(r){let e;return{c(){e=V("added")},l(l){e=P(l,"added")},m(l,n){b(l,e,n)},d(l){l&&_(e)}}}function Gl(r){return{c:m,l:m,m,p:m,d:m}}function Rl(r){return{c:m,l:m,m,p:m,d:m}}function Ll(r){let e;function l(s,i){if(s[0].type=="text")return vl;if(s[0].type=="channel_description_changed"||s[0].type=="channel_icon_changed"||s[0].type=="channel_renamed"||s[0].type=="user_added"||s[0].type=="user_remove")return kl;if(s[0].type=="channel_ownership_changed")return bl;if(s[0].type=="user_banned"||s[0].type=="user_joined"||s[0].type=="user_kicked"||s[0].type=="user_left")return gl}let n=l(r),t=n&&n(r);return{c(){e=M("span"),t&&t.c(),this.h()},l(s){e=I(s,"SPAN",{class:!0});var i=D(e);t&&t.l(i),i.forEach(_),this.h()},h(){u(e,"class","container svelte-qj8q6t")},m(s,i){b(s,e,i),t&&t.m(e,null)},p(s,[i]){n===(n=l(s))&&t?t.p(s,i):(t&&t.d(1),t=n&&n(s),t&&(t.c(),t.m(e,null)))},i:m,o:m,d(s){s&&_(e),t&&t.d()}}}function Kl(r,e,l){const n=J(Ee);let{system:t}=e;const s=i=>n.api.fetchUser(i);return r.$$set=i=>{"system"in i&&l(0,t=i.system)},[t,n,s]}class zl extends _e{constructor(e){super(),he(this,e,Kl,Ll,ue,{system:0})}}function Hl(r){let e,l,n,t,s,i,c,o="Ok",a,d,f="Cancel",h,g,B;const C=r[3].default,w=Ft(C,r,r[2],null);return{c(){e=M("dialog"),l=M("div"),w&&w.c(),n=G(),t=M("hr"),s=G(),i=M("form"),c=M("button"),c.textContent=o,a=G(),d=M("button"),d.textContent=f,this.h()},l(y){e=I(y,"DIALOG",{});var N=D(e);l=I(N,"DIV",{});var A=D(l);w&&w.l(A),n=R(A),t=I(A,"HR",{}),s=R(A),i=I(A,"FORM",{id:!0,method:!0});var T=D(i);c=I(T,"BUTTON",{type:!0,"data-svelte-h":!0}),Ce(c)!=="svelte-fdbbw9"&&(c.textContent=o),a=R(T),d=I(T,"BUTTON",{type:!0,"data-svelte-h":!0}),Ce(d)!=="svelte-1gqjcfl"&&(d.textContent=f),T.forEach(_),A.forEach(_),N.forEach(_),this.h()},h(){u(c,"type","submit"),u(d,"type","reset"),u(i,"id","modal-form"),u(i,"method","dialog")},m(y,N){b(y,e,N),v(e,l),w&&w.m(l,null),v(l,n),v(l,t),v(l,s),v(l,i),v(i,c),v(i,a),v(i,d),r[6](e),h=!0,g||(B=[oe(d,"click",r[5]),oe(i,"submit",r[4]),oe(e,"close",r[7])],g=!0)},p(y,[N]){w&&w.p&&(!h||N&4)&&Bt(w,C,y,y[2],h?Rt(C,y[2],N,null):Gt(y[2]),null)},i(y){h||(k(w,y),h=!0)},o(y){$(w,y),h=!1},d(y){y&&_(e),w&&w.d(y),r[6](null),g=!1,Pe(B)}}}function Wl(r,e,l){let{$$slots:n={},$$scope:t}=e,{showModal:s}=e,i;function c(f){Lt.call(this,r,f)}const o=()=>l(0,s=!1);function a(f){Se[f?"unshift":"push"](()=>{i=f,l(1,i)})}const d=()=>l(0,s=!1);return r.$$set=f=>{"showModal"in f&&l(0,s=f.showModal),"$$scope"in f&&l(2,t=f.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&(s?i==null||i.showModal():i==null||i.close())},[s,i,t,n,c,o,a,d]}class Xl extends _e{constructor(e){super(),he(this,e,Wl,Hl,ue,{showModal:0})}}function Jl(r){let e,l="External Link",n,t,s,i,c="Are you sure you want to go to this link? External links can be dangerous.";return{c(){e=M("h1"),e.textContent=l,n=G(),t=M("hr"),s=G(),i=M("p"),i.textContent=c,this.h()},l(o){e=I(o,"H1",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-qkxu7n"&&(e.textContent=l),n=R(o),t=I(o,"HR",{}),s=R(o),i=I(o,"P",{"data-svelte-h":!0}),Ce(i)!=="svelte-os1rtp"&&(i.textContent=c),this.h()},h(){u(e,"class","text-3xl")},m(o,a){b(o,e,a),b(o,n,a),b(o,t,a),b(o,s,a),b(o,i,a)},p:m,d(o){o&&(_(e),_(n),_(t),_(s),_(i))}}}function Ql(r){let e,l,n,t,s,i,c,o;function a(f){r[2](f)}let d={$$slots:{default:[Jl]},$$scope:{ctx:r}};return r[1]!==void 0&&(d.showModal=r[1]),e=new Xl({props:d}),Se.push(()=>Le(e,"showModal",a)),e.$on("submit",r[3]),{c(){x(e.$$.fragment),n=G(),t=M("a"),s=V(r[0]),this.h()},l(f){ee(e.$$.fragment,f),n=R(f),t=I(f,"A",{href:!0,target:!0,rel:!0});var h=D(t);s=P(h,r[0]),h.forEach(_),this.h()},h(){u(t,"href",r[0]),u(t,"target","_blank"),u(t,"rel","noreferrer")},m(f,h){te(e,f,h),b(f,n,h),b(f,t,h),v(t,s),i=!0,c||(o=oe(t,"click",Kt(r[4])),c=!0)},p(f,[h]){const g={};h&32&&(g.$$scope={dirty:h,ctx:f}),!l&&h&2&&(l=!0,g.showModal=f[1],Re(()=>l=!1)),e.$set(g),(!i||h&1)&&Q(s,f[0]),(!i||h&1)&&u(t,"href",f[0])},i(f){i||(k(e.$$.fragment,f),i=!0)},o(f){$(e.$$.fragment,f),i=!1},d(f){f&&(_(n),_(t)),le(e,f),c=!1,o()}}}function Yl(r,e,l){let{href:n}=e,t=!1;function s(o){t=o,l(1,t)}const i=()=>window.open(n),c=()=>l(1,t=!0);return r.$$set=o=>{"href"in o&&l(0,n=o.href)},[n,t,s,i,c]}class He extends _e{constructor(e){super(),he(this,e,Yl,Ql,ue,{href:0})}}function Zl(r){let e,l,n,t;const s=[rn,nn],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),l=i[e]=s[e](r),{c(){l.c(),n=L()},l(o){l.l(o),n=L()},m(o,a){i[e].m(o,a),b(o,n,a),t=!0},p(o,a){let d=e;e=c(o),e===d?i[e].p(o,a):(Y(),$(i[d],1,1,()=>{i[d]=null}),Z(),l=i[e],l?l.p(o,a):(l=i[e]=s[e](o),l.c()),k(l,1),l.m(n.parentNode,n))},i(o){t||(k(l),t=!0)},o(o){$(l),t=!1},d(o){o&&_(n),i[e].d(o)}}}function xl(r){let e,l,n=r[0].filename+"",t,s,i,c;return i=new He({props:{href:r[1]}}),{c(){e=M("span"),l=V("[File "),t=V(n),s=V(`]
			`),x(i.$$.fragment),this.h()},l(o){e=I(o,"SPAN",{class:!0});var a=D(e);l=P(a,"[File "),t=P(a,n),s=P(a,`]
			`),ee(i.$$.fragment,a),a.forEach(_),this.h()},h(){u(e,"class","text-gray-500")},m(o,a){b(o,e,a),v(e,l),v(e,t),v(e,s),te(i,e,null),c=!0},p(o,a){(!c||a&1)&&n!==(n=o[0].filename+"")&&Q(t,n);const d={};a&2&&(d.href=o[1]),i.$set(d)},i(o){c||(k(i.$$.fragment,o),c=!0)},o(o){$(i.$$.fragment,o),c=!1},d(o){o&&_(e),le(i)}}}function en(r){let e,l,n;return{c(){e=M("audio"),l=M("source"),this.h()},l(t){e=I(t,"AUDIO",{});var s=D(e);l=I(s,"SOURCE",{src:!0}),s.forEach(_),this.h()},h(){X(l.src,n=r[1])||u(l,"src",n),e.controls=!0},m(t,s){b(t,e,s),v(e,l)},p(t,s){s&2&&!X(l.src,n=t[1])&&u(l,"src",n)},i:m,o:m,d(t){t&&_(e)}}}function tn(r){let e,l,n;return{c(){e=M("video"),l=M("source"),this.h()},l(t){e=I(t,"VIDEO",{class:!0});var s=D(e);l=I(s,"SOURCE",{src:!0}),s.forEach(_),this.h()},h(){X(l.src,n=r[1])||u(l,"src",n),e.controls=!0,u(e,"class","svelte-m38imf")},m(t,s){b(t,e,s),v(e,l)},p(t,s){s&2&&!X(l.src,n=t[1])&&u(l,"src",n)},i:m,o:m,d(t){t&&_(e)}}}function ln(r){let e,l,n,t;const s=[hn,_n],i=[];function c(o,a){return o[2]["jolt:low-data-mode"]?0:1}return e=c(r),l=i[e]=s[e](r),{c(){l.c(),n=L()},l(o){l.l(o),n=L()},m(o,a){i[e].m(o,a),b(o,n,a),t=!0},p(o,a){let d=e;e=c(o),e===d?i[e].p(o,a):(Y(),$(i[d],1,1,()=>{i[d]=null}),Z(),l=i[e],l?l.p(o,a):(l=i[e]=s[e](o),l.c()),k(l,1),l.m(n.parentNode,n))},i(o){t||(k(l),t=!0)},o(o){$(l),t=!1},d(o){o&&_(n),i[e].d(o)}}}function nn(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!0,pending:un,then:on,catch:sn,value:4,error:6};return ie(l=fetch(r[1]),n),{c(){e=L(),n.block.c()},l(t){e=L(),n.block.l(t)},m(t,s){b(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&2&&l!==(l=fetch(r[1]))&&ie(l,n)||ke(n,r,s)},i:m,o:m,d(t){t&&_(e),n.block.d(t),n.token=null,n=null}}}function rn(r){let e,l,n,t,s;return n=new He({props:{href:r[1]}}),{c(){e=M("span"),l=V("[Text "),x(n.$$.fragment),t=V("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var c=D(e);l=P(c,"[Text "),ee(n.$$.fragment,c),t=P(c,"]"),c.forEach(_),this.h()},h(){u(e,"class","text-gray-500")},m(i,c){b(i,e,c),v(e,l),te(n,e,null),v(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),n.$set(o)},i(i){s||(k(n.$$.fragment,i),s=!0)},o(i){$(n.$$.fragment,i),s=!1},d(i){i&&_(e),le(n)}}}function sn(r){let e,l,n=r[0].filename+"",t,s,i=r[6]+"",c;return{c(){e=M("p"),l=V("Unable to download "),t=V(n),s=V(": "),c=V(i)},l(o){e=I(o,"P",{});var a=D(e);l=P(a,"Unable to download "),t=P(a,n),s=P(a,": "),c=P(a,i),a.forEach(_)},m(o,a){b(o,e,a),v(e,l),v(e,t),v(e,s),v(e,c)},p(o,a){a&1&&n!==(n=o[0].filename+"")&&Q(t,n),a&2&&i!==(i=o[6]+"")&&Q(c,i)},d(o){o&&_(e)}}}function on(r){let e,l,n={ctx:r,current:null,token:null,hasCatch:!1,pending:fn,then:an,catch:cn,value:5};return ie(l=r[4].text(),n),{c(){e=L(),n.block.c()},l(t){e=L(),n.block.l(t)},m(t,s){b(t,e,s),n.block.m(t,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(t,s){r=t,n.ctx=r,s&2&&l!==(l=r[4].text())&&ie(l,n)||ke(n,r,s)},d(t){t&&_(e),n.block.d(t),n.token=null,n=null}}}function cn(r){return{c:m,l:m,m,p:m,d:m}}function an(r){let e,l=r[5]+"",n;return{c(){e=M("p"),n=V(l)},l(t){e=I(t,"P",{});var s=D(e);n=P(s,l),s.forEach(_)},m(t,s){b(t,e,s),v(e,n)},p(t,s){s&2&&l!==(l=t[5]+"")&&Q(n,l)},d(t){t&&_(e)}}}function fn(r){return{c:m,l:m,m,p:m,d:m}}function un(r){return{c:m,l:m,m,p:m,d:m}}function _n(r){let e,l,n;return{c(){e=M("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){X(e.src,l=r[1])||u(e,"src",l),u(e,"alt",n=r[0].filename),u(e,"class","max-w-xl max-h-xl svelte-m38imf")},m(t,s){b(t,e,s)},p(t,s){s&2&&!X(e.src,l=t[1])&&u(e,"src",l),s&1&&n!==(n=t[0].filename)&&u(e,"alt",n)},i:m,o:m,d(t){t&&_(e)}}}function hn(r){let e,l,n,t,s;return n=new He({props:{href:r[1]}}),{c(){e=M("span"),l=V("[Image "),x(n.$$.fragment),t=V("]"),this.h()},l(i){e=I(i,"SPAN",{class:!0});var c=D(e);l=P(c,"[Image "),ee(n.$$.fragment,c),t=P(c,"]"),c.forEach(_),this.h()},h(){u(e,"class","text-gray-500")},m(i,c){b(i,e,c),v(e,l),te(n,e,null),v(e,t),s=!0},p(i,c){const o={};c&2&&(o.href=i[1]),n.$set(o)},i(i){s||(k(n.$$.fragment,i),s=!0)},o(i){$(n.$$.fragment,i),s=!1},d(i){i&&_(e),le(n)}}}function mn(r){let e,l,n,t;const s=[ln,tn,en,xl,Zl],i=[];function c(o,a){return o[0].metadata.type=="Image"?0:o[0].metadata.type=="Video"?1:o[0].metadata.type=="Audio"?2:o[0].metadata.type=="File"?3:o[0].metadata.type=="Text"?4:-1}return~(l=c(r))&&(n=i[l]=s[l](r)),{c(){e=M("div"),n&&n.c()},l(o){e=I(o,"DIV",{});var a=D(e);n&&n.l(a),a.forEach(_)},m(o,a){b(o,e,a),~l&&i[l].m(e,null),t=!0},p(o,[a]){let d=l;l=c(o),l===d?~l&&i[l].p(o,a):(n&&(Y(),$(i[d],1,1,()=>{i[d]=null}),Z()),~l?(n=i[l],n?n.p(o,a):(n=i[l]=s[l](o),n.c()),k(n,1),n.m(e,null)):n=null)},i(o){t||(k(n),t=!0)},o(o){$(n),t=!1},d(o){o&&_(e),~l&&i[l].d()}}}function dn(r,e,l){let n,t;const s=J(je);se(r,s,c=>l(2,t=c));let{attachment:i}=e;return r.$$set=c=>{"attachment"in c&&l(0,i=c.attachment)},r.$$.update=()=>{r.$$.dirty&1&&l(1,n=Yt(i))},[i,n,t,s]}class pn extends _e{constructor(e){super(),he(this,e,dn,mn,ue,{attachment:0})}}function gn(r){let e,l="oop website embed, can't handle that :(";return{c(){e=M("span"),e.textContent=l,this.h()},l(n){e=I(n,"SPAN",{style:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-rjpnkw"&&(e.textContent=l),this.h()},h(){Oe(e,"color","var(--secondary-foreground)")},m(n,t){b(n,e,t)},p:m,d(n){n&&_(e)}}}function bn(r){let e,l,n,t=r[0].icon_url&&!r[1]["jolt:low-data-mode"]&&lt(r),s=r[0].title&&nt(r),i=r[0].description&&rt(r);return{c(){e=M("div"),t&&t.c(),l=G(),s&&s.c(),n=G(),i&&i.c(),this.h()},l(c){e=I(c,"DIV",{class:!0,style:!0});var o=D(e);t&&t.l(o),l=R(o),s&&s.l(o),n=R(o),i&&i.l(o),o.forEach(_),this.h()},h(){u(e,"class","text-embed svelte-qbtmm9"),Oe(e,"border-left","solid "+r[0].colour)},m(c,o){b(c,e,o),t&&t.m(e,null),v(e,l),s&&s.m(e,null),v(e,n),i&&i.m(e,null)},p(c,o){c[0].icon_url&&!c[1]["jolt:low-data-mode"]?t?t.p(c,o):(t=lt(c),t.c(),t.m(e,l)):t&&(t.d(1),t=null),c[0].title?s?s.p(c,o):(s=nt(c),s.c(),s.m(e,n)):s&&(s.d(1),s=null),c[0].description?i?i.p(c,o):(i=rt(c),i.c(),i.m(e,null)):i&&(i.d(1),i=null),o&1&&Oe(e,"border-left","solid "+c[0].colour)},d(c){c&&_(e),t&&t.d(),s&&s.d(),i&&i.d()}}}function kn(r){let e,l,n,t,s;return{c(){e=M("video"),l=M("source"),this.h()},l(i){e=I(i,"VIDEO",{class:!0});var c=D(e);l=I(c,"SOURCE",{src:!0,width:!0,height:!0}),c.forEach(_),this.h()},h(){X(l.src,n=r[0].url)||u(l,"src",n),u(l,"width",t=r[0].width),u(l,"height",s=r[0].height),e.controls=!0,u(e,"class","svelte-qbtmm9")},m(i,c){b(i,e,c),v(e,l)},p(i,c){c&1&&!X(l.src,n=i[0].url)&&u(l,"src",n),c&1&&t!==(t=i[0].width)&&u(l,"width",t),c&1&&s!==(s=i[0].height)&&u(l,"height",s)},d(i){i&&_(e)}}}function vn(r){let e,l,n,t;return{c(){e=M("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,width:!0,height:!0,class:!0}),this.h()},h(){X(e.src,l=r[0].url)||u(e,"src",l),u(e,"width",n=r[0].width),u(e,"height",t=r[0].height),u(e,"class","svelte-qbtmm9")},m(s,i){b(s,e,i)},p(s,i){i&1&&!X(e.src,l=s[0].url)&&u(e,"src",l),i&1&&n!==(n=s[0].width)&&u(e,"width",n),i&1&&t!==(t=s[0].height)&&u(e,"height",t)},d(s){s&&_(e)}}}function lt(r){let e,l,n;return{c(){e=M("img"),this.h()},l(t){e=I(t,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),this.h()},h(){X(e.src,l=r[0].icon_url)||u(e,"src",l),u(e,"alt",n=r[0].title),u(e,"width","24"),u(e,"height","24"),u(e,"class","svelte-qbtmm9")},m(t,s){b(t,e,s)},p(t,s){s&1&&!X(e.src,l=t[0].icon_url)&&u(e,"src",l),s&1&&n!==(n=t[0].title)&&u(e,"alt",n)},d(t){t&&_(e)}}}function nt(r){let e,l=r[0].title+"",n;return{c(){e=M("h1"),n=V(l)},l(t){e=I(t,"H1",{});var s=D(e);n=P(s,l),s.forEach(_)},m(t,s){b(t,e,s),v(e,n)},p(t,s){s&1&&l!==(l=t[0].title+"")&&Q(n,l)},d(t){t&&_(e)}}}function rt(r){let e,l=r[0].description+"",n;return{c(){e=M("p"),n=V(l)},l(t){e=I(t,"P",{});var s=D(e);n=P(s,l),s.forEach(_)},m(t,s){b(t,e,s),v(e,n)},p(t,s){s&1&&l!==(l=t[0].description+"")&&Q(n,l)},d(t){t&&_(e)}}}function yn(r){let e;function l(s,i){if(s[0].type=="Image"&&!s[1]["jolt:low-data-mode"])return vn;if(s[0].type=="Video"&&!s[1]["jolt:low-data-mode"])return kn;if(s[0].type=="Text")return bn;if(s[0].type=="Website")return gn}let n=l(r),t=n&&n(r);return{c(){t&&t.c(),e=L()},l(s){t&&t.l(s),e=L()},m(s,i){t&&t.m(s,i),b(s,e,i)},p(s,[i]){n===(n=l(s))&&t?t.p(s,i):(t&&t.d(1),t=n&&n(s),t&&(t.c(),t.m(e.parentNode,e)))},i:m,o:m,d(s){s&&_(e),t&&t.d(s)}}}function wn(r,e,l){let n,{embed:t}=e;const s=J(je);return se(r,s,i=>l(1,n=i)),r.$$set=i=>{"embed"in i&&l(0,t=i.embed)},[t,n,s]}class $n extends _e{constructor(e){super(),he(this,e,wn,yn,ue,{embed:0})}}function En(r){let e,l,n;return{c(){e=M("textarea"),this.h()},l(t){e=I(t,"TEXTAREA",{maxlength:!0,placeholder:!0,class:!0}),D(e).forEach(_),this.h()},h(){u(e,"maxlength","2000"),u(e,"placeholder",r[1]),u(e,"class","svelte-kqfcqt")},m(t,s){b(t,e,s),Ve(e,r[0]),l||(n=[oe(e,"blur",r[3]),oe(e,"input",r[4]),oe(e,"keydown",r[6]),oe(e,"input",r[7])],l=!0)},p(t,[s]){s&2&&u(e,"placeholder",t[1]),s&1&&Ve(e,t[0])},i:m,o:m,d(t){t&&_(e),l=!1,Pe(n)}}}function Mn(r,e,l){const n=J(Ee),t=J(jt);let{placeholder:s=void 0}=e,{value:i=""}=e,{sendTypingEvents:c}=e;const o=zt();function a(){c&&n.websocket.send({type:"EndTyping",channel:t._id})}function d(){if(c){if(i==""){n.websocket.send({type:"EndTyping",channel:t._id});return}n.websocket.send({type:"BeginTyping",channel:t._id})}}const f=g=>{var B;o("keydown",g),!(g.shiftKey||g.key!="Enter")&&(g.preventDefault(),(B=g.currentTarget.form)==null||B.requestSubmit())};function h(){i=this.value,l(0,i)}return r.$$set=g=>{"placeholder"in g&&l(1,s=g.placeholder),"value"in g&&l(0,i=g.value),"sendTypingEvents"in g&&l(5,c=g.sendTypingEvents)},[i,s,o,a,d,c,f,h]}class Pt extends _e{constructor(e){super(),he(this,e,Mn,En,ue,{placeholder:1,value:0,sendTypingEvents:5})}}function it(r,e,l){const n=r.slice();return n[22]=e[l],n}function st(r,e,l){const n=r.slice();return n[25]=e[l],n}function Be(r){const e=r.slice(),l=new Date(e[0].edited);return e[6]=l,e}function In(r){const e=r.slice(),l=ge(e[1],e[2],e[0]);return e[28]=l,e}function ot(r,e,l){const n=r.slice();return n[29]=e[l],n}function ct(r){let e,l,n=fe(r[0].replies),t=[];for(let i=0;i<n.length;i+=1)t[i]=at(ot(r,n,i));const s=i=>$(t[i],1,1,()=>{t[i]=null});return{c(){e=M("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=I(i,"DIV",{class:!0});var c=D(e);for(let o=0;o<t.length;o+=1)t[o].l(c);c.forEach(_),this.h()},h(){u(e,"class","replies svelte-wy25lb")},m(i,c){b(i,e,c);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null);l=!0},p(i,c){if(c[0]&1){n=fe(i[0].replies);let o;for(o=0;o<n.length;o+=1){const a=ot(i,n,o);t[o]?(t[o].p(a,c),k(t[o],1)):(t[o]=at(a),t[o].c(),k(t[o],1),t[o].m(e,null))}for(Y(),o=n.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!l){for(let c=0;c<n.length;c+=1)k(t[c]);l=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)$(t[c]);l=!1},d(i){i&&_(e),$e(t,i)}}}function at(r){let e,l;return e=new pl({props:{id:r[29]}}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,t){te(e,n,t),l=!0},p(n,t){const s={};t[0]&1&&(s.id=n[29]),e.$set(s)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){$(e.$$.fragment,n),l=!1},d(n){le(e,n)}}}function ft(r){let e,l,n,t,s,i,c,o=Ue(r[6]).calendar()+"",a,d,f;const h=[Tn,Cn],g=[];function B(y,N){return y[5]["jolt:low-data-mode"]||y[1]==null?0:1}function C(y,N){return N===1?In(y):y}l=B(r),n=g[l]=h[l](C(r,l));let w=r[0].edited!=null&&ut(Be(r));return{c(){e=M("div"),n.c(),t=G(),s=V(r[4]),i=G(),c=M("p"),a=V(o),d=G(),w&&w.c(),this.h()},l(y){e=I(y,"DIV",{class:!0});var N=D(e);n.l(N),t=R(N),s=P(N,r[4]),i=R(N),c=I(N,"P",{class:!0});var A=D(c);a=P(A,o),d=R(A),w&&w.l(A),A.forEach(_),N.forEach(_),this.h()},h(){u(c,"class","timestamp svelte-wy25lb"),u(e,"class","user-detail svelte-wy25lb")},m(y,N){b(y,e,N),g[l].m(e,null),v(e,t),v(e,s),v(e,i),v(e,c),v(c,a),v(c,d),w&&w.m(c,null),f=!0},p(y,N){let A=l;l=B(y),l===A?g[l].p(C(y,l),N):(Y(),$(g[A],1,1,()=>{g[A]=null}),Z(),n=g[l],n?n.p(C(y,l),N):(n=g[l]=h[l](C(y,l)),n.c()),k(n,1),n.m(e,t)),(!f||N[0]&16)&&Q(s,y[4]),(!f||N[0]&64)&&o!==(o=Ue(y[6]).calendar()+"")&&Q(a,o),y[0].edited!=null?w?w.p(Be(y),N):(w=ut(Be(y)),w.c(),w.m(c,null)):w&&(w.d(1),w=null)},i(y){f||(k(n),f=!0)},o(y){$(n),f=!1},d(y){y&&_(e),g[l].d(),w&&w.d()}}}function Cn(r){let e,l,n,t;const s=[Un,Nn],i=[];function c(o,a){return o[28]==null?0:1}return e=c(r),l=i[e]=s[e](r),{c(){l.c(),n=L()},l(o){l.l(o),n=L()},m(o,a){i[e].m(o,a),b(o,n,a),t=!0},p(o,a){let d=e;e=c(o),e===d?i[e].p(o,a):(Y(),$(i[d],1,1,()=>{i[d]=null}),Z(),l=i[e],l?l.p(o,a):(l=i[e]=s[e](o),l.c()),k(l,1),l.m(n.parentNode,n))},i(o){t||(k(l),t=!0)},o(o){$(l),t=!1},d(o){o&&_(n),i[e].d(o)}}}function Tn(r){let e,l;return e=new De({}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,t){te(e,n,t),l=!0},p:m,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){$(e.$$.fragment,n),l=!1},d(n){le(e,n)}}}function Nn(r){let e,l;return{c(){e=M("img"),this.h()},l(n){e=I(n,"IMG",{class:!0,alt:!0,src:!0,width:!0,height:!0}),this.h()},h(){u(e,"class","cover"),u(e,"alt",r[4]),X(e.src,l=r[28])||u(e,"src",l),u(e,"width","40px"),u(e,"height","40px")},m(n,t){b(n,e,t)},p(n,t){t[0]&16&&u(e,"alt",n[4]),t[0]&7&&!X(e.src,l=n[28])&&u(e,"src",l)},i:m,o:m,d(n){n&&_(e)}}}function Un(r){let e,l;return e=new De({}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,t){te(e,n,t),l=!0},p:m,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){$(e.$$.fragment,n),l=!1},d(n){le(e,n)}}}function ut(r){let e,l="(edited)",n,t,s;return{c(){e=M("span"),e.textContent=l,this.h()},l(i){e=I(i,"SPAN",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-1c19xdw"&&(e.textContent=l),this.h()},h(){u(e,"class","timestamp svelte-wy25lb")},m(i,c){b(i,e,c),t||(s=Ht(n=tl.call(null,e,{placement:"top",content:Ue(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away-subtle",duration:100})),t=!0)},p(i,c){r=i,n&&Wt(n.update)&&c[0]&1&&n.update.call(null,{placement:"top",content:Ue(r[6]).calendar(),theme:"top-tooltip",animation:"shift-away-subtle",duration:100})},d(i){i&&_(e),t=!1,s()}}}function Sn(r){let e,l=r[0].content+"",n;return{c(){e=M("span"),n=V(l),this.h()},l(t){e=I(t,"SPAN",{class:!0});var s=D(e);n=P(s,l),s.forEach(_),this.h()},h(){u(e,"class","message-content svelte-wy25lb")},m(t,s){b(t,e,s),v(e,n)},p(t,s){s[0]&1&&l!==(l=t[0].content+"")&&Q(n,l)},i:m,o:m,d(t){t&&_(e)}}}function jn(r){let e,l,n,t,s,i;function c(a){r[16](a)}let o={placeholder:"Edit this message",sendTypingEvents:!1};return r[3]!==void 0&&(o.value=r[3]),l=new Pt({props:o}),Se.push(()=>Le(l,"value",c)),l.$on("keydown",r[17]),{c(){e=M("form"),x(l.$$.fragment),this.h()},l(a){e=I(a,"FORM",{id:!0,class:!0});var d=D(e);ee(l.$$.fragment,d),d.forEach(_),this.h()},h(){u(e,"id","message-edit-form"),u(e,"class","message-form")},m(a,d){b(a,e,d),te(l,e,null),t=!0,s||(i=oe(e,"submit",r[11]),s=!0)},p(a,d){const f={};!n&&d[0]&8&&(n=!0,f.value=a[3],Re(()=>n=!1)),l.$set(f)},i(a){t||(k(l.$$.fragment,a),t=!0)},o(a){$(l.$$.fragment,a),t=!1},d(a){a&&_(e),le(l),s=!1,i()}}}function _t(r){let e,l;return e=new zl({props:{system:r[0].system}}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,t){te(e,n,t),l=!0},p(n,t){const s={};t[0]&1&&(s.system=n[0].system),e.$set(s)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){$(e.$$.fragment,n),l=!1},d(n){le(e,n)}}}function ht(r){let e,l,n=fe(r[0].attachments),t=[];for(let i=0;i<n.length;i+=1)t[i]=mt(st(r,n,i));const s=i=>$(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=L()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=L()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);b(i,e,c),l=!0},p(i,c){if(c[0]&1){n=fe(i[0].attachments);let o;for(o=0;o<n.length;o+=1){const a=st(i,n,o);t[o]?(t[o].p(a,c),k(t[o],1)):(t[o]=mt(a),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=n.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!l){for(let c=0;c<n.length;c+=1)k(t[c]);l=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)$(t[c]);l=!1},d(i){i&&_(e),$e(t,i)}}}function mt(r){let e,l;return e=new pn({props:{attachment:r[25]}}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,t){te(e,n,t),l=!0},p(n,t){const s={};t[0]&1&&(s.attachment=n[25]),e.$set(s)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){$(e.$$.fragment,n),l=!1},d(n){le(e,n)}}}function dt(r){let e,l,n=fe(r[0].embeds),t=[];for(let i=0;i<n.length;i+=1)t[i]=pt(it(r,n,i));const s=i=>$(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=L()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=L()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);b(i,e,c),l=!0},p(i,c){if(c[0]&1){n=fe(i[0].embeds);let o;for(o=0;o<n.length;o+=1){const a=it(i,n,o);t[o]?(t[o].p(a,c),k(t[o],1)):(t[o]=pt(a),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=n.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!l){for(let c=0;c<n.length;c+=1)k(t[c]);l=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)$(t[c]);l=!1},d(i){i&&_(e),$e(t,i)}}}function pt(r){let e,l;return e=new $n({props:{embed:r[22]}}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,t){te(e,n,t),l=!0},p(n,t){const s={};t[0]&1&&(s.embed=n[22]),e.$set(s)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){$(e.$$.fragment,n),l=!1},d(n){le(e,n)}}}function Dn(r){let e,l,n=r[12](r[0])&&r[0].system==null,t,s,i,c,o,a,d,f,h=r[0].replies!=null&&r[0].replies.length!=0&&ct(r),g=n&&ft(r);const B=[jn,Sn],C=[];function w(T,S){return T[3]!=null?0:T[0].content!=null?1:-1}~(s=w(r))&&(i=C[s]=B[s](r));let y=r[0].system!=null&&_t(r),N=r[0].attachments!=null&&ht(r),A=r[0].embeds!=null&&dt(r);return{c(){e=M("div"),h&&h.c(),l=G(),g&&g.c(),t=G(),i&&i.c(),c=G(),y&&y.c(),o=G(),N&&N.c(),a=G(),A&&A.c(),this.h()},l(T){e=I(T,"DIV",{id:!0,class:!0});var S=D(e);h&&h.l(S),l=R(S),g&&g.l(S),t=R(S),i&&i.l(S),c=R(S),y&&y.l(S),o=R(S),N&&N.l(S),a=R(S),A&&A.l(S),S.forEach(_),this.h()},h(){u(e,"id",d="MESSAGE-"+r[0]._id),u(e,"class","message-container svelte-wy25lb")},m(T,S){b(T,e,S),h&&h.m(e,null),v(e,l),g&&g.m(e,null),v(e,t),~s&&C[s].m(e,null),v(e,c),y&&y.m(e,null),v(e,o),N&&N.m(e,null),v(e,a),A&&A.m(e,null),f=!0},p(T,S){T[0].replies!=null&&T[0].replies.length!=0?h?(h.p(T,S),S[0]&1&&k(h,1)):(h=ct(T),h.c(),k(h,1),h.m(e,l)):h&&(Y(),$(h,1,1,()=>{h=null}),Z()),S[0]&1&&(n=T[12](T[0])&&T[0].system==null),n?g?(g.p(T,S),S[0]&1&&k(g,1)):(g=ft(T),g.c(),k(g,1),g.m(e,t)):g&&(Y(),$(g,1,1,()=>{g=null}),Z());let W=s;s=w(T),s===W?~s&&C[s].p(T,S):(i&&(Y(),$(C[W],1,1,()=>{C[W]=null}),Z()),~s?(i=C[s],i?i.p(T,S):(i=C[s]=B[s](T),i.c()),k(i,1),i.m(e,c)):i=null),T[0].system!=null?y?(y.p(T,S),S[0]&1&&k(y,1)):(y=_t(T),y.c(),k(y,1),y.m(e,o)):y&&(Y(),$(y,1,1,()=>{y=null}),Z()),T[0].attachments!=null?N?(N.p(T,S),S[0]&1&&k(N,1)):(N=ht(T),N.c(),k(N,1),N.m(e,a)):N&&(Y(),$(N,1,1,()=>{N=null}),Z()),T[0].embeds!=null?A?(A.p(T,S),S[0]&1&&k(A,1)):(A=dt(T),A.c(),k(A,1),A.m(e,null)):A&&(Y(),$(A,1,1,()=>{A=null}),Z()),(!f||S[0]&1&&d!==(d="MESSAGE-"+T[0]._id))&&u(e,"id",d)},i(T){f||(k(h),k(g),k(i),k(y),k(N),k(A),f=!0)},o(T){$(h),$(g),$(i),$(y),$(N),$(A),f=!1},d(T){T&&_(e),h&&h.d(),g&&g.d(),~s&&C[s].d(),y&&y.d(),N&&N.d(),A&&A.d()}}}function An(r,e,l){let n,t,s,i,c,o;Ue.extend(nl);let{message:a}=e,{messageIndex:d}=e,f,h,g;const B=J(je);se(r,B,U=>l(5,o=U));const C=J(Ee),w=J(Vt);se(r,w,U=>l(14,s=U));const y=J(Ke),N=J(ze);se(r,N,U=>l(15,i=U));const A=J(Dt);se(r,A,U=>l(18,c=U));async function T(U,q){l(2,g=c==null?void 0:c.find(K=>K._id.server==U&&K._id.user==q))}async function S(){const U=await C.api.editMessage(a.channel,a._id,{content:f});y==null||y.update(q=>(q[q.findIndex(K=>K._id==a._id)]=U,q)),l(3,f=void 0)}function W(U){var O;if(y==null)return!0;const K=Xt(y)[d-1];return K==null?!0:U.author!=K.author||U.masquerade!=K.masquerade||Fe(U._id)-Fe(K._id)>=7*60*1e3||(((O=U.replies)==null?void 0:O.length)??0)!=0}function ce(U){f=U,l(3,f)}const de=U=>{U.detail.key=="Escape"&&l(3,f=void 0)};return r.$$set=U=>{"message"in U&&l(0,a=U.message),"messageIndex"in U&&l(13,d=U.messageIndex)},r.$$.update=()=>{r.$$.dirty[0]&32769&&Ge(C.api,i??C.api.cache.users,a.author).then(U=>l(1,h=U)),r.$$.dirty[0]&16385&&(s==null||T(s,a.author)),r.$$.dirty[0]&7&&l(4,n=h==null?"Unknown User":ae(h,g,a)),r.$$.dirty[0]&1&&l(6,t=Fe(a._id))},[a,h,g,f,n,o,t,B,w,N,A,S,W,d,s,i,ce,de]}class On extends _e{constructor(e){super(),he(this,e,An,Dn,ue,{message:0,messageIndex:13},null,[-1,-1])}}function Vn(r){let e,l;return{c(){e=Te("svg"),l=Te("path"),this.h()},l(n){e=Ne(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=D(e);l=Ne(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),D(l).forEach(_),t.forEach(_),this.h()},h(){u(l,"stroke-linecap","round"),u(l,"stroke-linejoin","round"),u(l,"d","M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width","1.5"),u(e,"stroke","currentColor"),u(e,"width","24px"),u(e,"height","24px")},m(n,t){b(n,e,t),v(e,l)},p:m,i:m,o:m,d(n){n&&_(e)}}}class qt extends _e{constructor(e){super(),he(this,e,null,Vn,ue,{})}}function Pn(r){let e,l;return{c(){e=Te("svg"),l=Te("path"),this.h()},l(n){e=Ne(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=D(e);l=Ne(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),D(l).forEach(_),t.forEach(_),this.h()},h(){u(l,"stroke-linecap","round"),u(l,"stroke-linejoin","round"),u(l,"d","M15.182 15.182a4.5 4.5 0 01-6.364 0M21 12a9 9 0 11-18 0 9 9 0 0118 0zM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75zm-.375 0h.008v.015h-.008V9.75zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75zm-.375 0h.008v.015h-.008V9.75z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width","1.5"),u(e,"stroke","currentColor"),u(e,"width","24px"),u(e,"height","24px")},m(n,t){b(n,e,t),v(e,l)},p:m,i:m,o:m,d(n){n&&_(e)}}}class qn extends _e{constructor(e){super(),he(this,e,null,Pn,ue,{})}}function Fn(r){let e,l;return{c(){e=Te("svg"),l=Te("path"),this.h()},l(n){e=Ne(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var t=D(e);l=Ne(t,"path",{"stroke-linecap":!0,d:!0}),D(l).forEach(_),t.forEach(_),this.h()},h(){u(l,"stroke-linecap","round"),u(l,"d","M16.5 12a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"fill","none"),u(e,"viewBox","0 0 24 24"),u(e,"stroke-width","1.5"),u(e,"stroke","currentColor"),u(e,"width","24px"),u(e,"height","24px")},m(n,t){b(n,e,t),v(e,l)},p:m,i:m,o:m,d(n){n&&_(e)}}}class Bn extends _e{constructor(e){super(),he(this,e,null,Fn,ue,{})}}function gt(r){const e=ae(r[5]);r[6]=e}function Gn(r){let e,l,n;return e=new De({}),{c(){x(e.$$.fragment),l=V(`
				<UnknownUser>`)},l(t){ee(e.$$.fragment,t),l=P(t,`
				<UnknownUser>`)},m(t,s){te(e,t,s),b(t,l,s),n=!0},p:m,i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){t&&_(l),le(e,t)}}}function Rn(r){gt(r);let e,l,n,t,s=r[6]+"",i;return{c(){e=M("img"),t=G(),i=V(s),this.h()},l(c){e=I(c,"IMG",{class:!0,src:!0,alt:!0}),t=R(c),i=P(c,s),this.h()},h(){u(e,"class","cover svelte-zbyf5q"),X(e.src,l=ge(r[5]))||u(e,"src",l),u(e,"alt",n=r[6])},m(c,o){b(c,e,o),b(c,t,o),b(c,i,o)},p(c,o){gt(c),o&1&&!X(e.src,l=ge(c[5]))&&u(e,"src",l),o&1&&n!==(n=c[6])&&u(e,"alt",n),o&1&&s!==(s=c[6]+"")&&Q(i,s)},i:m,o:m,d(c){c&&(_(e),_(t),_(i))}}}function Ln(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function bt(r){let e,l=r[0].message.content+"",n;return{c(){e=M("p"),n=V(l),this.h()},l(t){e=I(t,"P",{class:!0});var s=D(e);n=P(s,l),s.forEach(_),this.h()},h(){u(e,"class","message-content svelte-zbyf5q")},m(t,s){b(t,e,s),v(e,n)},p(t,s){s&1&&l!==(l=t[0].message.content+"")&&Q(n,l)},d(t){t&&_(e)}}}function Kn(r){let e,l,n,t,s,i,c,o,a,d,f,h,g,B,C=r[0].mention?"ON":"OFF",w,y,N,A,T,S,W,ce,de,U={ctx:r,current:null,token:null,hasCatch:!0,pending:Ln,then:Rn,catch:Gn,value:5,blocks:[,,,]};ie(s=r[2].api.fetchUser(r[0].message.author),U);let q=r[0].message.content&&bt(r);return g=new Bn({}),S=new qt({}),{c(){e=M("div"),l=M("p"),n=V(`Replying to
		`),t=M("strong"),U.block.c(),i=G(),q&&q.c(),c=G(),o=M("div"),a=G(),d=M("label"),f=M("input"),h=G(),x(g.$$.fragment),B=G(),w=V(C),N=G(),A=M("div"),T=M("button"),x(S.$$.fragment),this.h()},l(K){e=I(K,"DIV",{class:!0});var O=D(e);l=I(O,"P",{});var be=D(l);n=P(be,`Replying to
		`),t=I(be,"STRONG",{});var me=D(t);U.block.l(me),me.forEach(_),be.forEach(_),i=R(O),q&&q.l(O),c=R(O),o=I(O,"DIV",{class:!0}),D(o).forEach(_),a=R(O),d=I(O,"LABEL",{class:!0,"aria-label":!0});var z=D(d);f=I(z,"INPUT",{id:!0,style:!0,type:!0}),h=R(z),ee(g.$$.fragment,z),B=R(z),w=P(z,C),z.forEach(_),N=R(O),A=I(O,"DIV",{});var Me=D(A);T=I(Me,"BUTTON",{});var ne=D(T);ee(S.$$.fragment,ne),ne.forEach(_),Me.forEach(_),O.forEach(_),this.h()},h(){u(o,"class","flex-divider"),u(f,"id","mention"),Oe(f,"display","none"),u(f,"type","checkbox"),u(d,"class","mention-button svelte-zbyf5q"),u(d,"aria-label",y="Mention author "+(r[0].mention?"ON":"OFF")),u(e,"class","container svelte-zbyf5q")},m(K,O){b(K,e,O),v(e,l),v(l,n),v(l,t),U.block.m(t,U.anchor=null),U.mount=()=>t,U.anchor=null,v(e,i),q&&q.m(e,null),v(e,c),v(e,o),v(e,a),v(e,d),v(d,f),f.checked=r[0].mention,v(d,h),te(g,d,null),v(d,B),v(d,w),v(e,N),v(e,A),v(A,T),te(S,T,null),W=!0,ce||(de=[oe(f,"change",r[3]),oe(T,"click",r[4])],ce=!0)},p(K,[O]){r=K,U.ctx=r,O&1&&s!==(s=r[2].api.fetchUser(r[0].message.author))&&ie(s,U)||ke(U,r,O),r[0].message.content?q?q.p(r,O):(q=bt(r),q.c(),q.m(e,c)):q&&(q.d(1),q=null),O&1&&(f.checked=r[0].mention),(!W||O&1)&&C!==(C=r[0].mention?"ON":"OFF")&&Q(w,C),(!W||O&1&&y!==(y="Mention author "+(r[0].mention?"ON":"OFF")))&&u(d,"aria-label",y)},i(K){W||(k(U.block),k(g.$$.fragment,K),k(S.$$.fragment,K),W=!0)},o(K){for(let O=0;O<3;O+=1){const be=U.blocks[O];$(be)}$(g.$$.fragment,K),$(S.$$.fragment,K),W=!1},d(K){K&&_(e),U.block.d(),U.token=null,U=null,q&&q.d(),le(g),le(S),ce=!1,Pe(de)}}}function zn(r,e,l){let{reply:n}=e;const t=J(Ee),s=J(At);function i(){n.mention=this.checked,l(0,n)}const c=()=>s.update(o=>(o=o.filter(a=>a.message._id!=n.message._id),o));return r.$$set=o=>{"reply"in o&&l(0,n=o.reply)},[n,s,t,i,c]}class Hn extends _e{constructor(e){super(),he(this,e,zn,Kn,ue,{reply:0})}}function kt(r,e,l){const n=r.slice();return n[8]=e[l],n}function vt(r){let e,l,n,t,s,i,c;function o(){return r[4](r[8])}return{c(){e=M("button"),l=M("img"),s=G(),this.h()},l(a){e=I(a,"BUTTON",{class:!0});var d=D(e);l=I(d,"IMG",{width:!0,height:!0,src:!0,alt:!0}),s=R(d),d.forEach(_),this.h()},h(){u(l,"width","28px"),u(l,"height","28px"),X(l.src,n="https://autumn.revolt.chat/emojis/"+r[8]._id)||u(l,"src",n),u(l,"alt",t=r[8].name),u(e,"class","svelte-uptso2")},m(a,d){b(a,e,d),v(e,l),v(e,s),i||(c=oe(e,"click",o),i=!0)},p(a,d){r=a,d&2&&!X(l.src,n="https://autumn.revolt.chat/emojis/"+r[8]._id)&&u(l,"src",n),d&2&&t!==(t=r[8].name)&&u(l,"alt",t)},d(a){a&&_(e),i=!1,c()}}}function Wn(r){let e,l,n,t,s,i,c=fe(r[1]),o=[];for(let a=0;a<c.length;a+=1)o[a]=vt(kt(r,c,a));return{c(){e=M("div"),l=M("input"),n=G(),t=M("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=I(a,"DIV",{class:!0});var d=D(e);l=I(d,"INPUT",{type:!0,placeholder:!0,class:!0}),n=R(d),t=I(d,"DIV",{});var f=D(t);for(let h=0;h<o.length;h+=1)o[h].l(f);f.forEach(_),d.forEach(_),this.h()},h(){u(l,"type","text"),u(l,"placeholder","Search for emojis"),u(l,"class","svelte-uptso2"),u(e,"class","emoji-container svelte-uptso2")},m(a,d){b(a,e,d),v(e,l),Ve(l,r[0]),v(e,n),v(e,t);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(t,null);s||(i=oe(l,"input",r[3]),s=!0)},p(a,[d]){if(d&1&&l.value!==a[0]&&Ve(l,a[0]),d&6){c=fe(a[1]);let f;for(f=0;f<c.length;f+=1){const h=kt(a,c,f);o[f]?o[f].p(h,d):(o[f]=vt(h),o[f].c(),o[f].m(t,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=c.length}},i:m,o:m,d(a){a&&_(e),$e(o,a),s=!1,i()}}}function yt(r){const e={};for(const l of r){const n=l.toUpperCase();if(n in e){e[n]++;continue}e[n]=1}return e}function Xn(r,e,l){let n;const t=J(Ee),s=J(Ot);let i="",c=Array.from(t.api.cache.emojis.values());function o(f){if(i.length==0)return f.length;const h=yt(f);let g=0;for(const[B,C]of Object.entries(h)){const w=n[B];w!=null&&(g+=Math.min(w,C))}return g/f.length}function a(){i=this.value,l(0,i)}const d=f=>s.update(h=>h+`:${f._id}:`);return r.$$.update=()=>{r.$$.dirty&1&&(n=yt(i)),r.$$.dirty&3&&(i.length==0?l(1,c=Array.from(t.api.cache.emojis.values())):l(1,c=c.flatMap(f=>{const h=o(f.name);return h==0?[]:[[h,f]]}).sort(([f],[h])=>f-h).map(([,f])=>f).reverse()))},[i,c,s,a,d]}class Jn extends _e{constructor(e){super(),he(this,e,Xn,Wn,ue,{})}}function wt(r,e,l){const n=r.slice();return n[35]=e[l],n}function $t(r,e,l){const n=r.slice();return n[38]=e[l],n}function Et(r,e,l){const n=r.slice();return n[41]=e[l],n[43]=l,n}function Qn(r){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Yn(r){let e,l,n=fe(r[8]),t=[];for(let i=0;i<n.length;i+=1)t[i]=Mt(Et(r,n,i));const s=i=>$(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=L()},l(i){for(let c=0;c<t.length;c+=1)t[c].l(i);e=L()},m(i,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(i,c);b(i,e,c),l=!0},p(i,c){if(c[0]&256){n=fe(i[8]);let o;for(o=0;o<n.length;o+=1){const a=Et(i,n,o);t[o]?(t[o].p(a,c),k(t[o],1)):(t[o]=Mt(a),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(Y(),o=n.length;o<t.length;o+=1)s(o);Z()}},i(i){if(!l){for(let c=0;c<n.length;c+=1)k(t[c]);l=!0}},o(i){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)$(t[c]);l=!1},d(i){i&&_(e),$e(t,i)}}}function Mt(r){let e,l;return e=new On({props:{message:r[41],messageIndex:r[43]}}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,t){te(e,n,t),l=!0},p(n,t){const s={};t[0]&256&&(s.message=n[41]),e.$set(s)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){$(e.$$.fragment,n),l=!1},d(n){le(e,n)}}}function Zn(r){let e;return{c(){e=V("Loading...")},l(l){e=P(l,"Loading...")},m(l,n){b(l,e,n)},p:m,i:m,o:m,d(l){l&&_(e)}}}function It(r){let e,l,n,t=Array.from(r[0]).map(St).join(", ")+"",s,i,c,o,a,d,f,h,g;return d=new qt({}),{c(){e=M("div"),l=M("p"),n=V(`Uploading
				`),s=V(t),i=G(),c=M("div"),o=G(),a=M("button"),x(d.$$.fragment),this.h()},l(B){e=I(B,"DIV",{class:!0});var C=D(e);l=I(C,"P",{});var w=D(l);n=P(w,`Uploading
				`),s=P(w,t),w.forEach(_),i=R(C),c=I(C,"DIV",{class:!0}),D(c).forEach(_),o=R(C),a=I(C,"BUTTON",{});var y=D(a);ee(d.$$.fragment,y),y.forEach(_),C.forEach(_),this.h()},h(){u(c,"class","flex-divider"),u(e,"class","flex-container")},m(B,C){b(B,e,C),v(e,l),v(l,n),v(l,s),v(e,i),v(e,c),v(e,o),v(e,a),te(d,a,null),f=!0,h||(g=oe(a,"click",r[23]),h=!0)},p(B,C){(!f||C[0]&1)&&t!==(t=Array.from(B[0]).map(St).join(", ")+"")&&Q(s,t)},i(B){f||(k(d.$$.fragment,B),f=!0)},o(B){$(d.$$.fragment,B),f=!1},d(B){B&&_(e),le(d),h=!1,g()}}}function Ct(r){let e,l;return e=new Hn({props:{reply:r[38]}}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,t){te(e,n,t),l=!0},p(n,t){const s={};t[0]&64&&(s.reply=n[38]),e.$set(s)},i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){$(e.$$.fragment,n),l=!1},d(n){le(e,n)}}}function xn(r){let e,l,n;return{c(){e=M("img"),this.h()},l(t){e=I(t,"IMG",{class:!0,src:!0,width:!0,height:!0,alt:!0}),this.h()},h(){u(e,"class","cover"),X(e.src,l=ge(r[35]))||u(e,"src",l),u(e,"width","16px"),u(e,"height","16px"),u(e,"alt",n=ae(r[35]))},m(t,s){b(t,e,s)},p(t,s){s[0]&16&&!X(e.src,l=ge(t[35]))&&u(e,"src",l),s[0]&16&&n!==(n=ae(t[35]))&&u(e,"alt",n)},i:m,o:m,d(t){t&&_(e)}}}function er(r){let e,l;return e=new De({}),{c(){x(e.$$.fragment)},l(n){ee(e.$$.fragment,n)},m(n,t){te(e,n,t),l=!0},p:m,i(n){l||(k(e.$$.fragment,n),l=!0)},o(n){$(e.$$.fragment,n),l=!1},d(n){le(e,n)}}}function Tt(r){let e,l,n,t;const s=[er,xn],i=[];function c(o,a){return o[3]["jolt:low-data-mode"]?0:1}return e=c(r),l=i[e]=s[e](r),{c(){l.c(),n=L()},l(o){l.l(o),n=L()},m(o,a){i[e].m(o,a),b(o,n,a),t=!0},p(o,a){let d=e;e=c(o),e===d?i[e].p(o,a):(Y(),$(i[d],1,1,()=>{i[d]=null}),Z(),l=i[e],l?l.p(o,a):(l=i[e]=s[e](o),l.c()),k(l,1),l.m(n.parentNode,n))},i(o){t||(k(l),t=!0)},o(o){$(l),t=!1},d(o){o&&_(n),i[e].d(o)}}}function Nt(r){let e=r[17](r[4])+"",l;return{c(){l=V(e)},l(n){l=P(n,e)},m(n,t){b(n,l,t)},p(n,t){t[0]&16&&e!==(e=n[17](n[4])+"")&&Q(l,e)},d(n){n&&_(l)}}}function Ut(r){let e,l,n;return l=new Jn({}),{c(){e=M("div"),x(l.$$.fragment),this.h()},l(t){e=I(t,"DIV",{class:!0});var s=D(e);ee(l.$$.fragment,s),s.forEach(_),this.h()},h(){u(e,"class","emoji-menu svelte-11kuk8h")},m(t,s){b(t,e,s),te(l,e,null),n=!0},i(t){n||(k(l.$$.fragment,t),n=!0)},o(t){$(l.$$.fragment,t),n=!1},d(t){t&&_(e),le(l)}}}function tr(r){let e,l,n,t,s,i,c,o,a,d,f,h,g,B,C,w,y,N,A,T,S,W,ce,de,U={ctx:r,current:null,token:null,hasCatch:!1,pending:Zn,then:Yn,catch:Qn,blocks:[,,,]};ie(n=r[2],U);let q=r[0]!=null&&r[0].length!=0&&It(r),K=fe(r[6]),O=[];for(let F=0;F<K.length;F+=1)O[F]=Ct($t(r,K,F));const be=F=>$(O[F],1,1,()=>{O[F]=null});let me=fe(r[4]),z=[];for(let F=0;F<me.length;F+=1)z[F]=Tt(wt(r,me,F));const Me=F=>$(z[F],1,1,()=>{z[F]=null});let ne=r[4].length!=0&&Nt(r),re=r[9]&&Ut();g=new ll({});function qe(F){r[24](F)}let Ae={sendTypingEvents:r[3]["jolt:send-typing-indicators"],placeholder:"Send message in "+r[5]};return r[7]!==void 0&&(Ae.value=r[7]),C=new Pt({props:Ae}),Se.push(()=>Le(C,"value",qe)),S=new qn({}),{c(){e=M("main"),l=M("div"),U.block.c(),t=G(),q&&q.c(),s=G();for(let F=0;F<O.length;F+=1)O[F].c();i=G(),c=M("div");for(let F=0;F<z.length;F+=1)z[F].c();o=G(),ne&&ne.c(),a=G(),re&&re.c(),d=G(),f=M("form"),h=M("button"),x(g.$$.fragment),B=G(),x(C.$$.fragment),y=G(),N=M("div"),A=G(),T=M("button"),x(S.$$.fragment),this.h()},l(F){e=I(F,"MAIN",{class:!0});var p=D(e);l=I(p,"DIV",{class:!0});var j=D(l);U.block.l(j),j.forEach(_),t=R(p),q&&q.l(p),s=R(p);for(let ve=0;ve<O.length;ve+=1)O[ve].l(p);i=R(p),c=I(p,"DIV",{class:!0});var E=D(c);for(let ve=0;ve<z.length;ve+=1)z[ve].l(E);o=R(E),ne&&ne.l(E),E.forEach(_),a=R(p),re&&re.l(p),d=R(p),f=I(p,"FORM",{class:!0,id:!0});var H=D(f);h=I(H,"BUTTON",{class:!0});var pe=D(h);ee(g.$$.fragment,pe),pe.forEach(_),B=R(H),ee(C.$$.fragment,H),y=R(H),N=I(H,"DIV",{class:!0}),D(N).forEach(_),A=R(H),T=I(H,"BUTTON",{type:!0,class:!0});var ye=D(T);ee(S.$$.fragment,ye),ye.forEach(_),H.forEach(_),p.forEach(_),this.h()},h(){u(l,"class","messages-list svelte-11kuk8h"),u(c,"class","typing-indicator svelte-11kuk8h"),We(c,"transparent-color",r[4].length==0),u(h,"class","default-button"),u(N,"class","flex-divider"),u(T,"type","button"),u(T,"class","default-button"),u(f,"class","message-form"),u(f,"id","send-message-form"),u(e,"class","main-content-container svelte-11kuk8h")},m(F,p){b(F,e,p),v(e,l),U.block.m(l,U.anchor=null),U.mount=()=>l,U.anchor=null,r[22](l),v(e,t),q&&q.m(e,null),v(e,s);for(let j=0;j<O.length;j+=1)O[j]&&O[j].m(e,null);v(e,i),v(e,c);for(let j=0;j<z.length;j+=1)z[j]&&z[j].m(c,null);v(c,o),ne&&ne.m(c,null),v(e,a),re&&re.m(e,null),v(e,d),v(e,f),v(f,h),te(g,h,null),v(f,B),te(C,f,null),v(f,y),v(f,N),v(f,A),v(f,T),te(S,T,null),W=!0,ce||(de=[oe(h,"click",r[16]),oe(T,"click",r[25]),oe(f,"submit",r[15])],ce=!0)},p(F,p){if(r=F,U.ctx=r,p[0]&4&&n!==(n=r[2])&&ie(n,U)||ke(U,r,p),r[0]!=null&&r[0].length!=0?q?(q.p(r,p),p[0]&1&&k(q,1)):(q=It(r),q.c(),k(q,1),q.m(e,s)):q&&(Y(),$(q,1,1,()=>{q=null}),Z()),p[0]&64){K=fe(r[6]);let E;for(E=0;E<K.length;E+=1){const H=$t(r,K,E);O[E]?(O[E].p(H,p),k(O[E],1)):(O[E]=Ct(H),O[E].c(),k(O[E],1),O[E].m(e,i))}for(Y(),E=K.length;E<O.length;E+=1)be(E);Z()}if(p[0]&24){me=fe(r[4]);let E;for(E=0;E<me.length;E+=1){const H=wt(r,me,E);z[E]?(z[E].p(H,p),k(z[E],1)):(z[E]=Tt(H),z[E].c(),k(z[E],1),z[E].m(c,o))}for(Y(),E=me.length;E<z.length;E+=1)Me(E);Z()}r[4].length!=0?ne?ne.p(r,p):(ne=Nt(r),ne.c(),ne.m(c,null)):ne&&(ne.d(1),ne=null),(!W||p[0]&16)&&We(c,"transparent-color",r[4].length==0),r[9]?re?p[0]&512&&k(re,1):(re=Ut(),re.c(),k(re,1),re.m(e,d)):re&&(Y(),$(re,1,1,()=>{re=null}),Z());const j={};p[0]&8&&(j.sendTypingEvents=r[3]["jolt:send-typing-indicators"]),p[0]&32&&(j.placeholder="Send message in "+r[5]),!w&&p[0]&128&&(w=!0,j.value=r[7],Re(()=>w=!1)),C.$set(j)},i(F){if(!W){k(U.block),k(q);for(let p=0;p<K.length;p+=1)k(O[p]);for(let p=0;p<me.length;p+=1)k(z[p]);k(re),k(g.$$.fragment,F),k(C.$$.fragment,F),k(S.$$.fragment,F),W=!0}},o(F){for(let p=0;p<3;p+=1){const j=U.blocks[p];$(j)}$(q),O=O.filter(Boolean);for(let p=0;p<O.length;p+=1)$(O[p]);z=z.filter(Boolean);for(let p=0;p<z.length;p+=1)$(z[p]);$(re),$(g.$$.fragment,F),$(C.$$.fragment,F),$(S.$$.fragment,F),W=!1},d(F){F&&_(e),U.block.d(),U.token=null,U=null,r[22](null),q&&q.d(),$e(O,F),$e(z,F),ne&&ne.d(),re&&re.d(),le(g),le(C),le(S),ce=!1,Pe(de)}}}const St=r=>r.name;function lr(r,e,l){let n,t,s,i,c,o;se(r,rl,p=>l(21,n=p));let{channel:a}=e,{replies:d=[]}=e,{messageInput:f=""}=e;const h=Ie(f);se(r,h,p=>l(7,s=p)),we(Ot,h);let{files:g=[]}=e;const B=J(je);se(r,B,p=>l(3,i=p));const C=J(Ee),w=Ie(new Array);se(r,w,p=>l(8,c=p));const y=Ie(new Array),N=Ie(new Array),A=Ie(!1);se(r,A,p=>l(9,o=p));const T=Ie(d);se(r,T,p=>l(6,t=p)),we(Ke,w),we(Dt,y),we(ze,N),we(At,T),we(Zt,A),we(jt,a);let S,W=[],ce="Unknown Channel",de=Promise.resolve();async function U(p){if(!p){C.removeAllListeners("ChannelStartTyping"),C.removeAllListeners("ChannelStopTyping");return}C.on("ChannelStartTyping",async({id:j,user:E})=>{var H;if(!(E==((H=C.user)==null?void 0:H._id)||j!=a._id)){for(const{_id:pe}of W)if(E==pe)return;l(4,W[W.length]=await C.api.fetchUser(E),W)}}),C.on("ChannelStopTyping",({id:j,user:E})=>{j==a._id&&l(4,W=W.filter(H=>H._id!=E))})}async function q(){const p=await Promise.all(g.map(j=>C.autumn.uploadFile(j)));l(0,g=[]),await C.api.sendMessage(a._id,{content:s.trim(),replies:t.map(({message:{_id:j},mention:E})=>({id:j,mention:E})),attachments:p}),T.set([]),h.set("")}function K(p){if(p.channel!=a._id)return;const j=S.offsetHeight+S.scrollTop>S.scrollHeight-20;document.hasFocus()&&j&&C.api.ackMessage(a._id,p._id),w.update(E=>(E.push(p),E)),j&&Xe().then(()=>S.scrollTo(0,S.scrollHeight))}function O({id:p,channel:j}){j==a._id&&w.update(E=>E.filter(H=>H._id!=p))}function be({id:p,channel:j,data:E}){j==a._id&&w.update(H=>{const pe=H.findIndex(ve=>ve._id==p),ye=H[pe];return E.content!=null&&(ye.content=E.content),E.embeds!=null&&(ye.embeds=E.embeds),ye.edited=E.edited,H[pe]=ye,H})}function me(p){var j;if(((j=p.clipboardData)==null?void 0:j.files)!=null&&p.clipboardData.files.length!=0){p.preventDefault();const E=Array.from(p.clipboardData.files);l(0,g=(g==null?void 0:g.concat(E))??E)}}function z(){const p=document.createElement("input");p.type="file",p.onchange=j=>{const E=j;E.target.files!=null&&l(0,g=g.concat(Array.from(E.target.files)))},p.click()}Jt(()=>{C.on("Message",K),C.on("MessageDelete",O),C.on("MessageUpdate",be),document.addEventListener("paste",me)}),Qt(()=>{C.removeListener("Message",K),C.removeListener("MessageDelete",O),C.removeListener("MessageUpdate",be),document.removeEventListener("paste",me)});async function Me(p){var j;if(p.channel_type=="TextChannel"||p.channel_type=="Group"){l(5,ce=`#${p.name}`);return}if(p.channel_type=="SavedMessages"){l(5,ce="Saved Notes");return}try{l(5,ce=`@${ae(await C.api.fetchUser(p.recipients[0]==((j=C.user)==null?void 0:j._id)?p.recipients[1]:p.recipients[0]))}`)}catch{l(5,ce="Unknown Channel")}}function ne(p){if(p.length==0)throw new Error("function called with an array of length 0");const j=p.map(E=>ae(E));return j.length==1?`${j[0]} is typing...`:j.length>=5?"Several users are typing...":`${j.slice(0,j.length-1).join(", ")} and ${j[j.length-1]} are typing...`}function re(p){Se[p?"unshift":"push"](()=>{S=p,l(1,S)})}const qe=()=>l(0,g=[]);function Ae(p){s=p,h.set(s)}const F=()=>A.update(p=>!p);return r.$$set=p=>{"channel"in p&&l(18,a=p.channel),"replies"in p&&l(19,d=p.replies),"messageInput"in p&&l(20,f=p.messageInput),"files"in p&&l(0,g=p.files)},r.$$.update=()=>{if(r.$$.dirty[0]&262150){const p=J(xt);l(2,de=C.api.queryMessages(a._id,{sort:"Latest",include_users:!0,limit:100,nearby:p}).then(j=>{if(Array.isArray(j)){let E;p==null?E=j.reverse():E=j.sort((H,pe)=>H._id.localeCompare(pe._id)),w.set(E)}else{let E;p==null?E=j.messages.reverse():E=j.messages.sort((H,pe)=>H._id.localeCompare(pe._id)),w.set(E),N.set(j.users),y.set(j.members??[])}})),T.set([]),l(4,W=[]),de.then(()=>{Xe().then(()=>S.scrollTo(0,S.scrollHeight))})}if(r.$$.dirty[0]&8&&U(i["jolt:receive-typing-indicators"]),r.$$.dirty[0]&262144&&Me(a),r.$$.dirty[0]&2097152){const p=document.getElementById(`MESSAGE-${n.url.hash.slice(1)}`);p==null||p.animate([{backgroundColor:"var(--mention)"},{backgroundColor:"var(--mention)",offset:.6},{backgroundColor:"transparent"}],{duration:3e3,iterations:1})}},[g,S,de,i,W,ce,t,s,c,o,h,B,w,A,T,q,z,ne,a,d,f,n,re,qe,Ae,F]}class vr extends _e{constructor(e){super(),he(this,e,lr,tr,ue,{channel:18,replies:19,messageInput:20,files:0},null,[-1,-1])}}export{vr as T};
