import{s as q,v as ue,f as O,g as V,h as E,d as p,j as i,i as j,z as C,A as de,w as fe,x as he,y as me,B as _e,C as K,D as U,u as b,a as N,c as A,r as X,o as pe,E as ge,e as J,F as ve,G as Y,l as be,m as $e,n as ke}from"../chunks/scheduler.e5faf66b.js";import{h as we,u as Se}from"../chunks/await_block.61db03c9.js";import{e as te}from"../chunks/each.e59479a4.js";import{S as P,i as F,a as $,t as w,b as H,d as B,m as R,c as Z,e as W,g as x}from"../chunks/index.fd37aab3.js";import{g as Ie}from"../chunks/navigation.016ca755.js";import{b as z}from"../chunks/paths.16ac5fdf.js";import{g as re,s as se,a as ye,c as je}from"../chunks/context.634f79ee.js";import{g as De,a as le}from"../chunks/util.650f29ea.js";import{t as Ce,P as Ee}from"../chunks/PlusIcon.9f49faf8.js";import{s as Oe,a as Ve}from"../chunks/context.fa34f1f8.js";import{w as ne}from"../chunks/index.586d49f4.js";import{p as Le}from"../chunks/stores.2748c692.js";function Me(n){let e,s,t,r,a,l,o;const c=n[5].default,f=ue(c,n,n[4],null);return{c(){e=O("div"),s=O("a"),f&&f.c(),this.h()},l(u){e=V(u,"DIV",{class:!0,"data-selected":!0,"aria-selected":!0});var g=E(e);s=V(g,"A",{href:!0,tabindex:!0,"aria-label":!0,class:!0});var D=E(s);f&&f.l(D),D.forEach(p),g.forEach(p),this.h()},h(){i(s,"href",n[0]),i(s,"tabindex","0"),i(s,"aria-label",t=typeof n[1]=="string"&&n[2]!=null?n[1]:n[2]),i(s,"class","server-sidebar-icon svelte-z9k92b"),i(e,"class","server-sidebar-icon-base svelte-z9k92b"),i(e,"data-selected",n[3]),i(e,"aria-selected",n[3])},m(u,g){j(u,e,g),C(e,s),f&&f.m(s,null),a=!0,l||(o=de(r=Ce.call(null,s,{placement:"right",content:n[1],theme:"server-sidebar-icon",animation:"scale-subtle",duration:100,onShow:n[6]})),l=!0)},p(u,[g]){f&&f.p&&(!a||g&16)&&fe(f,c,u,u[4],a?me(c,u[4],g,null):he(u[4]),null),(!a||g&1)&&i(s,"href",u[0]),(!a||g&6&&t!==(t=typeof u[1]=="string"&&u[2]!=null?u[1]:u[2]))&&i(s,"aria-label",t),r&&_e(r.update)&&g&2&&r.update.call(null,{placement:"right",content:u[1],theme:"server-sidebar-icon",animation:"scale-subtle",duration:100,onShow:u[6]}),(!a||g&8)&&i(e,"data-selected",u[3]),(!a||g&8)&&i(e,"aria-selected",u[3])},i(u){a||($(f,u),a=!0)},o(u){w(f,u),a=!1},d(u){u&&p(e),f&&f.d(u),l=!1,o()}}}function Ne(n,e,s){let{$$slots:t={},$$scope:r}=e,{href:a}=e,{tooltip:l}=e,{ariaLabel:o=void 0}=e,{selected:c}=e;const f=function(){if(!l)return!1};return n.$$set=u=>{"href"in u&&s(0,a=u.href),"tooltip"in u&&s(1,l=u.tooltip),"ariaLabel"in u&&s(2,o=u.ariaLabel),"selected"in u&&s(3,c=u.selected),"$$scope"in u&&s(4,r=u.$$scope)},[a,l,o,c,r,t,f]}class G extends P{constructor(e){super(),F(this,e,Ne,Me,q,{href:0,tooltip:1,ariaLabel:2,selected:3})}}function Ae(n){let e,s;return{c(){e=K("svg"),s=K("path"),this.h()},l(t){e=U(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var r=E(e);s=U(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(s).forEach(p),r.forEach(p),this.h()},h(){i(s,"stroke-linecap","round"),i(s,"stroke-linejoin","round"),i(s,"d","M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),i(e,"xmlns","http://www.w3.org/2000/svg"),i(e,"fill","none"),i(e,"viewBox","0 0 24 24"),i(e,"stroke-width","1.5"),i(e,"stroke","currentColor"),i(e,"width","24px"),i(e,"height","24px")},m(t,r){j(t,e,r),C(e,s)},p:b,i:b,o:b,d(t){t&&p(e)}}}class He extends P{constructor(e){super(),F(this,e,null,Ae,q,{})}}function Be(n){let e,s,t;return{c(){e=K("svg"),s=K("path"),t=K("path"),this.h()},l(r){e=U(r,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var a=E(e);s=U(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(s).forEach(p),t=U(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),E(t).forEach(p),a.forEach(p),this.h()},h(){i(s,"stroke-linecap","round"),i(s,"stroke-linejoin","round"),i(s,"d","M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"),i(t,"stroke-linecap","round"),i(t,"stroke-linejoin","round"),i(t,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),i(e,"xmlns","http://www.w3.org/2000/svg"),i(e,"fill","none"),i(e,"viewBox","0 0 24 24"),i(e,"stroke-width","1.5"),i(e,"stroke","currentColor"),i(e,"width","24px"),i(e,"height","24px")},m(r,a){j(r,e,a),C(e,s),C(e,t)},p:b,i:b,o:b,d(r){r&&p(e)}}}class Re extends P{constructor(e){super(),F(this,e,null,Be,q,{})}}function ae(n,e,s){const t=n.slice();return t[10]=e[s],t}function We(n){let e,s,t={ctx:n,current:null,token:null,hasCatch:!1,pending:Je,then:Ue,catch:Ke,value:13,blocks:[,,,]};return we(n[5].user??n[5].api.fetchUser("@me"),t),{c(){e=J(),t.block.c()},l(r){e=J(),t.block.l(r)},m(r,a){j(r,e,a),t.block.m(r,t.anchor=a),t.mount=()=>e.parentNode,t.anchor=e,s=!0},p(r,a){n=r,Se(t,n,a)},i(r){s||($(t.block),s=!0)},o(r){for(let a=0;a<3;a+=1){const l=t.blocks[a];w(l)}s=!1},d(r){r&&p(e),t.block.d(r),t.token=null,t=null}}}function ze(n){var a;let e,s,t,r;return e=new G({props:{selected:((a=n[3].route.id)==null?void 0:a.startsWith("/(app)/(home)"))??!1,href:z+"/",tooltip:"Home",$$slots:{default:[qe]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment),s=N(),t=O("hr"),this.h()},l(l){B(e.$$.fragment,l),s=A(l),t=V(l,"HR",{class:!0}),this.h()},h(){i(t,"class","border-gray-600 mx-4")},m(l,o){R(e,l,o),j(l,s,o),j(l,t,o),r=!0},p(l,o){var f;const c={};o&8&&(c.selected=((f=l[3].route.id)==null?void 0:f.startsWith("/(app)/(home)"))??!1),o&256&&(c.$$scope={dirty:o,ctx:l}),e.$set(c)},i(l){r||($(e.$$.fragment,l),r=!0)},o(l){w(e.$$.fragment,l),r=!1},d(l){l&&(p(s),p(t)),W(e,l)}}}function Ke(n){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function Ue(n){var a;let e,s,t,r;return e=new G({props:{href:z+"/",selected:((a=n[3].route.id)==null?void 0:a.startsWith("/(app)/(home)"))??!1,ariaLabel:"Home",tooltip:n[13].username+"#"+n[13].discriminator,$$slots:{default:[Ge]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment),s=N(),t=O("hr"),this.h()},l(l){B(e.$$.fragment,l),s=A(l),t=V(l,"HR",{class:!0}),this.h()},h(){i(t,"class","border-gray-600 mx-4")},m(l,o){R(e,l,o),j(l,s,o),j(l,t,o),r=!0},p(l,o){var f;const c={};o&8&&(c.selected=((f=l[3].route.id)==null?void 0:f.startsWith("/(app)/(home)"))??!1),o&256&&(c.$$scope={dirty:o,ctx:l}),e.$set(c)},i(l){r||($(e.$$.fragment,l),r=!0)},o(l){w(e.$$.fragment,l),r=!1},d(l){l&&(p(s),p(t)),W(e,l)}}}function Ge(n){let e,s;return{c(){e=O("img"),this.h()},l(t){e=V(t,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){i(e,"class","cover"),Y(e.src,s=De(n[13]))||i(e,"src",s),i(e,"alt","Home"),i(e,"width","48px"),i(e,"height","48px")},m(t,r){j(t,e,r)},p:b,d(t){t&&p(e)}}}function Je(n){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function qe(n){let e,s;return e=new He({}),{c(){H(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){R(e,t,r),s=!0},i(t){s||($(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){W(e,t)}}}function oe(n){let e,s,t=te(n[0]),r=[];for(let l=0;l<t.length;l+=1)r[l]=ie(ae(n,t,l));const a=l=>w(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=J()},l(l){for(let o=0;o<r.length;o+=1)r[o].l(l);e=J()},m(l,o){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(l,o);j(l,e,o),s=!0},p(l,o){if(o&7){t=te(l[0]);let c;for(c=0;c<t.length;c+=1){const f=ae(l,t,c);r[c]?(r[c].p(f,o),$(r[c],1)):(r[c]=ie(f),r[c].c(),$(r[c],1),r[c].m(e.parentNode,e))}for(x(),c=t.length;c<r.length;c+=1)a(c);Z()}},i(l){if(!s){for(let o=0;o<t.length;o+=1)$(r[o]);s=!0}},o(l){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)w(r[o]);s=!1},d(l){l&&p(e),ve(r,l)}}}function Pe(n){let e,s,t;return{c(){e=O("img"),this.h()},l(r){e=V(r,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){i(e,"class","cover"),Y(e.src,s=le(n[10].icon,{max_side:"256"}))||i(e,"src",s),i(e,"alt",t=n[10].name),i(e,"width","48px"),i(e,"height","48px")},m(r,a){j(r,e,a)},p(r,a){a&1&&!Y(e.src,s=le(r[10].icon,{max_side:"256"}))&&i(e,"src",s),a&1&&t!==(t=r[10].name)&&i(e,"alt",t)},d(r){r&&p(e)}}}function Fe(n){let e=n[10].name.split(" ").map(ce).join("")+"",s;return{c(){s=be(e)},l(t){s=$e(t,e)},m(t,r){j(t,s,r)},p(t,r){r&1&&e!==(e=t[10].name.split(" ").map(ce).join("")+"")&&ke(s,e)},d(t){t&&p(s)}}}function Te(n){let e;function s(a,l){return a[10].icon==null||a[2]["jolt:low-data-mode"]?Fe:Pe}let t=s(n),r=t(n);return{c(){r.c(),e=N()},l(a){r.l(a),e=A(a)},m(a,l){r.m(a,l),j(a,e,l)},p(a,l){t===(t=s(a))&&r?r.p(a,l):(r.d(1),r=t(a),r&&(r.c(),r.m(e.parentNode,e)))},d(a){a&&p(e),r.d(a)}}}function ie(n){let e,s;return e=new G({props:{href:z+"/servers/"+n[10]._id+"/channels/"+n[10].channels[0],tooltip:n[10].name,selected:n[1]==n[10]._id,$$slots:{default:[Te]},$$scope:{ctx:n}}}),{c(){H(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){R(e,t,r),s=!0},p(t,r){const a={};r&1&&(a.href=z+"/servers/"+t[10]._id+"/channels/"+t[10].channels[0]),r&1&&(a.tooltip=t[10].name),r&3&&(a.selected=t[1]==t[10]._id),r&261&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){s||($(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){W(e,t)}}}function Qe(n){let e,s;return e=new Ee({}),{c(){H(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){R(e,t,r),s=!0},i(t){s||($(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){W(e,t)}}}function Xe(n){let e,s;return e=new Re({}),{c(){H(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){R(e,t,r),s=!0},i(t){s||($(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){W(e,t)}}}function Ye(n){var M;let e,s,t,r,a,l,o,c,f,u,g,D,d;const L=[ze,We],S=[];function k(m,v){return m[2]["jolt:low-data-mode"]?0:1}t=k(n),r=S[t]=L[t](n);let h=n[0]!=null&&oe(n);o=new G({props:{selected:n[3].route.id=="/(app)/servers/create",href:z+"/servers/create",tooltip:"Create Server",$$slots:{default:[Qe]},$$scope:{ctx:n}}}),g=new G({props:{selected:((M=n[3].route.id)==null?void 0:M.startsWith("/(app)/settings"))??!1,href:z+"/settings",tooltip:"Settings",$$slots:{default:[Xe]},$$scope:{ctx:n}}});const I=n[7].default,_=ue(I,n,n[8],null);return{c(){e=O("div"),s=O("div"),r.c(),a=N(),h&&h.c(),l=N(),H(o.$$.fragment),c=N(),f=O("div"),u=N(),H(g.$$.fragment),D=N(),_&&_.c(),this.h()},l(m){e=V(m,"DIV",{class:!0});var v=E(e);s=V(v,"DIV",{class:!0});var y=E(s);r.l(y),a=A(y),h&&h.l(y),l=A(y),B(o.$$.fragment,y),c=A(y),f=V(y,"DIV",{class:!0}),E(f).forEach(p),u=A(y),B(g.$$.fragment,y),y.forEach(p),D=A(v),_&&_.l(v),v.forEach(p),this.h()},h(){i(f,"class","flex-1"),i(s,"class","server-sidebar-container svelte-10y9f05"),i(e,"class","app-container svelte-10y9f05")},m(m,v){j(m,e,v),C(e,s),S[t].m(s,null),C(s,a),h&&h.m(s,null),C(s,l),R(o,s,null),C(s,c),C(s,f),C(s,u),R(g,s,null),C(e,D),_&&_.m(e,null),d=!0},p(m,[v]){var ee;let y=t;t=k(m),t===y?S[t].p(m,v):(x(),w(S[y],1,1,()=>{S[y]=null}),Z(),r=S[t],r?r.p(m,v):(r=S[t]=L[t](m),r.c()),$(r,1),r.m(s,a)),m[0]!=null?h?(h.p(m,v),v&1&&$(h,1)):(h=oe(m),h.c(),$(h,1),h.m(s,l)):h&&(x(),w(h,1,1,()=>{h=null}),Z());const T={};v&8&&(T.selected=m[3].route.id=="/(app)/servers/create"),v&256&&(T.$$scope={dirty:v,ctx:m}),o.$set(T);const Q={};v&8&&(Q.selected=((ee=m[3].route.id)==null?void 0:ee.startsWith("/(app)/settings"))??!1),v&256&&(Q.$$scope={dirty:v,ctx:m}),g.$set(Q),_&&_.p&&(!d||v&256)&&fe(_,I,m,m[8],d?me(I,m[8],v,null):he(m[8]),null)},i(m){d||($(r),$(h),$(o.$$.fragment,m),$(g.$$.fragment,m),$(_,m),d=!0)},o(m){w(r),w(h),w(o.$$.fragment,m),w(g.$$.fragment,m),w(_,m),d=!1},d(m){m&&p(e),S[t].d(),h&&h.d(),W(o),W(g),_&&_.d(m)}}}const ce=n=>n[0];function Ze(n,e,s){let t,r,a;X(n,Le,d=>s(3,a=d));let{$$slots:l={},$$scope:o}=e;const c=re(ye);X(n,c,d=>s(2,r=d));const f=re(je),u=ne();X(n,u,d=>s(1,t=d));const g=ne();se(Oe,g),se(Ve,u);let D=Array.from(f.api.cache.servers.values());return c.subscribe(d=>{s(0,D=D.sort((L,S)=>{var I,_;const k=((I=d.ordering.servers)==null?void 0:I.indexOf(L._id))??-1,h=((_=d.ordering.servers)==null?void 0:_.indexOf(S._id))??-1;return h==-1?-1:k==-1?1:k-h}))}),f.on("ServerCreate",()=>{s(0,D=Array.from(f.api.cache.servers.values()))}),f.on("ServerDelete",async({id:d})=>{s(0,D=Array.from(f.api.cache.servers.values())),t==d&&await Ie(`${z}/`)}),f.on("Ready",d=>{s(0,D=d.servers)}),pe(async()=>{const d=ge(c);for(const k of Object.keys(d)){const h=localStorage.getItem(k);h!=null&&(d[k]=JSON.parse(h))}const L=await f.api.fetchSettings(Object.keys(d)),S={};for(const[k,h]of Object.entries(d)){const I=`revision:${k}`,_=L[k];if(_==null)continue;const[M,m]=_,v=Number(localStorage.getItem(I)??"0");M>=v?(localStorage.setItem(I,M.toString()),localStorage.setItem(k,m),d[k]=JSON.parse(m)):S[k]=h}f.api.setSettings(S),console.log(d),c.set(d)}),f.on("UserSettingsUpdate",({id:d,update:L})=>{var k;if(d!=((k=f.user)==null?void 0:k._id))return;let S={};for(const[h,[I,_]]of Object.entries(L)){const M=`revision:${h}`;I>Number(localStorage.getItem(M))&&(localStorage.setItem(M,I.toString()),localStorage.setItem(h,_),S[h]=JSON.parse(_))}c.update(h=>{for(const[I,_]of Object.entries(S))h[I]=_;return h})}),n.$$set=d=>{"$$scope"in d&&s(8,o=d.$$scope)},[D,t,r,a,c,f,u,l,o]}class ft extends P{constructor(e){super(),F(this,e,Ze,Ye,q,{})}}export{ft as component};
