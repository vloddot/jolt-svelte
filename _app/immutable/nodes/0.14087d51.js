var af=Object.defineProperty;var of=(r,e,t)=>e in r?af(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var T=(r,e,t)=>(of(r,typeof e!="symbol"?e+"":e,t),t),Ii=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var Xe=(r,e,t)=>(Ii(r,e,"read from private field"),t?t.call(r):e.get(r)),mr=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},jt=(r,e,t,s)=>(Ii(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);var Li=(r,e,t)=>(Ii(r,e,"access private method"),t);import{s as cf,c as lc,n as Le,d as df,u as lf,g as uf,e as hf}from"../chunks/scheduler.a21a5cad.js";import{S as pf,i as ff,e as uc,a as mf,d as ml,t as gl,f as gf}from"../chunks/index.4419476b.js";import{h as _f,u as wf}from"../chunks/await_block.7ed97119.js";import{g as _l}from"../chunks/navigation.31235eca.js";import{b as wl}from"../chunks/paths.07194b7e.js";import{g as Gr,c as S,r as yf}from"../chunks/runtime.esm.252c27a7.js";import{s as tn,a as vf,b as bf,c as Sf,v as Rf}from"../chunks/context.898bb4a8.js";import"../chunks/i18n.278a6baa.js";import{D as Tf}from"../chunks/util.8e693f68.js";import{w as Ai}from"../chunks/index.d8292243.js";function Df(r,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in r)){const i=Object.getOwnPropertyDescriptor(s,n);i&&Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}const Cf=!0,Ef=!1,ZR=Object.freeze(Object.defineProperty({__proto__:null,prerender:Cf,ssr:Ef},Symbol.toStringTag,{value:"Module"}));var yl={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(t=!1));function n(u,o,l){this.fn=u,this.context=o,this.once=l||!1}function i(u,o,l,d,h){if(typeof l!="function")throw new TypeError("The listener must be a function");var p=new n(l,d||u,h),f=t?t+o:o;return u._events[f]?u._events[f].fn?u._events[f]=[u._events[f],p]:u._events[f].push(p):(u._events[f]=p,u._eventsCount++),u}function a(u,o){--u._eventsCount===0?u._events=new s:delete u._events[o]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var o=[],l,d;if(this._eventsCount===0)return o;for(d in l=this._events)e.call(l,d)&&o.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(l)):o},c.prototype.listeners=function(o){var l=t?t+o:o,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,p=d.length,f=new Array(p);h<p;h++)f[h]=d[h].fn;return f},c.prototype.listenerCount=function(o){var l=t?t+o:o,d=this._events[l];return d?d.fn?1:d.length:0},c.prototype.emit=function(o,l,d,h,p,f){var w=t?t+o:o;if(!this._events[w])return!1;var g=this._events[w],b=arguments.length,E,M;if(g.fn){switch(g.once&&this.removeListener(o,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,l),!0;case 3:return g.fn.call(g.context,l,d),!0;case 4:return g.fn.call(g.context,l,d,h),!0;case 5:return g.fn.call(g.context,l,d,h,p),!0;case 6:return g.fn.call(g.context,l,d,h,p,f),!0}for(M=1,E=new Array(b-1);M<b;M++)E[M-1]=arguments[M];g.fn.apply(g.context,E)}else{var P=g.length,y;for(M=0;M<P;M++)switch(g[M].once&&this.removeListener(o,g[M].fn,void 0,!0),b){case 1:g[M].fn.call(g[M].context);break;case 2:g[M].fn.call(g[M].context,l);break;case 3:g[M].fn.call(g[M].context,l,d);break;case 4:g[M].fn.call(g[M].context,l,d,h);break;default:if(!E)for(y=1,E=new Array(b-1);y<b;y++)E[y-1]=arguments[y];g[M].fn.apply(g[M].context,E)}}return!0},c.prototype.on=function(o,l,d){return i(this,o,l,d,!1)},c.prototype.once=function(o,l,d){return i(this,o,l,d,!0)},c.prototype.removeListener=function(o,l,d,h){var p=t?t+o:o;if(!this._events[p])return this;if(!l)return a(this,p),this;var f=this._events[p];if(f.fn)f.fn===l&&(!h||f.once)&&(!d||f.context===d)&&a(this,p);else{for(var w=0,g=[],b=f.length;w<b;w++)(f[w].fn!==l||h&&!f[w].once||d&&f[w].context!==d)&&g.push(f[w]);g.length?this._events[p]=g.length===1?g[0]:g:a(this,p)}return this},c.prototype.removeAllListeners=function(o){var l;return o?(l=t?t+o:o,this._events[l]&&a(this,l)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,r.exports=c})(yl);var Mf=yl.exports;const vl=Gr(Mf);class Of{constructor(e){T(this,"cache");T(this,"token");this.cache={channels:[],emojis:[],members:[],servers:[],users:[]},e&&(this.token=e)}async req(e,t,s,n){const i=await fetch(`https://api.revolt.chat${t}`,{method:e,body:n,headers:this.token==null?this.token:{"x-session-token":this.token}});if(i.status==401&&(localStorage.removeItem("session"),await _l(`${wl}/login`)),i.body==null&&s)throw new Error(`expected response from route ${t}, got ${i.status}: ${i.statusText}`);return i.json()}login(e){return this.req("POST","/auth/session/login",!0,JSON.stringify(e))}logout(){return this.req("POST","/auth/session/logout",!1)}deleteSession(e){return this.req("DELETE",`/auth/session/${e}`,!1)}createServer(e){return this.req("POST","/servers/create",!0,JSON.stringify(e))}changeUsername(e,t){return this.req("PATCH","/users/@me/username",!0,JSON.stringify({username:e,password:t}))}joinCall(e){return new Promise((t,s)=>{this.req("POST",`/channels/${e}/join_call`,!0).then(({token:n})=>t(n)).catch(s)})}async fetchChannel(e){var t;return((t=this.cache)==null?void 0:t.channels.find(s=>s._id==e))??this.req("GET",`/channels/${e}`,!0)}fetchDirectMessages(){return this.req("GET","/users/dms",!0)}ackMessage(e,t){return this.req("PUT",`/channels/${e}/ack/${t}`,!1)}async fetchSettings(e){return this.req("POST","/sync/settings/fetch",!0,JSON.stringify({keys:e}))}fetchMembers(e){return this.req("GET",`/servers/${e}/members`,!0)}async fetchMember(e,t,s){var i;const n=()=>this.req("GET",`/servers/${e}/members/${t}`,!0);return s==null?n():((i=this.cache)==null?void 0:i.members.find(a=>a._id.server==e&&a._id.user==s))??n()}fetchMessage(e,t){return this.req("GET",`/channels/${e}/messages/${t}`,!0)}queryMessages(e,t){const s="?"+new URLSearchParams(Object.entries(t).map(([n,i])=>[n,i.toString()]));return this.req("GET",`/channels/${e}/messages${s}`,!0)}sendMessage(e,t){return this.req("POST",`/channels/${e}/messages`,!0,JSON.stringify(t))}editMessage(e,t,s){return this.req("PATCH",`/channels/${e}/messages/${t}`,!0,JSON.stringify(s))}deleteMessage(e,t){return this.req("DELETE",`/channels/${e}/messages/${t}`,!1)}async fetchServer(e){var t;return((t=this.cache)==null?void 0:t.servers.find(s=>s._id==e))??await this.req("GET",`/servers/${e}`,!0)}fetchSessions(){return this.req("GET","/auth/session/all",!0)}async fetchUser(e){var t;return((t=this.cache)==null?void 0:t.users.find(s=>s._id==e))??this.req("GET",`/users/${e}`,!0)}fetchUserProfile(e){return this.req("GET",`/users/${e}/profile`,!0)}}const Pf=30,xf=10;var We,Ts,Ds,ir,pl;let kf=(pl=class extends vl{constructor(){super();mr(this,We,void 0);mr(this,Ts,void 0);mr(this,Ds,void 0);mr(this,ir,"idle")}get connectionState(){return Xe(this,ir)}authenticate(t){jt(this,We,new WebSocket(`wss://ws.revolt.chat?token=${t}`)),jt(this,ir,"connecting"),Xe(this,We).onopen=()=>{jt(this,Ts,setInterval(()=>{this.send({type:"Ping",data:Date.now()}),jt(this,Ds,setTimeout(()=>this.disconnect(),xf*1e3))},Pf*1e3))},Xe(this,We).onmessage=s=>this.handleMessage(JSON.parse(s.data.toString())),Xe(this,We).onclose=()=>this.disconnect()}handleMessage(t){switch(t.type){case"Ping":this.send({type:"Pong",data:t.data});return;case"Pong":clearTimeout(Xe(this,Ds));return;case"Error":this.emit("error",t),this.disconnect();return}switch(this.connectionState){case"connecting":if(t.type=="Ready")this.emit("serverEvent",t),jt(this,ir,"connected");else if(t.type!="Authenticated")throw new Error(`Received ${t.type} event from server in connecting state.`);break;case"connected":if(t.type=="Authenticated"||t.type=="Ready")throw new Error(`Received ${t.type} in connecting state.`);this.emit("serverEvent",t);break;default:throw new Error(`Received ${t.type} in ${this.connectionState} state.`)}}send(t){if(!Xe(this,We))throw new Error("Tried to send WS message when the connection was disconnected.");Xe(this,We).send(JSON.stringify(t))}disconnect(){if(!Xe(this,We))return;clearInterval(Xe(this,Ts));const t=Xe(this,We);jt(this,We,void 0),t.close(),jt(this,ir,"disconnected")}},We=new WeakMap,Ts=new WeakMap,Ds=new WeakMap,ir=new WeakMap,pl);var Cs,Ea,fl;let If=(fl=class extends vl{constructor(){super(...arguments);mr(this,Cs);T(this,"api",new Of);T(this,"websocket",new kf);T(this,"user")}get ready(){return this.api.cache!=null}authenticate(t){this.api.token=t,this.websocket.authenticate(t),this.api.fetchUser("@me").then(s=>this.user=s),this.websocket.on("serverEvent",s=>Li(this,Cs,Ea).call(this,s))}},Cs=new WeakSet,Ea=function(t){switch(t.type){case"Bulk":for(const s of t.v)Li(this,Cs,Ea).call(this,s);break;case"Ready":this.api.cache=t,this.emit("Ready",t);break;case"Message":case"MessageUpdate":case"MessageAppend":case"MessageDelete":case"MessageReact":case"MessageUnreact":case"MessageRemoveReaction":case"BulkMessageDelete":case"ChannelCreate":case"ChannelUpdate":case"ChannelDelete":case"ChannelGroupJoin":case"ChannelGroupLeave":case"ChannelStartTyping":case"ChannelStopTyping":case"ChannelAck":case"ServerCreate":case"ServerUpdate":case"ServerDelete":case"ServerMemberUpdate":case"ServerMemberJoin":case"ServerMemberLeave":case"ServerRoleUpdate":case"ServerRoleDelete":case"UserUpdate":case"UserRelationship":case"UserPresence":case"UserSettingsUpdate":case"UserPlatformWipe":case"EmojiCreate":case"EmojiDelete":case"Auth":this.emit(t.type,t);break}},fl);var Un={},Ma={exports:{}},Ni,hc;function Lf(){if(hc)return Ni;hc=1;var r=1e3,e=r*60,t=e*60,s=t*24,n=s*7,i=s*365.25;Ni=function(l,d){d=d||{};var h=typeof l;if(h==="string"&&l.length>0)return a(l);if(h==="number"&&isFinite(l))return d.long?u(l):c(l);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(l))};function a(l){if(l=String(l),!(l.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(l);if(d){var h=parseFloat(d[1]),p=(d[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return h*i;case"weeks":case"week":case"w":return h*n;case"days":case"day":case"d":return h*s;case"hours":case"hour":case"hrs":case"hr":case"h":return h*t;case"minutes":case"minute":case"mins":case"min":case"m":return h*e;case"seconds":case"second":case"secs":case"sec":case"s":return h*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function c(l){var d=Math.abs(l);return d>=s?Math.round(l/s)+"d":d>=t?Math.round(l/t)+"h":d>=e?Math.round(l/e)+"m":d>=r?Math.round(l/r)+"s":l+"ms"}function u(l){var d=Math.abs(l);return d>=s?o(l,d,s,"day"):d>=t?o(l,d,t,"hour"):d>=e?o(l,d,e,"minute"):d>=r?o(l,d,r,"second"):l+" ms"}function o(l,d,h,p){var f=d>=h*1.5;return Math.round(l/h)+" "+p+(f?"s":"")}return Ni}function Af(r){t.debug=t,t.default=t,t.coerce=u,t.disable=i,t.enable=n,t.enabled=a,t.humanize=Lf(),t.destroy=o,Object.keys(r).forEach(l=>{t[l]=r[l]}),t.names=[],t.skips=[],t.formatters={};function e(l){let d=0;for(let h=0;h<l.length;h++)d=(d<<5)-d+l.charCodeAt(h),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(l){let d,h=null,p,f;function w(...g){if(!w.enabled)return;const b=w,E=Number(new Date),M=E-(d||E);b.diff=M,b.prev=d,b.curr=E,d=E,g[0]=t.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");let P=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,(D,Z)=>{if(D==="%%")return"%";P++;const ae=t.formatters[Z];if(typeof ae=="function"){const Me=g[P];D=ae.call(b,Me),g.splice(P,1),P--}return D}),t.formatArgs.call(b,g),(b.log||t.log).apply(b,g)}return w.namespace=l,w.useColors=t.useColors(),w.color=t.selectColor(l),w.extend=s,w.destroy=t.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==t.namespaces&&(p=t.namespaces,f=t.enabled(l)),f),set:g=>{h=g}}),typeof t.init=="function"&&t.init(w),w}function s(l,d){const h=t(this.namespace+(typeof d>"u"?":":d)+l);return h.log=this.log,h}function n(l){t.save(l),t.namespaces=l,t.names=[],t.skips=[];let d;const h=(typeof l=="string"?l:"").split(/[\s,]+/),p=h.length;for(d=0;d<p;d++)h[d]&&(l=h[d].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.slice(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function i(){const l=[...t.names.map(c),...t.skips.map(c).map(d=>"-"+d)].join(",");return t.enable(""),l}function a(l){if(l[l.length-1]==="*")return!0;let d,h;for(d=0,h=t.skips.length;d<h;d++)if(t.skips[d].test(l))return!1;for(d=0,h=t.names.length;d<h;d++)if(t.names[d].test(l))return!0;return!1}function c(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function u(l){return l instanceof Error?l.stack||l.message:l}function o(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var Nf=Af;(function(r,e){e.formatArgs=s,e.save=n,e.load=i,e.useColors=t,e.storage=a(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function s(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const o="color: "+this.color;u.splice(1,0,o,"color: inherit");let l=0,d=0;u[0].replace(/%[a-zA-Z%]/g,h=>{h!=="%%"&&(l++,h==="%c"&&(d=l))}),u.splice(d,0,o)}e.log=console.debug||console.log||(()=>{});function n(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function i(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u={}.DEBUG),u}function a(){try{return localStorage}catch{}}r.exports=Nf(e);const{formatters:c}=r.exports;c.j=function(u){try{return JSON.stringify(u)}catch(o){return"[UnexpectedJSONParseError]: "+o.message}}})(Ma,Ma.exports);var Bn=Ma.exports,cr={},bl={exports:{}};(function(r,e){(function(t,s){r.exports=s()})(S,function(){return function(t){var s={};function n(i){if(s[i])return s[i].exports;var a=s[i]={i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=s,n.d=function(i,a,c){n.o(i,a)||Object.defineProperty(i,a,{enumerable:!0,get:c})},n.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,a){if(1&a&&(i=n(i)),8&a||4&a&&typeof i=="object"&&i&&i.__esModule)return i;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:i}),2&a&&typeof i!="string")for(var u in i)n.d(c,u,(function(o){return i[o]}).bind(null,u));return c},n.n=function(i){var a=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(a,"a",a),a},n.o=function(i,a){return Object.prototype.hasOwnProperty.call(i,a)},n.p="",n(n.s=90)}({17:function(t,s,n){s.__esModule=!0,s.default=void 0;var i=n(18),a=function(){function c(){}return c.getFirstMatch=function(u,o){var l=o.match(u);return l&&l.length>0&&l[1]||""},c.getSecondMatch=function(u,o){var l=o.match(u);return l&&l.length>1&&l[2]||""},c.matchAndReturnConst=function(u,o,l){if(u.test(o))return l},c.getWindowsVersionName=function(u){switch(u){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},c.getMacOSVersionName=function(u){var o=u.split(".").splice(0,2).map(function(l){return parseInt(l,10)||0});if(o.push(0),o[0]===10)switch(o[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},c.getAndroidVersionName=function(u){var o=u.split(".").splice(0,2).map(function(l){return parseInt(l,10)||0});if(o.push(0),!(o[0]===1&&o[1]<5))return o[0]===1&&o[1]<6?"Cupcake":o[0]===1&&o[1]>=6?"Donut":o[0]===2&&o[1]<2?"Eclair":o[0]===2&&o[1]===2?"Froyo":o[0]===2&&o[1]>2?"Gingerbread":o[0]===3?"Honeycomb":o[0]===4&&o[1]<1?"Ice Cream Sandwich":o[0]===4&&o[1]<4?"Jelly Bean":o[0]===4&&o[1]>=4?"KitKat":o[0]===5?"Lollipop":o[0]===6?"Marshmallow":o[0]===7?"Nougat":o[0]===8?"Oreo":o[0]===9?"Pie":void 0},c.getVersionPrecision=function(u){return u.split(".").length},c.compareVersions=function(u,o,l){l===void 0&&(l=!1);var d=c.getVersionPrecision(u),h=c.getVersionPrecision(o),p=Math.max(d,h),f=0,w=c.map([u,o],function(g){var b=p-c.getVersionPrecision(g),E=g+new Array(b+1).join(".0");return c.map(E.split("."),function(M){return new Array(20-M.length).join("0")+M}).reverse()});for(l&&(f=p-Math.min(d,h)),p-=1;p>=f;){if(w[0][p]>w[1][p])return 1;if(w[0][p]===w[1][p]){if(p===f)return 0;p-=1}else if(w[0][p]<w[1][p])return-1}},c.map=function(u,o){var l,d=[];if(Array.prototype.map)return Array.prototype.map.call(u,o);for(l=0;l<u.length;l+=1)d.push(o(u[l]));return d},c.find=function(u,o){var l,d;if(Array.prototype.find)return Array.prototype.find.call(u,o);for(l=0,d=u.length;l<d;l+=1){var h=u[l];if(o(h,l))return h}},c.assign=function(u){for(var o,l,d=u,h=arguments.length,p=new Array(h>1?h-1:0),f=1;f<h;f++)p[f-1]=arguments[f];if(Object.assign)return Object.assign.apply(Object,[u].concat(p));var w=function(){var g=p[o];typeof g=="object"&&g!==null&&Object.keys(g).forEach(function(b){d[b]=g[b]})};for(o=0,l=p.length;o<l;o+=1)w();return u},c.getBrowserAlias=function(u){return i.BROWSER_ALIASES_MAP[u]},c.getBrowserTypeByAlias=function(u){return i.BROWSER_MAP[u]||""},c}();s.default=a,t.exports=s.default},18:function(t,s,n){s.__esModule=!0,s.ENGINE_MAP=s.OS_MAP=s.PLATFORMS_MAP=s.BROWSER_MAP=s.BROWSER_ALIASES_MAP=void 0,s.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},s.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},s.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},s.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},s.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(t,s,n){s.__esModule=!0,s.default=void 0;var i,a=(i=n(91))&&i.__esModule?i:{default:i},c=n(18);function u(l,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(l,p.key,p)}}var o=function(){function l(){}var d,h,p;return l.getParser=function(f,w){if(w===void 0&&(w=!1),typeof f!="string")throw new Error("UserAgent should be a string");return new a.default(f,w)},l.parse=function(f){return new a.default(f).getResult()},d=l,p=[{key:"BROWSER_MAP",get:function(){return c.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return c.ENGINE_MAP}},{key:"OS_MAP",get:function(){return c.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return c.PLATFORMS_MAP}}],(h=null)&&u(d.prototype,h),p&&u(d,p),l}();s.default=o,t.exports=s.default},91:function(t,s,n){s.__esModule=!0,s.default=void 0;var i=l(n(92)),a=l(n(93)),c=l(n(94)),u=l(n(95)),o=l(n(17));function l(h){return h&&h.__esModule?h:{default:h}}var d=function(){function h(f,w){if(w===void 0&&(w=!1),f==null||f==="")throw new Error("UserAgent parameter can't be empty");this._ua=f,this.parsedResult={},w!==!0&&this.parse()}var p=h.prototype;return p.getUA=function(){return this._ua},p.test=function(f){return f.test(this._ua)},p.parseBrowser=function(){var f=this;this.parsedResult.browser={};var w=o.default.find(i.default,function(g){if(typeof g.test=="function")return g.test(f);if(g.test instanceof Array)return g.test.some(function(b){return f.test(b)});throw new Error("Browser's test function is not valid")});return w&&(this.parsedResult.browser=w.describe(this.getUA())),this.parsedResult.browser},p.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},p.getBrowserName=function(f){return f?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},p.getBrowserVersion=function(){return this.getBrowser().version},p.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},p.parseOS=function(){var f=this;this.parsedResult.os={};var w=o.default.find(a.default,function(g){if(typeof g.test=="function")return g.test(f);if(g.test instanceof Array)return g.test.some(function(b){return f.test(b)});throw new Error("Browser's test function is not valid")});return w&&(this.parsedResult.os=w.describe(this.getUA())),this.parsedResult.os},p.getOSName=function(f){var w=this.getOS().name;return f?String(w).toLowerCase()||"":w||""},p.getOSVersion=function(){return this.getOS().version},p.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},p.getPlatformType=function(f){f===void 0&&(f=!1);var w=this.getPlatform().type;return f?String(w).toLowerCase()||"":w||""},p.parsePlatform=function(){var f=this;this.parsedResult.platform={};var w=o.default.find(c.default,function(g){if(typeof g.test=="function")return g.test(f);if(g.test instanceof Array)return g.test.some(function(b){return f.test(b)});throw new Error("Browser's test function is not valid")});return w&&(this.parsedResult.platform=w.describe(this.getUA())),this.parsedResult.platform},p.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},p.getEngineName=function(f){return f?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},p.parseEngine=function(){var f=this;this.parsedResult.engine={};var w=o.default.find(u.default,function(g){if(typeof g.test=="function")return g.test(f);if(g.test instanceof Array)return g.test.some(function(b){return f.test(b)});throw new Error("Browser's test function is not valid")});return w&&(this.parsedResult.engine=w.describe(this.getUA())),this.parsedResult.engine},p.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},p.getResult=function(){return o.default.assign({},this.parsedResult)},p.satisfies=function(f){var w=this,g={},b=0,E={},M=0;if(Object.keys(f).forEach(function(G){var re=f[G];typeof re=="string"?(E[G]=re,M+=1):typeof re=="object"&&(g[G]=re,b+=1)}),b>0){var P=Object.keys(g),y=o.default.find(P,function(G){return w.isOS(G)});if(y){var D=this.satisfies(g[y]);if(D!==void 0)return D}var Z=o.default.find(P,function(G){return w.isPlatform(G)});if(Z){var ae=this.satisfies(g[Z]);if(ae!==void 0)return ae}}if(M>0){var Me=Object.keys(E),me=o.default.find(Me,function(G){return w.isBrowser(G,!0)});if(me!==void 0)return this.compareVersion(E[me])}},p.isBrowser=function(f,w){w===void 0&&(w=!1);var g=this.getBrowserName().toLowerCase(),b=f.toLowerCase(),E=o.default.getBrowserTypeByAlias(b);return w&&E&&(b=E.toLowerCase()),b===g},p.compareVersion=function(f){var w=[0],g=f,b=!1,E=this.getBrowserVersion();if(typeof E=="string")return f[0]===">"||f[0]==="<"?(g=f.substr(1),f[1]==="="?(b=!0,g=f.substr(2)):w=[],f[0]===">"?w.push(1):w.push(-1)):f[0]==="="?g=f.substr(1):f[0]==="~"&&(b=!0,g=f.substr(1)),w.indexOf(o.default.compareVersions(E,g,b))>-1},p.isOS=function(f){return this.getOSName(!0)===String(f).toLowerCase()},p.isPlatform=function(f){return this.getPlatformType(!0)===String(f).toLowerCase()},p.isEngine=function(f){return this.getEngineName(!0)===String(f).toLowerCase()},p.is=function(f,w){return w===void 0&&(w=!1),this.isBrowser(f,w)||this.isOS(f)||this.isPlatform(f)},p.some=function(f){var w=this;return f===void 0&&(f=[]),f.some(function(g){return w.is(g)})},h}();s.default=d,t.exports=s.default},92:function(t,s,n){s.__esModule=!0,s.default=void 0;var i,a=(i=n(17))&&i.__esModule?i:{default:i},c=/version\/(\d+(\.?_?\d+)+)/i,u=[{test:[/googlebot/i],describe:function(o){var l={name:"Googlebot"},d=a.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/opera/i],describe:function(o){var l={name:"Opera"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/opr\/|opios/i],describe:function(o){var l={name:"Opera"},d=a.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/SamsungBrowser/i],describe:function(o){var l={name:"Samsung Internet for Android"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/Whale/i],describe:function(o){var l={name:"NAVER Whale Browser"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/MZBrowser/i],describe:function(o){var l={name:"MZ Browser"},d=a.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/focus/i],describe:function(o){var l={name:"Focus"},d=a.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/swing/i],describe:function(o){var l={name:"Swing"},d=a.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/coast/i],describe:function(o){var l={name:"Opera Coast"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(o){var l={name:"Opera Touch"},d=a.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/yabrowser/i],describe:function(o){var l={name:"Yandex Browser"},d=a.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/ucbrowser/i],describe:function(o){var l={name:"UC Browser"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/Maxthon|mxios/i],describe:function(o){var l={name:"Maxthon"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/epiphany/i],describe:function(o){var l={name:"Epiphany"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/puffin/i],describe:function(o){var l={name:"Puffin"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/sleipnir/i],describe:function(o){var l={name:"Sleipnir"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/k-meleon/i],describe:function(o){var l={name:"K-Meleon"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/micromessenger/i],describe:function(o){var l={name:"WeChat"},d=a.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/qqbrowser/i],describe:function(o){var l={name:/qqbrowserlite/i.test(o)?"QQ Browser Lite":"QQ Browser"},d=a.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/msie|trident/i],describe:function(o){var l={name:"Internet Explorer"},d=a.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/\sedg\//i],describe:function(o){var l={name:"Microsoft Edge"},d=a.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/edg([ea]|ios)/i],describe:function(o){var l={name:"Microsoft Edge"},d=a.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/vivaldi/i],describe:function(o){var l={name:"Vivaldi"},d=a.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/seamonkey/i],describe:function(o){var l={name:"SeaMonkey"},d=a.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/sailfish/i],describe:function(o){var l={name:"Sailfish"},d=a.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,o);return d&&(l.version=d),l}},{test:[/silk/i],describe:function(o){var l={name:"Amazon Silk"},d=a.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/phantom/i],describe:function(o){var l={name:"PhantomJS"},d=a.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/slimerjs/i],describe:function(o){var l={name:"SlimerJS"},d=a.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(o){var l={name:"BlackBerry"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/(web|hpw)[o0]s/i],describe:function(o){var l={name:"WebOS Browser"},d=a.default.getFirstMatch(c,o)||a.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/bada/i],describe:function(o){var l={name:"Bada"},d=a.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/tizen/i],describe:function(o){var l={name:"Tizen"},d=a.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/qupzilla/i],describe:function(o){var l={name:"QupZilla"},d=a.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/firefox|iceweasel|fxios/i],describe:function(o){var l={name:"Firefox"},d=a.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/electron/i],describe:function(o){var l={name:"Electron"},d=a.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/MiuiBrowser/i],describe:function(o){var l={name:"Miui"},d=a.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/chromium/i],describe:function(o){var l={name:"Chromium"},d=a.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,o)||a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/chrome|crios|crmo/i],describe:function(o){var l={name:"Chrome"},d=a.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/GSA/i],describe:function(o){var l={name:"Google Search"},d=a.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:function(o){var l=!o.test(/like android/i),d=o.test(/android/i);return l&&d},describe:function(o){var l={name:"Android Browser"},d=a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/playstation 4/i],describe:function(o){var l={name:"PlayStation 4"},d=a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/safari|applewebkit/i],describe:function(o){var l={name:"Safari"},d=a.default.getFirstMatch(c,o);return d&&(l.version=d),l}},{test:[/.*/i],describe:function(o){var l=o.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:a.default.getFirstMatch(l,o),version:a.default.getSecondMatch(l,o)}}}];s.default=u,t.exports=s.default},93:function(t,s,n){s.__esModule=!0,s.default=void 0;var i,a=(i=n(17))&&i.__esModule?i:{default:i},c=n(18),u=[{test:[/Roku\/DVP/],describe:function(o){var l=a.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,o);return{name:c.OS_MAP.Roku,version:l}}},{test:[/windows phone/i],describe:function(o){var l=a.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,o);return{name:c.OS_MAP.WindowsPhone,version:l}}},{test:[/windows /i],describe:function(o){var l=a.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,o),d=a.default.getWindowsVersionName(l);return{name:c.OS_MAP.Windows,version:l,versionName:d}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(o){var l={name:c.OS_MAP.iOS},d=a.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,o);return d&&(l.version=d),l}},{test:[/macintosh/i],describe:function(o){var l=a.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,o).replace(/[_\s]/g,"."),d=a.default.getMacOSVersionName(l),h={name:c.OS_MAP.MacOS,version:l};return d&&(h.versionName=d),h}},{test:[/(ipod|iphone|ipad)/i],describe:function(o){var l=a.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,o).replace(/[_\s]/g,".");return{name:c.OS_MAP.iOS,version:l}}},{test:function(o){var l=!o.test(/like android/i),d=o.test(/android/i);return l&&d},describe:function(o){var l=a.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,o),d=a.default.getAndroidVersionName(l),h={name:c.OS_MAP.Android,version:l};return d&&(h.versionName=d),h}},{test:[/(web|hpw)[o0]s/i],describe:function(o){var l=a.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,o),d={name:c.OS_MAP.WebOS};return l&&l.length&&(d.version=l),d}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(o){var l=a.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,o)||a.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,o)||a.default.getFirstMatch(/\bbb(\d+)/i,o);return{name:c.OS_MAP.BlackBerry,version:l}}},{test:[/bada/i],describe:function(o){var l=a.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,o);return{name:c.OS_MAP.Bada,version:l}}},{test:[/tizen/i],describe:function(o){var l=a.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,o);return{name:c.OS_MAP.Tizen,version:l}}},{test:[/linux/i],describe:function(){return{name:c.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:c.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(o){var l=a.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,o);return{name:c.OS_MAP.PlayStation4,version:l}}}];s.default=u,t.exports=s.default},94:function(t,s,n){s.__esModule=!0,s.default=void 0;var i,a=(i=n(17))&&i.__esModule?i:{default:i},c=n(18),u=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(o){var l=a.default.getFirstMatch(/(can-l01)/i,o)&&"Nova",d={type:c.PLATFORMS_MAP.mobile,vendor:"Huawei"};return l&&(d.model=l),d}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:c.PLATFORMS_MAP.tablet}}},{test:function(o){var l=o.test(/ipod|iphone/i),d=o.test(/like (ipod|iphone)/i);return l&&!d},describe:function(o){var l=a.default.getFirstMatch(/(ipod|iphone)/i,o);return{type:c.PLATFORMS_MAP.mobile,vendor:"Apple",model:l}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:c.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:c.PLATFORMS_MAP.mobile}}},{test:function(o){return o.getBrowserName(!0)==="blackberry"},describe:function(){return{type:c.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(o){return o.getBrowserName(!0)==="bada"},describe:function(){return{type:c.PLATFORMS_MAP.mobile}}},{test:function(o){return o.getBrowserName()==="windows phone"},describe:function(){return{type:c.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(o){var l=Number(String(o.getOSVersion()).split(".")[0]);return o.getOSName(!0)==="android"&&l>=3},describe:function(){return{type:c.PLATFORMS_MAP.tablet}}},{test:function(o){return o.getOSName(!0)==="android"},describe:function(){return{type:c.PLATFORMS_MAP.mobile}}},{test:function(o){return o.getOSName(!0)==="macos"},describe:function(){return{type:c.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(o){return o.getOSName(!0)==="windows"},describe:function(){return{type:c.PLATFORMS_MAP.desktop}}},{test:function(o){return o.getOSName(!0)==="linux"},describe:function(){return{type:c.PLATFORMS_MAP.desktop}}},{test:function(o){return o.getOSName(!0)==="playstation 4"},describe:function(){return{type:c.PLATFORMS_MAP.tv}}},{test:function(o){return o.getOSName(!0)==="roku"},describe:function(){return{type:c.PLATFORMS_MAP.tv}}}];s.default=u,t.exports=s.default},95:function(t,s,n){s.__esModule=!0,s.default=void 0;var i,a=(i=n(17))&&i.__esModule?i:{default:i},c=n(18),u=[{test:function(o){return o.getBrowserName(!0)==="microsoft edge"},describe:function(o){if(/\sedg\//i.test(o))return{name:c.ENGINE_MAP.Blink};var l=a.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,o);return{name:c.ENGINE_MAP.EdgeHTML,version:l}}},{test:[/trident/i],describe:function(o){var l={name:c.ENGINE_MAP.Trident},d=a.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:function(o){return o.test(/presto/i)},describe:function(o){var l={name:c.ENGINE_MAP.Presto},d=a.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:function(o){var l=o.test(/gecko/i),d=o.test(/like gecko/i);return l&&!d},describe:function(o){var l={name:c.ENGINE_MAP.Gecko},d=a.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:c.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(o){var l={name:c.ENGINE_MAP.WebKit},d=a.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,o);return d&&(l.version=d),l}}];s.default=u,t.exports=s.default}})})})(bl);var Ff=bl.exports,fe={},$f=S&&S.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fe,"__esModule",{value:!0});fe.Logger=void 0;const gr=$f(Bn),_r="mediasoup-client";let jf=class{constructor(e){e?(this._debug=(0,gr.default)(`${_r}:${e}`),this._warn=(0,gr.default)(`${_r}:WARN:${e}`),this._error=(0,gr.default)(`${_r}:ERROR:${e}`)):(this._debug=(0,gr.default)(_r),this._warn=(0,gr.default)(`${_r}:WARN`),this._error=(0,gr.default)(`${_r}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};fe.Logger=jf;var vt={},Ka={exports:{}},jr=typeof Reflect=="object"?Reflect:null,pc=jr&&typeof jr.apply=="function"?jr.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)},Sn;jr&&typeof jr.ownKeys=="function"?Sn=jr.ownKeys:Object.getOwnPropertySymbols?Sn=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Sn=function(e){return Object.getOwnPropertyNames(e)};function Uf(r){console&&console.warn&&console.warn(r)}var Sl=Number.isNaN||function(e){return e!==e};function oe(){oe.init.call(this)}Ka.exports=oe;Ka.exports.once=Vf;oe.EventEmitter=oe;oe.prototype._events=void 0;oe.prototype._eventsCount=0;oe.prototype._maxListeners=void 0;var fc=10;function qn(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(oe,"defaultMaxListeners",{enumerable:!0,get:function(){return fc},set:function(r){if(typeof r!="number"||r<0||Sl(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");fc=r}});oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Sl(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Rl(r){return r._maxListeners===void 0?oe.defaultMaxListeners:r._maxListeners}oe.prototype.getMaxListeners=function(){return Rl(this)};oe.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var n=e==="error",i=this._events;if(i!==void 0)n=n&&i.error===void 0;else if(!n)return!1;if(n){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var c=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw c.context=a,c}var u=i[e];if(u===void 0)return!1;if(typeof u=="function")pc(u,this,t);else for(var o=u.length,l=Ml(u,o),s=0;s<o;++s)pc(l[s],this,t);return!0};function Tl(r,e,t,s){var n,i,a;if(qn(t),i=r._events,i===void 0?(i=r._events=Object.create(null),r._eventsCount=0):(i.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),i=r._events),a=i[e]),a===void 0)a=i[e]=t,++r._eventsCount;else if(typeof a=="function"?a=i[e]=s?[t,a]:[a,t]:s?a.unshift(t):a.push(t),n=Rl(r),n>0&&a.length>n&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=r,c.type=e,c.count=a.length,Uf(c)}return r}oe.prototype.addListener=function(e,t){return Tl(this,e,t,!1)};oe.prototype.on=oe.prototype.addListener;oe.prototype.prependListener=function(e,t){return Tl(this,e,t,!0)};function Bf(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Dl(r,e,t){var s={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=Bf.bind(s);return n.listener=t,s.wrapFn=n,n}oe.prototype.once=function(e,t){return qn(t),this.on(e,Dl(this,e,t)),this};oe.prototype.prependOnceListener=function(e,t){return qn(t),this.prependListener(e,Dl(this,e,t)),this};oe.prototype.removeListener=function(e,t){var s,n,i,a,c;if(qn(t),n=this._events,n===void 0)return this;if(s=n[e],s===void 0)return this;if(s===t||s.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,s.listener||t));else if(typeof s!="function"){for(i=-1,a=s.length-1;a>=0;a--)if(s[a]===t||s[a].listener===t){c=s[a].listener,i=a;break}if(i<0)return this;i===0?s.shift():qf(s,i),s.length===1&&(n[e]=s[0]),n.removeListener!==void 0&&this.emit("removeListener",e,c||t)}return this};oe.prototype.off=oe.prototype.removeListener;oe.prototype.removeAllListeners=function(e){var t,s,n;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[e]),this;if(arguments.length===0){var i=Object.keys(s),a;for(n=0;n<i.length;++n)a=i[n],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=s[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function Cl(r,e,t){var s=r._events;if(s===void 0)return[];var n=s[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?zf(n):Ml(n,n.length)}oe.prototype.listeners=function(e){return Cl(this,e,!0)};oe.prototype.rawListeners=function(e){return Cl(this,e,!1)};oe.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):El.call(r,e)};oe.prototype.listenerCount=El;function El(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}oe.prototype.eventNames=function(){return this._eventsCount>0?Sn(this._events):[]};function Ml(r,e){for(var t=new Array(e),s=0;s<e;++s)t[s]=r[s];return t}function qf(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function zf(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Vf(r,e){return new Promise(function(t,s){function n(a){r.removeListener(e,i),s(a)}function i(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}Ol(r,e,i,{once:!0}),e!=="error"&&Hf(r,n,{once:!0})})}function Hf(r,e,t){typeof r.on=="function"&&Ol(r,"error",e,t)}function Ol(r,e,t,s){if(typeof r.on=="function")s.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(i){s.once&&r.removeEventListener(e,n),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var Gf=Ka.exports;Object.defineProperty(vt,"__esModule",{value:!0});vt.EnhancedEventEmitter=void 0;const Wf=Gf,Zf=fe,Jf=new Zf.Logger("EnhancedEventEmitter");class Kf extends Wf.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}emit(e,...t){return super.emit(e,...t)}safeEmit(e,...t){const s=super.listenerCount(e);try{return super.emit(e,...t)}catch(n){return Jf.error("safeEmit() | event listener threw an error [eventName:%s]:%o",e,n),!!s}}on(e,t){return super.on(e,t),this}off(e,t){return super.off(e,t),this}addListener(e,t){return super.on(e,t),this}prependListener(e,t){return super.prependListener(e,t),this}once(e,t){return super.once(e,t),this}prependOnceListener(e,t){return super.prependOnceListener(e,t),this}removeListener(e,t){return super.off(e,t),this}removeAllListeners(e){return super.removeAllListeners(e),this}listenerCount(e){return super.listenerCount(e)}listeners(e){return super.listeners(e)}rawListeners(e){return super.rawListeners(e)}}vt.EnhancedEventEmitter=Kf;var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.InvalidStateError=Pe.UnsupportedError=void 0;class Ya extends Error{constructor(e){super(e),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Ya):this.stack=new Error(e).stack}}Pe.UnsupportedError=Ya;class Qa extends Error{constructor(e){super(e),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Qa):this.stack=new Error(e).stack}}Pe.InvalidStateError=Qa;var ge={};Object.defineProperty(ge,"__esModule",{value:!0});ge.generateRandomNumber=ge.clone=void 0;function Yf(r,e){return typeof r>"u"?e:JSON.parse(JSON.stringify(r))}ge.clone=Yf;function Qf(){return Math.round(Math.random()*1e7)}ge.generateRandomNumber=Qf;var k={},Pl={};(function(r){const e=Bn("h264-profile-level-id");e.log=console.info.bind(console);const t=1,s=2,n=3,i=4,a=5;r.ProfileConstrainedBaseline=t,r.ProfileBaseline=s,r.ProfileMain=n,r.ProfileConstrainedHigh=i,r.ProfileHigh=a;const c=0,u=10,o=11,l=12,d=13,h=20,p=21,f=22,w=30,g=31,b=32,E=40,M=41,P=42,y=50,D=51,Z=52;r.Level1_b=c,r.Level1=u,r.Level1_1=o,r.Level1_2=l,r.Level1_3=d,r.Level2=h,r.Level2_1=p,r.Level2_2=f,r.Level3=w,r.Level3_1=g,r.Level3_2=b,r.Level4=E,r.Level4_1=M,r.Level4_2=P,r.Level5=y,r.Level5_1=D,r.Level5_2=Z;class ae{constructor(I,he){this.profile=I,this.level=he}}r.ProfileLevelId=ae;const Me=new ae(t,g),me=16;class G{constructor(I){this._mask=~Nt("x",I),this._maskedValue=Nt("1",I)}isMatch(I){return this._maskedValue===(I&this._mask)}}class re{constructor(I,he,Fe){this.profile_idc=I,this.profile_iop=he,this.profile=Fe}}const rs=[new re(66,new G("x1xx0000"),t),new re(77,new G("1xxx0000"),t),new re(88,new G("11xx0000"),t),new re(66,new G("x0xx0000"),s),new re(88,new G("10xx0000"),s),new re(77,new G("0x0x0000"),n),new re(100,new G("00000000"),a),new re(100,new G("00001100"),i)];r.parseProfileLevelId=function(j){if(typeof j!="string"||j.length!==6)return null;const I=parseInt(j,16);if(I===0)return null;const he=I&255,Fe=I>>8&255,ss=I>>16&255;let Q;switch(he){case o:{Q=Fe&me?c:o;break}case u:case l:case d:case h:case p:case f:case w:case g:case b:case E:case M:case P:case y:case D:case Z:{Q=he;break}default:return e("parseProfileLevelId() | unrecognized level_idc:%s",he),null}for(const Ft of rs)if(ss===Ft.profile_idc&&Ft.profile_iop.isMatch(Fe))return new ae(Ft.profile,Q);return e("parseProfileLevelId() | unrecognized profile_idc/profile_iop combination"),null},r.profileLevelIdToString=function(j){if(j.level==c)switch(j.profile){case t:return"42f00b";case s:return"42100b";case n:return"4d100b";default:return e("profileLevelIdToString() | Level 1_b not is allowed for profile:%s",j.profile),null}let I;switch(j.profile){case t:{I="42e0";break}case s:{I="4200";break}case n:{I="4d00";break}case i:{I="640c";break}case a:{I="6400";break}default:return e("profileLevelIdToString() | unrecognized profile:%s",j.profile),null}let he=j.level.toString(16);return he.length===1&&(he=`0${he}`),`${I}${he}`},r.parseSdpProfileLevelId=function(j={}){const I=j["profile-level-id"];return I?r.parseProfileLevelId(I):Me},r.isSameProfile=function(j={},I={}){const he=r.parseSdpProfileLevelId(j),Fe=r.parseSdpProfileLevelId(I);return!!(he&&Fe&&he.profile===Fe.profile)},r.generateProfileLevelIdForAnswer=function(j={},I={}){if(!j["profile-level-id"]&&!I["profile-level-id"])return e("generateProfileLevelIdForAnswer() | no profile-level-id in local and remote params"),null;const he=r.parseSdpProfileLevelId(j),Fe=r.parseSdpProfileLevelId(I);if(!he)throw new TypeError("invalid local_profile_level_id");if(!Fe)throw new TypeError("invalid remote_profile_level_id");if(he.profile!==Fe.profile)throw new TypeError("H264 Profile mismatch");const ss=Gs(j)&&Gs(I),Q=he.level,Ft=Fe.level,yi=wi(Q,Ft),$t=ss?Q:yi;return e("generateProfileLevelIdForAnswer() | result: [profile:%s, level:%s]",he.profile,$t),r.profileLevelIdToString(new ae(he.profile,$t))};function Nt(j,I){return(I[0]===j)<<7|(I[1]===j)<<6|(I[2]===j)<<5|(I[3]===j)<<4|(I[4]===j)<<3|(I[5]===j)<<2|(I[6]===j)<<1|(I[7]===j)<<0}function _i(j,I){return j===c?I!==u&&I!==c:I===c?j!==u:j<I}function wi(j,I){return _i(j,I)?j:I}function Gs(j={}){const I=j["level-asymmetry-allowed"];return I===1||I==="1"}})(Pl);var Xf=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),em=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),xl=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Xf(e,r,t);return em(e,r),e};Object.defineProperty(k,"__esModule",{value:!0});k.canReceive=k.canSend=k.generateProbatorRtpParameters=k.reduceCodecs=k.getSendingRemoteRtpParameters=k.getSendingRtpParameters=k.getRecvRtpCapabilities=k.getExtendedRtpCapabilities=k.validateSctpStreamParameters=k.validateSctpParameters=k.validateNumSctpStreams=k.validateSctpCapabilities=k.validateRtcpParameters=k.validateRtpEncodingParameters=k.validateRtpHeaderExtensionParameters=k.validateRtpCodecParameters=k.validateRtpParameters=k.validateRtpHeaderExtension=k.validateRtcpFeedback=k.validateRtpCodecCapability=k.validateRtpCapabilities=void 0;const mc=xl(Pl),tm=xl(ge),rm="probator",sm=1234,nm=127;function im(r){if(typeof r!="object")throw new TypeError("caps is not an object");if(r.codecs&&!Array.isArray(r.codecs))throw new TypeError("caps.codecs is not an array");r.codecs||(r.codecs=[]);for(const e of r.codecs)kl(e);if(r.headerExtensions&&!Array.isArray(r.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");r.headerExtensions||(r.headerExtensions=[]);for(const e of r.headerExtensions)Il(e)}k.validateRtpCapabilities=im;function kl(r){const e=new RegExp("^(audio|video)/(.+)","i");if(typeof r!="object")throw new TypeError("codec is not an object");if(!r.mimeType||typeof r.mimeType!="string")throw new TypeError("missing codec.mimeType");const t=e.exec(r.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");if(r.kind=t[1].toLowerCase(),r.preferredPayloadType&&typeof r.preferredPayloadType!="number")throw new TypeError("invalid codec.preferredPayloadType");if(typeof r.clockRate!="number")throw new TypeError("missing codec.clockRate");r.kind==="audio"?typeof r.channels!="number"&&(r.channels=1):delete r.channels,(!r.parameters||typeof r.parameters!="object")&&(r.parameters={});for(const s of Object.keys(r.parameters)){let n=r.parameters[s];if(n===void 0&&(r.parameters[s]="",n=""),typeof n!="string"&&typeof n!="number")throw new TypeError(`invalid codec parameter [key:${s}s, value:${n}]`);if(s==="apt"&&typeof n!="number")throw new TypeError("invalid codec apt parameter")}(!r.rtcpFeedback||!Array.isArray(r.rtcpFeedback))&&(r.rtcpFeedback=[]);for(const s of r.rtcpFeedback)Xa(s)}k.validateRtpCodecCapability=kl;function Xa(r){if(typeof r!="object")throw new TypeError("fb is not an object");if(!r.type||typeof r.type!="string")throw new TypeError("missing fb.type");(!r.parameter||typeof r.parameter!="string")&&(r.parameter="")}k.validateRtcpFeedback=Xa;function Il(r){if(typeof r!="object")throw new TypeError("ext is not an object");if(r.kind!=="audio"&&r.kind!=="video")throw new TypeError("invalid ext.kind");if(!r.uri||typeof r.uri!="string")throw new TypeError("missing ext.uri");if(typeof r.preferredId!="number")throw new TypeError("missing ext.preferredId");if(r.preferredEncrypt&&typeof r.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(r.preferredEncrypt||(r.preferredEncrypt=!1),r.direction&&typeof r.direction!="string")throw new TypeError("invalid ext.direction");r.direction||(r.direction="sendrecv")}k.validateRtpHeaderExtension=Il;function eo(r){if(typeof r!="object")throw new TypeError("params is not an object");if(r.mid&&typeof r.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(r.codecs))throw new TypeError("missing params.codecs");for(const e of r.codecs)Ll(e);if(r.headerExtensions&&!Array.isArray(r.headerExtensions))throw new TypeError("params.headerExtensions is not an array");r.headerExtensions||(r.headerExtensions=[]);for(const e of r.headerExtensions)Al(e);if(r.encodings&&!Array.isArray(r.encodings))throw new TypeError("params.encodings is not an array");r.encodings||(r.encodings=[]);for(const e of r.encodings)Nl(e);if(r.rtcp&&typeof r.rtcp!="object")throw new TypeError("params.rtcp is not an object");r.rtcp||(r.rtcp={}),Fl(r.rtcp)}k.validateRtpParameters=eo;function Ll(r){const e=new RegExp("^(audio|video)/(.+)","i");if(typeof r!="object")throw new TypeError("codec is not an object");if(!r.mimeType||typeof r.mimeType!="string")throw new TypeError("missing codec.mimeType");const t=e.exec(r.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");if(typeof r.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof r.clockRate!="number")throw new TypeError("missing codec.clockRate");t[1].toLowerCase()==="audio"?typeof r.channels!="number"&&(r.channels=1):delete r.channels,(!r.parameters||typeof r.parameters!="object")&&(r.parameters={});for(const n of Object.keys(r.parameters)){let i=r.parameters[n];if(i===void 0&&(r.parameters[n]="",i=""),typeof i!="string"&&typeof i!="number")throw new TypeError(`invalid codec parameter [key:${n}s, value:${i}]`);if(n==="apt"&&typeof i!="number")throw new TypeError("invalid codec apt parameter")}(!r.rtcpFeedback||!Array.isArray(r.rtcpFeedback))&&(r.rtcpFeedback=[]);for(const n of r.rtcpFeedback)Xa(n)}k.validateRtpCodecParameters=Ll;function Al(r){if(typeof r!="object")throw new TypeError("ext is not an object");if(!r.uri||typeof r.uri!="string")throw new TypeError("missing ext.uri");if(typeof r.id!="number")throw new TypeError("missing ext.id");if(r.encrypt&&typeof r.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");r.encrypt||(r.encrypt=!1),(!r.parameters||typeof r.parameters!="object")&&(r.parameters={});for(const e of Object.keys(r.parameters)){let t=r.parameters[e];if(t===void 0&&(r.parameters[e]="",t=""),typeof t!="string"&&typeof t!="number")throw new TypeError("invalid header extension parameter")}}k.validateRtpHeaderExtensionParameters=Al;function Nl(r){if(typeof r!="object")throw new TypeError("encoding is not an object");if(r.ssrc&&typeof r.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(r.rid&&typeof r.rid!="string")throw new TypeError("invalid encoding.rid");if(r.rtx&&typeof r.rtx!="object")throw new TypeError("invalid encoding.rtx");if(r.rtx&&typeof r.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!r.dtx||typeof r.dtx!="boolean")&&(r.dtx=!1),r.scalabilityMode&&typeof r.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}k.validateRtpEncodingParameters=Nl;function Fl(r){if(typeof r!="object")throw new TypeError("rtcp is not an object");if(r.cname&&typeof r.cname!="string")throw new TypeError("invalid rtcp.cname");(!r.reducedSize||typeof r.reducedSize!="boolean")&&(r.reducedSize=!0)}k.validateRtcpParameters=Fl;function am(r){if(typeof r!="object")throw new TypeError("caps is not an object");if(!r.numStreams||typeof r.numStreams!="object")throw new TypeError("missing caps.numStreams");$l(r.numStreams)}k.validateSctpCapabilities=am;function $l(r){if(typeof r!="object")throw new TypeError("numStreams is not an object");if(typeof r.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof r.MIS!="number")throw new TypeError("missing numStreams.MIS")}k.validateNumSctpStreams=$l;function om(r){if(typeof r!="object")throw new TypeError("params is not an object");if(typeof r.port!="number")throw new TypeError("missing params.port");if(typeof r.OS!="number")throw new TypeError("missing params.OS");if(typeof r.MIS!="number")throw new TypeError("missing params.MIS");if(typeof r.maxMessageSize!="number")throw new TypeError("missing params.maxMessageSize")}k.validateSctpParameters=om;function cm(r){if(typeof r!="object")throw new TypeError("params is not an object");if(typeof r.streamId!="number")throw new TypeError("missing params.streamId");let e=!1;if(typeof r.ordered=="boolean"?e=!0:r.ordered=!0,r.maxPacketLifeTime&&typeof r.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(r.maxRetransmits&&typeof r.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(r.maxPacketLifeTime&&r.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(e&&r.ordered&&(r.maxPacketLifeTime||r.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!e&&(r.maxPacketLifeTime||r.maxRetransmits)&&(r.ordered=!1),r.label&&typeof r.label!="string")throw new TypeError("invalid params.label");if(r.protocol&&typeof r.protocol!="string")throw new TypeError("invalid params.protocol")}k.validateSctpStreamParameters=cm;function dm(r,e){const t={codecs:[],headerExtensions:[]};for(const s of e.codecs||[]){if(ws(s))continue;const n=(r.codecs||[]).find(a=>jl(a,s,{strict:!0,modify:!0}));if(!n)continue;const i={mimeType:n.mimeType,kind:n.kind,clockRate:n.clockRate,channels:n.channels,localPayloadType:n.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:s.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:n.parameters,remoteParameters:s.parameters,rtcpFeedback:wm(n,s)};t.codecs.push(i)}for(const s of t.codecs){const n=r.codecs.find(a=>ws(a)&&a.parameters.apt===s.localPayloadType),i=e.codecs.find(a=>ws(a)&&a.parameters.apt===s.remotePayloadType);n&&i&&(s.localRtxPayloadType=n.preferredPayloadType,s.remoteRtxPayloadType=i.preferredPayloadType)}for(const s of e.headerExtensions){const n=r.headerExtensions.find(a=>_m(a,s));if(!n)continue;const i={kind:s.kind,uri:s.uri,sendId:n.preferredId,recvId:s.preferredId,encrypt:n.preferredEncrypt,direction:"sendrecv"};switch(s.direction){case"sendrecv":i.direction="sendrecv";break;case"recvonly":i.direction="sendonly";break;case"sendonly":i.direction="recvonly";break;case"inactive":i.direction="inactive";break}t.headerExtensions.push(i)}return t}k.getExtendedRtpCapabilities=dm;function lm(r){const e={codecs:[],headerExtensions:[]};for(const t of r.codecs){const s={mimeType:t.mimeType,kind:t.kind,preferredPayloadType:t.remotePayloadType,clockRate:t.clockRate,channels:t.channels,parameters:t.localParameters,rtcpFeedback:t.rtcpFeedback};if(e.codecs.push(s),!t.remoteRtxPayloadType)continue;const n={mimeType:`${t.kind}/rtx`,kind:t.kind,preferredPayloadType:t.remoteRtxPayloadType,clockRate:t.clockRate,parameters:{apt:t.remotePayloadType},rtcpFeedback:[]};e.codecs.push(n)}for(const t of r.headerExtensions){if(t.direction!=="sendrecv"&&t.direction!=="recvonly")continue;const s={kind:t.kind,uri:t.uri,preferredId:t.recvId,preferredEncrypt:t.encrypt,direction:t.direction};e.headerExtensions.push(s)}return e}k.getRecvRtpCapabilities=lm;function um(r,e){const t={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const s of e.codecs){if(s.kind!==r)continue;const n={mimeType:s.mimeType,payloadType:s.localPayloadType,clockRate:s.clockRate,channels:s.channels,parameters:s.localParameters,rtcpFeedback:s.rtcpFeedback};if(t.codecs.push(n),s.localRtxPayloadType){const i={mimeType:`${s.kind}/rtx`,payloadType:s.localRtxPayloadType,clockRate:s.clockRate,parameters:{apt:s.localPayloadType},rtcpFeedback:[]};t.codecs.push(i)}}for(const s of e.headerExtensions){if(s.kind&&s.kind!==r||s.direction!=="sendrecv"&&s.direction!=="sendonly")continue;const n={uri:s.uri,id:s.sendId,encrypt:s.encrypt,parameters:{}};t.headerExtensions.push(n)}return t}k.getSendingRtpParameters=um;function hm(r,e){const t={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const s of e.codecs){if(s.kind!==r)continue;const n={mimeType:s.mimeType,payloadType:s.localPayloadType,clockRate:s.clockRate,channels:s.channels,parameters:s.remoteParameters,rtcpFeedback:s.rtcpFeedback};if(t.codecs.push(n),s.localRtxPayloadType){const i={mimeType:`${s.kind}/rtx`,payloadType:s.localRtxPayloadType,clockRate:s.clockRate,parameters:{apt:s.localPayloadType},rtcpFeedback:[]};t.codecs.push(i)}}for(const s of e.headerExtensions){if(s.kind&&s.kind!==r||s.direction!=="sendrecv"&&s.direction!=="sendonly")continue;const n={uri:s.uri,id:s.sendId,encrypt:s.encrypt,parameters:{}};t.headerExtensions.push(n)}if(t.headerExtensions.some(s=>s.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const s of t.codecs)s.rtcpFeedback=(s.rtcpFeedback||[]).filter(n=>n.type!=="goog-remb");else if(t.headerExtensions.some(s=>s.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const s of t.codecs)s.rtcpFeedback=(s.rtcpFeedback||[]).filter(n=>n.type!=="transport-cc");else for(const s of t.codecs)s.rtcpFeedback=(s.rtcpFeedback||[]).filter(n=>n.type!=="transport-cc"&&n.type!=="goog-remb");return t}k.getSendingRemoteRtpParameters=hm;function pm(r,e){const t=[];if(!e)t.push(r[0]),ws(r[1])&&t.push(r[1]);else{for(let s=0;s<r.length;++s)if(jl(r[s],e)){t.push(r[s]),ws(r[s+1])&&t.push(r[s+1]);break}if(t.length===0)throw new TypeError("no matching codec found")}return t}k.reduceCodecs=pm;function fm(r){r=tm.clone(r,{}),eo(r);const e={mid:rm,codecs:[],headerExtensions:[],encodings:[{ssrc:sm}],rtcp:{cname:"probator"}};return e.codecs.push(r.codecs[0]),e.codecs[0].payloadType=nm,e.headerExtensions=r.headerExtensions,e}k.generateProbatorRtpParameters=fm;function mm(r,e){return e.codecs.some(t=>t.kind===r)}k.canSend=mm;function gm(r,e){if(eo(r),r.codecs.length===0)return!1;const t=r.codecs[0];return e.codecs.some(s=>s.remotePayloadType===t.payloadType)}k.canReceive=gm;function ws(r){return r?/.+\/rtx$/i.test(r.mimeType):!1}function jl(r,e,{strict:t=!1,modify:s=!1}={}){const n=r.mimeType.toLowerCase(),i=e.mimeType.toLowerCase();if(n!==i||r.clockRate!==e.clockRate||r.channels!==e.channels)return!1;switch(n){case"video/h264":{if(t){const a=r.parameters["packetization-mode"]||0,c=e.parameters["packetization-mode"]||0;if(a!==c||!mc.isSameProfile(r.parameters,e.parameters))return!1;let u;try{u=mc.generateProfileLevelIdForAnswer(r.parameters,e.parameters)}catch{return!1}s&&(u?(r.parameters["profile-level-id"]=u,e.parameters["profile-level-id"]=u):(delete r.parameters["profile-level-id"],delete e.parameters["profile-level-id"]))}break}case"video/vp9":{if(t){const a=r.parameters["profile-id"]||0,c=e.parameters["profile-id"]||0;if(a!==c)return!1}break}}return!0}function _m(r,e){return!(r.kind&&e.kind&&r.kind!==e.kind||r.uri!==e.uri)}function wm(r,e){const t=[];for(const s of r.rtcpFeedback||[]){const n=(e.rtcpFeedback||[]).find(i=>i.type===s.type&&(i.parameter===s.parameter||!i.parameter&&!s.parameter));n&&t.push(n)}return t}var Es={},Jt={},zn={},ym=S&&S.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(zn,"__esModule",{value:!0});zn.Logger=void 0;const wr=ym(Bn),yr="awaitqueue";class vm{constructor(e){e?(this._debug=(0,wr.default)(`${yr}:${e}`),this._warn=(0,wr.default)(`${yr}:WARN:${e}`),this._error=(0,wr.default)(`${yr}:ERROR:${e}`)):(this._debug=(0,wr.default)(yr),this._warn=(0,wr.default)(`${yr}:WARN`),this._error=(0,wr.default)(`${yr}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}zn.Logger=vm;Object.defineProperty(Jt,"__esModule",{value:!0});Jt.AwaitQueue=Jt.AwaitQueueRemovedTaskError=Jt.AwaitQueueStoppedError=void 0;const bm=zn,Ut=new bm.Logger;class Vn extends Error{constructor(e){super(e??"AwaitQueue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Vn)}}Jt.AwaitQueueStoppedError=Vn;class Hn extends Error{constructor(e){super(e??"AwaitQueue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Hn)}}Jt.AwaitQueueRemovedTaskError=Hn;class Sm{constructor(){this.pendingTasks=new Map,this.nextTaskId=0,this.stopping=!1}get size(){return this.pendingTasks.size}async push(e,t){if(t=t??e.name,Ut.debug(`push() [name:${t}]`),typeof e!="function")throw new TypeError("given task is not a function");if(t)try{Object.defineProperty(e,"name",{value:t})}catch{}return new Promise((s,n)=>{const i={id:this.nextTaskId++,task:e,name:t,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:a=>{if(i.completed)return;i.completed=!0,this.pendingTasks.delete(i.id),Ut.debug(`resolving task [name:${i.name}]`),s(a);const[c]=this.pendingTasks.values();c&&!c.executedAt&&this.execute(c)},reject:a=>{if(!i.completed&&(i.completed=!0,this.pendingTasks.delete(i.id),Ut.debug(`rejecting task [name:${i.name}]: %s`,String(a)),n(a),!this.stopping)){const[c]=this.pendingTasks.values();c&&!c.executedAt&&this.execute(c)}}};this.pendingTasks.set(i.id,i),this.pendingTasks.size===1&&this.execute(i)})}stop(){Ut.debug("stop()"),this.stopping=!0;for(const e of this.pendingTasks.values())Ut.debug(`stop() | stopping task [name:${e.name}]`),e.reject(new Vn);this.stopping=!1}remove(e){Ut.debug(`remove() [taskIdx:${e}]`);const t=Array.from(this.pendingTasks.values())[e];if(!t){Ut.debug(`stop() | no task with given idx [taskIdx:${e}]`);return}t.reject(new Hn)}dump(){const e=Date.now();let t=0;return Array.from(this.pendingTasks.values()).map(s=>({idx:t++,task:s.task,name:s.name,enqueuedTime:s.executedAt?s.executedAt-s.enqueuedAt:e-s.enqueuedAt,executionTime:s.executedAt?e-s.executedAt:0}))}async execute(e){if(Ut.debug(`execute() [name:${e.name}]`),e.executedAt)throw new Error("task already being executed");e.executedAt=Date.now();try{const t=await e.task();e.resolve(t)}catch(t){e.reject(t)}}}Jt.AwaitQueue=Sm;/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let gc;var Rm=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:S):r=>(gc||(gc=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0)),Ms={};Object.defineProperty(Ms,"__esModule",{value:!0});Ms.Producer=void 0;const Tm=fe,_c=vt,vr=Pe,lt=new Tm.Logger("Producer");class Dm extends _c.EnhancedEventEmitter{constructor({id:e,localId:t,rtpSender:s,track:n,rtpParameters:i,stopTracks:a,disableTrackOnPause:c,zeroRtpOnPause:u,appData:o}){super(),this._closed=!1,this._observer=new _c.EnhancedEventEmitter,lt.debug("constructor()"),this._id=e,this._localId=t,this._rtpSender=s,this._track=n,this._kind=n.kind,this._rtpParameters=i,this._paused=c?!n.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=a,this._disableTrackOnPause=c,this._zeroRtpOnPause=u,this._appData=o||{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(lt.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(lt.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new vr.InvalidStateError("closed");return new Promise((e,t)=>{this.safeEmit("@getstats",e,t)})}pause(){if(lt.debug("pause()"),this._closed){lt.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((e,t)=>{this.safeEmit("@pause",e,t)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(lt.debug("resume()"),this._closed){lt.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((e,t)=>{this.safeEmit("@resume",e,t)}).catch(()=>{}),this._observer.safeEmit("resume")}async replaceTrack({track:e}){if(lt.debug("replaceTrack() [track:%o]",e),this._closed){if(e&&this._stopTracks)try{e.stop()}catch{}throw new vr.InvalidStateError("closed")}else if(e&&e.readyState==="ended")throw new vr.InvalidStateError("track ended");if(e===this._track){lt.debug("replaceTrack() | same track, ignored");return}await new Promise((t,s)=>{this.safeEmit("@replacetrack",e,t,s)}),this.destroyTrack(),this._track=e,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()}async setMaxSpatialLayer(e){if(this._closed)throw new vr.InvalidStateError("closed");if(this._kind!=="video")throw new vr.UnsupportedError("not a video Producer");if(typeof e!="number")throw new TypeError("invalid spatialLayer");e!==this._maxSpatialLayer&&(await new Promise((t,s)=>{this.safeEmit("@setmaxspatiallayer",e,t,s)}).catch(()=>{}),this._maxSpatialLayer=e)}async setRtpEncodingParameters(e){if(this._closed)throw new vr.InvalidStateError("closed");if(typeof e!="object")throw new TypeError("invalid params");await new Promise((t,s)=>{this.safeEmit("@setrtpencodingparameters",e,t,s)})}onTrackEnded(){lt.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}}Ms.Producer=Dm;var Os={};Object.defineProperty(Os,"__esModule",{value:!0});Os.Consumer=void 0;const Cm=fe,wc=vt,Em=Pe,ut=new Cm.Logger("Consumer");class Mm extends wc.EnhancedEventEmitter{constructor({id:e,localId:t,producerId:s,rtpReceiver:n,track:i,rtpParameters:a,appData:c}){super(),this._closed=!1,this._observer=new wc.EnhancedEventEmitter,ut.debug("constructor()"),this._id=e,this._localId=t,this._producerId=s,this._rtpReceiver=n,this._track=i,this._rtpParameters=a,this._paused=!i.enabled,this._appData=c||{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(ut.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(ut.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new Em.InvalidStateError("closed");return new Promise((e,t)=>{this.safeEmit("@getstats",e,t)})}pause(){if(ut.debug("pause()"),this._closed){ut.error("pause() | Consumer closed");return}if(this._paused){ut.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(ut.debug("resume()"),this._closed){ut.error("resume() | Consumer closed");return}if(!this._paused){ut.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){ut.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}}Os.Consumer=Mm;var Ps={};Object.defineProperty(Ps,"__esModule",{value:!0});Ps.DataProducer=void 0;const Om=fe,yc=vt,Pm=Pe,Ct=new Om.Logger("DataProducer");class xm extends yc.EnhancedEventEmitter{constructor({id:e,dataChannel:t,sctpStreamParameters:s,appData:n}){super(),this._closed=!1,this._observer=new yc.EnhancedEventEmitter,Ct.debug("constructor()"),this._id=e,this._dataChannel=t,this._sctpStreamParameters=s,this._appData=n||{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(e){this._dataChannel.bufferedAmountLowThreshold=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(Ct.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Ct.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(e){if(Ct.debug("send()"),this._closed)throw new Pm.InvalidStateError("closed");this._dataChannel.send(e)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(Ct.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:t}=e;t||(t=new Error("unknown DataChannel error")),t.errorDetail==="sctp-failure"?Ct.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.sctpCauseCode,t.message):Ct.error('DataChannel "error" event: %o',t),this.safeEmit("error",t)}),this._dataChannel.addEventListener("close",()=>{this._closed||(Ct.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||Ct.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}}Ps.DataProducer=xm;var xs={};Object.defineProperty(xs,"__esModule",{value:!0});xs.DataConsumer=void 0;const km=fe,vc=vt,tr=new km.Logger("DataConsumer");class Im extends vc.EnhancedEventEmitter{constructor({id:e,dataProducerId:t,dataChannel:s,sctpStreamParameters:n,appData:i}){super(),this._closed=!1,this._observer=new vc.EnhancedEventEmitter,tr.debug("constructor()"),this._id=e,this._dataProducerId=t,this._dataChannel=s,this._sctpStreamParameters=n,this._appData=i||{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(e){this._dataChannel.binaryType=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(tr.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(tr.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(tr.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:t}=e;t||(t=new Error("unknown DataChannel error")),t.errorDetail==="sctp-failure"?tr.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",t.sctpCauseCode,t.message):tr.error('DataChannel "error" event: %o',t),this.safeEmit("error",t)}),this._dataChannel.addEventListener("close",()=>{this._closed||(tr.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",e=>{this._closed||this.safeEmit("message",e.data)})}}xs.DataConsumer=Im;var Lm=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Am=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Ul=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Lm(e,r,t);return Am(e,r),e},Nm=S&&S.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Es,"__esModule",{value:!0});Es.Transport=void 0;const Fm=Jt,Fi=Nm(Rm),$m=fe,bc=vt,ve=Pe,$i=Ul(ge),cs=Ul(k),jm=Ms,Um=Os,Bm=Ps,qm=xs,be=new $m.Logger("Transport");class zm{constructor(e){this.consumerOptions=e,this.promise=new Promise((t,s)=>{this.resolve=t,this.reject=s})}}class Vm extends bc.EnhancedEventEmitter{constructor({direction:e,id:t,iceParameters:s,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:c,iceTransportPolicy:u,additionalSettings:o,proprietaryConstraints:l,appData:d,handlerFactory:h,extendedRtpCapabilities:p,canProduceByKind:f}){super(),this._closed=!1,this._connectionState="new",this._producers=new Map,this._consumers=new Map,this._dataProducers=new Map,this._dataConsumers=new Map,this._probatorConsumerCreated=!1,this._awaitQueue=new Fm.AwaitQueue,this._pendingConsumerTasks=[],this._consumerCreationInProgress=!1,this._pendingPauseConsumers=new Map,this._consumerPauseInProgress=!1,this._pendingResumeConsumers=new Map,this._consumerResumeInProgress=!1,this._pendingCloseConsumers=new Map,this._consumerCloseInProgress=!1,this._observer=new bc.EnhancedEventEmitter,be.debug("constructor() [id:%s, direction:%s]",t,e),this._id=t,this._direction=e,this._extendedRtpCapabilities=p,this._canProduceByKind=f,this._maxSctpMessageSize=a?a.maxMessageSize:null,o=$i.clone(o,{}),delete o.iceServers,delete o.iceTransportPolicy,delete o.bundlePolicy,delete o.rtcpMuxPolicy,delete o.sdpSemantics,this._handler=h(),this._handler.run({direction:e,iceParameters:s,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:c,iceTransportPolicy:u,additionalSettings:o,proprietaryConstraints:l,extendedRtpCapabilities:p}),this._appData=d||{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){if(!this._closed){be.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close();for(const e of this._producers.values())e.transportClosed();this._producers.clear();for(const e of this._consumers.values())e.transportClosed();this._consumers.clear();for(const e of this._dataProducers.values())e.transportClosed();this._dataProducers.clear();for(const e of this._dataConsumers.values())e.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close")}}async getStats(){if(this._closed)throw new ve.InvalidStateError("closed");return this._handler.getTransportStats()}async restartIce({iceParameters:e}){if(be.debug("restartIce()"),this._closed)throw new ve.InvalidStateError("closed");if(!e)throw new TypeError("missing iceParameters");return this._awaitQueue.push(async()=>this._handler.restartIce(e),"transport.restartIce()")}async updateIceServers({iceServers:e}={}){if(be.debug("updateIceServers()"),this._closed)throw new ve.InvalidStateError("closed");if(!Array.isArray(e))throw new TypeError("missing iceServers");return this._awaitQueue.push(async()=>this._handler.updateIceServers(e),"transport.updateIceServers()")}async produce({track:e,encodings:t,codecOptions:s,codec:n,stopTracks:i=!0,disableTrackOnPause:a=!0,zeroRtpOnPause:c=!1,appData:u={}}={}){if(be.debug("produce() [track:%o]",e),this._closed)throw new ve.InvalidStateError("closed");if(e){if(this._direction!=="send")throw new ve.UnsupportedError("not a sending Transport");if(this._canProduceByKind[e.kind]){if(e.readyState==="ended")throw new ve.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if(u&&typeof u!="object")throw new TypeError("if given, appData must be an object")}else throw new ve.UnsupportedError(`cannot produce ${e.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(async()=>{let o;if(t&&!Array.isArray(t))throw TypeError("encodings must be an array");t&&t.length===0?o=void 0:t&&(o=t.map(p=>{const f={active:!0};return p.active===!1&&(f.active=!1),typeof p.dtx=="boolean"&&(f.dtx=p.dtx),typeof p.scalabilityMode=="string"&&(f.scalabilityMode=p.scalabilityMode),typeof p.scaleResolutionDownBy=="number"&&(f.scaleResolutionDownBy=p.scaleResolutionDownBy),typeof p.maxBitrate=="number"&&(f.maxBitrate=p.maxBitrate),typeof p.maxFramerate=="number"&&(f.maxFramerate=p.maxFramerate),typeof p.adaptivePtime=="boolean"&&(f.adaptivePtime=p.adaptivePtime),typeof p.priority=="string"&&(f.priority=p.priority),typeof p.networkPriority=="string"&&(f.networkPriority=p.networkPriority),f}));const{localId:l,rtpParameters:d,rtpSender:h}=await this._handler.send({track:e,encodings:o,codecOptions:s,codec:n});try{cs.validateRtpParameters(d);const{id:p}=await new Promise((w,g)=>{this.safeEmit("produce",{kind:e.kind,rtpParameters:d,appData:u},w,g)}),f=new jm.Producer({id:p,localId:l,rtpSender:h,track:e,rtpParameters:d,stopTracks:i,disableTrackOnPause:a,zeroRtpOnPause:c,appData:u});return this._producers.set(f.id,f),this.handleProducer(f),this._observer.safeEmit("newproducer",f),f}catch(p){throw this._handler.stopSending(l).catch(()=>{}),p}},"transport.produce()").catch(o=>{if(i)try{e.stop()}catch{}throw o})}async consume({id:e,producerId:t,kind:s,rtpParameters:n,streamId:i,appData:a={}}){if(be.debug("consume()"),n=$i.clone(n,void 0),this._closed)throw new ve.InvalidStateError("closed");if(this._direction!=="recv")throw new ve.UnsupportedError("not a receiving Transport");if(typeof e!="string")throw new TypeError("missing id");if(typeof t!="string")throw new TypeError("missing producerId");if(s!=="audio"&&s!=="video")throw new TypeError(`invalid kind '${s}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object");if(!cs.canReceive(n,this._extendedRtpCapabilities))throw new ve.UnsupportedError("cannot consume this Producer");const u=new zm({id:e,producerId:t,kind:s,rtpParameters:n,streamId:i,appData:a});return this._pendingConsumerTasks.push(u),(0,Fi.default)(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),u.promise}async produceData({ordered:e=!0,maxPacketLifeTime:t,maxRetransmits:s,label:n="",protocol:i="",appData:a={}}={}){if(be.debug("produceData()"),this._closed)throw new ve.InvalidStateError("closed");if(this._direction!=="send")throw new ve.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object")}else throw new ve.UnsupportedError("SCTP not enabled by remote Transport");return(t||s)&&(e=!1),this._awaitQueue.push(async()=>{const{dataChannel:c,sctpStreamParameters:u}=await this._handler.sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i});cs.validateSctpStreamParameters(u);const{id:o}=await new Promise((d,h)=>{this.safeEmit("producedata",{sctpStreamParameters:u,label:n,protocol:i,appData:a},d,h)}),l=new Bm.DataProducer({id:o,dataChannel:c,sctpStreamParameters:u,appData:a});return this._dataProducers.set(l.id,l),this.handleDataProducer(l),this._observer.safeEmit("newdataproducer",l),l},"transport.produceData()")}async consumeData({id:e,dataProducerId:t,sctpStreamParameters:s,label:n="",protocol:i="",appData:a={}}){if(be.debug("consumeData()"),s=$i.clone(s,void 0),this._closed)throw new ve.InvalidStateError("closed");if(this._direction!=="recv")throw new ve.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof e!="string")throw new TypeError("missing id");if(typeof t!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object")}else throw new ve.UnsupportedError("SCTP not enabled by remote Transport");return cs.validateSctpStreamParameters(s),this._awaitQueue.push(async()=>{const{dataChannel:c}=await this._handler.receiveDataChannel({sctpStreamParameters:s,label:n,protocol:i}),u=new qm.DataConsumer({id:e,dataProducerId:t,dataChannel:c,sctpStreamParameters:s,appData:a});return this._dataConsumers.set(u.id,u),this.handleDataConsumer(u),this._observer.safeEmit("newdataconsumer",u),u},"transport.consumeData()")}async createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingConsumerTasks.length===0){be.debug("createPendingConsumers() | there is no Consumer to be created");return}const e=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let t;const s=[];for(const n of e){const{id:i,kind:a,rtpParameters:c,streamId:u}=n.consumerOptions;s.push({trackId:i,kind:a,rtpParameters:c,streamId:u})}try{const n=await this._handler.receive(s);for(let i=0;i<n.length;++i){const a=e[i],c=n[i],{id:u,producerId:o,kind:l,rtpParameters:d,appData:h}=a.consumerOptions,{localId:p,rtpReceiver:f,track:w}=c,g=new Um.Consumer({id:u,localId:p,producerId:o,rtpReceiver:f,track:w,rtpParameters:d,appData:h});this._consumers.set(g.id,g),this.handleConsumer(g),!this._probatorConsumerCreated&&!t&&l==="video"&&(t=g),this._observer.safeEmit("newconsumer",g),a.resolve(g)}}catch(n){for(const i of e)i.reject(n)}if(t)try{const n=cs.generateProbatorRtpParameters(t.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:n}]),be.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(n){be.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",n)}},"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingPauseConsumers.size===0){be.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const e=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const t=e.map(s=>s.localId);await this._handler.pauseReceiving(t)}catch(t){be.error("pausePendingConsumers() | failed to pause Consumers:",t)}},"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingResumeConsumers.size===0){be.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const e=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const t=e.map(s=>s.localId);await this._handler.resumeReceiving(t)}catch(t){be.error("resumePendingConsumers() | failed to resume Consumers:",t)}},"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingCloseConsumers.size===0){be.debug("closePendingConsumers() | there is no Consumer to be closed");return}const e=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(e.map(t=>t.localId))}catch(t){be.error("closePendingConsumers() | failed to close Consumers:",t)}},"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const e=this._handler;e.on("@connect",({dtlsParameters:t},s,n)=>{if(this._closed){n(new ve.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:t},s,n)}),e.on("@connectionstatechange",t=>{t!==this._connectionState&&(be.debug("connection state changed to %s",t),this._connectionState=t,this._closed||this.safeEmit("connectionstatechange",t))})}handleProducer(e){e.on("@close",()=>{this._producers.delete(e.id),!this._closed&&this._awaitQueue.push(async()=>this._handler.stopSending(e.localId),"producer @close event").catch(t=>be.warn("producer.close() failed:%o",t))}),e.on("@pause",(t,s)=>{this._awaitQueue.push(async()=>this._handler.pauseSending(e.localId),"producer @pause event").then(t).catch(s)}),e.on("@resume",(t,s)=>{this._awaitQueue.push(async()=>this._handler.resumeSending(e.localId),"producer @resume event").then(t).catch(s)}),e.on("@replacetrack",(t,s,n)=>{this._awaitQueue.push(async()=>this._handler.replaceTrack(e.localId,t),"producer @replacetrack event").then(s).catch(n)}),e.on("@setmaxspatiallayer",(t,s,n)=>{this._awaitQueue.push(async()=>this._handler.setMaxSpatialLayer(e.localId,t),"producer @setmaxspatiallayer event").then(s).catch(n)}),e.on("@setrtpencodingparameters",(t,s,n)=>{this._awaitQueue.push(async()=>this._handler.setRtpEncodingParameters(e.localId,t),"producer @setrtpencodingparameters event").then(s).catch(n)}),e.on("@getstats",(t,s)=>{if(this._closed)return s(new ve.InvalidStateError("closed"));this._handler.getSenderStats(e.localId).then(t).catch(s)})}handleConsumer(e){e.on("@close",()=>{this._consumers.delete(e.id),this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.delete(e.id),!this._closed&&(this._pendingCloseConsumers.set(e.id,e),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),e.on("@pause",()=>{this._pendingResumeConsumers.has(e.id)&&this._pendingResumeConsumers.delete(e.id),this._pendingPauseConsumers.set(e.id,e),(0,Fi.default)(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),e.on("@resume",()=>{this._pendingPauseConsumers.has(e.id)&&this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.set(e.id,e),(0,Fi.default)(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),e.on("@getstats",(t,s)=>{if(this._closed)return s(new ve.InvalidStateError("closed"));this._handler.getReceiverStats(e.localId).then(t).catch(s)})}handleDataProducer(e){e.on("@close",()=>{this._dataProducers.delete(e.id)})}handleDataConsumer(e){e.on("@close",()=>{this._dataConsumers.delete(e.id)})}}Es.Transport=Vm;var Gn={},_e={},Bl={},ql={exports:{}},Sc=ql.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(r){return r.encoding?"rtpmap:%d %s/%s/%s":r.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(r){return r.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(r){return r.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(r){return"extmap:%d"+(r.direction?"/%s":"%v")+(r["encrypt-uri"]?" %s":"%v")+" %s"+(r.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(r){return r.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(r){var e="candidate:%s %d %s %d %s %d typ %s";return e+=r.raddr!=null?" raddr %s rport %d":"%v%v",e+=r.tcptype!=null?" tcptype %s":"%v",r.generation!=null&&(e+=" generation %d"),e+=r["network-id"]!=null?" network-id %d":"%v",e+=r["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(r){var e="ssrc:%d";return r.attribute!=null&&(e+=" %s",r.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(r){return r.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(r){return r.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(r){return"imageattr:%s %s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(r){return"simulcast:%s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(r){return"ts-refclk:%s"+(r.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(r){var e="mediaclk:";return e+=r.id!=null?"id=%s %s":"%v%s",e+=r.mediaClockValue!=null?"=%s":"",e+=r.rateNumerator!=null?" rate=%s":"",e+=r.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(Sc).forEach(function(r){var e=Sc[r];e.forEach(function(t){t.reg||(t.reg=/(.*)/),t.format||(t.format="%s")})});var zl=ql.exports;(function(r){var e=function(c){return String(Number(c))===c?Number(c):c},t=function(c,u,o,l){if(l&&!o)u[l]=e(c[1]);else for(var d=0;d<o.length;d+=1)c[d+1]!=null&&(u[o[d]]=e(c[d+1]))},s=function(c,u,o){var l=c.name&&c.names;c.push&&!u[c.push]?u[c.push]=[]:l&&!u[c.name]&&(u[c.name]={});var d=c.push?{}:l?u[c.name]:u;t(o.match(c.reg),d,c.names,c.name),c.push&&u[c.push].push(d)},n=zl,i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);r.parse=function(c){var u={},o=[],l=u;return c.split(/(\r\n|\r|\n)/).filter(i).forEach(function(d){var h=d[0],p=d.slice(2);h==="m"&&(o.push({rtp:[],fmtp:[]}),l=o[o.length-1]);for(var f=0;f<(n[h]||[]).length;f+=1){var w=n[h][f];if(w.reg.test(p))return s(w,l,p)}}),u.media=o,u};var a=function(c,u){var o=u.split(/=(.+)/,2);return o.length===2?c[o[0]]=e(o[1]):o.length===1&&u.length>1&&(c[o[0]]=void 0),c};r.parseParams=function(c){return c.split(/;\s?/).reduce(a,{})},r.parseFmtpConfig=r.parseParams,r.parsePayloads=function(c){return c.toString().split(" ").map(Number)},r.parseRemoteCandidates=function(c){for(var u=[],o=c.split(" ").map(e),l=0;l<o.length;l+=3)u.push({component:o[l],ip:o[l+1],port:o[l+2]});return u},r.parseImageAttributes=function(c){return c.split(" ").map(function(u){return u.substring(1,u.length-1).split(",").reduce(a,{})})},r.parseSimulcastStreamList=function(c){return c.split(";").map(function(u){return u.split(",").map(function(o){var l,d=!1;return o[0]!=="~"?l=e(o):(l=e(o.substring(1,o.length)),d=!0),{scid:l,paused:d}})})}})(Bl);var ji=zl,Hm=/%[sdv%]/g,Gm=function(r){var e=1,t=arguments,s=t.length;return r.replace(Hm,function(n){if(e>=s)return n;var i=t[e];switch(e+=1,n){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},ds=function(r,e,t){var s=e.format instanceof Function?e.format(e.push?t:t[e.name]):e.format,n=[r+"="+s];if(e.names)for(var i=0;i<e.names.length;i+=1){var a=e.names[i];e.name?n.push(t[e.name][a]):n.push(t[e.names[i]])}else n.push(t[e.name]);return Gm.apply(null,n)},Wm=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Zm=["i","c","b","a"],Jm=function(r,e){e=e||{},r.version==null&&(r.version=0),r.name==null&&(r.name=" "),r.media.forEach(function(i){i.payloads==null&&(i.payloads="")});var t=e.outerOrder||Wm,s=e.innerOrder||Zm,n=[];return t.forEach(function(i){ji[i].forEach(function(a){a.name in r&&r[a.name]!=null?n.push(ds(i,a,r)):a.push in r&&r[a.push]!=null&&r[a.push].forEach(function(c){n.push(ds(i,a,c))})})}),r.media.forEach(function(i){n.push(ds("m",ji.m[0],i)),s.forEach(function(a){ji[a].forEach(function(c){c.name in i&&i[c.name]!=null?n.push(ds(a,c,i)):c.push in i&&i[c.push]!=null&&i[c.push].forEach(function(u){n.push(ds(a,c,u))})})})}),n.join(`\r
`)+`\r
`},dr=Bl,Km=Jm;_e.write=Km;_e.parse=dr.parse;_e.parseParams=dr.parseParams;_e.parseFmtpConfig=dr.parseFmtpConfig;_e.parsePayloads=dr.parsePayloads;_e.parseRemoteCandidates=dr.parseRemoteCandidates;_e.parseImageAttributes=dr.parseImageAttributes;_e.parseSimulcastStreamList=dr.parseSimulcastStreamList;var Se={},Ym=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Qm=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Xm=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ym(e,r,t);return Qm(e,r),e};Object.defineProperty(Se,"__esModule",{value:!0});Se.applyCodecParameters=Se.getCname=Se.extractDtlsParameters=Se.extractRtpCapabilities=void 0;const Vl=Xm(_e);function eg({sdpObject:r}){const e=new Map,t=[];let s=!1,n=!1;for(const a of r.media){const c=a.type;switch(c){case"audio":{if(s)continue;s=!0;break}case"video":{if(n)continue;n=!0;break}default:continue}for(const u of a.rtp){const o={kind:c,mimeType:`${c}/${u.codec}`,preferredPayloadType:u.payload,clockRate:u.rate,channels:u.encoding,parameters:{},rtcpFeedback:[]};e.set(o.preferredPayloadType,o)}for(const u of a.fmtp||[]){const o=Vl.parseParams(u.config),l=e.get(u.payload);l&&(o&&o.hasOwnProperty("profile-level-id")&&(o["profile-level-id"]=String(o["profile-level-id"])),l.parameters=o)}for(const u of a.rtcpFb||[]){const o={type:u.type,parameter:u.subtype};if(o.parameter||delete o.parameter,u.payload!=="*"){const l=e.get(u.payload);if(!l)continue;l.rtcpFeedback.push(o)}else for(const l of e.values())l.kind===c&&!/.+\/rtx$/i.test(l.mimeType)&&l.rtcpFeedback.push(o)}for(const u of a.ext||[]){if(u["encrypt-uri"])continue;const o={kind:c,uri:u.uri,preferredId:u.value};t.push(o)}}return{codecs:Array.from(e.values()),headerExtensions:t}}Se.extractRtpCapabilities=eg;function tg({sdpObject:r}){const e=(r.media||[]).find(i=>i.iceUfrag&&i.port!==0);if(!e)throw new Error("no active media section found");const t=e.fingerprint||r.fingerprint;let s;switch(e.setup){case"active":s="client";break;case"passive":s="server";break;case"actpass":s="auto";break}return{role:s,fingerprints:[{algorithm:t.type,value:t.hash}]}}Se.extractDtlsParameters=tg;function rg({offerMediaObject:r}){const e=(r.ssrcs||[]).find(t=>t.attribute==="cname");return e?e.value:""}Se.getCname=rg;function sg({offerRtpParameters:r,answerMediaObject:e}){for(const t of r.codecs){const s=t.mimeType.toLowerCase();if(s!=="audio/opus"||!(e.rtp||[]).find(c=>c.payload===t.payloadType))continue;e.fmtp=e.fmtp||[];let i=e.fmtp.find(c=>c.payload===t.payloadType);i||(i={payload:t.payloadType,config:""},e.fmtp.push(i));const a=Vl.parseParams(i.config);switch(s){case"audio/opus":{const c=t.parameters["sprop-stereo"];c!==void 0&&(a.stereo=c?1:0);break}}i.config="";for(const c of Object.keys(a))i.config&&(i.config+=";"),i.config+=`${c}=${a[c]}`}}Se.applyCodecParameters=sg;var at={};Object.defineProperty(at,"__esModule",{value:!0});at.addLegacySimulcast=at.getRtpEncodings=void 0;function ng({offerMediaObject:r}){const e=new Set;for(const n of r.ssrcs||[]){const i=n.id;e.add(i)}if(e.size===0)throw new Error("no a=ssrc lines found");const t=new Map;for(const n of r.ssrcGroups||[]){if(n.semantics!=="FID")continue;let[i,a]=n.ssrcs.split(/\s+/);i=Number(i),a=Number(a),e.has(i)&&(e.delete(i),e.delete(a),t.set(i,a))}for(const n of e)t.set(n,null);const s=[];for(const[n,i]of t){const a={ssrc:n};i&&(a.rtx={ssrc:i}),s.push(a)}return s}at.getRtpEncodings=ng;function ig({offerMediaObject:r,numStreams:e}){if(e<=1)throw new TypeError("numStreams must be greater than 1");const t=(r.ssrcs||[]).find(d=>d.attribute==="msid");if(!t)throw new Error("a=ssrc line with msid information not found");const[s,n]=t.value.split(" "),i=t.id;let a;(r.ssrcGroups||[]).some(d=>{if(d.semantics!=="FID")return!1;const h=d.ssrcs.split(/\s+/);return Number(h[0])===i?(a=Number(h[1]),!0):!1});const c=r.ssrcs.find(d=>d.attribute==="cname");if(!c)throw new Error("a=ssrc line with cname information not found");const u=c.value,o=[],l=[];for(let d=0;d<e;++d)o.push(i+d),a&&l.push(a+d);r.ssrcGroups=[],r.ssrcs=[],r.ssrcGroups.push({semantics:"SIM",ssrcs:o.join(" ")});for(let d=0;d<o.length;++d){const h=o[d];r.ssrcs.push({id:h,attribute:"cname",value:u}),r.ssrcs.push({id:h,attribute:"msid",value:`${s} ${n}`})}for(let d=0;d<l.length;++d){const h=o[d],p=l[d];r.ssrcs.push({id:p,attribute:"cname",value:u}),r.ssrcs.push({id:p,attribute:"msid",value:`${s} ${n}`}),r.ssrcGroups.push({semantics:"FID",ssrcs:`${h} ${p}`})}}at.addLegacySimulcast=ig;var lr={};Object.defineProperty(lr,"__esModule",{value:!0});lr.addNackSuppportForOpus=void 0;function ag(r){var e;for(const t of r.codecs||[])(t.mimeType.toLowerCase()==="audio/opus"||t.mimeType.toLowerCase()==="audio/multiopus")&&!(!((e=t.rtcpFeedback)===null||e===void 0)&&e.some(s=>s.type==="nack"&&!s.parameter))&&(t.rtcpFeedback||(t.rtcpFeedback=[]),t.rtcpFeedback.push({type:"nack"}))}lr.addNackSuppportForOpus=ag;var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.HandlerInterface=void 0;const og=vt;class cg extends og.EnhancedEventEmitter{constructor(){super()}}xe.HandlerInterface=cg;var ze={},Kt={},dg=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),lg=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Hl=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&dg(e,r,t);return lg(e,r),e};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.OfferMediaSection=Kt.AnswerMediaSection=Kt.MediaSection=void 0;const ug=Hl(_e),Rc=Hl(ge);class to{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:s,planB:n=!1}){if(this._mediaObject={},this._planB=n,e&&this.setIceParameters(e),t){this._mediaObject.candidates=[];for(const i of t){const a={};a.component=1,a.foundation=i.foundation,a.ip=i.ip,a.port=i.port,a.priority=i.priority,a.transport=i.protocol,a.type=i.type,i.tcpType&&(a.tcptype=i.tcpType),this._mediaObject.candidates.push(a)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}s&&this.setDtlsRole(s.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}}Kt.MediaSection=to;class hg extends to{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:s,sctpParameters:n,plainRtpParameters:i,planB:a=!1,offerMediaObject:c,offerRtpParameters:u,answerRtpParameters:o,codecOptions:l,extmapAllowMixed:d=!1}){switch(super({iceParameters:e,iceCandidates:t,dtlsParameters:s,planB:a}),this._mediaObject.mid=String(c.mid),this._mediaObject.type=c.type,this._mediaObject.protocol=c.protocol,i?(this._mediaObject.connection={ip:i.ip,version:i.ipVersion},this._mediaObject.port=i.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),c.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const h of o.codecs){const p={payload:h.payloadType,codec:Oa(h),rate:h.clockRate};h.channels>1&&(p.encoding=h.channels),this._mediaObject.rtp.push(p);const f=Rc.clone(h.parameters,{});let w=Rc.clone(h.rtcpFeedback,[]);if(l){const{opusStereo:b,opusFec:E,opusDtx:M,opusMaxPlaybackRate:P,opusMaxAverageBitrate:y,opusPtime:D,opusNack:Z,videoGoogleStartBitrate:ae,videoGoogleMaxBitrate:Me,videoGoogleMinBitrate:me}=l,G=u.codecs.find(re=>re.payloadType===h.payloadType);switch(h.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{b!==void 0&&(G.parameters["sprop-stereo"]=b?1:0,f.stereo=b?1:0),E!==void 0&&(G.parameters.useinbandfec=E?1:0,f.useinbandfec=E?1:0),M!==void 0&&(G.parameters.usedtx=M?1:0,f.usedtx=M?1:0),P!==void 0&&(f.maxplaybackrate=P),y!==void 0&&(f.maxaveragebitrate=y),D!==void 0&&(G.parameters.ptime=D,f.ptime=D),Z||(G.rtcpFeedback=G.rtcpFeedback.filter(re=>re.type!=="nack"||re.parameter),w=w.filter(re=>re.type!=="nack"||re.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":{ae!==void 0&&(f["x-google-start-bitrate"]=ae),Me!==void 0&&(f["x-google-max-bitrate"]=Me),me!==void 0&&(f["x-google-min-bitrate"]=me);break}}}const g={payload:h.payloadType,config:""};for(const b of Object.keys(f))g.config&&(g.config+=";"),g.config+=`${b}=${f[b]}`;g.config&&this._mediaObject.fmtp.push(g);for(const b of w)this._mediaObject.rtcpFb.push({payload:h.payloadType,type:b.type,subtype:b.parameter})}this._mediaObject.payloads=o.codecs.map(h=>h.payloadType).join(" "),this._mediaObject.ext=[];for(const h of o.headerExtensions)(c.ext||[]).some(f=>f.uri===h.uri)&&this._mediaObject.ext.push({uri:h.uri,value:h.id});if(d&&c.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),c.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:c.simulcast.list1},this._mediaObject.rids=[];for(const h of c.rids||[])h.direction==="send"&&this._mediaObject.rids.push({id:h.id,direction:"recv"})}else if(c.simulcast_03){this._mediaObject.simulcast_03={value:c.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const h of c.rids||[])h.direction==="send"&&this._mediaObject.rids.push({id:h.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize",this._planB&&this._mediaObject.type==="video"&&(this._mediaObject.xGoogleFlag="conference");break}case"application":{typeof c.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=n.port,this._mediaObject.maxMessageSize=n.maxMessageSize):c.sctpmap&&(this._mediaObject.payloads=n.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:n.port,maxMessageSize:n.maxMessageSize});break}}}setDtlsRole(e){switch(e){case"client":this._mediaObject.setup="active";break;case"server":this._mediaObject.setup="passive";break;case"auto":this._mediaObject.setup="actpass";break}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(e){var t;if(!this._mediaObject.simulcast||!this._mediaObject.simulcast.list1)return;const s={};for(const a of e)a.rid&&(s[a.rid]=a);const n=this._mediaObject.simulcast.list1,i=ug.parseSimulcastStreamList(n);for(const a of i)for(const c of a)c.paused=!(!((t=s[c.scid])===null||t===void 0)&&t.active);this._mediaObject.simulcast.list1=i.map(a=>a.map(c=>`${c.paused?"~":""}${c.scid}`).join(",")).join(";")}}Kt.AnswerMediaSection=hg;class pg extends to{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:s,sctpParameters:n,plainRtpParameters:i,planB:a=!1,mid:c,kind:u,offerRtpParameters:o,streamId:l,trackId:d,oldDataChannelSpec:h=!1}){switch(super({iceParameters:e,iceCandidates:t,dtlsParameters:s,planB:a}),this._mediaObject.mid=String(c),this._mediaObject.type=u,i?(this._mediaObject.connection={ip:i.ip,version:i.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=i.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},n?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),u){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._planB||(this._mediaObject.msid=`${l||"-"} ${d}`);for(const g of o.codecs){const b={payload:g.payloadType,codec:Oa(g),rate:g.clockRate};g.channels>1&&(b.encoding=g.channels),this._mediaObject.rtp.push(b);const E={payload:g.payloadType,config:""};for(const M of Object.keys(g.parameters))E.config&&(E.config+=";"),E.config+=`${M}=${g.parameters[M]}`;E.config&&this._mediaObject.fmtp.push(E);for(const M of g.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:g.payloadType,type:M.type,subtype:M.parameter})}this._mediaObject.payloads=o.codecs.map(g=>g.payloadType).join(" "),this._mediaObject.ext=[];for(const g of o.headerExtensions)this._mediaObject.ext.push({uri:g.uri,value:g.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const p=o.encodings[0],f=p.ssrc,w=p.rtx&&p.rtx.ssrc?p.rtx.ssrc:void 0;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],o.rtcp.cname&&this._mediaObject.ssrcs.push({id:f,attribute:"cname",value:o.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:f,attribute:"msid",value:`${l||"-"} ${d}`}),w&&(o.rtcp.cname&&this._mediaObject.ssrcs.push({id:w,attribute:"cname",value:o.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:w,attribute:"msid",value:`${l||"-"} ${d}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${f} ${w}`}));break}case"application":{h?(this._mediaObject.payloads=n.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:n.port,maxMessageSize:n.maxMessageSize}):(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=n.port,this._mediaObject.maxMessageSize=n.maxMessageSize);break}}}setDtlsRole(e){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}planBReceive({offerRtpParameters:e,streamId:t,trackId:s}){const n=e.encodings[0],i=n.ssrc,a=n.rtx&&n.rtx.ssrc?n.rtx.ssrc:void 0,c=this._mediaObject.payloads.split(" ");for(const u of e.codecs){if(c.includes(String(u.payloadType)))continue;const o={payload:u.payloadType,codec:Oa(u),rate:u.clockRate};u.channels>1&&(o.encoding=u.channels),this._mediaObject.rtp.push(o);const l={payload:u.payloadType,config:""};for(const d of Object.keys(u.parameters))l.config&&(l.config+=";"),l.config+=`${d}=${u.parameters[d]}`;l.config&&this._mediaObject.fmtp.push(l);for(const d of u.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:u.payloadType,type:d.type,subtype:d.parameter})}this._mediaObject.payloads+=` ${e.codecs.filter(u=>!this._mediaObject.payloads.includes(u.payloadType)).map(u=>u.payloadType).join(" ")}`,this._mediaObject.payloads=this._mediaObject.payloads.trim(),e.rtcp.cname&&this._mediaObject.ssrcs.push({id:i,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:i,attribute:"msid",value:`${t||"-"} ${s}`}),a&&(e.rtcp.cname&&this._mediaObject.ssrcs.push({id:a,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:a,attribute:"msid",value:`${t||"-"} ${s}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${i} ${a}`}))}planBStopReceiving({offerRtpParameters:e}){const t=e.encodings[0],s=t.ssrc,n=t.rtx&&t.rtx.ssrc?t.rtx.ssrc:void 0;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter(i=>i.id!==s&&i.id!==n),n&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter(i=>i.ssrcs!==`${s} ${n}`))}}Kt.OfferMediaSection=pg;function Oa(r){const t=new RegExp("^(audio|video)/(.+)","i").exec(r.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");return t[2]}var fg=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),mg=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),gg=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&fg(e,r,t);return mg(e,r),e};Object.defineProperty(ze,"__esModule",{value:!0});ze.RemoteSdp=void 0;const _g=gg(_e),wg=fe,rn=Kt,Ui=new wg.Logger("RemoteSdp");class yg{constructor({iceParameters:e,iceCandidates:t,dtlsParameters:s,sctpParameters:n,plainRtpParameters:i,planB:a=!1}){if(this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=e,this._iceCandidates=t,this._dtlsParameters=s,this._sctpParameters=n,this._plainRtpParameters=i,this._planB=a,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},e&&e.iceLite&&(this._sdpObject.icelite="ice-lite"),s){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const c=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:s.fingerprints[c-1].algorithm,hash:s.fingerprints[c-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}i&&(this._sdpObject.origin.address=i.ip,this._sdpObject.origin.ipVer=i.ipVersion)}updateIceParameters(e){Ui.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;for(const t of this._mediaSections)t.setIceParameters(e)}updateDtlsRole(e){Ui.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;for(const t of this._mediaSections)t.setDtlsRole(e)}getNextMediaSectionIdx(){for(let e=0;e<this._mediaSections.length;++e){const t=this._mediaSections[e];if(t.closed)return{idx:e,reuseMid:t.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:e,reuseMid:t,offerRtpParameters:s,answerRtpParameters:n,codecOptions:i,extmapAllowMixed:a=!1}){const c=new rn.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:e,offerRtpParameters:s,answerRtpParameters:n,codecOptions:i,extmapAllowMixed:a});t?this._replaceMediaSection(c,t):this._midToIndex.has(c.mid)?this._replaceMediaSection(c):this._addMediaSection(c)}receive({mid:e,kind:t,offerRtpParameters:s,streamId:n,trackId:i}){const a=this._midToIndex.get(e);let c;if(a!==void 0&&(c=this._mediaSections[a]),c)c.planBReceive({offerRtpParameters:s,streamId:n,trackId:i}),this._replaceMediaSection(c);else{c=new rn.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:e,kind:t,offerRtpParameters:s,streamId:n,trackId:i});const u=this._mediaSections.find(o=>o.closed);u?this._replaceMediaSection(c,u.mid):this._addMediaSection(c)}}pauseMediaSection(e){this._findMediaSection(e).pause()}resumeSendingMediaSection(e){this._findMediaSection(e).resume()}resumeReceivingMediaSection(e){this._findMediaSection(e).resume()}disableMediaSection(e){this._findMediaSection(e).disable()}closeMediaSection(e){const t=this._findMediaSection(e);return e===this._firstMid?(Ui.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),this.disableMediaSection(e),!1):(t.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(e,t){const s=this._findMediaSection(e);s.muxSimulcastStreams(t),this._replaceMediaSection(s)}planBStopReceiving({mid:e,offerRtpParameters:t}){const s=this._findMediaSection(e);s.planBStopReceiving({offerRtpParameters:t}),this._replaceMediaSection(s)}sendSctpAssociation({offerMediaObject:e}){const t=new rn.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:e});this._addMediaSection(t)}receiveSctpAssociation({oldDataChannelSpec:e=!1}={}){const t=new rn.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:e});this._addMediaSection(t)}getSdp(){return this._sdpObject.origin.sessionVersion++,_g.write(this._sdpObject)}_addMediaSection(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}_replaceMediaSection(e,t){if(typeof t=="string"){const s=this._midToIndex.get(t);if(s===void 0)throw new Error(`no media section found for reuseMid '${t}'`);const n=this._mediaSections[s];this._mediaSections[s]=e,this._midToIndex.delete(n.mid),this._midToIndex.set(e.mid,s),this._sdpObject.media[s]=e.getObject(),this._regenerateBundleMids()}else{const s=this._midToIndex.get(e.mid);if(s===void 0)throw new Error(`no media section found with mid '${e.mid}'`);this._mediaSections[s]=e,this._sdpObject.media[s]=e.getObject()}}_findMediaSection(e){const t=this._midToIndex.get(e);if(t===void 0)throw new Error(`no media section found with mid '${e}'`);return this._mediaSections[t]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(e=>!e.closed).map(e=>e.mid).join(" "))}}ze.RemoteSdp=yg;var bt={};Object.defineProperty(bt,"__esModule",{value:!0});bt.parse=void 0;const vg=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function bg(r){const e=vg.exec(r||"");return e?{spatialLayers:Number(e[1]),temporalLayers:Number(e[2])}:{spatialLayers:1,temporalLayers:1}}bt.parse=bg;var Sg=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Rg=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Wr=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Sg(e,r,t);return Rg(e,r),e};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.Chrome111=void 0;const Bt=Wr(_e),Tg=fe,Tc=Wr(ge),br=Wr(k),sn=Wr(Se),Dc=Wr(at),Dg=Wr(lr),Cg=xe,Eg=ze,Mg=bt,F=new Tg.Logger("Chrome111"),Cc={OS:1024,MIS:1024};class ro extends Cg.HandlerInterface{static createFactory(){return()=>new ro}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome111"}close(){if(F.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){F.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const t=await e.createOffer();try{e.close()}catch{}const s=Bt.parse(t.sdp),n=sn.extractRtpCapabilities({sdpObject:s});return Dg.addNackSuppportForOpus(n),n}catch(t){try{e.close()}catch{}throw t}}async getNativeSctpCapabilities(){return F.debug("getNativeSctpCapabilities()"),{numStreams:Cc}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){F.debug("run()"),this._direction=e,this._remoteSdp=new Eg.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i}),this._sendingRtpParametersByKind={audio:br.getSendingRtpParameters("audio",l),video:br.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:br.getSendingRemoteRtpParameters("audio",l),video:br.getSendingRemoteRtpParameters("video",l)},n.role&&n.role!=="auto"&&(this._forcedLocalDtlsRole=n.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(F.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}}))}async updateIceServers(e){F.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(F.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});F.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();F.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){var i;if(this.assertSendDirection(),F.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&t.length>1){t.forEach((b,E)=>{b.rid=`r${E}`});let w=1,g=1;for(const b of t){const E=b.scalabilityMode?(0,Mg.parse)(b.scalabilityMode).temporalLayers:3;E>g&&(g=E)}for(const b of t)b.rid=`r${w++}`,b.scalabilityMode=`L1T${g}`}const a=Tc.clone(this._sendingRtpParametersByKind[e.kind],{});a.codecs=br.reduceCodecs(a.codecs,n);const c=Tc.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});c.codecs=br.reduceCodecs(c.codecs,n);const u=this._remoteSdp.getNextMediaSectionIdx(),o=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:t}),l=await this._pc.createOffer();let d=Bt.parse(l.sdp);this._transportReady||await this.setupTransport({localDtlsRole:(i=this._forcedLocalDtlsRole)!==null&&i!==void 0?i:"client",localSdpObject:d}),F.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const h=o.mid;a.mid=h,d=Bt.parse(this._pc.localDescription.sdp);const p=d.media[u.idx];if(a.rtcp.cname=sn.getCname({offerMediaObject:p}),!t)a.encodings=Dc.getRtpEncodings({offerMediaObject:p});else if(t.length===1){const w=Dc.getRtpEncodings({offerMediaObject:p});Object.assign(w[0],t[0]),a.encodings=w}else a.encodings=t;this._remoteSdp.send({offerMediaObject:p,reuseMid:u.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s,extmapAllowMixed:!0});const f={type:"answer",sdp:this._remoteSdp.getSdp()};return F.debug("send() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._mapMidTransceiver.set(h,o),{localId:h,rtpParameters:a,rtpSender:o.sender}}async stopSending(e){this.assertSendDirection(),F.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");if(t.sender.replaceTrack(null),this._pc.removeTrack(t.sender),this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch{}const n=await this._pc.createOffer();F.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),F.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const s=await this._pc.createOffer();F.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertSendDirection(),F.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly";const s=await this._pc.createOffer();F.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertSendDirection(),t?F.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):F.debug("replaceTrack() [localId:%s, no track]",e);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),F.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{u<=t?c.active=!0:c.active=!1}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();F.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),F.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{n.encodings[u]={...c,...t}}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();F.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){var a;this.assertSendDirection();const c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:s,protocol:i};F.debug("sendDataChannel() [options:%o]",c);const u=this._pc.createDataChannel(n,c);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Cc.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Bt.parse(l.sdp),h=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:(a=this._forcedLocalDtlsRole)!==null&&a!==void 0?a:"client",localSdpObject:d}),F.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:h});const p={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._hasDataChannelMediaSection=!0}const o={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits};return{dataChannel:u,sctpStreamParameters:o}}async receive(e){var t;this.assertRecvDirection();const s=[],n=new Map;for(const u of e){const{trackId:o,kind:l,rtpParameters:d,streamId:h}=u;F.debug("receive() [trackId:%s, kind:%s]",o,l);const p=d.mid||String(this._mapMidTransceiver.size);n.set(o,p),this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:h||d.rtcp.cname,trackId:o})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let a=await this._pc.createAnswer();const c=Bt.parse(a.sdp);for(const u of e){const{trackId:o,rtpParameters:l}=u,d=n.get(o),h=c.media.find(p=>String(p.mid)===d);sn.applyCodecParameters({offerRtpParameters:l,answerMediaObject:h})}a={type:"answer",sdp:Bt.write(c)},this._transportReady||await this.setupTransport({localDtlsRole:(t=this._forcedLocalDtlsRole)!==null&&t!==void 0?t:"client",localSdpObject:c}),F.debug("receive() | calling pc.setLocalDescription() [answer:%o]",a),await this._pc.setLocalDescription(a);for(const u of e){const{trackId:o}=u,l=n.get(o),d=this._pc.getTransceivers().find(h=>h.mid===l);if(d)this._mapMidTransceiver.set(l,d),s.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return s}async stopReceiving(e){this.assertRecvDirection();for(const n of e){F.debug("stopReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();F.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertRecvDirection();for(const n of e){F.debug("pauseReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();F.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(e){this.assertRecvDirection();for(const n of e){F.debug("resumeReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();F.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){var n;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u}=e,o={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u,protocol:s};F.debug("receiveDataChannel() [options:%o]",o);const l=this._pc.createDataChannel(t,o);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const h=await this._pc.createAnswer();if(!this._transportReady){const p=Bt.parse(h.sdp);await this.setupTransport({localDtlsRole:(n=this._forcedLocalDtlsRole)!==null&&n!==void 0?n:"client",localSdpObject:p})}F.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setLocalDescription(h),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=Bt.parse(this._pc.localDescription.sdp));const s=sn.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Gn.Chrome111=ro;var Wn={},Og=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Pg=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Zr=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Og(e,r,t);return Pg(e,r),e};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.Chrome74=void 0;const ht=Zr(_e),xg=fe,Ec=Zr(ge),Sr=Zr(k),nn=Zr(Se),Bi=Zr(at),kg=Zr(lr),Ig=xe,Lg=ze,Ag=bt,L=new xg.Logger("Chrome74"),Mc={OS:1024,MIS:1024};class so extends Ig.HandlerInterface{static createFactory(){return()=>new so}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome74"}close(){if(L.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){L.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const t=await e.createOffer();try{e.close()}catch{}const s=ht.parse(t.sdp),n=nn.extractRtpCapabilities({sdpObject:s});return kg.addNackSuppportForOpus(n),n}catch(t){try{e.close()}catch{}throw t}}async getNativeSctpCapabilities(){return L.debug("getNativeSctpCapabilities()"),{numStreams:Mc}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){L.debug("run()"),this._direction=e,this._remoteSdp=new Lg.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i}),this._sendingRtpParametersByKind={audio:Sr.getSendingRtpParameters("audio",l),video:Sr.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:Sr.getSendingRemoteRtpParameters("audio",l),video:Sr.getSendingRemoteRtpParameters("video",l)},n.role&&n.role!=="auto"&&(this._forcedLocalDtlsRole=n.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(L.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}}))}async updateIceServers(e){L.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(L.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});L.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();L.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){var i;this.assertSendDirection(),L.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&t.length>1&&t.forEach((b,E)=>{b.rid=`r${E}`});const a=Ec.clone(this._sendingRtpParametersByKind[e.kind],{});a.codecs=Sr.reduceCodecs(a.codecs,n);const c=Ec.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});c.codecs=Sr.reduceCodecs(c.codecs,n);const u=this._remoteSdp.getNextMediaSectionIdx(),o=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:t});let l=await this._pc.createOffer(),d=ht.parse(l.sdp),h;this._transportReady||await this.setupTransport({localDtlsRole:(i=this._forcedLocalDtlsRole)!==null&&i!==void 0?i:"client",localSdpObject:d});let p=!1;const f=(0,Ag.parse)((t||[{}])[0].scalabilityMode);t&&t.length===1&&f.spatialLayers>1&&a.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(L.debug("send() | enabling legacy simulcast for VP9 SVC"),p=!0,d=ht.parse(l.sdp),h=d.media[u.idx],Bi.addLegacySimulcast({offerMediaObject:h,numStreams:f.spatialLayers}),l={type:"offer",sdp:ht.write(d)}),L.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const w=o.mid;if(a.mid=w,d=ht.parse(this._pc.localDescription.sdp),h=d.media[u.idx],a.rtcp.cname=nn.getCname({offerMediaObject:h}),!t)a.encodings=Bi.getRtpEncodings({offerMediaObject:h});else if(t.length===1){let b=Bi.getRtpEncodings({offerMediaObject:h});Object.assign(b[0],t[0]),p&&(b=[b[0]]),a.encodings=b}else a.encodings=t;if(a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const b of a.encodings)b.scalabilityMode?b.scalabilityMode=`L1T${f.temporalLayers}`:b.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:h,reuseMid:u.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s,extmapAllowMixed:!0});const g={type:"answer",sdp:this._remoteSdp.getSdp()};return L.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),await this._pc.setRemoteDescription(g),this._mapMidTransceiver.set(w,o),{localId:w,rtpParameters:a,rtpSender:o.sender}}async stopSending(e){this.assertSendDirection(),L.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");if(t.sender.replaceTrack(null),this._pc.removeTrack(t.sender),this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch{}const n=await this._pc.createOffer();L.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),L.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const s=await this._pc.createOffer();L.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertSendDirection(),L.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly";const s=await this._pc.createOffer();L.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertSendDirection(),t?L.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):L.debug("replaceTrack() [localId:%s, no track]",e);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),L.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{u<=t?c.active=!0:c.active=!1}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();L.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),L.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{n.encodings[u]={...c,...t}}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();L.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){var a;this.assertSendDirection();const c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:s,protocol:i};L.debug("sendDataChannel() [options:%o]",c);const u=this._pc.createDataChannel(n,c);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Mc.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=ht.parse(l.sdp),h=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:(a=this._forcedLocalDtlsRole)!==null&&a!==void 0?a:"client",localSdpObject:d}),L.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:h});const p={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._hasDataChannelMediaSection=!0}const o={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits};return{dataChannel:u,sctpStreamParameters:o}}async receive(e){var t;this.assertRecvDirection();const s=[],n=new Map;for(const u of e){const{trackId:o,kind:l,rtpParameters:d,streamId:h}=u;L.debug("receive() [trackId:%s, kind:%s]",o,l);const p=d.mid||String(this._mapMidTransceiver.size);n.set(o,p),this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:h||d.rtcp.cname,trackId:o})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let a=await this._pc.createAnswer();const c=ht.parse(a.sdp);for(const u of e){const{trackId:o,rtpParameters:l}=u,d=n.get(o),h=c.media.find(p=>String(p.mid)===d);nn.applyCodecParameters({offerRtpParameters:l,answerMediaObject:h})}a={type:"answer",sdp:ht.write(c)},this._transportReady||await this.setupTransport({localDtlsRole:(t=this._forcedLocalDtlsRole)!==null&&t!==void 0?t:"client",localSdpObject:c}),L.debug("receive() | calling pc.setLocalDescription() [answer:%o]",a),await this._pc.setLocalDescription(a);for(const u of e){const{trackId:o}=u,l=n.get(o),d=this._pc.getTransceivers().find(h=>h.mid===l);if(d)this._mapMidTransceiver.set(l,d),s.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return s}async stopReceiving(e){this.assertRecvDirection();for(const n of e){L.debug("stopReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();L.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertRecvDirection();for(const n of e){L.debug("pauseReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();L.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(e){this.assertRecvDirection();for(const n of e){L.debug("resumeReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();L.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){var n;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u}=e,o={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u,protocol:s};L.debug("receiveDataChannel() [options:%o]",o);const l=this._pc.createDataChannel(t,o);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const h=await this._pc.createAnswer();if(!this._transportReady){const p=ht.parse(h.sdp);await this.setupTransport({localDtlsRole:(n=this._forcedLocalDtlsRole)!==null&&n!==void 0?n:"client",localSdpObject:p})}L.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setLocalDescription(h),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=ht.parse(this._pc.localDescription.sdp));const s=nn.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Wn.Chrome74=so;var Zn={},Ng=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Fg=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ks=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ng(e,r,t);return Fg(e,r),e};Object.defineProperty(Zn,"__esModule",{value:!0});Zn.Chrome70=void 0;const He=ks(_e),$g=fe,Oc=ks(ge),Rr=ks(k),an=ks(Se),qi=ks(at),jg=xe,Ug=ze,Bg=bt,B=new $g.Logger("Chrome70"),Pc={OS:1024,MIS:1024};class no extends jg.HandlerInterface{static createFactory(){return()=>new no}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome70"}close(){if(B.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){B.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const t=await e.createOffer();try{e.close()}catch{}const s=He.parse(t.sdp);return an.extractRtpCapabilities({sdpObject:s})}catch(t){try{e.close()}catch{}throw t}}async getNativeSctpCapabilities(){return B.debug("getNativeSctpCapabilities()"),{numStreams:Pc}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){B.debug("run()"),this._direction=e,this._remoteSdp=new Ug.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i}),this._sendingRtpParametersByKind={audio:Rr.getSendingRtpParameters("audio",l),video:Rr.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:Rr.getSendingRemoteRtpParameters("audio",l),video:Rr.getSendingRemoteRtpParameters("video",l)},n.role&&n.role!=="auto"&&(this._forcedLocalDtlsRole=n.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(B.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}})}async updateIceServers(e){B.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(B.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});B.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};B.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};B.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();B.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){var i;this.assertSendDirection(),B.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);const a=Oc.clone(this._sendingRtpParametersByKind[e.kind],{});a.codecs=Rr.reduceCodecs(a.codecs,n);const c=Oc.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});c.codecs=Rr.reduceCodecs(c.codecs,n);const u=this._remoteSdp.getNextMediaSectionIdx(),o=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});let l=await this._pc.createOffer(),d=He.parse(l.sdp),h;this._transportReady||await this.setupTransport({localDtlsRole:(i=this._forcedLocalDtlsRole)!==null&&i!==void 0?i:"client",localSdpObject:d}),t&&t.length>1&&(B.debug("send() | enabling legacy simulcast"),d=He.parse(l.sdp),h=d.media[u.idx],qi.addLegacySimulcast({offerMediaObject:h,numStreams:t.length}),l={type:"offer",sdp:He.write(d)});let p=!1;const f=(0,Bg.parse)((t||[{}])[0].scalabilityMode);if(t&&t.length===1&&f.spatialLayers>1&&a.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(B.debug("send() | enabling legacy simulcast for VP9 SVC"),p=!0,d=He.parse(l.sdp),h=d.media[u.idx],qi.addLegacySimulcast({offerMediaObject:h,numStreams:f.spatialLayers}),l={type:"offer",sdp:He.write(d)}),B.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),t){B.debug("send() | applying given encodings");const b=o.sender.getParameters();for(let E=0;E<(b.encodings||[]).length;++E){const M=b.encodings[E],P=t[E];if(!P)break;b.encodings[E]=Object.assign(M,P)}await o.sender.setParameters(b)}const w=o.mid;if(a.mid=w,d=He.parse(this._pc.localDescription.sdp),h=d.media[u.idx],a.rtcp.cname=an.getCname({offerMediaObject:h}),a.encodings=qi.getRtpEncodings({offerMediaObject:h}),t)for(let b=0;b<a.encodings.length;++b)t[b]&&Object.assign(a.encodings[b],t[b]);if(p&&(a.encodings=[a.encodings[0]]),a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const b of a.encodings)b.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:h,reuseMid:u.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const g={type:"answer",sdp:this._remoteSdp.getSdp()};return B.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),await this._pc.setRemoteDescription(g),this._mapMidTransceiver.set(w,o),{localId:w,rtpParameters:a,rtpSender:o.sender}}async stopSending(e){this.assertSendDirection(),B.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");if(t.sender.replaceTrack(null),this._pc.removeTrack(t.sender),this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch{}const n=await this._pc.createOffer();B.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};B.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?B.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):B.debug("replaceTrack() [localId:%s, no track]",e);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),B.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{u<=t?c.active=!0:c.active=!1}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();B.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};B.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),B.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{n.encodings[u]={...c,...t}}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();B.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};B.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){var a;this.assertSendDirection();const c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:s,protocol:i};B.debug("sendDataChannel() [options:%o]",c);const u=this._pc.createDataChannel(n,c);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Pc.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=He.parse(l.sdp),h=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:(a=this._forcedLocalDtlsRole)!==null&&a!==void 0?a:"client",localSdpObject:d}),B.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:h});const p={type:"answer",sdp:this._remoteSdp.getSdp()};B.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._hasDataChannelMediaSection=!0}const o={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits};return{dataChannel:u,sctpStreamParameters:o}}async receive(e){var t;this.assertRecvDirection();const s=[],n=new Map;for(const u of e){const{trackId:o,kind:l,rtpParameters:d,streamId:h}=u;B.debug("receive() [trackId:%s, kind:%s]",o,l);const p=d.mid||String(this._mapMidTransceiver.size);n.set(o,p),this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:h||d.rtcp.cname,trackId:o})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};B.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let a=await this._pc.createAnswer();const c=He.parse(a.sdp);for(const u of e){const{trackId:o,rtpParameters:l}=u,d=n.get(o),h=c.media.find(p=>String(p.mid)===d);an.applyCodecParameters({offerRtpParameters:l,answerMediaObject:h})}a={type:"answer",sdp:He.write(c)},this._transportReady||await this.setupTransport({localDtlsRole:(t=this._forcedLocalDtlsRole)!==null&&t!==void 0?t:"client",localSdpObject:c}),B.debug("receive() | calling pc.setLocalDescription() [answer:%o]",a),await this._pc.setLocalDescription(a);for(const u of e){const{trackId:o}=u,l=n.get(o),d=this._pc.getTransceivers().find(h=>h.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),s.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return s}async stopReceiving(e){this.assertRecvDirection();for(const n of e){B.debug("stopReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};B.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();B.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){var n;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u}=e,o={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:c,maxRetransmitTime:c,maxRetransmits:u,protocol:s};B.debug("receiveDataChannel() [options:%o]",o);const l=this._pc.createDataChannel(t,o);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};B.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const h=await this._pc.createAnswer();if(!this._transportReady){const p=He.parse(h.sdp);await this.setupTransport({localDtlsRole:(n=this._forcedLocalDtlsRole)!==null&&n!==void 0?n:"client",localSdpObject:p})}B.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setLocalDescription(h),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=He.parse(this._pc.localDescription.sdp));const s=an.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Zn.Chrome70=no;var Jn={},kt={};Object.defineProperty(kt,"__esModule",{value:!0});kt.addLegacySimulcast=kt.getRtpEncodings=void 0;function qg({offerMediaObject:r,track:e}){const t=new Set;for(const i of r.ssrcs||[]){if(i.attribute!=="msid")continue;if(i.value.split(" ")[1]===e.id){const c=i.id;t.add(c)}}if(t.size===0)throw new Error(`a=ssrc line with msid information not found [track.id:${e.id}]`);const s=new Map;for(const i of r.ssrcGroups||[]){if(i.semantics!=="FID")continue;let[a,c]=i.ssrcs.split(/\s+/);a=Number(a),c=Number(c),t.has(a)&&(t.delete(a),t.delete(c),s.set(a,c))}for(const i of t)s.set(i,null);const n=[];for(const[i,a]of s){const c={ssrc:i};a&&(c.rtx={ssrc:a}),n.push(c)}return n}kt.getRtpEncodings=qg;function zg({offerMediaObject:r,track:e,numStreams:t}){if(t<=1)throw new TypeError("numStreams must be greater than 1");let s,n,i;if(!(r.ssrcs||[]).find(d=>d.attribute!=="msid"?!1:d.value.split(" ")[1]===e.id?(s=d.id,i=d.value.split(" ")[0],!0):!1))throw new Error(`a=ssrc line with msid information not found [track.id:${e.id}]`);(r.ssrcGroups||[]).some(d=>{if(d.semantics!=="FID")return!1;const h=d.ssrcs.split(/\s+/);return Number(h[0])===s?(n=Number(h[1]),!0):!1});const c=r.ssrcs.find(d=>d.attribute==="cname"&&d.id===s);if(!c)throw new Error(`a=ssrc line with cname information not found [track.id:${e.id}]`);const u=c.value,o=[],l=[];for(let d=0;d<t;++d)o.push(s+d),n&&l.push(n+d);r.ssrcGroups=r.ssrcGroups||[],r.ssrcs=r.ssrcs||[],r.ssrcGroups.push({semantics:"SIM",ssrcs:o.join(" ")});for(let d=0;d<o.length;++d){const h=o[d];r.ssrcs.push({id:h,attribute:"cname",value:u}),r.ssrcs.push({id:h,attribute:"msid",value:`${i} ${e.id}`})}for(let d=0;d<l.length;++d){const h=o[d],p=l[d];r.ssrcs.push({id:p,attribute:"cname",value:u}),r.ssrcs.push({id:p,attribute:"msid",value:`${i} ${e.id}`}),r.ssrcGroups.push({semantics:"FID",ssrcs:`${h} ${p}`})}}kt.addLegacySimulcast=zg;var Vg=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Hg=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Is=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Vg(e,r,t);return Hg(e,r),e};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.Chrome67=void 0;const pt=Is(_e),Gg=fe,xc=Is(ge),Tr=Is(k),on=Is(Se),kc=Is(kt),Wg=xe,Zg=ze,q=new Gg.Logger("Chrome67"),Ic={OS:1024,MIS:1024};class io extends Wg.HandlerInterface{static createFactory(){return()=>new io}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome67"}close(){if(q.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){q.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const s=pt.parse(t.sdp);return on.extractRtpCapabilities({sdpObject:s})}catch(t){try{e.close()}catch{}throw t}}async getNativeSctpCapabilities(){return q.debug("getNativeSctpCapabilities()"),{numStreams:Ic}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){q.debug("run()"),this._direction=e,this._remoteSdp=new Zg.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,planB:!0}),this._sendingRtpParametersByKind={audio:Tr.getSendingRtpParameters("audio",l),video:Tr.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:Tr.getSendingRemoteRtpParameters("audio",l),video:Tr.getSendingRemoteRtpParameters("video",l)},n.role&&n.role!=="auto"&&(this._forcedLocalDtlsRole=n.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(q.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}})}async updateIceServers(e){q.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(q.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});q.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};q.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};q.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();q.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){var i;this.assertSendDirection(),q.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),n&&q.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let a=await this._pc.createOffer(),c=pt.parse(a.sdp),u;const o=xc.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=Tr.reduceCodecs(o.codecs);const l=xc.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(l.codecs=Tr.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:(i=this._forcedLocalDtlsRole)!==null&&i!==void 0?i:"client",localSdpObject:c}),e.kind==="video"&&t&&t.length>1&&(q.debug("send() | enabling simulcast"),c=pt.parse(a.sdp),u=c.media.find(f=>f.type==="video"),kc.addLegacySimulcast({offerMediaObject:u,track:e,numStreams:t.length}),a={type:"offer",sdp:pt.write(c)}),q.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a),c=pt.parse(this._pc.localDescription.sdp),u=c.media.find(f=>f.type===e.kind),o.rtcp.cname=on.getCname({offerMediaObject:u}),o.encodings=kc.getRtpEncodings({offerMediaObject:u,track:e}),t)for(let f=0;f<o.encodings.length;++f)t[f]&&Object.assign(o.encodings[f],t[f]);if(o.encodings.length>1&&o.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const f of o.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,offerRtpParameters:o,answerRtpParameters:l,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};q.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const h=String(this._nextSendLocalId);this._nextSendLocalId++;const p=this._pc.getSenders().find(f=>f.track===e);return this._mapSendLocalIdRtpSender.set(h,p),{localId:h,rtpParameters:o,rtpSender:p}}async stopSending(e){this.assertSendDirection(),q.debug("stopSending() [localId:%s]",e);const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");this._pc.removeTrack(t),t.track&&this._sendStream.removeTrack(t.track),this._mapSendLocalIdRtpSender.delete(e);const s=await this._pc.createOffer();q.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(i){if(this._sendStream.getTracks().length===0){q.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());return}throw i}if(this._pc.signalingState==="stable")return;const n={type:"answer",sdp:this._remoteSdp.getSdp()};q.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?q.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):q.debug("replaceTrack() [localId:%s, no track]",e);const s=this._mapSendLocalIdRtpSender.get(e);if(!s)throw new Error("associated RTCRtpSender not found");const n=s.track;await s.replaceTrack(t),n&&this._sendStream.removeTrack(n),t&&this._sendStream.addTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),q.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const s=this._mapSendLocalIdRtpSender.get(e);if(!s)throw new Error("associated RTCRtpSender not found");const n=s.getParameters();n.encodings.forEach((i,a)=>{a<=t?i.active=!0:i.active=!1}),await s.setParameters(n)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),q.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const s=this._mapSendLocalIdRtpSender.get(e);if(!s)throw new Error("associated RTCRtpSender not found");const n=s.getParameters();n.encodings.forEach((i,a)=>{n.encodings[a]={...i,...t}}),await s.setParameters(n)}async getSenderStats(e){this.assertSendDirection();const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");return t.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){var a;this.assertSendDirection();const c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:s,protocol:i};q.debug("sendDataChannel() [options:%o]",c);const u=this._pc.createDataChannel(n,c);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Ic.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=pt.parse(l.sdp),h=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:(a=this._forcedLocalDtlsRole)!==null&&a!==void 0?a:"client",localSdpObject:d}),q.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:h});const p={type:"answer",sdp:this._remoteSdp.getSdp()};q.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._hasDataChannelMediaSection=!0}const o={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits};return{dataChannel:u,sctpStreamParameters:o}}async receive(e){var t;this.assertRecvDirection();const s=[];for(const c of e){const{trackId:u,kind:o,rtpParameters:l,streamId:d}=c;q.debug("receive() [trackId:%s, kind:%s]",u,o);const h=o;this._remoteSdp.receive({mid:h,kind:o,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:u})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};q.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=pt.parse(i.sdp);for(const c of e){const{kind:u,rtpParameters:o}=c,l=u,d=a.media.find(h=>String(h.mid)===l);on.applyCodecParameters({offerRtpParameters:o,answerMediaObject:d})}i={type:"answer",sdp:pt.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:(t=this._forcedLocalDtlsRole)!==null&&t!==void 0?t:"client",localSdpObject:a}),q.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const c of e){const{kind:u,trackId:o,rtpParameters:l}=c,d=o,h=u,p=this._pc.getReceivers().find(f=>f.track&&f.track.id===d);if(!p)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(d,{mid:h,rtpParameters:l,rtpReceiver:p}),s.push({localId:d,track:p.track,rtpReceiver:p})}return s}async stopReceiving(e){this.assertRecvDirection();for(const n of e){q.debug("stopReceiving() [localId:%s]",n);const{mid:i,rtpParameters:a}=this._mapRecvLocalIdInfo.get(n)||{};this._mapRecvLocalIdInfo.delete(n),this._remoteSdp.planBStopReceiving({mid:i,offerRtpParameters:a})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};q.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();q.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:t}=this._mapRecvLocalIdInfo.get(e)||{};if(!t)throw new Error("associated RTCRtpReceiver not found");return t.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){var n;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u}=e,o={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:c,maxRetransmitTime:c,maxRetransmits:u,protocol:s};q.debug("receiveDataChannel() [options:%o]",o);const l=this._pc.createDataChannel(t,o);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};q.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const h=await this._pc.createAnswer();if(!this._transportReady){const p=pt.parse(h.sdp);await this.setupTransport({localDtlsRole:(n=this._forcedLocalDtlsRole)!==null&&n!==void 0?n:"client",localSdpObject:p})}q.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setLocalDescription(h),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=pt.parse(this._pc.localDescription.sdp));const s=on.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Jn.Chrome67=io;var Kn={},Jg=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Kg=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Ls=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Jg(e,r,t);return Kg(e,r),e};Object.defineProperty(Kn,"__esModule",{value:!0});Kn.Chrome55=void 0;const ft=Ls(_e),Yg=fe,ls=Pe,Lc=Ls(ge),Dr=Ls(k),cn=Ls(Se),Ac=Ls(kt),Qg=xe,Xg=ze,X=new Yg.Logger("Chrome55"),Nc={OS:1024,MIS:1024};class ao extends Qg.HandlerInterface{static createFactory(){return()=>new ao}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Chrome55"}close(){if(X.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){X.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const s=ft.parse(t.sdp);return cn.extractRtpCapabilities({sdpObject:s})}catch(t){try{e.close()}catch{}throw t}}async getNativeSctpCapabilities(){return X.debug("getNativeSctpCapabilities()"),{numStreams:Nc}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){X.debug("run()"),this._direction=e,this._remoteSdp=new Xg.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,planB:!0}),this._sendingRtpParametersByKind={audio:Dr.getSendingRtpParameters("audio",l),video:Dr.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:Dr.getSendingRemoteRtpParameters("audio",l),video:Dr.getSendingRemoteRtpParameters("video",l)},n.role&&n.role!=="auto"&&(this._forcedLocalDtlsRole=n.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(X.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}})}async updateIceServers(e){X.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(X.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});X.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};X.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};X.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();X.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){var i;this.assertSendDirection(),X.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),n&&X.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let a=await this._pc.createOffer(),c=ft.parse(a.sdp),u;const o=Lc.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=Dr.reduceCodecs(o.codecs);const l=Lc.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(l.codecs=Dr.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:(i=this._forcedLocalDtlsRole)!==null&&i!==void 0?i:"client",localSdpObject:c}),e.kind==="video"&&t&&t.length>1&&(X.debug("send() | enabling simulcast"),c=ft.parse(a.sdp),u=c.media.find(p=>p.type==="video"),Ac.addLegacySimulcast({offerMediaObject:u,track:e,numStreams:t.length}),a={type:"offer",sdp:ft.write(c)}),X.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a),c=ft.parse(this._pc.localDescription.sdp),u=c.media.find(p=>p.type===e.kind),o.rtcp.cname=cn.getCname({offerMediaObject:u}),o.encodings=Ac.getRtpEncodings({offerMediaObject:u,track:e}),t)for(let p=0;p<o.encodings.length;++p)t[p]&&Object.assign(o.encodings[p],t[p]);if(o.encodings.length>1&&o.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const p of o.encodings)p.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,offerRtpParameters:o,answerRtpParameters:l,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};X.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const h=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(h,e),{localId:h,rtpParameters:o}}async stopSending(e){this.assertSendDirection(),X.debug("stopSending() [localId:%s]",e);const t=this._mapSendLocalIdTrack.get(e);if(!t)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(t),this._pc.addStream(this._sendStream);const s=await this._pc.createOffer();X.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(i){if(this._sendStream.getTracks().length===0){X.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());return}throw i}if(this._pc.signalingState==="stable")return;const n={type:"answer",sdp:this._remoteSdp.getSdp()};X.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){throw new ls.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,t){throw new ls.UnsupportedError(" not implemented")}async setRtpEncodingParameters(e,t){throw new ls.UnsupportedError("not supported")}async getSenderStats(e){throw new ls.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){var a;this.assertSendDirection();const c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:s,protocol:i};X.debug("sendDataChannel() [options:%o]",c);const u=this._pc.createDataChannel(n,c);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Nc.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=ft.parse(l.sdp),h=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:(a=this._forcedLocalDtlsRole)!==null&&a!==void 0?a:"client",localSdpObject:d}),X.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:h});const p={type:"answer",sdp:this._remoteSdp.getSdp()};X.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._hasDataChannelMediaSection=!0}const o={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits};return{dataChannel:u,sctpStreamParameters:o}}async receive(e){var t;this.assertRecvDirection();const s=[];for(const c of e){const{trackId:u,kind:o,rtpParameters:l,streamId:d}=c;X.debug("receive() [trackId:%s, kind:%s]",u,o);const h=o;this._remoteSdp.receive({mid:h,kind:o,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:u})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};X.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=ft.parse(i.sdp);for(const c of e){const{kind:u,rtpParameters:o}=c,l=u,d=a.media.find(h=>String(h.mid)===l);cn.applyCodecParameters({offerRtpParameters:o,answerMediaObject:d})}i={type:"answer",sdp:ft.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:(t=this._forcedLocalDtlsRole)!==null&&t!==void 0?t:"client",localSdpObject:a}),X.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const c of e){const{kind:u,trackId:o,rtpParameters:l}=c,d=u,h=o,p=c.streamId||l.rtcp.cname,w=this._pc.getRemoteStreams().find(g=>g.id===p).getTrackById(h);if(!w)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(h,{mid:d,rtpParameters:l}),s.push({localId:h,track:w})}return s}async stopReceiving(e){this.assertRecvDirection();for(const n of e){X.debug("stopReceiving() [localId:%s]",n);const{mid:i,rtpParameters:a}=this._mapRecvLocalIdInfo.get(n)||{};this._mapRecvLocalIdInfo.delete(n),this._remoteSdp.planBStopReceiving({mid:i,offerRtpParameters:a})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};X.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();X.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new ls.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){var n;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u}=e,o={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:c,maxRetransmitTime:c,maxRetransmits:u,protocol:s};X.debug("receiveDataChannel() [options:%o]",o);const l=this._pc.createDataChannel(t,o);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};X.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const h=await this._pc.createAnswer();if(!this._transportReady){const p=ft.parse(h.sdp);await this.setupTransport({localDtlsRole:(n=this._forcedLocalDtlsRole)!==null&&n!==void 0?n:"client",localSdpObject:p})}X.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setLocalDescription(h),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=ft.parse(this._pc.localDescription.sdp));const s=cn.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Kn.Chrome55=ao;var Yn={},e_=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),t_=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),As=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&e_(e,r,t);return t_(e,r),e};Object.defineProperty(Yn,"__esModule",{value:!0});Yn.Firefox60=void 0;const qt=As(_e),r_=fe,s_=Pe,zi=As(ge),Cr=As(k),dn=As(Se),Fc=As(at),n_=xe,i_=ze,a_=bt,$=new r_.Logger("Firefox60"),$c={OS:16,MIS:2048};class oo extends n_.HandlerInterface{static createFactory(){return()=>new oo}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Firefox60"}close(){if($.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){$.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),t=document.createElement("canvas");t.getContext("2d");const n=t.captureStream().getVideoTracks()[0];try{e.addTransceiver("audio",{direction:"sendrecv"});const i=e.addTransceiver(n,{direction:"sendrecv"}),a=i.sender.getParameters(),c=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}];a.encodings=c,await i.sender.setParameters(a);const u=await e.createOffer();try{t.remove()}catch{}try{n.stop()}catch{}try{e.close()}catch{}const o=qt.parse(u.sdp);return dn.extractRtpCapabilities({sdpObject:o})}catch(i){try{t.remove()}catch{}try{n.stop()}catch{}try{e.close()}catch{}throw i}}async getNativeSctpCapabilities(){return $.debug("getNativeSctpCapabilities()"),{numStreams:$c}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){$.debug("run()"),this._direction=e,this._remoteSdp=new i_.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i}),this._sendingRtpParametersByKind={audio:Cr.getSendingRtpParameters("audio",l),video:Cr.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:Cr.getSendingRemoteRtpParameters("audio",l),video:Cr.getSendingRemoteRtpParameters("video",l)},this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch($.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}})}async updateIceServers(e){throw new s_.UnsupportedError("not supported")}async restartIce(e){if($.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});$.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();$.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){this.assertSendDirection(),$.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&(t=zi.clone(t,[]),t.length>1&&(t.forEach((f,w)=>{f.rid=`r${w}`}),t.reverse()));const i=zi.clone(this._sendingRtpParametersByKind[e.kind],{});i.codecs=Cr.reduceCodecs(i.codecs,n);const a=zi.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});a.codecs=Cr.reduceCodecs(a.codecs,n);const c=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});if(t){const f=c.sender.getParameters();f.encodings=t,await c.sender.setParameters(f)}const u=await this._pc.createOffer();let o=qt.parse(u.sdp);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:o});const l=(0,a_.parse)((t||[{}])[0].scalabilityMode);$.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u);const d=c.mid;i.mid=d,o=qt.parse(this._pc.localDescription.sdp);const h=o.media[o.media.length-1];if(i.rtcp.cname=dn.getCname({offerMediaObject:h}),!t)i.encodings=Fc.getRtpEncodings({offerMediaObject:h});else if(t.length===1){const f=Fc.getRtpEncodings({offerMediaObject:h});Object.assign(f[0],t[0]),i.encodings=f}else i.encodings=t.reverse();if(i.encodings.length>1&&(i.codecs[0].mimeType.toLowerCase()==="video/vp8"||i.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const f of i.encodings)f.scalabilityMode?f.scalabilityMode=`L1T${l.temporalLayers}`:f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:h,offerRtpParameters:i,answerRtpParameters:a,codecOptions:s,extmapAllowMixed:!0});const p={type:"answer",sdp:this._remoteSdp.getSdp()};return $.debug("send() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._mapMidTransceiver.set(d,c),{localId:d,rtpParameters:i,rtpSender:c.sender}}async stopSending(e){$.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated transceiver not found");t.sender.replaceTrack(null),this._pc.removeTrack(t.sender),this._remoteSdp.disableMediaSection(t.mid);const s=await this._pc.createOffer();$.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),$.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const s=await this._pc.createOffer();$.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertSendDirection(),$.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const s=await this._pc.createOffer();$.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertSendDirection(),t?$.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):$.debug("replaceTrack() [localId:%s, no track]",e);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),$.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated transceiver not found");const n=s.sender.getParameters();t=n.encodings.length-1-t,n.encodings.forEach((c,u)=>{u>=t?c.active=!0:c.active=!1}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();$.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),$.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{n.encodings[u]={...c,...t}}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();$.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:s,protocol:i};$.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(n,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%$c.MIS,!this._hasDataChannelMediaSection){const o=await this._pc.createOffer(),l=qt.parse(o.sdp),d=l.media.find(p=>p.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:l}),$.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),this._remoteSdp.sendSctpAssociation({offerMediaObject:d});const h={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setRemoteDescription(h),this._hasDataChannelMediaSection=!0}const u={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:u}}async receive(e){this.assertRecvDirection();const t=[],s=new Map;for(const c of e){const{trackId:u,kind:o,rtpParameters:l,streamId:d}=c;$.debug("receive() [trackId:%s, kind:%s]",u,o);const h=l.mid||String(this._mapMidTransceiver.size);s.set(u,h),this._remoteSdp.receive({mid:h,kind:o,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:u})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=qt.parse(i.sdp);for(const c of e){const{trackId:u,rtpParameters:o}=c,l=s.get(u),d=a.media.find(h=>String(h.mid)===l);dn.applyCodecParameters({offerRtpParameters:o,answerMediaObject:d}),i={type:"answer",sdp:qt.write(a)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:a}),$.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const c of e){const{trackId:u}=c,o=s.get(u),l=this._pc.getTransceivers().find(d=>d.mid===o);if(!l)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(o,l),t.push({localId:o,track:l.receiver.track,rtpReceiver:l.receiver})}return t}async stopReceiving(e){this.assertRecvDirection();for(const n of e){$.debug("stopReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();$.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertRecvDirection();for(const n of e){$.debug("pauseReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();$.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(e){this.assertRecvDirection();for(const n of e){$.debug("resumeReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();$.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){this.assertRecvDirection();const{streamId:n,ordered:i,maxPacketLifeTime:a,maxRetransmits:c}=e,u={negotiated:!0,id:n,ordered:i,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};$.debug("receiveDataChannel() [options:%o]",u);const o=this._pc.createDataChannel(t,u);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const l={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",l),await this._pc.setRemoteDescription(l);const d=await this._pc.createAnswer();if(!this._transportReady){const h=qt.parse(d.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:h})}$.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setLocalDescription(d),this._hasDataChannelMediaSection=!0}return{dataChannel:o}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=qt.parse(this._pc.localDescription.sdp));const s=dn.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Yn.Firefox60=oo;var Qn={},o_=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),c_=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Jr=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&o_(e,r,t);return c_(e,r),e};Object.defineProperty(Qn,"__esModule",{value:!0});Qn.Safari12=void 0;const mt=Jr(_e),d_=fe,jc=Jr(ge),Er=Jr(k),ln=Jr(Se),Uc=Jr(at),l_=Jr(lr),u_=xe,h_=ze,p_=bt,A=new d_.Logger("Safari12"),Bc={OS:1024,MIS:1024};class co extends u_.HandlerInterface{static createFactory(){return()=>new co}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Safari12"}close(){if(A.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){A.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{e.addTransceiver("audio"),e.addTransceiver("video");const t=await e.createOffer();try{e.close()}catch{}const s=mt.parse(t.sdp),n=ln.extractRtpCapabilities({sdpObject:s});return l_.addNackSuppportForOpus(n),n}catch(t){try{e.close()}catch{}throw t}}async getNativeSctpCapabilities(){return A.debug("getNativeSctpCapabilities()"),{numStreams:Bc}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){A.debug("run()"),this._direction=e,this._remoteSdp=new h_.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i}),this._sendingRtpParametersByKind={audio:Er.getSendingRtpParameters("audio",l),video:Er.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:Er.getSendingRemoteRtpParameters("audio",l),video:Er.getSendingRemoteRtpParameters("video",l)},n.role&&n.role!=="auto"&&(this._forcedLocalDtlsRole=n.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(A.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}})}async updateIceServers(e){A.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(A.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});A.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();A.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){var i;this.assertSendDirection(),A.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);const a=jc.clone(this._sendingRtpParametersByKind[e.kind],{});a.codecs=Er.reduceCodecs(a.codecs,n);const c=jc.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});c.codecs=Er.reduceCodecs(c.codecs,n);const u=this._remoteSdp.getNextMediaSectionIdx(),o=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});let l=await this._pc.createOffer(),d=mt.parse(l.sdp),h;this._transportReady||await this.setupTransport({localDtlsRole:(i=this._forcedLocalDtlsRole)!==null&&i!==void 0?i:"client",localSdpObject:d});const p=(0,p_.parse)((t||[{}])[0].scalabilityMode);t&&t.length>1&&(A.debug("send() | enabling legacy simulcast"),d=mt.parse(l.sdp),h=d.media[u.idx],Uc.addLegacySimulcast({offerMediaObject:h,numStreams:t.length}),l={type:"offer",sdp:mt.write(d)}),A.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const f=o.mid;if(a.mid=f,d=mt.parse(this._pc.localDescription.sdp),h=d.media[u.idx],a.rtcp.cname=ln.getCname({offerMediaObject:h}),a.encodings=Uc.getRtpEncodings({offerMediaObject:h}),t)for(let g=0;g<a.encodings.length;++g)t[g]&&Object.assign(a.encodings[g],t[g]);if(a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const g of a.encodings)g.scalabilityMode?g.scalabilityMode=`L1T${p.temporalLayers}`:g.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:h,reuseMid:u.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const w={type:"answer",sdp:this._remoteSdp.getSdp()};return A.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w),this._mapMidTransceiver.set(f,o),{localId:f,rtpParameters:a,rtpSender:o.sender}}async stopSending(e){this.assertSendDirection(),A.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");if(t.sender.replaceTrack(null),this._pc.removeTrack(t.sender),this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch{}const n=await this._pc.createOffer();A.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),A.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const s=await this._pc.createOffer();A.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertSendDirection(),A.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const s=await this._pc.createOffer();A.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertSendDirection(),t?A.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):A.debug("replaceTrack() [localId:%s, no track]",e);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),A.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{u<=t?c.active=!0:c.active=!1}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();A.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),A.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{n.encodings[u]={...c,...t}}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();A.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){var a;this.assertSendDirection();const c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:s,protocol:i};A.debug("sendDataChannel() [options:%o]",c);const u=this._pc.createDataChannel(n,c);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Bc.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=mt.parse(l.sdp),h=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:(a=this._forcedLocalDtlsRole)!==null&&a!==void 0?a:"client",localSdpObject:d}),A.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:h});const p={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._hasDataChannelMediaSection=!0}const o={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits};return{dataChannel:u,sctpStreamParameters:o}}async receive(e){var t;this.assertRecvDirection();const s=[],n=new Map;for(const u of e){const{trackId:o,kind:l,rtpParameters:d,streamId:h}=u;A.debug("receive() [trackId:%s, kind:%s]",o,l);const p=d.mid||String(this._mapMidTransceiver.size);n.set(o,p),this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:h||d.rtcp.cname,trackId:o})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let a=await this._pc.createAnswer();const c=mt.parse(a.sdp);for(const u of e){const{trackId:o,rtpParameters:l}=u,d=n.get(o),h=c.media.find(p=>String(p.mid)===d);ln.applyCodecParameters({offerRtpParameters:l,answerMediaObject:h})}a={type:"answer",sdp:mt.write(c)},this._transportReady||await this.setupTransport({localDtlsRole:(t=this._forcedLocalDtlsRole)!==null&&t!==void 0?t:"client",localSdpObject:c}),A.debug("receive() | calling pc.setLocalDescription() [answer:%o]",a),await this._pc.setLocalDescription(a);for(const u of e){const{trackId:o}=u,l=n.get(o),d=this._pc.getTransceivers().find(h=>h.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),s.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return s}async stopReceiving(e){this.assertRecvDirection();for(const n of e){A.debug("stopReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();A.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertRecvDirection();for(const n of e){A.debug("pauseReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();A.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(e){this.assertRecvDirection();for(const n of e){A.debug("resumeReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();A.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){var n;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u}=e,o={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u,protocol:s};A.debug("receiveDataChannel() [options:%o]",o);const l=this._pc.createDataChannel(t,o);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const h=await this._pc.createAnswer();if(!this._transportReady){const p=mt.parse(h.sdp);await this.setupTransport({localDtlsRole:(n=this._forcedLocalDtlsRole)!==null&&n!==void 0?n:"client",localSdpObject:p})}A.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setLocalDescription(h),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=mt.parse(this._pc.localDescription.sdp));const s=ln.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Qn.Safari12=co;var Xn={},f_=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),m_=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Ns=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&f_(e,r,t);return m_(e,r),e};Object.defineProperty(Xn,"__esModule",{value:!0});Xn.Safari11=void 0;const gt=Ns(_e),g_=fe,qc=Ns(ge),Mr=Ns(k),un=Ns(Se),zc=Ns(kt),__=xe,w_=ze,H=new g_.Logger("Safari11"),Vc={OS:1024,MIS:1024};class lo extends __.HandlerInterface{static createFactory(){return()=>new lo}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"Safari11"}close(){if(H.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){H.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const s=gt.parse(t.sdp);return un.extractRtpCapabilities({sdpObject:s})}catch(t){try{e.close()}catch{}throw t}}async getNativeSctpCapabilities(){return H.debug("getNativeSctpCapabilities()"),{numStreams:Vc}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){H.debug("run()"),this._direction=e,this._remoteSdp=new w_.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,planB:!0}),this._sendingRtpParametersByKind={audio:Mr.getSendingRtpParameters("audio",l),video:Mr.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:Mr.getSendingRemoteRtpParameters("audio",l),video:Mr.getSendingRemoteRtpParameters("video",l)},n.role&&n.role!=="auto"&&(this._forcedLocalDtlsRole=n.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(H.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}})}async updateIceServers(e){H.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(H.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});H.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();H.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){var i;this.assertSendDirection(),H.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),n&&H.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let a=await this._pc.createOffer(),c=gt.parse(a.sdp),u;const o=qc.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=Mr.reduceCodecs(o.codecs);const l=qc.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(l.codecs=Mr.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:(i=this._forcedLocalDtlsRole)!==null&&i!==void 0?i:"client",localSdpObject:c}),e.kind==="video"&&t&&t.length>1&&(H.debug("send() | enabling simulcast"),c=gt.parse(a.sdp),u=c.media.find(f=>f.type==="video"),zc.addLegacySimulcast({offerMediaObject:u,track:e,numStreams:t.length}),a={type:"offer",sdp:gt.write(c)}),H.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a),c=gt.parse(this._pc.localDescription.sdp),u=c.media.find(f=>f.type===e.kind),o.rtcp.cname=un.getCname({offerMediaObject:u}),o.encodings=zc.getRtpEncodings({offerMediaObject:u,track:e}),t)for(let f=0;f<o.encodings.length;++f)t[f]&&Object.assign(o.encodings[f],t[f]);if(o.encodings.length>1&&o.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const f of o.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,offerRtpParameters:o,answerRtpParameters:l,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const h=String(this._nextSendLocalId);this._nextSendLocalId++;const p=this._pc.getSenders().find(f=>f.track===e);return this._mapSendLocalIdRtpSender.set(h,p),{localId:h,rtpParameters:o,rtpSender:p}}async stopSending(e){this.assertSendDirection();const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");t.track&&this._sendStream.removeTrack(t.track),this._mapSendLocalIdRtpSender.delete(e);const s=await this._pc.createOffer();H.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(i){if(this._sendStream.getTracks().length===0){H.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());return}throw i}if(this._pc.signalingState==="stable")return;const n={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){this.assertSendDirection(),t?H.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):H.debug("replaceTrack() [localId:%s, no track]",e);const s=this._mapSendLocalIdRtpSender.get(e);if(!s)throw new Error("associated RTCRtpSender not found");const n=s.track;await s.replaceTrack(t),n&&this._sendStream.removeTrack(n),t&&this._sendStream.addTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),H.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const s=this._mapSendLocalIdRtpSender.get(e);if(!s)throw new Error("associated RTCRtpSender not found");const n=s.getParameters();n.encodings.forEach((i,a)=>{a<=t?i.active=!0:i.active=!1}),await s.setParameters(n)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),H.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const s=this._mapSendLocalIdRtpSender.get(e);if(!s)throw new Error("associated RTCRtpSender not found");const n=s.getParameters();n.encodings.forEach((i,a)=>{n.encodings[a]={...i,...t}}),await s.setParameters(n)}async getSenderStats(e){this.assertSendDirection();const t=this._mapSendLocalIdRtpSender.get(e);if(!t)throw new Error("associated RTCRtpSender not found");return t.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){var a;this.assertSendDirection();const c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:s,protocol:i};H.debug("sendDataChannel() [options:%o]",c);const u=this._pc.createDataChannel(n,c);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Vc.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=gt.parse(l.sdp),h=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:(a=this._forcedLocalDtlsRole)!==null&&a!==void 0?a:"client",localSdpObject:d}),H.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:h});const p={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._hasDataChannelMediaSection=!0}const o={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits};return{dataChannel:u,sctpStreamParameters:o}}async receive(e){var t;this.assertRecvDirection();const s=[];for(const c of e){const{trackId:u,kind:o,rtpParameters:l,streamId:d}=c;H.debug("receive() [trackId:%s, kind:%s]",u,o);const h=o;this._remoteSdp.receive({mid:h,kind:o,offerRtpParameters:l,streamId:d||l.rtcp.cname,trackId:u})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const a=gt.parse(i.sdp);for(const c of e){const{kind:u,rtpParameters:o}=c,l=u,d=a.media.find(h=>String(h.mid)===l);un.applyCodecParameters({offerRtpParameters:o,answerMediaObject:d})}i={type:"answer",sdp:gt.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:(t=this._forcedLocalDtlsRole)!==null&&t!==void 0?t:"client",localSdpObject:a}),H.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const c of e){const{kind:u,trackId:o,rtpParameters:l}=c,d=u,h=o,p=this._pc.getReceivers().find(f=>f.track&&f.track.id===h);if(!p)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(h,{mid:d,rtpParameters:l,rtpReceiver:p}),s.push({localId:h,track:p.track,rtpReceiver:p})}return s}async stopReceiving(e){this.assertRecvDirection();for(const n of e){H.debug("stopReceiving() [localId:%s]",n);const{mid:i,rtpParameters:a}=this._mapRecvLocalIdInfo.get(n)||{};this._mapRecvLocalIdInfo.delete(n),this._remoteSdp.planBStopReceiving({mid:i,offerRtpParameters:a})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();H.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:t}=this._mapRecvLocalIdInfo.get(e)||{};if(!t)throw new Error("associated RTCRtpReceiver not found");return t.getStats()}async pauseReceiving(e){}async resumeReceiving(e){}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){var n;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u}=e,o={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u,protocol:s};H.debug("receiveDataChannel() [options:%o]",o);const l=this._pc.createDataChannel(t,o);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const h=await this._pc.createAnswer();if(!this._transportReady){const p=gt.parse(h.sdp);await this.setupTransport({localDtlsRole:(n=this._forcedLocalDtlsRole)!==null&&n!==void 0?n:"client",localSdpObject:p})}H.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setLocalDescription(h),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=gt.parse(this._pc.localDescription.sdp));const s=un.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Xn.Safari11=lo;var ei={},qr={},y_=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),v_=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),b_=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&y_(e,r,t);return v_(e,r),e};Object.defineProperty(qr,"__esModule",{value:!0});qr.mangleRtpParameters=qr.getCapabilities=void 0;const Gl=b_(ge);function S_(){const r=RTCRtpReceiver.getCapabilities(),e=Gl.clone(r,{});for(const t of e.codecs){if(t.channels=t.numChannels,delete t.numChannels,t.mimeType=t.mimeType||`${t.kind}/${t.name}`,t.parameters){const s=t.parameters;s.apt&&(s.apt=Number(s.apt)),s["packetization-mode"]&&(s["packetization-mode"]=Number(s["packetization-mode"]))}for(const s of t.rtcpFeedback||[])s.parameter||(s.parameter="")}return e}qr.getCapabilities=S_;function R_(r){const e=Gl.clone(r,{});e.mid&&(e.muxId=e.mid,delete e.mid);for(const t of e.codecs)t.channels&&(t.numChannels=t.channels,delete t.channels),t.mimeType&&!t.name&&(t.name=t.mimeType.split("/")[1]),delete t.mimeType;return e}qr.mangleRtpParameters=R_;var T_=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),D_=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),uo=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&T_(e,r,t);return D_(e,r),e};Object.defineProperty(ei,"__esModule",{value:!0});ei.Edge11=void 0;const C_=fe,Vi=Pe,hn=uo(ge),Hi=uo(k),Gi=uo(qr),E_=xe,ie=new C_.Logger("Edge11");class ho extends E_.HandlerInterface{static createFactory(){return()=>new ho}constructor(){super(),this._rtpSenders=new Map,this._rtpReceivers=new Map,this._nextSendLocalId=0,this._transportReady=!1}get name(){return"Edge11"}close(){ie.debug("close()");try{this._iceGatherer.close()}catch{}try{this._iceTransport.stop()}catch{}try{this._dtlsTransport.stop()}catch{}for(const e of this._rtpSenders.values())try{e.stop()}catch{}for(const e of this._rtpReceivers.values())try{e.stop()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){return ie.debug("getNativeRtpCapabilities()"),Gi.getCapabilities()}async getNativeSctpCapabilities(){return ie.debug("getNativeSctpCapabilities()"),{numStreams:{OS:0,MIS:0}}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){ie.debug("run()"),this._sendingRtpParametersByKind={audio:Hi.getSendingRtpParameters("audio",l),video:Hi.getSendingRtpParameters("video",l)},this._remoteIceParameters=t,this._remoteIceCandidates=s,this._remoteDtlsParameters=n,this._cname=`CNAME-${hn.generateRandomNumber()}`,this.setIceGatherer({iceServers:a,iceTransportPolicy:c}),this.setIceTransport(),this.setDtlsTransport()}async updateIceServers(e){throw new Vi.UnsupportedError("not supported")}async restartIce(e){if(ie.debug("restartIce()"),this._remoteIceParameters=e,!!this._transportReady){ie.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,e,"controlling");for(const t of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(t);this._iceTransport.addRemoteCandidate({})}}async getTransportStats(){return this._iceTransport.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){ie.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),ie.debug("send() | calling new RTCRtpSender()");const i=new RTCRtpSender(e,this._dtlsTransport),a=hn.clone(this._sendingRtpParametersByKind[e.kind],{});a.codecs=Hi.reduceCodecs(a.codecs,n);const c=a.codecs.some(l=>/.+\/rtx$/i.test(l.mimeType));t||(t=[{}]);for(const l of t)l.ssrc=hn.generateRandomNumber(),c&&(l.rtx={ssrc:hn.generateRandomNumber()});a.encodings=t,a.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const u=Gi.mangleRtpParameters(a);ie.debug("send() | calling rtpSender.send() [params:%o]",u),await i.send(u);const o=String(this._nextSendLocalId);return this._nextSendLocalId++,this._rtpSenders.set(o,i),{localId:o,rtpParameters:a,rtpSender:i}}async stopSending(e){ie.debug("stopSending() [localId:%s]",e);const t=this._rtpSenders.get(e);if(!t)throw new Error("RTCRtpSender not found");this._rtpSenders.delete(e);try{ie.debug("stopSending() | calling rtpSender.stop()"),t.stop()}catch(s){throw ie.warn("stopSending() | rtpSender.stop() failed:%o",s),s}}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){t?ie.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):ie.debug("replaceTrack() [localId:%s, no track]",e);const s=this._rtpSenders.get(e);if(!s)throw new Error("RTCRtpSender not found");s.setTrack(t)}async setMaxSpatialLayer(e,t){ie.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const s=this._rtpSenders.get(e);if(!s)throw new Error("RTCRtpSender not found");const n=s.getParameters();n.encodings.forEach((i,a)=>{a<=t?i.active=!0:i.active=!1}),await s.setParameters(n)}async setRtpEncodingParameters(e,t){ie.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const s=this._rtpSenders.get(e);if(!s)throw new Error("RTCRtpSender not found");const n=s.getParameters();n.encodings.forEach((i,a)=>{n.encodings[a]={...i,...t}}),await s.setParameters(n)}async getSenderStats(e){const t=this._rtpSenders.get(e);if(!t)throw new Error("RTCRtpSender not found");return t.getStats()}async sendDataChannel(e){throw new Vi.UnsupportedError("not implemented")}async receive(e){const t=[];for(const s of e){const{trackId:n,kind:i}=s;ie.debug("receive() [trackId:%s, kind:%s]",n,i)}this._transportReady||await this.setupTransport({localDtlsRole:"server"});for(const s of e){const{trackId:n,kind:i,rtpParameters:a}=s;ie.debug("receive() | calling new RTCRtpReceiver()");const c=new RTCRtpReceiver(this._dtlsTransport,i);c.addEventListener("error",l=>{ie.error('rtpReceiver "error" event [event:%o]',l)});const u=Gi.mangleRtpParameters(a);ie.debug("receive() | calling rtpReceiver.receive() [params:%o]",u),await c.receive(u);const o=n;this._rtpReceivers.set(o,c),t.push({localId:o,track:c.track,rtpReceiver:c})}return t}async stopReceiving(e){for(const t of e){ie.debug("stopReceiving() [localId:%s]",t);const s=this._rtpReceivers.get(t);if(!s)throw new Error("RTCRtpReceiver not found");this._rtpReceivers.delete(t);try{ie.debug("stopReceiving() | calling rtpReceiver.stop()"),s.stop()}catch(n){ie.warn("stopReceiving() | rtpReceiver.stop() failed:%o",n)}}}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){const t=this._rtpReceivers.get(e);if(!t)throw new Error("RTCRtpReceiver not found");return t.getStats()}async receiveDataChannel(e){throw new Vi.UnsupportedError("not implemented")}setIceGatherer({iceServers:e,iceTransportPolicy:t}){const s=new RTCIceGatherer({iceServers:e||[],gatherPolicy:t||"all"});s.addEventListener("error",n=>{ie.error('iceGatherer "error" event [event:%o]',n)});try{s.gather()}catch(n){ie.debug("setIceGatherer() | iceGatherer.gather() failed: %s",n.toString())}this._iceGatherer=s}setIceTransport(){const e=new RTCIceTransport(this._iceGatherer);e.addEventListener("statechange",()=>{switch(e.state){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}}),e.addEventListener("icestatechange",()=>{switch(e.state){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}}),e.addEventListener("candidatepairchange",t=>{ie.debug('iceTransport "candidatepairchange" event [pair:%o]',t.pair)}),this._iceTransport=e}setDtlsTransport(){const e=new RTCDtlsTransport(this._iceTransport);e.addEventListener("statechange",()=>{ie.debug('dtlsTransport "statechange" event [state:%s]',e.state)}),e.addEventListener("dtlsstatechange",()=>{ie.debug('dtlsTransport "dtlsstatechange" event [state:%s]',e.state),e.state==="closed"&&this.emit("@connectionstatechange","closed")}),e.addEventListener("error",t=>{ie.error('dtlsTransport "error" event [event:%o]',t)}),this._dtlsTransport=e}async setupTransport({localDtlsRole:e}){ie.debug("setupTransport()");const t=this._dtlsTransport.getLocalParameters();t.role=e,await new Promise((s,n)=>{this.safeEmit("@connect",{dtlsParameters:t},s,n)}),this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling");for(const s of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(s);this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter(s=>s.algorithm==="sha-256"||s.algorithm==="sha-384"||s.algorithm==="sha-512"),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0}}ei.Edge11=ho;var ti={},M_=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),O_=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Kr=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&M_(e,r,t);return O_(e,r),e};Object.defineProperty(ti,"__esModule",{value:!0});ti.ReactNativeUnifiedPlan=void 0;const _t=Kr(_e),P_=fe,Hc=Kr(ge),Or=Kr(k),pn=Kr(Se),Wi=Kr(at),x_=Kr(lr),k_=xe,I_=ze,L_=bt,N=new P_.Logger("ReactNativeUnifiedPlan"),Gc={OS:1024,MIS:1024};class po extends k_.HandlerInterface{static createFactory(){return()=>new po}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"ReactNativeUnifiedPlan"}close(){if(N.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){N.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const t=await e.createOffer();try{e.close()}catch{}const s=_t.parse(t.sdp),n=pn.extractRtpCapabilities({sdpObject:s});return x_.addNackSuppportForOpus(n),n}catch(t){try{e.close()}catch{}throw t}}async getNativeSctpCapabilities(){return N.debug("getNativeSctpCapabilities()"),{numStreams:Gc}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){N.debug("run()"),this._direction=e,this._remoteSdp=new I_.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i}),this._sendingRtpParametersByKind={audio:Or.getSendingRtpParameters("audio",l),video:Or.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:Or.getSendingRemoteRtpParameters("audio",l),video:Or.getSendingRemoteRtpParameters("video",l)},n.role&&n.role!=="auto"&&(this._forcedLocalDtlsRole=n.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(N.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}})}async updateIceServers(e){N.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(N.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});N.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};N.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};N.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();N.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){var i;this.assertSendDirection(),N.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),t&&t.length>1&&t.forEach((b,E)=>{b.rid=`r${E}`});const a=Hc.clone(this._sendingRtpParametersByKind[e.kind],{});a.codecs=Or.reduceCodecs(a.codecs,n);const c=Hc.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});c.codecs=Or.reduceCodecs(c.codecs,n);const u=this._remoteSdp.getNextMediaSectionIdx(),o=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:t});let l=await this._pc.createOffer(),d=_t.parse(l.sdp),h;this._transportReady||await this.setupTransport({localDtlsRole:(i=this._forcedLocalDtlsRole)!==null&&i!==void 0?i:"client",localSdpObject:d});let p=!1;const f=(0,L_.parse)((t||[{}])[0].scalabilityMode);t&&t.length===1&&f.spatialLayers>1&&a.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(N.debug("send() | enabling legacy simulcast for VP9 SVC"),p=!0,d=_t.parse(l.sdp),h=d.media[u.idx],Wi.addLegacySimulcast({offerMediaObject:h,numStreams:f.spatialLayers}),l={type:"offer",sdp:_t.write(d)}),N.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const w=o.mid;if(a.mid=w,d=_t.parse(this._pc.localDescription.sdp),h=d.media[u.idx],a.rtcp.cname=pn.getCname({offerMediaObject:h}),!t)a.encodings=Wi.getRtpEncodings({offerMediaObject:h});else if(t.length===1){let b=Wi.getRtpEncodings({offerMediaObject:h});Object.assign(b[0],t[0]),p&&(b=[b[0]]),a.encodings=b}else a.encodings=t;if(a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const b of a.encodings)b.scalabilityMode?b.scalabilityMode=`L1T${f.temporalLayers}`:b.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:h,reuseMid:u.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s,extmapAllowMixed:!0});const g={type:"answer",sdp:this._remoteSdp.getSdp()};return N.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),await this._pc.setRemoteDescription(g),this._mapMidTransceiver.set(w,o),{localId:w,rtpParameters:a,rtpSender:o.sender}}async stopSending(e){this.assertSendDirection(),N.debug("stopSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");if(t.sender.replaceTrack(null),this._pc.removeTrack(t.sender),this._remoteSdp.closeMediaSection(t.mid))try{t.stop()}catch{}const n=await this._pc.createOffer();N.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};N.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertSendDirection(),N.debug("pauseSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="inactive",this._remoteSdp.pauseMediaSection(e);const s=await this._pc.createOffer();N.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};N.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async resumeSending(e){this.assertSendDirection(),N.debug("resumeSending() [localId:%s]",e);const t=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!t)throw new Error("associated RTCRtpTransceiver not found");t.direction="sendonly";const s=await this._pc.createOffer();N.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const n={type:"answer",sdp:this._remoteSdp.getSdp()};N.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async replaceTrack(e,t){this.assertSendDirection(),t?N.debug("replaceTrack() [localId:%s, track.id:%s]",e,t.id):N.debug("replaceTrack() [localId:%s, no track]",e);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(t)}async setMaxSpatialLayer(e,t){this.assertSendDirection(),N.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{u<=t?c.active=!0:c.active=!1}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();N.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};N.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(e,t){this.assertSendDirection(),N.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,t);const s=this._mapMidTransceiver.get(e);if(!s)throw new Error("associated RTCRtpTransceiver not found");const n=s.sender.getParameters();n.encodings.forEach((c,u)=>{n.encodings[u]={...c,...t}}),await s.sender.setParameters(n),this._remoteSdp.muxMediaSectionSimulcast(e,n.encodings);const i=await this._pc.createOffer();N.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const a={type:"answer",sdp:this._remoteSdp.getSdp()};N.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(e){this.assertSendDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){var a;this.assertSendDirection();const c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmits:s,protocol:i};N.debug("sendDataChannel() [options:%o]",c);const u=this._pc.createDataChannel(n,c);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Gc.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=_t.parse(l.sdp),h=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:(a=this._forcedLocalDtlsRole)!==null&&a!==void 0?a:"client",localSdpObject:d}),N.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:h});const p={type:"answer",sdp:this._remoteSdp.getSdp()};N.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._hasDataChannelMediaSection=!0}const o={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits};return{dataChannel:u,sctpStreamParameters:o}}async receive(e){var t;this.assertRecvDirection();const s=[],n=new Map;for(const u of e){const{trackId:o,kind:l,rtpParameters:d,streamId:h}=u;N.debug("receive() [trackId:%s, kind:%s]",o,l);const p=d.mid||String(this._mapMidTransceiver.size);n.set(o,p),this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:h||d.rtcp.cname,trackId:o})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};N.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let a=await this._pc.createAnswer();const c=_t.parse(a.sdp);for(const u of e){const{trackId:o,rtpParameters:l}=u,d=n.get(o),h=c.media.find(p=>String(p.mid)===d);pn.applyCodecParameters({offerRtpParameters:l,answerMediaObject:h})}a={type:"answer",sdp:_t.write(c)},this._transportReady||await this.setupTransport({localDtlsRole:(t=this._forcedLocalDtlsRole)!==null&&t!==void 0?t:"client",localSdpObject:c}),N.debug("receive() | calling pc.setLocalDescription() [answer:%o]",a),await this._pc.setLocalDescription(a);for(const u of e){const{trackId:o}=u,l=n.get(o),d=this._pc.getTransceivers().find(h=>h.mid===l);if(d)this._mapMidTransceiver.set(l,d),s.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return s}async stopReceiving(e){this.assertRecvDirection();for(const n of e){N.debug("stopReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(i.mid)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};N.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();N.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const n of e)this._mapMidTransceiver.delete(n)}async pauseReceiving(e){this.assertRecvDirection();for(const n of e){N.debug("pauseReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="inactive",this._remoteSdp.pauseMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};N.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();N.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(e){this.assertRecvDirection();for(const n of e){N.debug("resumeReceiving() [localId:%s]",n);const i=this._mapMidTransceiver.get(n);if(!i)throw new Error("associated RTCRtpTransceiver not found");i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(n)}const t={type:"offer",sdp:this._remoteSdp.getSdp()};N.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();N.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(e){this.assertRecvDirection();const t=this._mapMidTransceiver.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){var n;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u}=e,o={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u,protocol:s};N.debug("receiveDataChannel() [options:%o]",o);const l=this._pc.createDataChannel(t,o);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};N.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const h=await this._pc.createAnswer();if(!this._transportReady){const p=_t.parse(h.sdp);await this.setupTransport({localDtlsRole:(n=this._forcedLocalDtlsRole)!==null&&n!==void 0?n:"client",localSdpObject:p})}N.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setLocalDescription(h),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=_t.parse(this._pc.localDescription.sdp));const s=pn.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ti.ReactNativeUnifiedPlan=po;var ri={},A_=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),N_=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Fs=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&A_(e,r,t);return N_(e,r),e};Object.defineProperty(ri,"__esModule",{value:!0});ri.ReactNative=void 0;const wt=Fs(_e),F_=fe,us=Pe,Zi=Fs(ge),Pr=Fs(k),fn=Fs(Se),Wc=Fs(kt),$_=xe,j_=ze,J=new F_.Logger("ReactNative"),Zc={OS:1024,MIS:1024};class fo extends $_.HandlerInterface{static createFactory(){return()=>new fo}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return"ReactNative"}close(){if(J.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){J.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const t=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const s=wt.parse(t.sdp);return fn.extractRtpCapabilities({sdpObject:s})}catch(t){try{e.close()}catch{}throw t}}async getNativeSctpCapabilities(){return J.debug("getNativeSctpCapabilities()"),{numStreams:Zc}}run({direction:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,extendedRtpCapabilities:l}){J.debug("run()"),this._direction=e,this._remoteSdp=new j_.RemoteSdp({iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,planB:!0}),this._sendingRtpParametersByKind={audio:Pr.getSendingRtpParameters("audio",l),video:Pr.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:Pr.getSendingRemoteRtpParameters("audio",l),video:Pr.getSendingRemoteRtpParameters("video",l)},n.role&&n.role!=="auto"&&(this._forcedLocalDtlsRole=n.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a||[],iceTransportPolicy:c||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...u},o),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(J.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":this.emit("@connectionstatechange","connecting");break;case"connected":case"completed":this.emit("@connectionstatechange","connected");break;case"failed":this.emit("@connectionstatechange","failed");break;case"disconnected":this.emit("@connectionstatechange","disconnected");break;case"closed":this.emit("@connectionstatechange","closed");break}})}async updateIceServers(e){J.debug("updateIceServers()");const t=this._pc.getConfiguration();t.iceServers=e,this._pc.setConfiguration(t)}async restartIce(e){if(J.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const t=await this._pc.createOffer({iceRestart:!0});J.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),await this._pc.setLocalDescription(t);const s={type:"answer",sdp:this._remoteSdp.getSdp()};J.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const t={type:"offer",sdp:this._remoteSdp.getSdp()};J.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();J.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:t,codecOptions:s,codec:n}){var i;this.assertSendDirection(),J.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),n&&J.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let a=await this._pc.createOffer(),c=wt.parse(a.sdp),u;const o=Zi.clone(this._sendingRtpParametersByKind[e.kind],{});o.codecs=Pr.reduceCodecs(o.codecs);const l=Zi.clone(this._sendingRemoteRtpParametersByKind[e.kind],{});if(l.codecs=Pr.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:(i=this._forcedLocalDtlsRole)!==null&&i!==void 0?i:"client",localSdpObject:c}),e.kind==="video"&&t&&t.length>1&&(J.debug("send() | enabling simulcast"),c=wt.parse(a.sdp),u=c.media.find(p=>p.type==="video"),Wc.addLegacySimulcast({offerMediaObject:u,track:e,numStreams:t.length}),a={type:"offer",sdp:wt.write(c)}),J.debug("send() | calling pc.setLocalDescription() [offer:%o]",a),await this._pc.setLocalDescription(a),c=wt.parse(this._pc.localDescription.sdp),u=c.media.find(p=>p.type===e.kind),o.rtcp.cname=fn.getCname({offerMediaObject:u}),o.encodings=Wc.getRtpEncodings({offerMediaObject:u,track:e}),t)for(let p=0;p<o.encodings.length;++p)t[p]&&Object.assign(o.encodings[p],t[p]);if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const p of o.encodings)p.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,offerRtpParameters:o,answerRtpParameters:l,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};J.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const h=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(h,e),{localId:h,rtpParameters:o}}async stopSending(e){this.assertSendDirection(),J.debug("stopSending() [localId:%s]",e);const t=this._mapSendLocalIdTrack.get(e);if(!t)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(t),this._pc.addStream(this._sendStream);const s=await this._pc.createOffer();J.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(i){if(this._sendStream.getTracks().length===0){J.warn("stopSending() | ignoring expected error due no sending tracks: %s",i.toString());return}throw i}if(this._pc.signalingState==="stable")return;const n={type:"answer",sdp:this._remoteSdp.getSdp()};J.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,t){throw new us.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,t){throw new us.UnsupportedError("not implemented")}async setRtpEncodingParameters(e,t){throw new us.UnsupportedError("not implemented")}async getSenderStats(e){throw new us.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:t,maxRetransmits:s,label:n,protocol:i}){var a;this.assertSendDirection();const c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:t,maxRetransmitTime:t,maxRetransmits:s,protocol:i};J.debug("sendDataChannel() [options:%o]",c);const u=this._pc.createDataChannel(n,c);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Zc.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=wt.parse(l.sdp),h=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:(a=this._forcedLocalDtlsRole)!==null&&a!==void 0?a:"client",localSdpObject:d}),J.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:h});const p={type:"answer",sdp:this._remoteSdp.getSdp()};J.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setRemoteDescription(p),this._hasDataChannelMediaSection=!0}const o={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits};return{dataChannel:u,sctpStreamParameters:o}}async receive(e){var t;this.assertRecvDirection();const s=[],n=new Map;for(const u of e){const{trackId:o,kind:l,rtpParameters:d}=u;J.debug("receive() [trackId:%s, kind:%s]",o,l);const h=l;let p=u.streamId||d.rtcp.cname;J.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),p+=`-hack-${Zi.generateRandomNumber()}`,n.set(o,p),this._remoteSdp.receive({mid:h,kind:l,offerRtpParameters:d,streamId:p,trackId:o})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};J.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let a=await this._pc.createAnswer();const c=wt.parse(a.sdp);for(const u of e){const{kind:o,rtpParameters:l}=u,d=o,h=c.media.find(p=>String(p.mid)===d);fn.applyCodecParameters({offerRtpParameters:l,answerMediaObject:h})}a={type:"answer",sdp:wt.write(c)},this._transportReady||await this.setupTransport({localDtlsRole:(t=this._forcedLocalDtlsRole)!==null&&t!==void 0?t:"client",localSdpObject:c}),J.debug("receive() | calling pc.setLocalDescription() [answer:%o]",a),await this._pc.setLocalDescription(a);for(const u of e){const{kind:o,trackId:l,rtpParameters:d}=u,h=l,p=o,f=n.get(l),g=this._pc.getRemoteStreams().find(b=>b.id===f).getTrackById(h);if(!g)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(h,{mid:p,rtpParameters:d}),s.push({localId:h,track:g})}return s}async stopReceiving(e){this.assertRecvDirection();for(const n of e){J.debug("stopReceiving() [localId:%s]",n);const{mid:i,rtpParameters:a}=this._mapRecvLocalIdInfo.get(n)||{};this._mapRecvLocalIdInfo.delete(n),this._remoteSdp.planBStopReceiving({mid:i,offerRtpParameters:a})}const t={type:"offer",sdp:this._remoteSdp.getSdp()};J.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",t),await this._pc.setRemoteDescription(t);const s=await this._pc.createAnswer();J.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new us.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:e,label:t,protocol:s}){var n;this.assertRecvDirection();const{streamId:i,ordered:a,maxPacketLifeTime:c,maxRetransmits:u}=e,o={negotiated:!0,id:i,ordered:a,maxPacketLifeTime:c,maxRetransmitTime:c,maxRetransmits:u,protocol:s};J.debug("receiveDataChannel() [options:%o]",o);const l=this._pc.createDataChannel(t,o);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};J.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const h=await this._pc.createAnswer();if(!this._transportReady){const p=wt.parse(h.sdp);await this.setupTransport({localDtlsRole:(n=this._forcedLocalDtlsRole)!==null&&n!==void 0?n:"client",localSdpObject:p})}J.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setLocalDescription(h),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:t}){t||(t=wt.parse(this._pc.localDescription.sdp));const s=fn.extractDtlsParameters({sdpObject:t});s.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:s},n,i)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ri.ReactNative=fo;var U_=S&&S.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),B_=S&&S.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Wl=S&&S.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&U_(e,r,t);return B_(e,r),e},q_=S&&S.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(cr,"__esModule",{value:!0});cr.Device=cr.detectDevice=void 0;const z_=q_(Ff),V_=fe,H_=vt,xr=Pe,G_=Wl(ge),zt=Wl(k),W_=Es,Z_=Gn,J_=Wn,K_=Zn,Y_=Jn,Q_=Kn,X_=Yn,ew=Qn,tw=Xn,rw=ei,sw=ti,nw=ri,Te=new V_.Logger("Device");function Zl(){if(typeof navigator=="object"&&navigator.product==="ReactNative"){if(typeof RTCPeerConnection>"u"){Te.warn("this._detectDevice() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?");return}return typeof RTCRtpTransceiver<"u"?(Te.debug("this._detectDevice() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(Te.debug("this._detectDevice() | ReactNative PlanB handler chosen"),"ReactNative")}else if(typeof navigator=="object"&&typeof navigator.userAgent=="string"){const r=navigator.userAgent,e=z_.default.getParser(r),t=e.getEngine();if(e.satisfies({chrome:">=111",chromium:">=111","microsoft edge":">=111"}))return"Chrome111";if(e.satisfies({chrome:">=74",chromium:">=74","microsoft edge":">=88"}))return"Chrome74";if(e.satisfies({chrome:">=70",chromium:">=70"}))return"Chrome70";if(e.satisfies({chrome:">=67",chromium:">=67"}))return"Chrome67";if(e.satisfies({chrome:">=55",chromium:">=55"}))return"Chrome55";if(e.satisfies({firefox:">=60"}))return"Firefox60";if(e.satisfies({ios:{OS:">=14.3",firefox:">=30.0"}}))return"Safari12";if(e.satisfies({safari:">=12.0"})&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(e.satisfies({safari:">=11"}))return"Safari11";if(e.satisfies({"microsoft edge":">=11"})&&e.satisfies({"microsoft edge":"<=18"}))return"Edge11";if(t.name&&t.name.toLowerCase()==="blink"){const s=r.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(s){const n=Number(s[1]);return n>=111?"Chrome111":n>=74?"Chrome74":n>=70?"Chrome70":n>=67?"Chrome67":"Chrome55"}else return"Chrome111"}else{Te.warn("this._detectDevice() | browser not supported [name:%s, version:%s]",e.getBrowserName(),e.getBrowserVersion());return}}else{Te.warn("this._detectDevice() | unknown device");return}}cr.detectDevice=Zl;class iw{constructor({handlerName:e,handlerFactory:t,Handler:s}={}){if(this._loaded=!1,this._observer=new H_.EnhancedEventEmitter,Te.debug("constructor()"),s)if(Te.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),typeof s=="string")e=s;else throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");if(e&&t)throw new TypeError("just one of handlerName or handlerInterface can be given");if(t)this._handlerFactory=t;else{if(e)Te.debug("constructor() | handler given: %s",e);else if(e=Zl(),e)Te.debug("constructor() | detected handler: %s",e);else throw new xr.UnsupportedError("device not supported");switch(e){case"Chrome111":this._handlerFactory=Z_.Chrome111.createFactory();break;case"Chrome74":this._handlerFactory=J_.Chrome74.createFactory();break;case"Chrome70":this._handlerFactory=K_.Chrome70.createFactory();break;case"Chrome67":this._handlerFactory=Y_.Chrome67.createFactory();break;case"Chrome55":this._handlerFactory=Q_.Chrome55.createFactory();break;case"Firefox60":this._handlerFactory=X_.Firefox60.createFactory();break;case"Safari12":this._handlerFactory=ew.Safari12.createFactory();break;case"Safari11":this._handlerFactory=tw.Safari11.createFactory();break;case"Edge11":this._handlerFactory=rw.Edge11.createFactory();break;case"ReactNativeUnifiedPlan":this._handlerFactory=sw.ReactNativeUnifiedPlan.createFactory();break;case"ReactNative":this._handlerFactory=nw.ReactNative.createFactory();break;default:throw new TypeError(`unknown handlerName "${e}"`)}}const n=this._handlerFactory();this._handlerName=n.name,n.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new xr.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new xr.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}async load({routerRtpCapabilities:e}){Te.debug("load() [routerRtpCapabilities:%o]",e),e=G_.clone(e,void 0);let t;try{if(this._loaded)throw new xr.InvalidStateError("already loaded");zt.validateRtpCapabilities(e),t=this._handlerFactory();const s=await t.getNativeRtpCapabilities();Te.debug("load() | got native RTP capabilities:%o",s),zt.validateRtpCapabilities(s),this._extendedRtpCapabilities=zt.getExtendedRtpCapabilities(s,e),Te.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=zt.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=zt.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=zt.getRecvRtpCapabilities(this._extendedRtpCapabilities),zt.validateRtpCapabilities(this._recvRtpCapabilities),Te.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._sctpCapabilities=await t.getNativeSctpCapabilities(),Te.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),zt.validateSctpCapabilities(this._sctpCapabilities),Te.debug("load() succeeded"),this._loaded=!0,t.close()}catch(s){throw t&&t.close(),s}}canProduce(e){if(this._loaded){if(e!=="audio"&&e!=="video")throw new TypeError(`invalid kind "${e}"`)}else throw new xr.InvalidStateError("not loaded");return this._canProduceByKind[e]}createSendTransport({id:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,appData:l}){return Te.debug("createSendTransport()"),this.createTransport({direction:"send",id:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,appData:l})}createRecvTransport({id:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,appData:l}){return Te.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:e,iceParameters:t,iceCandidates:s,dtlsParameters:n,sctpParameters:i,iceServers:a,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:o,appData:l})}createTransport({direction:e,id:t,iceParameters:s,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:c,iceTransportPolicy:u,additionalSettings:o,proprietaryConstraints:l,appData:d}){if(this._loaded){if(typeof t!="string")throw new TypeError("missing id");if(typeof s!="object")throw new TypeError("missing iceParameters");if(Array.isArray(n)){if(typeof i!="object")throw new TypeError("missing dtlsParameters");if(a&&typeof a!="object")throw new TypeError("wrong sctpParameters");if(d&&typeof d!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new xr.InvalidStateError("not loaded");const h=new W_.Transport({direction:e,id:t,iceParameters:s,iceCandidates:n,dtlsParameters:i,sctpParameters:a,iceServers:c,iceTransportPolicy:u,additionalSettings:o,proprietaryConstraints:l,appData:d,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",h),h}}cr.Device=iw;var Jl={},Kl={};Object.defineProperty(Kl,"__esModule",{value:!0});var Yl={};Object.defineProperty(Yl,"__esModule",{value:!0});(function(r){var e=S&&S.__createBinding||(Object.create?function(s,n,i,a){a===void 0&&(a=i);var c=Object.getOwnPropertyDescriptor(n,i);(!c||("get"in c?!n.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(s,a,c)}:function(s,n,i,a){a===void 0&&(a=i),s[a]=n[i]}),t=S&&S.__exportStar||function(s,n){for(var i in s)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,s,i)};Object.defineProperty(r,"__esModule",{value:!0}),t(cr,r),t(Es,r),t(Ms,r),t(Os,r),t(Ps,r),t(xs,r),t(Kl,r),t(Yl,r),t(xe,r),t(Pe,r)})(Jl);(function(r){var e=S&&S.__createBinding||(Object.create?function(o,l,d,h){h===void 0&&(h=d);var p=Object.getOwnPropertyDescriptor(l,d);(!p||("get"in p?!l.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return l[d]}}),Object.defineProperty(o,h,p)}:function(o,l,d,h){h===void 0&&(h=d),o[h]=l[d]}),t=S&&S.__setModuleDefault||(Object.create?function(o,l){Object.defineProperty(o,"default",{enumerable:!0,value:l})}:function(o,l){o.default=l}),s=S&&S.__importStar||function(o){if(o&&o.__esModule)return o;var l={};if(o!=null)for(var d in o)d!=="default"&&Object.prototype.hasOwnProperty.call(o,d)&&e(l,o,d);return t(l,o),l},n=S&&S.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(r,"__esModule",{value:!0}),r.debug=r.parseScalabilityMode=r.detectDevice=r.Device=r.version=r.types=void 0;const i=n(Bn);r.debug=i.default;const a=cr;Object.defineProperty(r,"Device",{enumerable:!0,get:function(){return a.Device}}),Object.defineProperty(r,"detectDevice",{enumerable:!0,get:function(){return a.detectDevice}});const c=s(Jl);r.types=c,r.version="3.6.84";var u=bt;Object.defineProperty(r,"parseScalabilityMode",{enumerable:!0,get:function(){return u.parse}})})(Un);const aw=Gr(Un),ow=Df({__proto__:null,default:aw},[Un]);var Ql={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(t=!1));function n(u,o,l){this.fn=u,this.context=o,this.once=l||!1}function i(u,o,l,d,h){if(typeof l!="function")throw new TypeError("The listener must be a function");var p=new n(l,d||u,h),f=t?t+o:o;return u._events[f]?u._events[f].fn?u._events[f]=[u._events[f],p]:u._events[f].push(p):(u._events[f]=p,u._eventsCount++),u}function a(u,o){--u._eventsCount===0?u._events=new s:delete u._events[o]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var o=[],l,d;if(this._eventsCount===0)return o;for(d in l=this._events)e.call(l,d)&&o.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(l)):o},c.prototype.listeners=function(o){var l=t?t+o:o,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,p=d.length,f=new Array(p);h<p;h++)f[h]=d[h].fn;return f},c.prototype.listenerCount=function(o){var l=t?t+o:o,d=this._events[l];return d?d.fn?1:d.length:0},c.prototype.emit=function(o,l,d,h,p,f){var w=t?t+o:o;if(!this._events[w])return!1;var g=this._events[w],b=arguments.length,E,M;if(g.fn){switch(g.once&&this.removeListener(o,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,l),!0;case 3:return g.fn.call(g.context,l,d),!0;case 4:return g.fn.call(g.context,l,d,h),!0;case 5:return g.fn.call(g.context,l,d,h,p),!0;case 6:return g.fn.call(g.context,l,d,h,p,f),!0}for(M=1,E=new Array(b-1);M<b;M++)E[M-1]=arguments[M];g.fn.apply(g.context,E)}else{var P=g.length,y;for(M=0;M<P;M++)switch(g[M].once&&this.removeListener(o,g[M].fn,void 0,!0),b){case 1:g[M].fn.call(g[M].context);break;case 2:g[M].fn.call(g[M].context,l);break;case 3:g[M].fn.call(g[M].context,l,d);break;case 4:g[M].fn.call(g[M].context,l,d,h);break;default:if(!E)for(y=1,E=new Array(b-1);y<b;y++)E[y-1]=arguments[y];g[M].fn.apply(g[M].context,E)}}return!0},c.prototype.on=function(o,l,d){return i(this,o,l,d,!1)},c.prototype.once=function(o,l,d){return i(this,o,l,d,!0)},c.prototype.removeListener=function(o,l,d,h){var p=t?t+o:o;if(!this._events[p])return this;if(!l)return a(this,p),this;var f=this._events[p];if(f.fn)f.fn===l&&(!h||f.once)&&(!d||f.context===d)&&a(this,p);else{for(var w=0,g=[],b=f.length;w<b;w++)(f[w].fn!==l||h&&!f[w].once||d&&f[w].context!==d)&&g.push(f[w]);g.length?this._events[p]=g.length===1?g[0]:g:a(this,p)}return this},c.prototype.removeAllListeners=function(o){var l;return o?(l=t?t+o:o,this._events[l]&&a(this,l)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,r.exports=c})(Ql);var cw=Ql.exports;const mo=Gr(cw);var go={exports:{}},Xl=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}},dw=Xl,Qt=Object.prototype.toString;function _o(r){return Array.isArray(r)}function Pa(r){return typeof r>"u"}function lw(r){return r!==null&&!Pa(r)&&r.constructor!==null&&!Pa(r.constructor)&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function eu(r){return Qt.call(r)==="[object ArrayBuffer]"}function uw(r){return Qt.call(r)==="[object FormData]"}function hw(r){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&eu(r.buffer),e}function pw(r){return typeof r=="string"}function fw(r){return typeof r=="number"}function tu(r){return r!==null&&typeof r=="object"}function Rn(r){if(Qt.call(r)!=="[object Object]")return!1;var e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}function mw(r){return Qt.call(r)==="[object Date]"}function gw(r){return Qt.call(r)==="[object File]"}function _w(r){return Qt.call(r)==="[object Blob]"}function ru(r){return Qt.call(r)==="[object Function]"}function ww(r){return tu(r)&&ru(r.pipe)}function yw(r){return Qt.call(r)==="[object URLSearchParams]"}function vw(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function bw(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function wo(r,e){if(!(r===null||typeof r>"u"))if(typeof r!="object"&&(r=[r]),_o(r))for(var t=0,s=r.length;t<s;t++)e.call(null,r[t],t,r);else for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.call(null,r[n],n,r)}function xa(){var r={};function e(n,i){Rn(r[i])&&Rn(n)?r[i]=xa(r[i],n):Rn(n)?r[i]=xa({},n):_o(n)?r[i]=n.slice():r[i]=n}for(var t=0,s=arguments.length;t<s;t++)wo(arguments[t],e);return r}function Sw(r,e,t){return wo(e,function(n,i){t&&typeof n=="function"?r[i]=dw(n,t):r[i]=n}),r}function Rw(r){return r.charCodeAt(0)===65279&&(r=r.slice(1)),r}var Ne={isArray:_o,isArrayBuffer:eu,isBuffer:lw,isFormData:uw,isArrayBufferView:hw,isString:pw,isNumber:fw,isObject:tu,isPlainObject:Rn,isUndefined:Pa,isDate:mw,isFile:gw,isBlob:_w,isFunction:ru,isStream:ww,isURLSearchParams:yw,isStandardBrowserEnv:bw,forEach:wo,merge:xa,extend:Sw,trim:vw,stripBOM:Rw},kr=Ne;function Jc(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var su=function(e,t,s){if(!t)return e;var n;if(s)n=s(t);else if(kr.isURLSearchParams(t))n=t.toString();else{var i=[];kr.forEach(t,function(u,o){u===null||typeof u>"u"||(kr.isArray(u)?o=o+"[]":u=[u],kr.forEach(u,function(d){kr.isDate(d)?d=d.toISOString():kr.isObject(d)&&(d=JSON.stringify(d)),i.push(Jc(o)+"="+Jc(d))}))}),n=i.join("&")}if(n){var a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+n}return e},Tw=Ne;function si(){this.handlers=[]}si.prototype.use=function(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1};si.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};si.prototype.forEach=function(e){Tw.forEach(this.handlers,function(s){s!==null&&e(s)})};var Dw=si,Cw=Ne,Ew=function(e,t){Cw.forEach(e,function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])})},nu=function(e,t,s,n,i){return e.config=t,s&&(e.code=s),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e},iu={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ji,Kc;function au(){if(Kc)return Ji;Kc=1;var r=nu;return Ji=function(t,s,n,i,a){var c=new Error(t);return r(c,s,n,i,a)},Ji}var Ki,Yc;function Mw(){if(Yc)return Ki;Yc=1;var r=au();return Ki=function(t,s,n){var i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):s(r("Request failed with status code "+n.status,n.config,null,n.request,n))},Ki}var Yi,Qc;function Ow(){if(Qc)return Yi;Qc=1;var r=Ne;return Yi=r.isStandardBrowserEnv()?function(){return{write:function(s,n,i,a,c,u){var o=[];o.push(s+"="+encodeURIComponent(n)),r.isNumber(i)&&o.push("expires="+new Date(i).toGMTString()),r.isString(a)&&o.push("path="+a),r.isString(c)&&o.push("domain="+c),u===!0&&o.push("secure"),document.cookie=o.join("; ")},read:function(s){var n=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Yi}var Qi,Xc;function Pw(){return Xc||(Xc=1,Qi=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}),Qi}var Xi,ed;function xw(){return ed||(ed=1,Xi=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}),Xi}var ea,td;function kw(){if(td)return ea;td=1;var r=Pw(),e=xw();return ea=function(s,n){return s&&!r(n)?e(s,n):n},ea}var ta,rd;function Iw(){if(rd)return ta;rd=1;var r=Ne,e=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return ta=function(s){var n={},i,a,c;return s&&r.forEach(s.split(`
`),function(o){if(c=o.indexOf(":"),i=r.trim(o.substr(0,c)).toLowerCase(),a=r.trim(o.substr(c+1)),i){if(n[i]&&e.indexOf(i)>=0)return;i==="set-cookie"?n[i]=(n[i]?n[i]:[]).concat([a]):n[i]=n[i]?n[i]+", "+a:a}}),n},ta}var ra,sd;function Lw(){if(sd)return ra;sd=1;var r=Ne;return ra=r.isStandardBrowserEnv()?function(){var t=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a"),n;function i(a){var c=a;return t&&(s.setAttribute("href",c),c=s.href),s.setAttribute("href",c),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return n=i(window.location.href),function(c){var u=r.isString(c)?i(c):c;return u.protocol===n.protocol&&u.host===n.host}}():function(){return function(){return!0}}(),ra}var sa,nd;function ni(){if(nd)return sa;nd=1;function r(e){this.message=e}return r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,sa=r,sa}var na,id;function ad(){if(id)return na;id=1;var r=Ne,e=Mw(),t=Ow(),s=su,n=kw(),i=Iw(),a=Lw(),c=au(),u=iu,o=ni();return na=function(d){return new Promise(function(p,f){var w=d.data,g=d.headers,b=d.responseType,E;function M(){d.cancelToken&&d.cancelToken.unsubscribe(E),d.signal&&d.signal.removeEventListener("abort",E)}r.isFormData(w)&&delete g["Content-Type"];var P=new XMLHttpRequest;if(d.auth){var y=d.auth.username||"",D=d.auth.password?unescape(encodeURIComponent(d.auth.password)):"";g.Authorization="Basic "+btoa(y+":"+D)}var Z=n(d.baseURL,d.url);P.open(d.method.toUpperCase(),s(Z,d.params,d.paramsSerializer),!0),P.timeout=d.timeout;function ae(){if(P){var me="getAllResponseHeaders"in P?i(P.getAllResponseHeaders()):null,G=!b||b==="text"||b==="json"?P.responseText:P.response,re={data:G,status:P.status,statusText:P.statusText,headers:me,config:d,request:P};e(function(Nt){p(Nt),M()},function(Nt){f(Nt),M()},re),P=null}}if("onloadend"in P?P.onloadend=ae:P.onreadystatechange=function(){!P||P.readyState!==4||P.status===0&&!(P.responseURL&&P.responseURL.indexOf("file:")===0)||setTimeout(ae)},P.onabort=function(){P&&(f(c("Request aborted",d,"ECONNABORTED",P)),P=null)},P.onerror=function(){f(c("Network Error",d,null,P)),P=null},P.ontimeout=function(){var G=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded",re=d.transitional||u;d.timeoutErrorMessage&&(G=d.timeoutErrorMessage),f(c(G,d,re.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",P)),P=null},r.isStandardBrowserEnv()){var Me=(d.withCredentials||a(Z))&&d.xsrfCookieName?t.read(d.xsrfCookieName):void 0;Me&&(g[d.xsrfHeaderName]=Me)}"setRequestHeader"in P&&r.forEach(g,function(G,re){typeof w>"u"&&re.toLowerCase()==="content-type"?delete g[re]:P.setRequestHeader(re,G)}),r.isUndefined(d.withCredentials)||(P.withCredentials=!!d.withCredentials),b&&b!=="json"&&(P.responseType=d.responseType),typeof d.onDownloadProgress=="function"&&P.addEventListener("progress",d.onDownloadProgress),typeof d.onUploadProgress=="function"&&P.upload&&P.upload.addEventListener("progress",d.onUploadProgress),(d.cancelToken||d.signal)&&(E=function(me){P&&(f(!me||me&&me.type?new o("canceled"):me),P.abort(),P=null)},d.cancelToken&&d.cancelToken.subscribe(E),d.signal&&(d.signal.aborted?E():d.signal.addEventListener("abort",E))),w||(w=null),P.send(w)})},na}var De=Ne,od=Ew,Aw=nu,Nw=iu,Fw={"Content-Type":"application/x-www-form-urlencoded"};function cd(r,e){!De.isUndefined(r)&&De.isUndefined(r["Content-Type"])&&(r["Content-Type"]=e)}function $w(){var r;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(r=ad()),r}function jw(r,e,t){if(De.isString(r))try{return(e||JSON.parse)(r),De.trim(r)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(r)}var ii={transitional:Nw,adapter:$w(),transformRequest:[function(e,t){return od(t,"Accept"),od(t,"Content-Type"),De.isFormData(e)||De.isArrayBuffer(e)||De.isBuffer(e)||De.isStream(e)||De.isFile(e)||De.isBlob(e)?e:De.isArrayBufferView(e)?e.buffer:De.isURLSearchParams(e)?(cd(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):De.isObject(e)||t&&t["Content-Type"]==="application/json"?(cd(t,"application/json"),jw(e)):e}],transformResponse:[function(e){var t=this.transitional||ii.transitional,s=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,i=!s&&this.responseType==="json";if(i||n&&De.isString(e)&&e.length)try{return JSON.parse(e)}catch(a){if(i)throw a.name==="SyntaxError"?Aw(a,this,"E_JSON_PARSE"):a}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};De.forEach(["delete","get","head"],function(e){ii.headers[e]={}});De.forEach(["post","put","patch"],function(e){ii.headers[e]=De.merge(Fw)});var yo=ii,Uw=Ne,Bw=yo,qw=function(e,t,s){var n=this||Bw;return Uw.forEach(s,function(a){e=a.call(n,e,t)}),e},ia,dd;function ou(){return dd||(dd=1,ia=function(e){return!!(e&&e.__CANCEL__)}),ia}var ld=Ne,aa=qw,zw=ou(),Vw=yo,Hw=ni();function oa(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Hw("canceled")}var Gw=function(e){oa(e),e.headers=e.headers||{},e.data=aa.call(e,e.data,e.headers,e.transformRequest),e.headers=ld.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),ld.forEach(["delete","get","head","post","put","patch","common"],function(n){delete e.headers[n]});var t=e.adapter||Vw.adapter;return t(e).then(function(n){return oa(e),n.data=aa.call(e,n.data,n.headers,e.transformResponse),n},function(n){return zw(n)||(oa(e),n&&n.response&&(n.response.data=aa.call(e,n.response.data,n.response.headers,e.transformResponse))),Promise.reject(n)})},je=Ne,cu=function(e,t){t=t||{};var s={};function n(l,d){return je.isPlainObject(l)&&je.isPlainObject(d)?je.merge(l,d):je.isPlainObject(d)?je.merge({},d):je.isArray(d)?d.slice():d}function i(l){if(je.isUndefined(t[l])){if(!je.isUndefined(e[l]))return n(void 0,e[l])}else return n(e[l],t[l])}function a(l){if(!je.isUndefined(t[l]))return n(void 0,t[l])}function c(l){if(je.isUndefined(t[l])){if(!je.isUndefined(e[l]))return n(void 0,e[l])}else return n(void 0,t[l])}function u(l){if(l in t)return n(e[l],t[l]);if(l in e)return n(void 0,e[l])}var o={url:a,method:a,data:a,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u};return je.forEach(Object.keys(e).concat(Object.keys(t)),function(d){var h=o[d]||i,p=h(d);je.isUndefined(p)&&h!==u||(s[d]=p)}),s},ca,ud;function du(){return ud||(ud=1,ca={version:"0.26.1"}),ca}var Ww=du().version,vo={};["object","boolean","number","function","string","symbol"].forEach(function(r,e){vo[r]=function(s){return typeof s===r||"a"+(e<1?"n ":" ")+r}});var hd={};vo.transitional=function(e,t,s){function n(i,a){return"[Axios v"+Ww+"] Transitional option '"+i+"'"+a+(s?". "+s:"")}return function(i,a,c){if(e===!1)throw new Error(n(a," has been removed"+(t?" in "+t:"")));return t&&!hd[a]&&(hd[a]=!0,console.warn(n(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,a,c):!0}};function Zw(r,e,t){if(typeof r!="object")throw new TypeError("options must be an object");for(var s=Object.keys(r),n=s.length;n-- >0;){var i=s[n],a=e[i];if(a){var c=r[i],u=c===void 0||a(c,i,r);if(u!==!0)throw new TypeError("option "+i+" must be "+u);continue}if(t!==!0)throw Error("Unknown option "+i)}}var Jw={assertOptions:Zw,validators:vo},lu=Ne,Kw=su,pd=Dw,fd=Gw,ai=cu,uu=Jw,Ir=uu.validators;function $s(r){this.defaults=r,this.interceptors={request:new pd,response:new pd}}$s.prototype.request=function(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ai(this.defaults,t),t.method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var s=t.transitional;s!==void 0&&uu.assertOptions(s,{silentJSONParsing:Ir.transitional(Ir.boolean),forcedJSONParsing:Ir.transitional(Ir.boolean),clarifyTimeoutError:Ir.transitional(Ir.boolean)},!1);var n=[],i=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(t)===!1||(i=i&&p.synchronous,n.unshift(p.fulfilled,p.rejected))});var a=[];this.interceptors.response.forEach(function(p){a.push(p.fulfilled,p.rejected)});var c;if(!i){var u=[fd,void 0];for(Array.prototype.unshift.apply(u,n),u=u.concat(a),c=Promise.resolve(t);u.length;)c=c.then(u.shift(),u.shift());return c}for(var o=t;n.length;){var l=n.shift(),d=n.shift();try{o=l(o)}catch(h){d(h);break}}try{c=fd(o)}catch(h){return Promise.reject(h)}for(;a.length;)c=c.then(a.shift(),a.shift());return c};$s.prototype.getUri=function(e){return e=ai(this.defaults,e),Kw(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")};lu.forEach(["delete","get","head","options"],function(e){$s.prototype[e]=function(t,s){return this.request(ai(s||{},{method:e,url:t,data:(s||{}).data}))}});lu.forEach(["post","put","patch"],function(e){$s.prototype[e]=function(t,s,n){return this.request(ai(n||{},{method:e,url:t,data:s}))}});var Yw=$s,da,md;function Qw(){if(md)return da;md=1;var r=ni();function e(t){if(typeof t!="function")throw new TypeError("executor must be a function.");var s;this.promise=new Promise(function(a){s=a});var n=this;this.promise.then(function(i){if(n._listeners){var a,c=n._listeners.length;for(a=0;a<c;a++)n._listeners[a](i);n._listeners=null}}),this.promise.then=function(i){var a,c=new Promise(function(u){n.subscribe(u),a=u}).then(i);return c.cancel=function(){n.unsubscribe(a)},c},t(function(a){n.reason||(n.reason=new r(a),s(n.reason))})}return e.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},e.prototype.subscribe=function(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]},e.prototype.unsubscribe=function(s){if(this._listeners){var n=this._listeners.indexOf(s);n!==-1&&this._listeners.splice(n,1)}},e.source=function(){var s,n=new e(function(a){s=a});return{token:n,cancel:s}},da=e,da}var la,gd;function Xw(){return gd||(gd=1,la=function(e){return function(s){return e.apply(null,s)}}),la}var ua,_d;function ey(){if(_d)return ua;_d=1;var r=Ne;return ua=function(t){return r.isObject(t)&&t.isAxiosError===!0},ua}var wd=Ne,ty=Xl,Tn=Yw,ry=cu,sy=yo;function hu(r){var e=new Tn(r),t=ty(Tn.prototype.request,e);return wd.extend(t,Tn.prototype,e),wd.extend(t,e),t.create=function(n){return hu(ry(r,n))},t}var St=hu(sy);St.Axios=Tn;St.Cancel=ni();St.CancelToken=Qw();St.isCancel=ou();St.VERSION=du().version;St.all=function(e){return Promise.all(e)};St.spread=Xw();St.isAxiosError=ey();go.exports=St;go.exports.default=St;var ny=go.exports,iy=ny;const ay=Gr(iy);var kn={exports:{}};kn.exports;(function(r,e){var t=200,s="__lodash_hash_undefined__",n=800,i=16,a=9007199254740991,c="[object Arguments]",u="[object Array]",o="[object AsyncFunction]",l="[object Boolean]",d="[object Date]",h="[object Error]",p="[object Function]",f="[object GeneratorFunction]",w="[object Map]",g="[object Number]",b="[object Null]",E="[object Object]",M="[object Proxy]",P="[object RegExp]",y="[object Set]",D="[object String]",Z="[object Undefined]",ae="[object WeakMap]",Me="[object ArrayBuffer]",me="[object DataView]",G="[object Float32Array]",re="[object Float64Array]",rs="[object Int8Array]",Nt="[object Int16Array]",_i="[object Int32Array]",wi="[object Uint8Array]",Gs="[object Uint8ClampedArray]",j="[object Uint16Array]",I="[object Uint32Array]",he=/[\\^$.*+?()[\]{}|]/g,Fe=/^\[object .+?Constructor\]$/,ss=/^(?:0|[1-9]\d*)$/,Q={};Q[G]=Q[re]=Q[rs]=Q[Nt]=Q[_i]=Q[wi]=Q[Gs]=Q[j]=Q[I]=!0,Q[c]=Q[u]=Q[Me]=Q[l]=Q[me]=Q[d]=Q[h]=Q[p]=Q[w]=Q[g]=Q[E]=Q[P]=Q[y]=Q[D]=Q[ae]=!1;var Ft=typeof S=="object"&&S&&S.Object===Object&&S,yi=typeof self=="object"&&self&&self.Object===Object&&self,$t=Ft||yi||Function("return this")(),jo=e&&!e.nodeType&&e,ns=jo&&!0&&r&&!r.nodeType&&r,Uo=ns&&ns.exports===jo,vi=Uo&&Ft.process,Bo=function(){try{var m=ns&&ns.require&&ns.require("util").types;return m||vi&&vi.binding&&vi.binding("util")}catch{}}(),qo=Bo&&Bo.isTypedArray;function zo(m,_,v){switch(v.length){case 0:return m.call(_);case 1:return m.call(_,v[0]);case 2:return m.call(_,v[0],v[1]);case 3:return m.call(_,v[0],v[1],v[2])}return m.apply(_,v)}function Wh(m,_){for(var v=-1,x=Array(m);++v<m;)x[v]=_(v);return x}function Zh(m){return function(_){return m(_)}}function Jh(m,_){return m==null?void 0:m[_]}function Kh(m,_){return function(v){return m(_(v))}}var Yh=Array.prototype,Qh=Function.prototype,Ws=Object.prototype,bi=$t["__core-js_shared__"],Zs=Qh.toString,Rt=Ws.hasOwnProperty,Vo=function(){var m=/[^.]+$/.exec(bi&&bi.keys&&bi.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Ho=Ws.toString,Xh=Zs.call(Object),ep=RegExp("^"+Zs.call(Rt).replace(he,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Js=Uo?$t.Buffer:void 0,Go=$t.Symbol,Wo=$t.Uint8Array,Zo=Js?Js.allocUnsafe:void 0,Jo=Kh(Object.getPrototypeOf,Object),Ko=Object.create,tp=Ws.propertyIsEnumerable,rp=Yh.splice,Xt=Go?Go.toStringTag:void 0,Ks=function(){try{var m=Di(Object,"defineProperty");return m({},"",{}),m}catch{}}(),sp=Js?Js.isBuffer:void 0,Yo=Math.max,np=Date.now,Qo=Di($t,"Map"),is=Di(Object,"create"),ip=function(){function m(){}return function(_){if(!Dt(_))return{};if(Ko)return Ko(_);m.prototype=_;var v=new m;return m.prototype=void 0,v}}();function er(m){var _=-1,v=m==null?0:m.length;for(this.clear();++_<v;){var x=m[_];this.set(x[0],x[1])}}function ap(){this.__data__=is?is(null):{},this.size=0}function op(m){var _=this.has(m)&&delete this.__data__[m];return this.size-=_?1:0,_}function cp(m){var _=this.__data__;if(is){var v=_[m];return v===s?void 0:v}return Rt.call(_,m)?_[m]:void 0}function dp(m){var _=this.__data__;return is?_[m]!==void 0:Rt.call(_,m)}function lp(m,_){var v=this.__data__;return this.size+=this.has(m)?0:1,v[m]=is&&_===void 0?s:_,this}er.prototype.clear=ap,er.prototype.delete=op,er.prototype.get=cp,er.prototype.has=dp,er.prototype.set=lp;function Tt(m){var _=-1,v=m==null?0:m.length;for(this.clear();++_<v;){var x=m[_];this.set(x[0],x[1])}}function up(){this.__data__=[],this.size=0}function hp(m){var _=this.__data__,v=Ys(_,m);if(v<0)return!1;var x=_.length-1;return v==x?_.pop():rp.call(_,v,1),--this.size,!0}function pp(m){var _=this.__data__,v=Ys(_,m);return v<0?void 0:_[v][1]}function fp(m){return Ys(this.__data__,m)>-1}function mp(m,_){var v=this.__data__,x=Ys(v,m);return x<0?(++this.size,v.push([m,_])):v[x][1]=_,this}Tt.prototype.clear=up,Tt.prototype.delete=hp,Tt.prototype.get=pp,Tt.prototype.has=fp,Tt.prototype.set=mp;function pr(m){var _=-1,v=m==null?0:m.length;for(this.clear();++_<v;){var x=m[_];this.set(x[0],x[1])}}function gp(){this.size=0,this.__data__={hash:new er,map:new(Qo||Tt),string:new er}}function _p(m){var _=Xs(this,m).delete(m);return this.size-=_?1:0,_}function wp(m){return Xs(this,m).get(m)}function yp(m){return Xs(this,m).has(m)}function vp(m,_){var v=Xs(this,m),x=v.size;return v.set(m,_),this.size+=v.size==x?0:1,this}pr.prototype.clear=gp,pr.prototype.delete=_p,pr.prototype.get=wp,pr.prototype.has=yp,pr.prototype.set=vp;function fr(m){var _=this.__data__=new Tt(m);this.size=_.size}function bp(){this.__data__=new Tt,this.size=0}function Sp(m){var _=this.__data__,v=_.delete(m);return this.size=_.size,v}function Rp(m){return this.__data__.get(m)}function Tp(m){return this.__data__.has(m)}function Dp(m,_){var v=this.__data__;if(v instanceof Tt){var x=v.__data__;if(!Qo||x.length<t-1)return x.push([m,_]),this.size=++v.size,this;v=this.__data__=new pr(x)}return v.set(m,_),this.size=v.size,this}fr.prototype.clear=bp,fr.prototype.delete=Sp,fr.prototype.get=Rp,fr.prototype.has=Tp,fr.prototype.set=Dp;function Cp(m,_){var v=Mi(m),x=!v&&Ei(m),z=!v&&!x&&nc(m),se=!v&&!x&&!z&&ac(m),le=v||x||z||se,V=le?Wh(m.length,String):[],ue=V.length;for(var Ve in m)(_||Rt.call(m,Ve))&&!(le&&(Ve=="length"||z&&(Ve=="offset"||Ve=="parent")||se&&(Ve=="buffer"||Ve=="byteLength"||Ve=="byteOffset")||rc(Ve,ue)))&&V.push(Ve);return V}function Si(m,_,v){(v!==void 0&&!en(m[_],v)||v===void 0&&!(_ in m))&&Ri(m,_,v)}function Ep(m,_,v){var x=m[_];(!(Rt.call(m,_)&&en(x,v))||v===void 0&&!(_ in m))&&Ri(m,_,v)}function Ys(m,_){for(var v=m.length;v--;)if(en(m[v][0],_))return v;return-1}function Ri(m,_,v){_=="__proto__"&&Ks?Ks(m,_,{configurable:!0,enumerable:!0,value:v,writable:!0}):m[_]=v}var Mp=Up();function Qs(m){return m==null?m===void 0?Z:b:Xt&&Xt in Object(m)?Bp(m):Wp(m)}function Xo(m){return as(m)&&Qs(m)==c}function Op(m){if(!Dt(m)||Hp(m))return!1;var _=Pi(m)?ep:Fe;return _.test(Yp(m))}function Pp(m){return as(m)&&ic(m.length)&&!!Q[Qs(m)]}function xp(m){if(!Dt(m))return Gp(m);var _=sc(m),v=[];for(var x in m)x=="constructor"&&(_||!Rt.call(m,x))||v.push(x);return v}function Ti(m,_,v,x,z){m!==_&&Mp(_,function(se,le){if(z||(z=new fr),Dt(se))kp(m,_,le,v,Ti,x,z);else{var V=x?x(Ci(m,le),se,le+"",m,_,z):void 0;V===void 0&&(V=se),Si(m,le,V)}},oc)}function kp(m,_,v,x,z,se,le){var V=Ci(m,v),ue=Ci(_,v),Ve=le.get(ue);if(Ve){Si(m,v,Ve);return}var $e=se?se(V,ue,v+"",m,_,le):void 0,os=$e===void 0;if(os){var xi=Mi(ue),ki=!xi&&nc(ue),dc=!xi&&!ki&&ac(ue);$e=ue,xi||ki||dc?Mi(V)?$e=V:Qp(V)?$e=Fp(V):ki?(os=!1,$e=Lp(ue,!0)):dc?(os=!1,$e=Np(ue,!0)):$e=[]:Xp(ue)||Ei(ue)?($e=V,Ei(V)?$e=ef(V):(!Dt(V)||Pi(V))&&($e=qp(ue))):os=!1}os&&(le.set(ue,$e),z($e,ue,x,se,le),le.delete(ue)),Si(m,v,$e)}function ec(m,_){return Jp(Zp(m,_,cc),m+"")}var Ip=Ks?function(m,_){return Ks(m,"toString",{configurable:!0,enumerable:!1,value:sf(_),writable:!0})}:cc;function Lp(m,_){if(_)return m.slice();var v=m.length,x=Zo?Zo(v):new m.constructor(v);return m.copy(x),x}function Ap(m){var _=new m.constructor(m.byteLength);return new Wo(_).set(new Wo(m)),_}function Np(m,_){var v=_?Ap(m.buffer):m.buffer;return new m.constructor(v,m.byteOffset,m.length)}function Fp(m,_){var v=-1,x=m.length;for(_||(_=Array(x));++v<x;)_[v]=m[v];return _}function $p(m,_,v,x){var z=!v;v||(v={});for(var se=-1,le=_.length;++se<le;){var V=_[se],ue=x?x(v[V],m[V],V,v,m):void 0;ue===void 0&&(ue=m[V]),z?Ri(v,V,ue):Ep(v,V,ue)}return v}function jp(m){return ec(function(_,v){var x=-1,z=v.length,se=z>1?v[z-1]:void 0,le=z>2?v[2]:void 0;for(se=m.length>3&&typeof se=="function"?(z--,se):void 0,le&&zp(v[0],v[1],le)&&(se=z<3?void 0:se,z=1),_=Object(_);++x<z;){var V=v[x];V&&m(_,V,x,se)}return _})}function Up(m){return function(_,v,x){for(var z=-1,se=Object(_),le=x(_),V=le.length;V--;){var ue=le[m?V:++z];if(v(se[ue],ue,se)===!1)break}return _}}function tc(m,_,v,x,z,se){return Dt(m)&&Dt(_)&&(se.set(_,m),Ti(m,_,void 0,tc,se),se.delete(_)),m}function Xs(m,_){var v=m.__data__;return Vp(_)?v[typeof _=="string"?"string":"hash"]:v.map}function Di(m,_){var v=Jh(m,_);return Op(v)?v:void 0}function Bp(m){var _=Rt.call(m,Xt),v=m[Xt];try{m[Xt]=void 0;var x=!0}catch{}var z=Ho.call(m);return x&&(_?m[Xt]=v:delete m[Xt]),z}function qp(m){return typeof m.constructor=="function"&&!sc(m)?ip(Jo(m)):{}}function rc(m,_){var v=typeof m;return _=_??a,!!_&&(v=="number"||v!="symbol"&&ss.test(m))&&m>-1&&m%1==0&&m<_}function zp(m,_,v){if(!Dt(v))return!1;var x=typeof _;return(x=="number"?Oi(v)&&rc(_,v.length):x=="string"&&_ in v)?en(v[_],m):!1}function Vp(m){var _=typeof m;return _=="string"||_=="number"||_=="symbol"||_=="boolean"?m!=="__proto__":m===null}function Hp(m){return!!Vo&&Vo in m}function sc(m){var _=m&&m.constructor,v=typeof _=="function"&&_.prototype||Ws;return m===v}function Gp(m){var _=[];if(m!=null)for(var v in Object(m))_.push(v);return _}function Wp(m){return Ho.call(m)}function Zp(m,_,v){return _=Yo(_===void 0?m.length-1:_,0),function(){for(var x=arguments,z=-1,se=Yo(x.length-_,0),le=Array(se);++z<se;)le[z]=x[_+z];z=-1;for(var V=Array(_+1);++z<_;)V[z]=x[z];return V[_]=v(le),zo(m,this,V)}}function Ci(m,_){if(!(_==="constructor"&&typeof m[_]=="function")&&_!="__proto__")return m[_]}var Jp=Kp(Ip);function Kp(m){var _=0,v=0;return function(){var x=np(),z=i-(x-v);if(v=x,z>0){if(++_>=n)return arguments[0]}else _=0;return m.apply(void 0,arguments)}}function Yp(m){if(m!=null){try{return Zs.call(m)}catch{}try{return m+""}catch{}}return""}function en(m,_){return m===_||m!==m&&_!==_}var Ei=Xo(function(){return arguments}())?Xo:function(m){return as(m)&&Rt.call(m,"callee")&&!tp.call(m,"callee")},Mi=Array.isArray;function Oi(m){return m!=null&&ic(m.length)&&!Pi(m)}function Qp(m){return as(m)&&Oi(m)}var nc=sp||nf;function Pi(m){if(!Dt(m))return!1;var _=Qs(m);return _==p||_==f||_==o||_==M}function ic(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=a}function Dt(m){var _=typeof m;return m!=null&&(_=="object"||_=="function")}function as(m){return m!=null&&typeof m=="object"}function Xp(m){if(!as(m)||Qs(m)!=E)return!1;var _=Jo(m);if(_===null)return!0;var v=Rt.call(_,"constructor")&&_.constructor;return typeof v=="function"&&v instanceof v&&Zs.call(v)==Xh}var ac=qo?Zh(qo):Pp;function ef(m){return $p(m,oc(m))}var tf=ec(function(m){return m.push(void 0,tc),zo(rf,void 0,m)});function oc(m){return Oi(m)?Cp(m,!0):xp(m)}var rf=jp(function(m,_,v,x){Ti(m,_,v,x)});function sf(m){return function(){return m}}function cc(m){return m}function nf(){return!1}r.exports=tf})(kn,kn.exports);var oy=kn.exports;const yd=Gr(oy),cy="https://api.revolt.chat",dy={1:[[""]],2:[["admin","stats"],["admin","messages"],["users","@me"],["users",["{target}"]],["users","dms"],["users","friend"],["bots","create"],["bots",["{target}"]],["bots","@me"],["channels",["{target}"]],["channels","create"],["servers","create"],["servers",["{target}"]],["invites",["{target}"]],["safety","reports"],["safety","report"],["onboard","hello"],["onboard","complete"],["push","subscribe"],["push","unsubscribe"],["sync","unreads"]],3:[["users",["{target}"],"flags"],["users","@me","username"],["users",["{target}"],"default_avatar"],["users",["{target}"],"profile"],["users",["{target}"],"dm"],["users",["{target}"],"mutual"],["users",["{target}"],"friend"],["users",["{target}"],"block"],["bots",["{target}"],"invite"],["channels",["{target}"],"members"],["channels",["{target}"],"invites"],["channels",["{target}"],"messages"],["channels",["{target}"],"search"],["channels",["{target}"],"join_call"],["servers",["{target}"],"ack"],["servers",["{target}"],"channels"],["servers",["{target}"],"members"],["servers",["{target}"],"bans"],["servers",["{target}"],"invites"],["servers",["{target}"],"roles"],["servers",["{target}"],"emojis"],["custom","emoji",["{id}"]],["safety","reports",["{report}"]],["safety","report",["{id}"]],["safety","snapshot",["{report_id}"]],["auth","account","create"],["auth","account","reverify"],["auth","account","delete"],["auth","account",""],["auth","account","disable"],["auth","account","reset_password"],["auth","session","login"],["auth","session","logout"],["auth","session","all"],["auth","session",["{id}"]],["auth","mfa","ticket"],["auth","mfa",""],["auth","mfa","recovery"],["auth","mfa","methods"],["auth","mfa","totp"],["sync","settings","fetch"],["sync","settings","set"]],4:[["channels",["{target}"],"ack",["{message}"]],["channels",["{_target}"],"messages","stale"],["channels",["{target}"],"messages",["{msg}"]],["channels",["{target}"],"messages","bulk"],["channels",["{target}"],"recipients",["{member}"]],["channels",["{target}"],"permissions",["{role_id}"]],["channels",["{target}"],"permissions","default"],["servers",["{target}"],"members",["{member}"]],["servers",["{server}"],"members",["{target}"]],["servers",["{server}"],"bans",["{target}"]],["servers",["{target}"],"roles",["{role_id}"]],["servers",["{target}"],"permissions",["{role_id}"]],["servers",["{target}"],"permissions","default"],["auth","account","change","password"],["auth","account","change","email"],["auth","account","verify",["{code}"]]],5:[["channels",["{target}"],"messages",["{msg}"],"reactions"]],6:[["channels",["{target}"],"messages",["{msg}"],"reactions",["{emoji}"]]]},ly={"/":{get:[]},"/admin/stats":{get:[]},"/admin/messages":{post:[]},"/users/@me":{get:[]},"/users/{target}":{get:[],patch:[]},"/users/{target}/flags":{get:[]},"/users/@me/username":{patch:[]},"/users/{target}/default_avatar":{get:[]},"/users/{target}/profile":{get:[]},"/users/dms":{get:[]},"/users/{target}/dm":{get:[]},"/users/{target}/mutual":{get:[]},"/users/{target}/friend":{put:[],delete:[]},"/users/{target}/block":{put:[],delete:[]},"/users/friend":{post:[]},"/bots/create":{post:[]},"/bots/{target}/invite":{get:[],post:[]},"/bots/{target}":{get:[],delete:[],patch:[]},"/bots/@me":{get:[]},"/channels/{target}/ack/{message}":{put:[]},"/channels/{target}":{get:[],delete:["leave_silently"],patch:[]},"/channels/{target}/members":{get:[]},"/channels/{target}/invites":{post:[]},"/channels/{target}/messages":{get:["limit","before","after","sort","nearby","include_users"],post:[]},"/channels/{target}/search":{post:[]},"/channels/{_target}/messages/stale":{post:[]},"/channels/{target}/messages/{msg}":{get:[],delete:[],patch:[]},"/channels/{target}/messages/bulk":{delete:[]},"/channels/create":{post:[]},"/channels/{target}/recipients/{member}":{put:[],delete:[]},"/channels/{target}/join_call":{post:[]},"/channels/{target}/permissions/{role_id}":{put:[]},"/channels/{target}/permissions/default":{put:[]},"/channels/{target}/messages/{msg}/reactions/{emoji}":{put:[],delete:["user_id","remove_all"]},"/channels/{target}/messages/{msg}/reactions":{delete:[]},"/servers/create":{post:[]},"/servers/{target}":{get:[],delete:["leave_silently"],patch:[]},"/servers/{target}/ack":{put:[]},"/servers/{target}/channels":{post:[]},"/servers/{target}/members":{get:["exclude_offline"]},"/servers/{target}/members/{member}":{get:[],delete:[]},"/servers/{server}/members/{target}":{patch:[]},"/servers/{server}/bans/{target}":{put:[],delete:[]},"/servers/{target}/bans":{get:[]},"/servers/{target}/invites":{get:[]},"/servers/{target}/roles":{post:[]},"/servers/{target}/roles/{role_id}":{delete:[],patch:[]},"/servers/{target}/permissions/{role_id}":{put:[]},"/servers/{target}/permissions/default":{put:[]},"/servers/{target}/emojis":{get:[]},"/invites/{target}":{get:[],post:[],delete:[]},"/custom/emoji/{id}":{get:[],put:[],delete:[]},"/safety/reports/{report}":{patch:[]},"/safety/report/{id}":{get:[]},"/safety/reports":{get:[]},"/safety/report":{post:[]},"/safety/snapshot/{report_id}":{get:[]},"/auth/account/create":{post:[]},"/auth/account/reverify":{post:[]},"/auth/account/delete":{put:[],post:[]},"/auth/account/":{get:[]},"/auth/account/disable":{post:[]},"/auth/account/change/password":{patch:[]},"/auth/account/change/email":{patch:[]},"/auth/account/verify/{code}":{post:[]},"/auth/account/reset_password":{post:[],patch:[]},"/auth/session/login":{post:[]},"/auth/session/logout":{post:[]},"/auth/session/all":{get:[],delete:["revoke_self"]},"/auth/session/{id}":{delete:[],patch:[]},"/auth/mfa/ticket":{put:[]},"/auth/mfa/":{get:[]},"/auth/mfa/recovery":{post:[],patch:[]},"/auth/mfa/methods":{get:[]},"/auth/mfa/totp":{put:[],post:[],delete:[]},"/onboard/hello":{get:[]},"/onboard/complete":{post:[]},"/push/subscribe":{post:[]},"/push/unsubscribe":{post:[]},"/sync/settings/fetch":{post:[]},"/sync/settings/set":{post:["timestamp"]},"/sync/unreads":{get:[]}};function uy(r){const e=r.split("/"),t=dy[(e.length-1).toString()]||[];for(const s of t){let n=1,i=[...e];for(n;n<e.length;n++)if(Array.isArray(s[n-1])){i[n]=s[n-1];continue}else if(s[n-1]!==e[n])break;if(n===e.length)return i.join("/")}}class vd{constructor({baseURL:e,authentication:t}={}){T(this,"baseURL");T(this,"authentication");this.baseURL=e||cy,this.authentication=t||{}}get auth(){if(this.authentication.rauth){if(typeof this.authentication.rauth=="string")return{headers:{"X-Session-Token":this.authentication.rauth}}}else if(this.authentication.revolt)switch(typeof this.authentication.revolt){case"string":return{headers:{"X-Bot-Token":this.authentication.revolt}};case"object":return{headers:{"X-Session-Token":this.authentication.revolt.token}}}return{}}get config(){return{baseURL:this.baseURL,...this.auth}}req(e,t,s,n){let i,a,c=uy(t);if(c&&typeof s=="object"){const o=ly[c][e];for(const l of Object.keys(s))o!=null&&o.includes(l)?i={...i||{},[l]:s[l]}:a={...a||{},[l]:s[l]}}return ay(t,yd({method:e,params:i,data:a},yd(n,this.config))).then(u=>u.data)}get(e,t,s){return this.req("get",e,t,s)}patch(e,t,s){return this.req("patch",e,t,s)}put(e,t,s){return this.req("put",e,t,s)}delete(e,t,s){return this.req("delete",e,t,s)}post(e,t,s){return this.req("post",e,t,s)}}var Et;(function(r){r.Blocked="Blocked",r.Friend="Friend",r.Incoming="Incoming",r.None="None",r.Outgoing="Outgoing",r.Self="User",r.SelfBlocked="BlockedOther"})(Et||(Et={}));var Ue;(function(r){r.GroupDescriptionChange="channel_description_changed",r.GroupIconChange="channel_icon_changed",r.GroupOwnershipChange="channel_ownership_changed",r.GroupRenamed="channel_renamed",r.Text="text",r.UserAdded="user_added",r.UserBanned="user_banned",r.UserJoined="user_joined",r.UserKicked="user_kicked",r.UserLeft="user_left",r.UserRemoved="user_remove"})(Ue||(Ue={}));const ka="00000000000000000000000000";function pu(r,e){return function(){return r.apply(e,arguments)}}const{toString:fu}=Object.prototype,{getPrototypeOf:bo}=Object,So=(r=>e=>{const t=fu.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Lt=r=>(r=r.toLowerCase(),e=>So(e)===r),oi=r=>e=>typeof e===r,{isArray:Yr}=Array,Ss=oi("undefined");function hy(r){return r!==null&&!Ss(r)&&r.constructor!==null&&!Ss(r.constructor)&&Yt(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const mu=Lt("ArrayBuffer");function py(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&mu(r.buffer),e}const fy=oi("string"),Yt=oi("function"),gu=oi("number"),Ro=r=>r!==null&&typeof r=="object",my=r=>r===!0||r===!1,Dn=r=>{if(So(r)!=="object")return!1;const e=bo(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},gy=Lt("Date"),_y=Lt("File"),wy=Lt("Blob"),yy=Lt("FileList"),vy=r=>Ro(r)&&Yt(r.pipe),by=r=>{const e="[object FormData]";return r&&(typeof FormData=="function"&&r instanceof FormData||fu.call(r)===e||Yt(r.toString)&&r.toString()===e)},Sy=Lt("URLSearchParams"),Ry=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function js(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r>"u")return;let s,n;if(typeof r!="object"&&(r=[r]),Yr(r))for(s=0,n=r.length;s<n;s++)e.call(null,r[s],s,r);else{const i=t?Object.getOwnPropertyNames(r):Object.keys(r),a=i.length;let c;for(s=0;s<a;s++)c=i[s],e.call(null,r[c],c,r)}}function _u(r,e){e=e.toLowerCase();const t=Object.keys(r);let s=t.length,n;for(;s-- >0;)if(n=t[s],e===n.toLowerCase())return n;return null}const wu=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),yu=r=>!Ss(r)&&r!==wu;function Ia(){const{caseless:r}=yu(this)&&this||{},e={},t=(s,n)=>{const i=r&&_u(e,n)||n;Dn(e[i])&&Dn(s)?e[i]=Ia(e[i],s):Dn(s)?e[i]=Ia({},s):Yr(s)?e[i]=s.slice():e[i]=s};for(let s=0,n=arguments.length;s<n;s++)arguments[s]&&js(arguments[s],t);return e}const Ty=(r,e,t,{allOwnKeys:s}={})=>(js(e,(n,i)=>{t&&Yt(n)?r[i]=pu(n,t):r[i]=n},{allOwnKeys:s}),r),Dy=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),Cy=(r,e,t,s)=>{r.prototype=Object.create(e.prototype,s),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},Ey=(r,e,t,s)=>{let n,i,a;const c={};if(e=e||{},r==null)return e;do{for(n=Object.getOwnPropertyNames(r),i=n.length;i-- >0;)a=n[i],(!s||s(a,r,e))&&!c[a]&&(e[a]=r[a],c[a]=!0);r=t!==!1&&bo(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},My=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;const s=r.indexOf(e,t);return s!==-1&&s===t},Oy=r=>{if(!r)return null;if(Yr(r))return r;let e=r.length;if(!gu(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},Py=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&bo(Uint8Array)),xy=(r,e)=>{const s=(r&&r[Symbol.iterator]).call(r);let n;for(;(n=s.next())&&!n.done;){const i=n.value;e.call(r,i[0],i[1])}},ky=(r,e)=>{let t;const s=[];for(;(t=r.exec(e))!==null;)s.push(t);return s},Iy=Lt("HTMLFormElement"),Ly=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,n){return s.toUpperCase()+n}),bd=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),Ay=Lt("RegExp"),vu=(r,e)=>{const t=Object.getOwnPropertyDescriptors(r),s={};js(t,(n,i)=>{e(n,i,r)!==!1&&(s[i]=n)}),Object.defineProperties(r,s)},Ny=r=>{vu(r,(e,t)=>{if(Yt(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=r[t];if(Yt(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Fy=(r,e)=>{const t={},s=n=>{n.forEach(i=>{t[i]=!0})};return Yr(r)?s(r):s(String(r).split(e)),t},$y=()=>{},jy=(r,e)=>(r=+r,Number.isFinite(r)?r:e),ha="abcdefghijklmnopqrstuvwxyz",Sd="0123456789",bu={DIGIT:Sd,ALPHA:ha,ALPHA_DIGIT:ha+ha.toUpperCase()+Sd},Uy=(r=16,e=bu.ALPHA_DIGIT)=>{let t="";const{length:s}=e;for(;r--;)t+=e[Math.random()*s|0];return t};function By(r){return!!(r&&Yt(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const qy=r=>{const e=new Array(10),t=(s,n)=>{if(Ro(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[n]=s;const i=Yr(s)?[]:{};return js(s,(a,c)=>{const u=t(a,n+1);!Ss(u)&&(i[c]=u)}),e[n]=void 0,i}}return s};return t(r,0)},R={isArray:Yr,isArrayBuffer:mu,isBuffer:hy,isFormData:by,isArrayBufferView:py,isString:fy,isNumber:gu,isBoolean:my,isObject:Ro,isPlainObject:Dn,isUndefined:Ss,isDate:gy,isFile:_y,isBlob:wy,isRegExp:Ay,isFunction:Yt,isStream:vy,isURLSearchParams:Sy,isTypedArray:Py,isFileList:yy,forEach:js,merge:Ia,extend:Ty,trim:Ry,stripBOM:Dy,inherits:Cy,toFlatObject:Ey,kindOf:So,kindOfTest:Lt,endsWith:My,toArray:Oy,forEachEntry:xy,matchAll:ky,isHTMLForm:Iy,hasOwnProperty:bd,hasOwnProp:bd,reduceDescriptors:vu,freezeMethods:Ny,toObjectSet:Fy,toCamelCase:Ly,noop:$y,toFiniteNumber:jy,findKey:_u,global:wu,isContextDefined:yu,ALPHABET:bu,generateString:Uy,isSpecCompliantForm:By,toJSONObject:qy};function Y(r,e,t,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),n&&(this.response=n)}R.inherits(Y,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:R.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Su=Y.prototype,Ru={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{Ru[r]={value:r}});Object.defineProperties(Y,Ru);Object.defineProperty(Su,"isAxiosError",{value:!0});Y.from=(r,e,t,s,n,i)=>{const a=Object.create(Su);return R.toFlatObject(r,a,function(u){return u!==Error.prototype},c=>c!=="isAxiosError"),Y.call(a,r.message,e,t,s,n),a.cause=r,a.name=r.name,i&&Object.assign(a,i),a};const zy=null;function La(r){return R.isPlainObject(r)||R.isArray(r)}function Tu(r){return R.endsWith(r,"[]")?r.slice(0,-2):r}function Rd(r,e,t){return r?r.concat(e).map(function(n,i){return n=Tu(n),!t&&i?"["+n+"]":n}).join(t?".":""):e}function Vy(r){return R.isArray(r)&&!r.some(La)}const Hy=R.toFlatObject(R,{},null,function(e){return/^is[A-Z]/.test(e)});function ci(r,e,t){if(!R.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=R.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,g){return!R.isUndefined(g[w])});const s=t.metaTokens,n=t.visitor||l,i=t.dots,a=t.indexes,u=(t.Blob||typeof Blob<"u"&&Blob)&&R.isSpecCompliantForm(e);if(!R.isFunction(n))throw new TypeError("visitor must be a function");function o(f){if(f===null)return"";if(R.isDate(f))return f.toISOString();if(!u&&R.isBlob(f))throw new Y("Blob is not supported. Use a Buffer instead.");return R.isArrayBuffer(f)||R.isTypedArray(f)?u&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function l(f,w,g){let b=f;if(f&&!g&&typeof f=="object"){if(R.endsWith(w,"{}"))w=s?w:w.slice(0,-2),f=JSON.stringify(f);else if(R.isArray(f)&&Vy(f)||(R.isFileList(f)||R.endsWith(w,"[]"))&&(b=R.toArray(f)))return w=Tu(w),b.forEach(function(M,P){!(R.isUndefined(M)||M===null)&&e.append(a===!0?Rd([w],P,i):a===null?w:w+"[]",o(M))}),!1}return La(f)?!0:(e.append(Rd(g,w,i),o(f)),!1)}const d=[],h=Object.assign(Hy,{defaultVisitor:l,convertValue:o,isVisitable:La});function p(f,w){if(!R.isUndefined(f)){if(d.indexOf(f)!==-1)throw Error("Circular reference detected in "+w.join("."));d.push(f),R.forEach(f,function(b,E){(!(R.isUndefined(b)||b===null)&&n.call(e,b,R.isString(E)?E.trim():E,w,h))===!0&&p(b,w?w.concat(E):[E])}),d.pop()}}if(!R.isObject(r))throw new TypeError("data must be an object");return p(r),e}function Td(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function To(r,e){this._pairs=[],r&&ci(r,this,e)}const Du=To.prototype;Du.append=function(e,t){this._pairs.push([e,t])};Du.toString=function(e){const t=e?function(s){return e.call(this,s,Td)}:Td;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function Gy(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Cu(r,e,t){if(!e)return r;const s=t&&t.encode||Gy,n=t&&t.serialize;let i;if(n?i=n(e,t):i=R.isURLSearchParams(e)?e.toString():new To(e,t).toString(s),i){const a=r.indexOf("#");a!==-1&&(r=r.slice(0,a)),r+=(r.indexOf("?")===-1?"?":"&")+i}return r}class Wy{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){R.forEach(this.handlers,function(s){s!==null&&e(s)})}}const Dd=Wy,Eu={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Zy=typeof URLSearchParams<"u"?URLSearchParams:To,Jy=typeof FormData<"u"?FormData:null,Ky=typeof Blob<"u"?Blob:null,Yy=(()=>{let r;return typeof navigator<"u"&&((r=navigator.product)==="ReactNative"||r==="NativeScript"||r==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),Qy=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),yt={isBrowser:!0,classes:{URLSearchParams:Zy,FormData:Jy,Blob:Ky},isStandardBrowserEnv:Yy,isStandardBrowserWebWorkerEnv:Qy,protocols:["http","https","file","blob","url","data"]};function Xy(r,e){return ci(r,new yt.classes.URLSearchParams,Object.assign({visitor:function(t,s,n,i){return yt.isNode&&R.isBuffer(t)?(this.append(s,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function ev(r){return R.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function tv(r){const e={},t=Object.keys(r);let s;const n=t.length;let i;for(s=0;s<n;s++)i=t[s],e[i]=r[i];return e}function Mu(r){function e(t,s,n,i){let a=t[i++];const c=Number.isFinite(+a),u=i>=t.length;return a=!a&&R.isArray(n)?n.length:a,u?(R.hasOwnProp(n,a)?n[a]=[n[a],s]:n[a]=s,!c):((!n[a]||!R.isObject(n[a]))&&(n[a]=[]),e(t,s,n[a],i)&&R.isArray(n[a])&&(n[a]=tv(n[a])),!c)}if(R.isFormData(r)&&R.isFunction(r.entries)){const t={};return R.forEachEntry(r,(s,n)=>{e(ev(s),n,t,0)}),t}return null}const rv={"Content-Type":void 0};function sv(r,e,t){if(R.isString(r))try{return(e||JSON.parse)(r),R.trim(r)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(r)}const di={transitional:Eu,adapter:["xhr","http"],transformRequest:[function(e,t){const s=t.getContentType()||"",n=s.indexOf("application/json")>-1,i=R.isObject(e);if(i&&R.isHTMLForm(e)&&(e=new FormData(e)),R.isFormData(e))return n&&n?JSON.stringify(Mu(e)):e;if(R.isArrayBuffer(e)||R.isBuffer(e)||R.isStream(e)||R.isFile(e)||R.isBlob(e))return e;if(R.isArrayBufferView(e))return e.buffer;if(R.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let c;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Xy(e,this.formSerializer).toString();if((c=R.isFileList(e))||s.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return ci(c?{"files[]":e}:e,u&&new u,this.formSerializer)}}return i||n?(t.setContentType("application/json",!1),sv(e)):e}],transformResponse:[function(e){const t=this.transitional||di.transitional,s=t&&t.forcedJSONParsing,n=this.responseType==="json";if(e&&R.isString(e)&&(s&&!this.responseType||n)){const a=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(c){if(a)throw c.name==="SyntaxError"?Y.from(c,Y.ERR_BAD_RESPONSE,this,null,this.response):c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:yt.classes.FormData,Blob:yt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};R.forEach(["delete","get","head"],function(e){di.headers[e]={}});R.forEach(["post","put","patch"],function(e){di.headers[e]=R.merge(rv)});const Do=di,nv=R.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),iv=r=>{const e={};let t,s,n;return r&&r.split(`
`).forEach(function(a){n=a.indexOf(":"),t=a.substring(0,n).trim().toLowerCase(),s=a.substring(n+1).trim(),!(!t||e[t]&&nv[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},Cd=Symbol("internals");function hs(r){return r&&String(r).trim().toLowerCase()}function Cn(r){return r===!1||r==null?r:R.isArray(r)?r.map(Cn):String(r)}function av(r){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(r);)e[s[1]]=s[2];return e}const ov=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function pa(r,e,t,s,n){if(R.isFunction(s))return s.call(this,e,t);if(n&&(e=t),!!R.isString(e)){if(R.isString(s))return e.indexOf(s)!==-1;if(R.isRegExp(s))return s.test(e)}}function cv(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function dv(r,e){const t=R.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(r,s+t,{value:function(n,i,a){return this[s].call(this,e,n,i,a)},configurable:!0})})}class li{constructor(e){e&&this.set(e)}set(e,t,s){const n=this;function i(c,u,o){const l=hs(u);if(!l)throw new Error("header name must be a non-empty string");const d=R.findKey(n,l);(!d||n[d]===void 0||o===!0||o===void 0&&n[d]!==!1)&&(n[d||u]=Cn(c))}const a=(c,u)=>R.forEach(c,(o,l)=>i(o,l,u));return R.isPlainObject(e)||e instanceof this.constructor?a(e,t):R.isString(e)&&(e=e.trim())&&!ov(e)?a(iv(e),t):e!=null&&i(t,e,s),this}get(e,t){if(e=hs(e),e){const s=R.findKey(this,e);if(s){const n=this[s];if(!t)return n;if(t===!0)return av(n);if(R.isFunction(t))return t.call(this,n,s);if(R.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=hs(e),e){const s=R.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||pa(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let n=!1;function i(a){if(a=hs(a),a){const c=R.findKey(s,a);c&&(!t||pa(s,s[c],c,t))&&(delete s[c],n=!0)}}return R.isArray(e)?e.forEach(i):i(e),n}clear(e){const t=Object.keys(this);let s=t.length,n=!1;for(;s--;){const i=t[s];(!e||pa(this,this[i],i,e,!0))&&(delete this[i],n=!0)}return n}normalize(e){const t=this,s={};return R.forEach(this,(n,i)=>{const a=R.findKey(s,i);if(a){t[a]=Cn(n),delete t[i];return}const c=e?cv(i):String(i).trim();c!==i&&delete t[i],t[c]=Cn(n),s[c]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return R.forEach(this,(s,n)=>{s!=null&&s!==!1&&(t[n]=e&&R.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(n=>s.set(n)),s}static accessor(e){const s=(this[Cd]=this[Cd]={accessors:{}}).accessors,n=this.prototype;function i(a){const c=hs(a);s[c]||(dv(n,a),s[c]=!0)}return R.isArray(e)?e.forEach(i):i(e),this}}li.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);R.freezeMethods(li.prototype);R.freezeMethods(li);const xt=li;function fa(r,e){const t=this||Do,s=e||t,n=xt.from(s.headers);let i=s.data;return R.forEach(r,function(c){i=c.call(t,i,n.normalize(),e?e.status:void 0)}),n.normalize(),i}function Ou(r){return!!(r&&r.__CANCEL__)}function Us(r,e,t){Y.call(this,r??"canceled",Y.ERR_CANCELED,e,t),this.name="CanceledError"}R.inherits(Us,Y,{__CANCEL__:!0});function lv(r,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?r(t):e(new Y("Request failed with status code "+t.status,[Y.ERR_BAD_REQUEST,Y.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}const uv=yt.isStandardBrowserEnv?function(){return{write:function(t,s,n,i,a,c){const u=[];u.push(t+"="+encodeURIComponent(s)),R.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),R.isString(i)&&u.push("path="+i),R.isString(a)&&u.push("domain="+a),c===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(t){const s=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function hv(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function pv(r,e){return e?r.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):r}function Pu(r,e){return r&&!hv(e)?pv(r,e):e}const fv=yt.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let s;function n(i){let a=i;return e&&(t.setAttribute("href",a),a=t.href),t.setAttribute("href",a),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return s=n(window.location.href),function(a){const c=R.isString(a)?n(a):a;return c.protocol===s.protocol&&c.host===s.host}}():function(){return function(){return!0}}();function mv(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function gv(r,e){r=r||10;const t=new Array(r),s=new Array(r);let n=0,i=0,a;return e=e!==void 0?e:1e3,function(u){const o=Date.now(),l=s[i];a||(a=o),t[n]=u,s[n]=o;let d=i,h=0;for(;d!==n;)h+=t[d++],d=d%r;if(n=(n+1)%r,n===i&&(i=(i+1)%r),o-a<e)return;const p=l&&o-l;return p?Math.round(h*1e3/p):void 0}}function Ed(r,e){let t=0;const s=gv(50,250);return n=>{const i=n.loaded,a=n.lengthComputable?n.total:void 0,c=i-t,u=s(c),o=i<=a;t=i;const l={loaded:i,total:a,progress:a?i/a:void 0,bytes:c,rate:u||void 0,estimated:u&&a&&o?(a-i)/u:void 0,event:n};l[e?"download":"upload"]=!0,r(l)}}const _v=typeof XMLHttpRequest<"u",wv=_v&&function(r){return new Promise(function(t,s){let n=r.data;const i=xt.from(r.headers).normalize(),a=r.responseType;let c;function u(){r.cancelToken&&r.cancelToken.unsubscribe(c),r.signal&&r.signal.removeEventListener("abort",c)}R.isFormData(n)&&(yt.isStandardBrowserEnv||yt.isStandardBrowserWebWorkerEnv)&&i.setContentType(!1);let o=new XMLHttpRequest;if(r.auth){const p=r.auth.username||"",f=r.auth.password?unescape(encodeURIComponent(r.auth.password)):"";i.set("Authorization","Basic "+btoa(p+":"+f))}const l=Pu(r.baseURL,r.url);o.open(r.method.toUpperCase(),Cu(l,r.params,r.paramsSerializer),!0),o.timeout=r.timeout;function d(){if(!o)return;const p=xt.from("getAllResponseHeaders"in o&&o.getAllResponseHeaders()),w={data:!a||a==="text"||a==="json"?o.responseText:o.response,status:o.status,statusText:o.statusText,headers:p,config:r,request:o};lv(function(b){t(b),u()},function(b){s(b),u()},w),o=null}if("onloadend"in o?o.onloadend=d:o.onreadystatechange=function(){!o||o.readyState!==4||o.status===0&&!(o.responseURL&&o.responseURL.indexOf("file:")===0)||setTimeout(d)},o.onabort=function(){o&&(s(new Y("Request aborted",Y.ECONNABORTED,r,o)),o=null)},o.onerror=function(){s(new Y("Network Error",Y.ERR_NETWORK,r,o)),o=null},o.ontimeout=function(){let f=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const w=r.transitional||Eu;r.timeoutErrorMessage&&(f=r.timeoutErrorMessage),s(new Y(f,w.clarifyTimeoutError?Y.ETIMEDOUT:Y.ECONNABORTED,r,o)),o=null},yt.isStandardBrowserEnv){const p=(r.withCredentials||fv(l))&&r.xsrfCookieName&&uv.read(r.xsrfCookieName);p&&i.set(r.xsrfHeaderName,p)}n===void 0&&i.setContentType(null),"setRequestHeader"in o&&R.forEach(i.toJSON(),function(f,w){o.setRequestHeader(w,f)}),R.isUndefined(r.withCredentials)||(o.withCredentials=!!r.withCredentials),a&&a!=="json"&&(o.responseType=r.responseType),typeof r.onDownloadProgress=="function"&&o.addEventListener("progress",Ed(r.onDownloadProgress,!0)),typeof r.onUploadProgress=="function"&&o.upload&&o.upload.addEventListener("progress",Ed(r.onUploadProgress)),(r.cancelToken||r.signal)&&(c=p=>{o&&(s(!p||p.type?new Us(null,r,o):p),o.abort(),o=null)},r.cancelToken&&r.cancelToken.subscribe(c),r.signal&&(r.signal.aborted?c():r.signal.addEventListener("abort",c)));const h=mv(l);if(h&&yt.protocols.indexOf(h)===-1){s(new Y("Unsupported protocol "+h+":",Y.ERR_BAD_REQUEST,r));return}o.send(n||null)})},En={http:zy,xhr:wv};R.forEach(En,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const yv={getAdapter:r=>{r=R.isArray(r)?r:[r];const{length:e}=r;let t,s;for(let n=0;n<e&&(t=r[n],!(s=R.isString(t)?En[t.toLowerCase()]:t));n++);if(!s)throw s===!1?new Y(`Adapter ${t} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(R.hasOwnProp(En,t)?`Adapter '${t}' is not available in the build`:`Unknown adapter '${t}'`);if(!R.isFunction(s))throw new TypeError("adapter is not a function");return s},adapters:En};function ma(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Us(null,r)}function Md(r){return ma(r),r.headers=xt.from(r.headers),r.data=fa.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),yv.getAdapter(r.adapter||Do.adapter)(r).then(function(s){return ma(r),s.data=fa.call(r,r.transformResponse,s),s.headers=xt.from(s.headers),s},function(s){return Ou(s)||(ma(r),s&&s.response&&(s.response.data=fa.call(r,r.transformResponse,s.response),s.response.headers=xt.from(s.response.headers))),Promise.reject(s)})}const Od=r=>r instanceof xt?r.toJSON():r;function zr(r,e){e=e||{};const t={};function s(o,l,d){return R.isPlainObject(o)&&R.isPlainObject(l)?R.merge.call({caseless:d},o,l):R.isPlainObject(l)?R.merge({},l):R.isArray(l)?l.slice():l}function n(o,l,d){if(R.isUndefined(l)){if(!R.isUndefined(o))return s(void 0,o,d)}else return s(o,l,d)}function i(o,l){if(!R.isUndefined(l))return s(void 0,l)}function a(o,l){if(R.isUndefined(l)){if(!R.isUndefined(o))return s(void 0,o)}else return s(void 0,l)}function c(o,l,d){if(d in e)return s(o,l);if(d in r)return s(void 0,o)}const u={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c,headers:(o,l)=>n(Od(o),Od(l),!0)};return R.forEach(Object.keys(r).concat(Object.keys(e)),function(l){const d=u[l]||n,h=d(r[l],e[l],l);R.isUndefined(h)&&d!==c||(t[l]=h)}),t}const xu="1.3.5",Co={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{Co[r]=function(s){return typeof s===r||"a"+(e<1?"n ":" ")+r}});const Pd={};Co.transitional=function(e,t,s){function n(i,a){return"[Axios v"+xu+"] Transitional option '"+i+"'"+a+(s?". "+s:"")}return(i,a,c)=>{if(e===!1)throw new Y(n(a," has been removed"+(t?" in "+t:"")),Y.ERR_DEPRECATED);return t&&!Pd[a]&&(Pd[a]=!0,console.warn(n(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,a,c):!0}};function vv(r,e,t){if(typeof r!="object")throw new Y("options must be an object",Y.ERR_BAD_OPTION_VALUE);const s=Object.keys(r);let n=s.length;for(;n-- >0;){const i=s[n],a=e[i];if(a){const c=r[i],u=c===void 0||a(c,i,r);if(u!==!0)throw new Y("option "+i+" must be "+u,Y.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Y("Unknown option "+i,Y.ERR_BAD_OPTION)}}const Aa={assertOptions:vv,validators:Co},Vt=Aa.validators;class In{constructor(e){this.defaults=e,this.interceptors={request:new Dd,response:new Dd}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=zr(this.defaults,t);const{transitional:s,paramsSerializer:n,headers:i}=t;s!==void 0&&Aa.assertOptions(s,{silentJSONParsing:Vt.transitional(Vt.boolean),forcedJSONParsing:Vt.transitional(Vt.boolean),clarifyTimeoutError:Vt.transitional(Vt.boolean)},!1),n!=null&&(R.isFunction(n)?t.paramsSerializer={serialize:n}:Aa.assertOptions(n,{encode:Vt.function,serialize:Vt.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a;a=i&&R.merge(i.common,i[t.method]),a&&R.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),t.headers=xt.concat(a,i);const c=[];let u=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(t)===!1||(u=u&&w.synchronous,c.unshift(w.fulfilled,w.rejected))});const o=[];this.interceptors.response.forEach(function(w){o.push(w.fulfilled,w.rejected)});let l,d=0,h;if(!u){const f=[Md.bind(this),void 0];for(f.unshift.apply(f,c),f.push.apply(f,o),h=f.length,l=Promise.resolve(t);d<h;)l=l.then(f[d++],f[d++]);return l}h=c.length;let p=t;for(d=0;d<h;){const f=c[d++],w=c[d++];try{p=f(p)}catch(g){w.call(this,g);break}}try{l=Md.call(this,p)}catch(f){return Promise.reject(f)}for(d=0,h=o.length;d<h;)l=l.then(o[d++],o[d++]);return l}getUri(e){e=zr(this.defaults,e);const t=Pu(e.baseURL,e.url);return Cu(t,e.params,e.paramsSerializer)}}R.forEach(["delete","get","head","options"],function(e){In.prototype[e]=function(t,s){return this.request(zr(s||{},{method:e,url:t,data:(s||{}).data}))}});R.forEach(["post","put","patch"],function(e){function t(s){return function(i,a,c){return this.request(zr(c||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}In.prototype[e]=t(),In.prototype[e+"Form"]=t(!0)});const Mn=In;class Eo{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const s=this;this.promise.then(n=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](n);s._listeners=null}),this.promise.then=n=>{let i;const a=new Promise(c=>{s.subscribe(c),i=c}).then(n);return a.cancel=function(){s.unsubscribe(i)},a},e(function(i,a,c){s.reason||(s.reason=new Us(i,a,c),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new Eo(function(n){e=n}),cancel:e}}}const bv=Eo;function Sv(r){return function(t){return r.apply(null,t)}}function Rv(r){return R.isObject(r)&&r.isAxiosError===!0}const Na={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Na).forEach(([r,e])=>{Na[e]=r});const Tv=Na;function ku(r){const e=new Mn(r),t=pu(Mn.prototype.request,e);return R.extend(t,Mn.prototype,e,{allOwnKeys:!0}),R.extend(t,e,null,{allOwnKeys:!0}),t.create=function(n){return ku(zr(r,n))},t}const Re=ku(Do);Re.Axios=Mn;Re.CanceledError=Us;Re.CancelToken=bv;Re.isCancel=Ou;Re.VERSION=xu;Re.toFormData=ci;Re.AxiosError=Y;Re.Cancel=Re.CanceledError;Re.all=function(e){return Promise.all(e)};Re.spread=Sv;Re.isAxiosError=Rv;Re.mergeConfig=zr;Re.AxiosHeaders=xt;Re.formToJSON=r=>Mu(R.isHTMLForm(r)?new FormData(r):r);Re.HttpStatusCode=Tv;Re.default=Re;const mn=Re;var Dv=typeof self=="object"?self.FormData:window.FormData;const Cv=Gr(Dv);function ar(r){var e=new Error(r);return e.source="ulid",e}var ui="0123456789ABCDEFGHJKMNPQRSTVWXYZ",Ur=ui.length,Fa=Math.pow(2,48)-1,$a=10,Iu=16;function Ev(r){var e=Math.floor(r()*Ur);return e===Ur&&(e=Ur-1),ui.charAt(e)}function Mv(r,e){if(isNaN(r))throw new Error(r+" must be a number");if(r>Fa)throw ar("cannot encode time greater than "+Fa);if(r<0)throw ar("time must be positive");if(Number.isInteger(r)===!1)throw ar("time must be an integer");for(var t=void 0,s="";e>0;e--)t=r%Ur,s=ui.charAt(t)+s,r=(r-t)/Ur;return s}function Ov(r,e){for(var t="";r>0;r--)t=Ev(e)+t;return t}function Pv(r){if(r.length!==$a+Iu)throw ar("malformed ulid");var e=r.substr(0,$a).split("").reverse().reduce(function(t,s,n){var i=ui.indexOf(s);if(i===-1)throw ar("invalid character found: "+s);return t+=i*Math.pow(Ur,n)},0);if(e>Fa)throw ar("malformed ulid, timestamp too large");return e}function xv(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=arguments[1];e||(e=typeof window<"u"?window:null);var t=e&&(e.crypto||e.msCrypto);if(t)return function(){var n=new Uint8Array(1);return t.getRandomValues(n),n[0]/255};try{var s=require("crypto");return function(){return s.randomBytes(1).readUInt8()/255}}catch{}if(r){try{console.error("secure crypto unusable, falling back to insecure Math.random()!")}catch{}return function(){return Math.random()}}throw ar("secure crypto unusable, insecure Math.random not allowed")}function kv(r){return r||(r=xv()),function(t){return isNaN(t)&&(t=Date.now()),Mv(t,$a)+Ov(Iu,r)}}var Rs=kv();class ur extends Error{}class Iv extends ur{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class Lv extends ur{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class Av extends ur{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class gs extends ur{}class Lu extends ur{constructor(e){super(`Invalid unit ${e}`)}}class Ze extends ur{}class Ht extends ur{constructor(){super("Zone is an abstract class")}}const O="numeric",ot="short",Be="long",Ln={year:O,month:O,day:O},Au={year:O,month:ot,day:O},Nv={year:O,month:ot,day:O,weekday:ot},Nu={year:O,month:Be,day:O},Fu={year:O,month:Be,day:O,weekday:Be},$u={hour:O,minute:O},ju={hour:O,minute:O,second:O},Uu={hour:O,minute:O,second:O,timeZoneName:ot},Bu={hour:O,minute:O,second:O,timeZoneName:Be},qu={hour:O,minute:O,hourCycle:"h23"},zu={hour:O,minute:O,second:O,hourCycle:"h23"},Vu={hour:O,minute:O,second:O,hourCycle:"h23",timeZoneName:ot},Hu={hour:O,minute:O,second:O,hourCycle:"h23",timeZoneName:Be},Gu={year:O,month:O,day:O,hour:O,minute:O},Wu={year:O,month:O,day:O,hour:O,minute:O,second:O},Zu={year:O,month:ot,day:O,hour:O,minute:O},Ju={year:O,month:ot,day:O,hour:O,minute:O,second:O},Fv={year:O,month:ot,day:O,weekday:ot,hour:O,minute:O},Ku={year:O,month:Be,day:O,hour:O,minute:O,timeZoneName:ot},Yu={year:O,month:Be,day:O,hour:O,minute:O,second:O,timeZoneName:ot},Qu={year:O,month:Be,day:O,weekday:Be,hour:O,minute:O,timeZoneName:Be},Xu={year:O,month:Be,day:O,weekday:Be,hour:O,minute:O,second:O,timeZoneName:Be};class Bs{get type(){throw new Ht}get name(){throw new Ht}get ianaName(){return this.name}get isUniversal(){throw new Ht}offsetName(e,t){throw new Ht}formatOffset(e,t){throw new Ht}offset(e){throw new Ht}equals(e){throw new Ht}get isValid(){throw new Ht}}let ga=null;class hi extends Bs{static get instance(){return ga===null&&(ga=new hi),ga}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:s}){return th(e,t,s)}formatOffset(e,t){return vs(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let On={};function $v(r){return On[r]||(On[r]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:r,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),On[r]}const jv={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function Uv(r,e){const t=r.format(e).replace(/\u200E/g,""),s=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,n,i,a,c,u,o,l]=s;return[a,n,i,c,u,o,l]}function Bv(r,e){const t=r.formatToParts(e),s=[];for(let n=0;n<t.length;n++){const{type:i,value:a}=t[n],c=jv[i];i==="era"?s[c]=a:W(c)||(s[c]=parseInt(a,10))}return s}let gn={};class It extends Bs{static create(e){return gn[e]||(gn[e]=new It(e)),gn[e]}static resetCache(){gn={},On={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=It.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:s}){return th(e,t,s,this.name)}formatOffset(e,t){return vs(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const s=$v(this.name);let[n,i,a,c,u,o,l]=s.formatToParts?Bv(s,t):Uv(s,t);c==="BC"&&(n=-Math.abs(n)+1);const h=Po({year:n,month:i,day:a,hour:u===24?0:u,minute:o,second:l,millisecond:0});let p=+t;const f=p%1e3;return p-=f>=0?f:1e3+f,(h-p)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let xd={};function qv(r,e={}){const t=JSON.stringify([r,e]);let s=xd[t];return s||(s=new Intl.ListFormat(r,e),xd[t]=s),s}let ja={};function Ua(r,e={}){const t=JSON.stringify([r,e]);let s=ja[t];return s||(s=new Intl.DateTimeFormat(r,e),ja[t]=s),s}let Ba={};function zv(r,e={}){const t=JSON.stringify([r,e]);let s=Ba[t];return s||(s=new Intl.NumberFormat(r,e),Ba[t]=s),s}let qa={};function Vv(r,e={}){const{base:t,...s}=e,n=JSON.stringify([r,s]);let i=qa[n];return i||(i=new Intl.RelativeTimeFormat(r,e),qa[n]=i),i}let _s=null;function Hv(){return _s||(_s=new Intl.DateTimeFormat().resolvedOptions().locale,_s)}function Gv(r){const e=r.indexOf("-x-");e!==-1&&(r=r.substring(0,e));const t=r.indexOf("-u-");if(t===-1)return[r];{let s,n;try{s=Ua(r).resolvedOptions(),n=r}catch{const u=r.substring(0,t);s=Ua(u).resolvedOptions(),n=u}const{numberingSystem:i,calendar:a}=s;return[n,i,a]}}function Wv(r,e,t){return(t||e)&&(r.includes("-u-")||(r+="-u"),t&&(r+=`-ca-${t}`),e&&(r+=`-nu-${e}`)),r}function Zv(r){const e=[];for(let t=1;t<=12;t++){const s=U.utc(2016,t,1);e.push(r(s))}return e}function Jv(r){const e=[];for(let t=1;t<=7;t++){const s=U.utc(2016,11,13+t);e.push(r(s))}return e}function _n(r,e,t,s,n){const i=r.listingMode(t);return i==="error"?null:i==="en"?s(e):n(e)}function Kv(r){return r.numberingSystem&&r.numberingSystem!=="latn"?!1:r.numberingSystem==="latn"||!r.locale||r.locale.startsWith("en")||new Intl.DateTimeFormat(r.intl).resolvedOptions().numberingSystem==="latn"}class Yv{constructor(e,t,s){this.padTo=s.padTo||0,this.floor=s.floor||!1;const{padTo:n,floor:i,...a}=s;if(!t||Object.keys(a).length>0){const c={useGrouping:!1,...s};s.padTo>0&&(c.minimumIntegerDigits=s.padTo),this.inf=zv(e,c)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):Oo(e,3);return ye(t,this.padTo)}}}class Qv{constructor(e,t,s){this.opts=s,this.originalZone=void 0;let n;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const a=-1*(e.offset/60),c=a>=0?`Etc/GMT+${a}`:`Etc/GMT${a}`;e.offset!==0&&It.create(c).valid?(n=c,this.dt=e):(n="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,n=e.zone.name):(n="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const i={...this.opts};i.timeZone=i.timeZone||n,this.dtf=Ua(t,i)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(t=>{if(t.type==="timeZoneName"){const s=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...t,value:s}}else return t}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class Xv{constructor(e,t,s){this.opts={style:"long",...s},!t&&eh()&&(this.rtf=Vv(e,s))}format(e,t){return this.rtf?this.rtf.format(e,t):gb(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}class ce{static fromOpts(e){return ce.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,t,s,n=!1){const i=e||we.defaultLocale,a=i||(n?"en-US":Hv()),c=t||we.defaultNumberingSystem,u=s||we.defaultOutputCalendar;return new ce(a,c,u,i)}static resetCache(){_s=null,ja={},Ba={},qa={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:s}={}){return ce.create(e,t,s)}constructor(e,t,s,n){const[i,a,c]=Gv(e);this.locale=i,this.numberingSystem=t||a||null,this.outputCalendar=s||c||null,this.intl=Wv(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Kv(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:ce.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1,s=!0){return _n(this,e,s,nh,()=>{const n=t?{month:e,day:"numeric"}:{month:e},i=t?"format":"standalone";return this.monthsCache[i][e]||(this.monthsCache[i][e]=Zv(a=>this.extract(a,n,"month"))),this.monthsCache[i][e]})}weekdays(e,t=!1,s=!0){return _n(this,e,s,oh,()=>{const n=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=t?"format":"standalone";return this.weekdaysCache[i][e]||(this.weekdaysCache[i][e]=Jv(a=>this.extract(a,n,"weekday"))),this.weekdaysCache[i][e]})}meridiems(e=!0){return _n(this,void 0,e,()=>ch,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[U.utc(2016,11,13,9),U.utc(2016,11,13,19)].map(s=>this.extract(s,t,"dayperiod"))}return this.meridiemCache})}eras(e,t=!0){return _n(this,e,t,dh,()=>{const s={era:e};return this.eraCache[e]||(this.eraCache[e]=[U.utc(-40,1,1),U.utc(2017,1,1)].map(n=>this.extract(n,s,"era"))),this.eraCache[e]})}extract(e,t,s){const n=this.dtFormatter(e,t),i=n.formatToParts(),a=i.find(c=>c.type.toLowerCase()===s);return a?a.value:null}numberFormatter(e={}){return new Yv(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new Qv(e,this.intl,t)}relFormatter(e={}){return new Xv(this.intl,this.isEnglish(),e)}listFormatter(e={}){return qv(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let _a=null;class Oe extends Bs{static get utcInstance(){return _a===null&&(_a=new Oe(0)),_a}static instance(e){return e===0?Oe.utcInstance:new Oe(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new Oe(fi(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${vs(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${vs(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return vs(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class eb extends Bs{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Zt(r,e){if(W(r)||r===null)return e;if(r instanceof Bs)return r;if(tb(r)){const t=r.toLowerCase();return t==="default"?e:t==="local"||t==="system"?hi.instance:t==="utc"||t==="gmt"?Oe.utcInstance:Oe.parseSpecifier(t)||It.create(r)}else return or(r)?Oe.instance(r):typeof r=="object"&&r.offset&&typeof r.offset=="number"?r:new eb(r)}let kd=()=>Date.now(),Id="system",Ld=null,Ad=null,Nd=null,Fd=60,$d;class we{static get now(){return kd}static set now(e){kd=e}static set defaultZone(e){Id=e}static get defaultZone(){return Zt(Id,hi.instance)}static get defaultLocale(){return Ld}static set defaultLocale(e){Ld=e}static get defaultNumberingSystem(){return Ad}static set defaultNumberingSystem(e){Ad=e}static get defaultOutputCalendar(){return Nd}static set defaultOutputCalendar(e){Nd=e}static get twoDigitCutoffYear(){return Fd}static set twoDigitCutoffYear(e){Fd=e%100}static get throwOnInvalid(){return $d}static set throwOnInvalid(e){$d=e}static resetCaches(){ce.resetCache(),It.resetCache()}}function W(r){return typeof r>"u"}function or(r){return typeof r=="number"}function pi(r){return typeof r=="number"&&r%1===0}function tb(r){return typeof r=="string"}function rb(r){return Object.prototype.toString.call(r)==="[object Date]"}function eh(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function sb(r){return Array.isArray(r)?r:[r]}function jd(r,e,t){if(r.length!==0)return r.reduce((s,n)=>{const i=[e(n),n];return s&&t(s[0],i[0])===s[0]?s:i},null)[1]}function nb(r,e){return e.reduce((t,s)=>(t[s]=r[s],t),{})}function Vr(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Ot(r,e,t){return pi(r)&&r>=e&&r<=t}function ib(r,e){return r-e*Math.floor(r/e)}function ye(r,e=2){const t=r<0;let s;return t?s="-"+(""+-r).padStart(e,"0"):s=(""+r).padStart(e,"0"),s}function Wt(r){if(!(W(r)||r===null||r===""))return parseInt(r,10)}function rr(r){if(!(W(r)||r===null||r===""))return parseFloat(r)}function Mo(r){if(!(W(r)||r===null||r==="")){const e=parseFloat("0."+r)*1e3;return Math.floor(e)}}function Oo(r,e,t=!1){const s=10**e;return(t?Math.trunc:Math.round)(r*s)/s}function qs(r){return r%4===0&&(r%100!==0||r%400===0)}function ys(r){return qs(r)?366:365}function An(r,e){const t=ib(e-1,12)+1,s=r+(e-t)/12;return t===2?qs(s)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function Po(r){let e=Date.UTC(r.year,r.month-1,r.day,r.hour,r.minute,r.second,r.millisecond);return r.year<100&&r.year>=0&&(e=new Date(e),e.setUTCFullYear(r.year,r.month-1,r.day)),+e}function Nn(r){const e=(r+Math.floor(r/4)-Math.floor(r/100)+Math.floor(r/400))%7,t=r-1,s=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7;return e===4||s===3?53:52}function za(r){return r>99?r:r>we.twoDigitCutoffYear?1900+r:2e3+r}function th(r,e,t,s=null){const n=new Date(r),i={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};s&&(i.timeZone=s);const a={timeZoneName:e,...i},c=new Intl.DateTimeFormat(t,a).formatToParts(n).find(u=>u.type.toLowerCase()==="timezonename");return c?c.value:null}function fi(r,e){let t=parseInt(r,10);Number.isNaN(t)&&(t=0);const s=parseInt(e,10)||0,n=t<0||Object.is(t,-0)?-s:s;return t*60+n}function rh(r){const e=Number(r);if(typeof r=="boolean"||r===""||Number.isNaN(e))throw new Ze(`Invalid unit value ${r}`);return e}function Fn(r,e){const t={};for(const s in r)if(Vr(r,s)){const n=r[s];if(n==null)continue;t[e(s)]=rh(n)}return t}function vs(r,e){const t=Math.trunc(Math.abs(r/60)),s=Math.trunc(Math.abs(r%60)),n=r>=0?"+":"-";switch(e){case"short":return`${n}${ye(t,2)}:${ye(s,2)}`;case"narrow":return`${n}${t}${s>0?`:${s}`:""}`;case"techie":return`${n}${ye(t,2)}${ye(s,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function mi(r){return nb(r,["hour","minute","second","millisecond"])}const ab=["January","February","March","April","May","June","July","August","September","October","November","December"],sh=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ob=["J","F","M","A","M","J","J","A","S","O","N","D"];function nh(r){switch(r){case"narrow":return[...ob];case"short":return[...sh];case"long":return[...ab];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const ih=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ah=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],cb=["M","T","W","T","F","S","S"];function oh(r){switch(r){case"narrow":return[...cb];case"short":return[...ah];case"long":return[...ih];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const ch=["AM","PM"],db=["Before Christ","Anno Domini"],lb=["BC","AD"],ub=["B","A"];function dh(r){switch(r){case"narrow":return[...ub];case"short":return[...lb];case"long":return[...db];default:return null}}function hb(r){return ch[r.hour<12?0:1]}function pb(r,e){return oh(e)[r.weekday-1]}function fb(r,e){return nh(e)[r.month-1]}function mb(r,e){return dh(e)[r.year<0?0:1]}function gb(r,e,t="always",s=!1){const n={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},i=["hours","minutes","seconds"].indexOf(r)===-1;if(t==="auto"&&i){const d=r==="days";switch(e){case 1:return d?"tomorrow":`next ${n[r][0]}`;case-1:return d?"yesterday":`last ${n[r][0]}`;case 0:return d?"today":`this ${n[r][0]}`}}const a=Object.is(e,-0)||e<0,c=Math.abs(e),u=c===1,o=n[r],l=s?u?o[1]:o[2]||o[1]:u?n[r][0]:r;return a?`${c} ${l} ago`:`in ${c} ${l}`}function Ud(r,e){let t="";for(const s of r)s.literal?t+=s.val:t+=e(s.val);return t}const _b={D:Ln,DD:Au,DDD:Nu,DDDD:Fu,t:$u,tt:ju,ttt:Uu,tttt:Bu,T:qu,TT:zu,TTT:Vu,TTTT:Hu,f:Gu,ff:Zu,fff:Ku,ffff:Qu,F:Wu,FF:Ju,FFF:Yu,FFFF:Xu};class Ce{static create(e,t={}){return new Ce(e,t)}static parseFormat(e){let t=null,s="",n=!1;const i=[];for(let a=0;a<e.length;a++){const c=e.charAt(a);c==="'"?(s.length>0&&i.push({literal:n||/^\s+$/.test(s),val:s}),t=null,s="",n=!n):n||c===t?s+=c:(s.length>0&&i.push({literal:/^\s+$/.test(s),val:s}),s=c,t=c)}return s.length>0&&i.push({literal:n||/^\s+$/.test(s),val:s}),i}static macroTokenToFormatOpts(e){return _b[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTime(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTimeParts(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).formatToParts()}formatInterval(e,t={}){return this.loc.dtFormatter(e.start,{...this.opts,...t}).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return ye(e,t);const s={...this.opts};return t>0&&(s.padTo=t),this.loc.numberFormatter(s).format(e)}formatDateTimeFromString(e,t){const s=this.loc.listingMode()==="en",n=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",i=(p,f)=>this.loc.extract(e,p,f),a=p=>e.isOffsetFixed&&e.offset===0&&p.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,p.format):"",c=()=>s?hb(e):i({hour:"numeric",hourCycle:"h12"},"dayperiod"),u=(p,f)=>s?fb(e,p):i(f?{month:p}:{month:p,day:"numeric"},"month"),o=(p,f)=>s?pb(e,p):i(f?{weekday:p}:{weekday:p,month:"long",day:"numeric"},"weekday"),l=p=>{const f=Ce.macroTokenToFormatOpts(p);return f?this.formatWithSystemDefault(e,f):p},d=p=>s?mb(e,p):i({era:p},"era"),h=p=>{switch(p){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return a({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return a({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return a({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return c();case"d":return n?i({day:"numeric"},"day"):this.num(e.day);case"dd":return n?i({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return o("short",!0);case"cccc":return o("long",!0);case"ccccc":return o("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return o("short",!1);case"EEEE":return o("long",!1);case"EEEEE":return o("narrow",!1);case"L":return n?i({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return n?i({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return n?i({month:"numeric"},"month"):this.num(e.month);case"MM":return n?i({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return n?i({year:"numeric"},"year"):this.num(e.year);case"yy":return n?i({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return n?i({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return n?i({year:"numeric"},"year"):this.num(e.year,6);case"G":return d("short");case"GG":return d("long");case"GGGGG":return d("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return l(p)}};return Ud(Ce.parseFormat(t),h)}formatDurationFromString(e,t){const s=u=>{switch(u[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=u=>o=>{const l=s(o);return l?this.num(u.get(l),o.length):o},i=Ce.parseFormat(t),a=i.reduce((u,{literal:o,val:l})=>o?u:u.concat(l),[]),c=e.shiftTo(...a.map(s).filter(u=>u));return Ud(i,n(c))}}class st{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const lh=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Qr(...r){const e=r.reduce((t,s)=>t+s.source,"");return RegExp(`^${e}$`)}function Xr(...r){return e=>r.reduce(([t,s,n],i)=>{const[a,c,u]=i(e,n);return[{...t,...a},c||s,u]},[{},null,1]).slice(0,2)}function es(r,...e){if(r==null)return[null,null];for(const[t,s]of e){const n=t.exec(r);if(n)return s(n)}return[null,null]}function uh(...r){return(e,t)=>{const s={};let n;for(n=0;n<r.length;n++)s[r[n]]=Wt(e[t+n]);return[s,null,t+n]}}const hh=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,wb=`(?:${hh.source}?(?:\\[(${lh.source})\\])?)?`,xo=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,ph=RegExp(`${xo.source}${wb}`),ko=RegExp(`(?:T${ph.source})?`),yb=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,vb=/(\d{4})-?W(\d\d)(?:-?(\d))?/,bb=/(\d{4})-?(\d{3})/,Sb=uh("weekYear","weekNumber","weekDay"),Rb=uh("year","ordinal"),Tb=/(\d{4})-(\d\d)-(\d\d)/,fh=RegExp(`${xo.source} ?(?:${hh.source}|(${lh.source}))?`),Db=RegExp(`(?: ${fh.source})?`);function Br(r,e,t){const s=r[e];return W(s)?t:Wt(s)}function Cb(r,e){return[{year:Br(r,e),month:Br(r,e+1,1),day:Br(r,e+2,1)},null,e+3]}function ts(r,e){return[{hours:Br(r,e,0),minutes:Br(r,e+1,0),seconds:Br(r,e+2,0),milliseconds:Mo(r[e+3])},null,e+4]}function zs(r,e){const t=!r[e]&&!r[e+1],s=fi(r[e+1],r[e+2]),n=t?null:Oe.instance(s);return[{},n,e+3]}function Vs(r,e){const t=r[e]?It.create(r[e]):null;return[{},t,e+1]}const Eb=RegExp(`^T?${xo.source}$`),Mb=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Ob(r){const[e,t,s,n,i,a,c,u,o]=r,l=e[0]==="-",d=u&&u[0]==="-",h=(p,f=!1)=>p!==void 0&&(f||p&&l)?-p:p;return[{years:h(rr(t)),months:h(rr(s)),weeks:h(rr(n)),days:h(rr(i)),hours:h(rr(a)),minutes:h(rr(c)),seconds:h(rr(u),u==="-0"),milliseconds:h(Mo(o),d)}]}const Pb={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Io(r,e,t,s,n,i,a){const c={year:e.length===2?za(Wt(e)):Wt(e),month:sh.indexOf(t)+1,day:Wt(s),hour:Wt(n),minute:Wt(i)};return a&&(c.second=Wt(a)),r&&(c.weekday=r.length>3?ih.indexOf(r)+1:ah.indexOf(r)+1),c}const xb=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function kb(r){const[,e,t,s,n,i,a,c,u,o,l,d]=r,h=Io(e,n,s,t,i,a,c);let p;return u?p=Pb[u]:o?p=0:p=fi(l,d),[h,new Oe(p)]}function Ib(r){return r.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const Lb=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Ab=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Nb=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Bd(r){const[,e,t,s,n,i,a,c]=r;return[Io(e,n,s,t,i,a,c),Oe.utcInstance]}function Fb(r){const[,e,t,s,n,i,a,c]=r;return[Io(e,c,t,s,n,i,a),Oe.utcInstance]}const $b=Qr(yb,ko),jb=Qr(vb,ko),Ub=Qr(bb,ko),Bb=Qr(ph),mh=Xr(Cb,ts,zs,Vs),qb=Xr(Sb,ts,zs,Vs),zb=Xr(Rb,ts,zs,Vs),Vb=Xr(ts,zs,Vs);function Hb(r){return es(r,[$b,mh],[jb,qb],[Ub,zb],[Bb,Vb])}function Gb(r){return es(Ib(r),[xb,kb])}function Wb(r){return es(r,[Lb,Bd],[Ab,Bd],[Nb,Fb])}function Zb(r){return es(r,[Mb,Ob])}const Jb=Xr(ts);function Kb(r){return es(r,[Eb,Jb])}const Yb=Qr(Tb,Db),Qb=Qr(fh),Xb=Xr(ts,zs,Vs);function eS(r){return es(r,[Yb,mh],[Qb,Xb])}const tS="Invalid Duration",gh={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},rS={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...gh},Ge=146097/400,Lr=146097/4800,sS={years:{quarters:4,months:12,weeks:Ge/7,days:Ge,hours:Ge*24,minutes:Ge*24*60,seconds:Ge*24*60*60,milliseconds:Ge*24*60*60*1e3},quarters:{months:3,weeks:Ge/28,days:Ge/4,hours:Ge*24/4,minutes:Ge*24*60/4,seconds:Ge*24*60*60/4,milliseconds:Ge*24*60*60*1e3/4},months:{weeks:Lr/7,days:Lr,hours:Lr*24,minutes:Lr*24*60,seconds:Lr*24*60*60,milliseconds:Lr*24*60*60*1e3},...gh},sr=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],nS=sr.slice(0).reverse();function Gt(r,e,t=!1){const s={values:t?e.values:{...r.values,...e.values||{}},loc:r.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||r.conversionAccuracy,matrix:e.matrix||r.matrix};return new K(s)}function iS(r){return r<0?Math.floor(r):Math.ceil(r)}function _h(r,e,t,s,n){const i=r[n][t],a=e[t]/i,c=Math.sign(a)===Math.sign(s[n]),u=!c&&s[n]!==0&&Math.abs(a)<=1?iS(a):Math.trunc(a);s[n]+=u,e[t]-=u*i}function aS(r,e){nS.reduce((t,s)=>W(e[s])?t:(t&&_h(r,e,t,e,s),s),null)}function oS(r){const e={};for(const[t,s]of Object.entries(r))s!==0&&(e[t]=s);return e}class K{constructor(e){const t=e.conversionAccuracy==="longterm"||!1;let s=t?sS:rS;e.matrix&&(s=e.matrix),this.values=e.values,this.loc=e.loc||ce.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=s,this.isLuxonDuration=!0}static fromMillis(e,t){return K.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new Ze(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new K({values:Fn(e,K.normalizeUnit),loc:ce.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(or(e))return K.fromMillis(e);if(K.isDuration(e))return e;if(typeof e=="object")return K.fromObject(e);throw new Ze(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[s]=Zb(e);return s?K.fromObject(s,t):K.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[s]=Kb(e);return s?K.fromObject(s,t):K.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new Ze("need to specify a reason the Duration is invalid");const s=e instanceof st?e:new st(e,t);if(we.throwOnInvalid)throw new Av(s);return new K({invalid:s})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new Lu(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const s={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?Ce.create(this.loc,s).formatDurationFromString(this,e):tS}toHuman(e={}){const t=sr.map(s=>{const n=this.values[s];return W(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:s.slice(0,-1)}).format(n)}).filter(s=>s);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=Oo(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e};const s=this.shiftTo("hours","minutes","seconds","milliseconds");let n=e.format==="basic"?"hhmm":"hh:mm";(!e.suppressSeconds||s.seconds!==0||s.milliseconds!==0)&&(n+=e.format==="basic"?"ss":":ss",(!e.suppressMilliseconds||s.milliseconds!==0)&&(n+=".SSS"));let i=s.toFormat(n);return e.includePrefix&&(i="T"+i),i}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=K.fromDurationLike(e),s={};for(const n of sr)(Vr(t.values,n)||Vr(this.values,n))&&(s[n]=t.get(n)+this.get(n));return Gt(this,{values:s},!0)}minus(e){if(!this.isValid)return this;const t=K.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const s of Object.keys(this.values))t[s]=rh(e(this.values[s],s));return Gt(this,{values:t},!0)}get(e){return this[K.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const t={...this.values,...Fn(e,K.normalizeUnit)};return Gt(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:s,matrix:n}={}){const a={loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:n,conversionAccuracy:s};return Gt(this,a)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return aS(this.matrix,e),Gt(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=oS(this.normalize().shiftToAll().toObject());return Gt(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(a=>K.normalizeUnit(a));const t={},s={},n=this.toObject();let i;for(const a of sr)if(e.indexOf(a)>=0){i=a;let c=0;for(const o in s)c+=this.matrix[o][a]*s[o],s[o]=0;or(n[a])&&(c+=n[a]);const u=Math.trunc(c);t[a]=u,s[a]=(c*1e3-u*1e3)/1e3;for(const o in n)sr.indexOf(o)>sr.indexOf(a)&&_h(this.matrix,n,o,t,a)}else or(n[a])&&(s[a]=n[a]);for(const a in s)s[a]!==0&&(t[i]+=a===i?s[a]:s[a]/this.matrix[i][a]);return Gt(this,{values:t},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return Gt(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(s,n){return s===void 0||s===0?n===void 0||n===0:s===n}for(const s of sr)if(!t(this.values[s],e.values[s]))return!1;return!0}}const Ar="Invalid Interval";function cS(r,e){return!r||!r.isValid?pe.invalid("missing or invalid start"):!e||!e.isValid?pe.invalid("missing or invalid end"):e<r?pe.invalid("end before start",`The end of an interval must be after its start, but you had start=${r.toISO()} and end=${e.toISO()}`):null}class pe{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new Ze("need to specify a reason the Interval is invalid");const s=e instanceof st?e:new st(e,t);if(we.throwOnInvalid)throw new Lv(s);return new pe({invalid:s})}static fromDateTimes(e,t){const s=ms(e),n=ms(t),i=cS(s,n);return i??new pe({start:s,end:n})}static after(e,t){const s=K.fromDurationLike(t),n=ms(e);return pe.fromDateTimes(n,n.plus(s))}static before(e,t){const s=K.fromDurationLike(t),n=ms(e);return pe.fromDateTimes(n.minus(s),n)}static fromISO(e,t){const[s,n]=(e||"").split("/",2);if(s&&n){let i,a;try{i=U.fromISO(s,t),a=i.isValid}catch{a=!1}let c,u;try{c=U.fromISO(n,t),u=c.isValid}catch{u=!1}if(a&&u)return pe.fromDateTimes(i,c);if(a){const o=K.fromISO(n,t);if(o.isValid)return pe.after(i,o)}else if(u){const o=K.fromISO(s,t);if(o.isValid)return pe.before(c,o)}}return pe.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const t=this.start.startOf(e),s=this.end.startOf(e);return Math.floor(s.diff(t,e).get(e))+(s.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?pe.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(ms).filter(a=>this.contains(a)).sort(),s=[];let{s:n}=this,i=0;for(;n<this.e;){const a=t[i]||this.e,c=+a>+this.e?this.e:a;s.push(pe.fromDateTimes(n,c)),n=c,i+=1}return s}splitBy(e){const t=K.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s}=this,n=1,i;const a=[];for(;s<this.e;){const c=this.start.plus(t.mapUnits(u=>u*n));i=+c>+this.e?this.e:c,a.push(pe.fromDateTimes(s,i)),s=i,n+=1}return a}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,s=this.e<e.e?this.e:e.e;return t>=s?null:pe.fromDateTimes(t,s)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,s=this.e>e.e?this.e:e.e;return pe.fromDateTimes(t,s)}static merge(e){const[t,s]=e.sort((n,i)=>n.s-i.s).reduce(([n,i],a)=>i?i.overlaps(a)||i.abutsStart(a)?[n,i.union(a)]:[n.concat([i]),a]:[n,a],[[],null]);return s&&t.push(s),t}static xor(e){let t=null,s=0;const n=[],i=e.map(u=>[{time:u.s,type:"s"},{time:u.e,type:"e"}]),a=Array.prototype.concat(...i),c=a.sort((u,o)=>u.time-o.time);for(const u of c)s+=u.type==="s"?1:-1,s===1?t=u.time:(t&&+t!=+u.time&&n.push(pe.fromDateTimes(t,u.time)),t=null);return pe.merge(n)}difference(...e){return pe.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:Ar}toLocaleString(e=Ln,t={}){return this.isValid?Ce.create(this.s.loc.clone(t),e).formatInterval(this):Ar}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Ar}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Ar}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Ar}toFormat(e,{separator:t=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:Ar}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):K.invalid(this.invalidReason)}mapEndpoints(e){return pe.fromDateTimes(e(this.s),e(this.e))}}class wn{static hasDST(e=we.defaultZone){const t=U.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return It.isValidZone(e)}static normalizeZone(e){return Zt(e,we.defaultZone)}static months(e="long",{locale:t=null,numberingSystem:s=null,locObj:n=null,outputCalendar:i="gregory"}={}){return(n||ce.create(t,s,i)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:s=null,locObj:n=null,outputCalendar:i="gregory"}={}){return(n||ce.create(t,s,i)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:s=null,locObj:n=null}={}){return(n||ce.create(t,s,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:s=null,locObj:n=null}={}){return(n||ce.create(t,s,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return ce.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return ce.create(t,null,"gregory").eras(e)}static features(){return{relative:eh()}}}function qd(r,e){const t=n=>n.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),s=t(e)-t(r);return Math.floor(K.fromMillis(s).as("days"))}function dS(r,e,t){const s=[["years",(u,o)=>o.year-u.year],["quarters",(u,o)=>o.quarter-u.quarter+(o.year-u.year)*4],["months",(u,o)=>o.month-u.month+(o.year-u.year)*12],["weeks",(u,o)=>{const l=qd(u,o);return(l-l%7)/7}],["days",qd]],n={},i=r;let a,c;for(const[u,o]of s)t.indexOf(u)>=0&&(a=u,n[u]=o(r,e),c=i.plus(n),c>e?(n[u]--,r=i.plus(n)):r=c);return[r,n,c,a]}function lS(r,e,t,s){let[n,i,a,c]=dS(r,e,t);const u=e-n,o=t.filter(d=>["hours","minutes","seconds","milliseconds"].indexOf(d)>=0);o.length===0&&(a<e&&(a=n.plus({[c]:1})),a!==n&&(i[c]=(i[c]||0)+u/(a-n)));const l=K.fromObject(i,s);return o.length>0?K.fromMillis(u,s).shiftTo(...o).plus(l):l}const Lo={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},zd={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},uS=Lo.hanidec.replace(/[\[|\]]/g,"").split("");function hS(r){let e=parseInt(r,10);if(isNaN(e)){e="";for(let t=0;t<r.length;t++){const s=r.charCodeAt(t);if(r[t].search(Lo.hanidec)!==-1)e+=uS.indexOf(r[t]);else for(const n in zd){const[i,a]=zd[n];s>=i&&s<=a&&(e+=s-i)}}return parseInt(e,10)}else return e}function et({numberingSystem:r},e=""){return new RegExp(`${Lo[r||"latn"]}${e}`)}const pS="missing Intl.DateTimeFormat.formatToParts support";function ne(r,e=t=>t){return{regex:r,deser:([t])=>e(hS(t))}}const fS=String.fromCharCode(160),wh=`[ ${fS}]`,yh=new RegExp(wh,"g");function mS(r){return r.replace(/\./g,"\\.?").replace(yh,wh)}function Vd(r){return r.replace(/\./g,"").replace(yh," ").toLowerCase()}function tt(r,e){return r===null?null:{regex:RegExp(r.map(mS).join("|")),deser:([t])=>r.findIndex(s=>Vd(t)===Vd(s))+e}}function Hd(r,e){return{regex:r,deser:([,t,s])=>fi(t,s),groups:e}}function yn(r){return{regex:r,deser:([e])=>e}}function gS(r){return r.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function _S(r,e){const t=et(e),s=et(e,"{2}"),n=et(e,"{3}"),i=et(e,"{4}"),a=et(e,"{6}"),c=et(e,"{1,2}"),u=et(e,"{1,3}"),o=et(e,"{1,6}"),l=et(e,"{1,9}"),d=et(e,"{2,4}"),h=et(e,"{4,6}"),p=g=>({regex:RegExp(gS(g.val)),deser:([b])=>b,literal:!0}),w=(g=>{if(r.literal)return p(g);switch(g.val){case"G":return tt(e.eras("short",!1),0);case"GG":return tt(e.eras("long",!1),0);case"y":return ne(o);case"yy":return ne(d,za);case"yyyy":return ne(i);case"yyyyy":return ne(h);case"yyyyyy":return ne(a);case"M":return ne(c);case"MM":return ne(s);case"MMM":return tt(e.months("short",!0,!1),1);case"MMMM":return tt(e.months("long",!0,!1),1);case"L":return ne(c);case"LL":return ne(s);case"LLL":return tt(e.months("short",!1,!1),1);case"LLLL":return tt(e.months("long",!1,!1),1);case"d":return ne(c);case"dd":return ne(s);case"o":return ne(u);case"ooo":return ne(n);case"HH":return ne(s);case"H":return ne(c);case"hh":return ne(s);case"h":return ne(c);case"mm":return ne(s);case"m":return ne(c);case"q":return ne(c);case"qq":return ne(s);case"s":return ne(c);case"ss":return ne(s);case"S":return ne(u);case"SSS":return ne(n);case"u":return yn(l);case"uu":return yn(c);case"uuu":return ne(t);case"a":return tt(e.meridiems(),0);case"kkkk":return ne(i);case"kk":return ne(d,za);case"W":return ne(c);case"WW":return ne(s);case"E":case"c":return ne(t);case"EEE":return tt(e.weekdays("short",!1,!1),1);case"EEEE":return tt(e.weekdays("long",!1,!1),1);case"ccc":return tt(e.weekdays("short",!0,!1),1);case"cccc":return tt(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Hd(new RegExp(`([+-]${c.source})(?::(${s.source}))?`),2);case"ZZZ":return Hd(new RegExp(`([+-]${c.source})(${s.source})?`),2);case"z":return yn(/[a-z_+-/]{1,256}?/i);case" ":return yn(/[^\S\n\r]/);default:return p(g)}})(r)||{invalidReason:pS};return w.token=r,w}const wS={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function yS(r,e){const{type:t,value:s}=r;if(t==="literal"){const a=/^\s+$/.test(s);return{literal:!a,val:a?" ":s}}const n=e[t];let i=wS[t];if(typeof i=="object"&&(i=i[n]),i)return{literal:!1,val:i}}function vS(r){return[`^${r.map(t=>t.regex).reduce((t,s)=>`${t}(${s.source})`,"")}$`,r]}function bS(r,e,t){const s=r.match(e);if(s){const n={};let i=1;for(const a in t)if(Vr(t,a)){const c=t[a],u=c.groups?c.groups+1:1;!c.literal&&c.token&&(n[c.token.val[0]]=c.deser(s.slice(i,i+u))),i+=u}return[s,n]}else return[s,{}]}function SS(r){const e=i=>{switch(i){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let t=null,s;return W(r.z)||(t=It.create(r.z)),W(r.Z)||(t||(t=new Oe(r.Z)),s=r.Z),W(r.q)||(r.M=(r.q-1)*3+1),W(r.h)||(r.h<12&&r.a===1?r.h+=12:r.h===12&&r.a===0&&(r.h=0)),r.G===0&&r.y&&(r.y=-r.y),W(r.u)||(r.S=Mo(r.u)),[Object.keys(r).reduce((i,a)=>{const c=e(a);return c&&(i[c]=r[a]),i},{}),t,s]}let wa=null;function RS(){return wa||(wa=U.fromMillis(1555555555555)),wa}function TS(r,e){if(r.literal)return r;const t=Ce.macroTokenToFormatOpts(r.val),s=Sh(t,e);return s==null||s.includes(void 0)?r:s}function vh(r,e){return Array.prototype.concat(...r.map(t=>TS(t,e)))}function bh(r,e,t){const s=vh(Ce.parseFormat(t),r),n=s.map(a=>_S(a,r)),i=n.find(a=>a.invalidReason);if(i)return{input:e,tokens:s,invalidReason:i.invalidReason};{const[a,c]=vS(n),u=RegExp(a,"i"),[o,l]=bS(e,u,c),[d,h,p]=l?SS(l):[null,null,void 0];if(Vr(l,"a")&&Vr(l,"H"))throw new gs("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:s,regex:u,rawMatches:o,matches:l,result:d,zone:h,specificOffset:p}}}function DS(r,e,t){const{result:s,zone:n,specificOffset:i,invalidReason:a}=bh(r,e,t);return[s,n,i,a]}function Sh(r,e){return r?Ce.create(e,r).formatDateTimeParts(RS()).map(n=>yS(n,r)):null}const Rh=[0,31,59,90,120,151,181,212,243,273,304,334],Th=[0,31,60,91,121,152,182,213,244,274,305,335];function Ke(r,e){return new st("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${r}, which is invalid`)}function Dh(r,e,t){const s=new Date(Date.UTC(r,e-1,t));r<100&&r>=0&&s.setUTCFullYear(s.getUTCFullYear()-1900);const n=s.getUTCDay();return n===0?7:n}function Ch(r,e,t){return t+(qs(r)?Th:Rh)[e-1]}function Eh(r,e){const t=qs(r)?Th:Rh,s=t.findIndex(i=>i<e),n=e-t[s];return{month:s+1,day:n}}function Va(r){const{year:e,month:t,day:s}=r,n=Ch(e,t,s),i=Dh(e,t,s);let a=Math.floor((n-i+10)/7),c;return a<1?(c=e-1,a=Nn(c)):a>Nn(e)?(c=e+1,a=1):c=e,{weekYear:c,weekNumber:a,weekday:i,...mi(r)}}function Gd(r){const{weekYear:e,weekNumber:t,weekday:s}=r,n=Dh(e,1,4),i=ys(e);let a=t*7+s-n-3,c;a<1?(c=e-1,a+=ys(c)):a>i?(c=e+1,a-=ys(e)):c=e;const{month:u,day:o}=Eh(c,a);return{year:c,month:u,day:o,...mi(r)}}function ya(r){const{year:e,month:t,day:s}=r,n=Ch(e,t,s);return{year:e,ordinal:n,...mi(r)}}function Wd(r){const{year:e,ordinal:t}=r,{month:s,day:n}=Eh(e,t);return{year:e,month:s,day:n,...mi(r)}}function CS(r){const e=pi(r.weekYear),t=Ot(r.weekNumber,1,Nn(r.weekYear)),s=Ot(r.weekday,1,7);return e?t?s?!1:Ke("weekday",r.weekday):Ke("week",r.week):Ke("weekYear",r.weekYear)}function ES(r){const e=pi(r.year),t=Ot(r.ordinal,1,ys(r.year));return e?t?!1:Ke("ordinal",r.ordinal):Ke("year",r.year)}function Mh(r){const e=pi(r.year),t=Ot(r.month,1,12),s=Ot(r.day,1,An(r.year,r.month));return e?t?s?!1:Ke("day",r.day):Ke("month",r.month):Ke("year",r.year)}function Oh(r){const{hour:e,minute:t,second:s,millisecond:n}=r,i=Ot(e,0,23)||e===24&&t===0&&s===0&&n===0,a=Ot(t,0,59),c=Ot(s,0,59),u=Ot(n,0,999);return i?a?c?u?!1:Ke("millisecond",n):Ke("second",s):Ke("minute",t):Ke("hour",e)}const va="Invalid DateTime",Zd=864e13;function vn(r){return new st("unsupported zone",`the zone "${r.name}" is not supported`)}function ba(r){return r.weekData===null&&(r.weekData=Va(r.c)),r.weekData}function ps(r,e){const t={ts:r.ts,zone:r.zone,c:r.c,o:r.o,loc:r.loc,invalid:r.invalid};return new U({...t,...e,old:t})}function Ph(r,e,t){let s=r-e*60*1e3;const n=t.offset(s);if(e===n)return[s,e];s-=(n-e)*60*1e3;const i=t.offset(s);return n===i?[s,n]:[r-Math.min(n,i)*60*1e3,Math.max(n,i)]}function Jd(r,e){r+=e*60*1e3;const t=new Date(r);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function Pn(r,e,t){return Ph(Po(r),e,t)}function Kd(r,e){const t=r.o,s=r.c.year+Math.trunc(e.years),n=r.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,i={...r.c,year:s,month:n,day:Math.min(r.c.day,An(s,n))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},a=K.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),c=Po(i);let[u,o]=Ph(c,t,r.zone);return a!==0&&(u+=a,o=r.zone.offset(u)),{ts:u,o}}function fs(r,e,t,s,n,i){const{setZone:a,zone:c}=t;if(r&&Object.keys(r).length!==0||e){const u=e||c,o=U.fromObject(r,{...t,zone:u,specificOffset:i});return a?o:o.setZone(c)}else return U.invalid(new st("unparsable",`the input "${n}" can't be parsed as ${s}`))}function bn(r,e,t=!0){return r.isValid?Ce.create(ce.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(r,e):null}function Sa(r,e){const t=r.c.year>9999||r.c.year<0;let s="";return t&&r.c.year>=0&&(s+="+"),s+=ye(r.c.year,t?6:4),e?(s+="-",s+=ye(r.c.month),s+="-",s+=ye(r.c.day)):(s+=ye(r.c.month),s+=ye(r.c.day)),s}function Yd(r,e,t,s,n,i){let a=ye(r.c.hour);return e?(a+=":",a+=ye(r.c.minute),(r.c.second!==0||!t)&&(a+=":")):a+=ye(r.c.minute),(r.c.second!==0||!t)&&(a+=ye(r.c.second),(r.c.millisecond!==0||!s)&&(a+=".",a+=ye(r.c.millisecond,3))),n&&(r.isOffsetFixed&&r.offset===0&&!i?a+="Z":r.o<0?(a+="-",a+=ye(Math.trunc(-r.o/60)),a+=":",a+=ye(Math.trunc(-r.o%60))):(a+="+",a+=ye(Math.trunc(r.o/60)),a+=":",a+=ye(Math.trunc(r.o%60)))),i&&(a+="["+r.zone.ianaName+"]"),a}const xh={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},MS={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},OS={ordinal:1,hour:0,minute:0,second:0,millisecond:0},kh=["year","month","day","hour","minute","second","millisecond"],PS=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],xS=["year","ordinal","hour","minute","second","millisecond"];function Qd(r){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[r.toLowerCase()];if(!e)throw new Lu(r);return e}function Xd(r,e){const t=Zt(e.zone,we.defaultZone),s=ce.fromObject(e),n=we.now();let i,a;if(W(r.year))i=n;else{for(const o of kh)W(r[o])&&(r[o]=xh[o]);const c=Mh(r)||Oh(r);if(c)return U.invalid(c);const u=t.offset(n);[i,a]=Pn(r,u,t)}return new U({ts:i,zone:t,loc:s,o:a})}function el(r,e,t){const s=W(t.round)?!0:t.round,n=(a,c)=>(a=Oo(a,s||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(a,c)),i=a=>t.calendary?e.hasSame(r,a)?0:e.startOf(a).diff(r.startOf(a),a).get(a):e.diff(r,a).get(a);if(t.unit)return n(i(t.unit),t.unit);for(const a of t.units){const c=i(a);if(Math.abs(c)>=1)return n(c,a)}return n(r>e?-0:0,t.units[t.units.length-1])}function tl(r){let e={},t;return r.length>0&&typeof r[r.length-1]=="object"?(e=r[r.length-1],t=Array.from(r).slice(0,r.length-1)):t=Array.from(r),[e,t]}class U{constructor(e){const t=e.zone||we.defaultZone;let s=e.invalid||(Number.isNaN(e.ts)?new st("invalid input"):null)||(t.isValid?null:vn(t));this.ts=W(e.ts)?we.now():e.ts;let n=null,i=null;if(!s)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[n,i]=[e.old.c,e.old.o];else{const c=t.offset(this.ts);n=Jd(this.ts,c),s=Number.isNaN(n.year)?new st("invalid input"):null,n=s?null:n,i=s?null:c}this._zone=t,this.loc=e.loc||ce.create(),this.invalid=s,this.weekData=null,this.c=n,this.o=i,this.isLuxonDateTime=!0}static now(){return new U({})}static local(){const[e,t]=tl(arguments),[s,n,i,a,c,u,o]=t;return Xd({year:s,month:n,day:i,hour:a,minute:c,second:u,millisecond:o},e)}static utc(){const[e,t]=tl(arguments),[s,n,i,a,c,u,o]=t;return e.zone=Oe.utcInstance,Xd({year:s,month:n,day:i,hour:a,minute:c,second:u,millisecond:o},e)}static fromJSDate(e,t={}){const s=rb(e)?e.valueOf():NaN;if(Number.isNaN(s))return U.invalid("invalid input");const n=Zt(t.zone,we.defaultZone);return n.isValid?new U({ts:s,zone:n,loc:ce.fromObject(t)}):U.invalid(vn(n))}static fromMillis(e,t={}){if(or(e))return e<-Zd||e>Zd?U.invalid("Timestamp out of range"):new U({ts:e,zone:Zt(t.zone,we.defaultZone),loc:ce.fromObject(t)});throw new Ze(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(or(e))return new U({ts:e*1e3,zone:Zt(t.zone,we.defaultZone),loc:ce.fromObject(t)});throw new Ze("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const s=Zt(t.zone,we.defaultZone);if(!s.isValid)return U.invalid(vn(s));const n=we.now(),i=W(t.specificOffset)?s.offset(n):t.specificOffset,a=Fn(e,Qd),c=!W(a.ordinal),u=!W(a.year),o=!W(a.month)||!W(a.day),l=u||o,d=a.weekYear||a.weekNumber,h=ce.fromObject(t);if((l||c)&&d)throw new gs("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&c)throw new gs("Can't mix ordinal dates with month/day");const p=d||a.weekday&&!l;let f,w,g=Jd(n,i);p?(f=PS,w=MS,g=Va(g)):c?(f=xS,w=OS,g=ya(g)):(f=kh,w=xh);let b=!1;for(const ae of f){const Me=a[ae];W(Me)?b?a[ae]=w[ae]:a[ae]=g[ae]:b=!0}const E=p?CS(a):c?ES(a):Mh(a),M=E||Oh(a);if(M)return U.invalid(M);const P=p?Gd(a):c?Wd(a):a,[y,D]=Pn(P,i,s),Z=new U({ts:y,zone:s,o:D,loc:h});return a.weekday&&l&&e.weekday!==Z.weekday?U.invalid("mismatched weekday",`you can't specify both a weekday of ${a.weekday} and a date of ${Z.toISO()}`):Z}static fromISO(e,t={}){const[s,n]=Hb(e);return fs(s,n,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[s,n]=Gb(e);return fs(s,n,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[s,n]=Wb(e);return fs(s,n,t,"HTTP",t)}static fromFormat(e,t,s={}){if(W(e)||W(t))throw new Ze("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:i=null}=s,a=ce.fromOpts({locale:n,numberingSystem:i,defaultToEN:!0}),[c,u,o,l]=DS(a,e,t);return l?U.invalid(l):fs(c,u,s,`format ${t}`,e,o)}static fromString(e,t,s={}){return U.fromFormat(e,t,s)}static fromSQL(e,t={}){const[s,n]=eS(e);return fs(s,n,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new Ze("need to specify a reason the DateTime is invalid");const s=e instanceof st?e:new st(e,t);if(we.throwOnInvalid)throw new Iv(s);return new U({invalid:s})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const s=Sh(e,ce.fromObject(t));return s?s.map(n=>n?n.val:null).join(""):null}static expandFormat(e,t={}){return vh(Ce.parseFormat(e),ce.fromObject(t)).map(n=>n.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?ba(this).weekYear:NaN}get weekNumber(){return this.isValid?ba(this).weekNumber:NaN}get weekday(){return this.isValid?ba(this).weekday:NaN}get ordinal(){return this.isValid?ya(this.c).ordinal:NaN}get monthShort(){return this.isValid?wn.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?wn.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?wn.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?wn.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}get isInLeapYear(){return qs(this.year)}get daysInMonth(){return An(this.year,this.month)}get daysInYear(){return this.isValid?ys(this.year):NaN}get weeksInWeekYear(){return this.isValid?Nn(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:s,calendar:n}=Ce.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:s,outputCalendar:n}}toUTC(e=0,t={}){return this.setZone(Oe.instance(e),t)}toLocal(){return this.setZone(we.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:s=!1}={}){if(e=Zt(e,we.defaultZone),e.equals(this.zone))return this;if(e.isValid){let n=this.ts;if(t||s){const i=e.offset(this.ts),a=this.toObject();[n]=Pn(a,i,e)}return ps(this,{ts:n,zone:e})}else return U.invalid(vn(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:s}={}){const n=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:s});return ps(this,{loc:n})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=Fn(e,Qd),s=!W(t.weekYear)||!W(t.weekNumber)||!W(t.weekday),n=!W(t.ordinal),i=!W(t.year),a=!W(t.month)||!W(t.day),c=i||a,u=t.weekYear||t.weekNumber;if((c||n)&&u)throw new gs("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(a&&n)throw new gs("Can't mix ordinal dates with month/day");let o;s?o=Gd({...Va(this.c),...t}):W(t.ordinal)?(o={...this.toObject(),...t},W(t.day)&&(o.day=Math.min(An(o.year,o.month),o.day))):o=Wd({...ya(this.c),...t});const[l,d]=Pn(o,this.o,this.zone);return ps(this,{ts:l,o:d})}plus(e){if(!this.isValid)return this;const t=K.fromDurationLike(e);return ps(this,Kd(this,t))}minus(e){if(!this.isValid)return this;const t=K.fromDurationLike(e).negate();return ps(this,Kd(this,t))}startOf(e){if(!this.isValid)return this;const t={},s=K.normalizeUnit(e);switch(s){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0;break}if(s==="weeks"&&(t.weekday=1),s==="quarters"){const n=Math.ceil(this.month/3);t.month=(n-1)*3+1}return this.set(t)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,t={}){return this.isValid?Ce.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):va}toLocaleString(e=Ln,t={}){return this.isValid?Ce.create(this.loc.clone(t),e).formatDateTime(this):va}toLocaleParts(e={}){return this.isValid?Ce.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:s=!1,includeOffset:n=!0,extendedZone:i=!1}={}){if(!this.isValid)return null;const a=e==="extended";let c=Sa(this,a);return c+="T",c+=Yd(this,a,t,s,n,i),c}toISODate({format:e="extended"}={}){return this.isValid?Sa(this,e==="extended"):null}toISOWeekDate(){return bn(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:s=!0,includePrefix:n=!1,extendedZone:i=!1,format:a="extended"}={}){return this.isValid?(n?"T":"")+Yd(this,a==="extended",t,e,s,i):null}toRFC2822(){return bn(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return bn(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?Sa(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:s=!0}={}){let n="HH:mm:ss.SSS";return(t||e)&&(s&&(n+=" "),t?n+="z":e&&(n+="ZZ")),bn(this,n,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():va}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",s={}){if(!this.isValid||!e.isValid)return K.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...s},i=sb(t).map(K.normalizeUnit),a=e.valueOf()>this.valueOf(),c=a?this:e,u=a?e:this,o=lS(c,u,i,n);return a?o.negate():o}diffNow(e="milliseconds",t={}){return this.diff(U.now(),e,t)}until(e){return this.isValid?pe.fromDateTimes(this,e):this}hasSame(e,t){if(!this.isValid)return!1;const s=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(t)<=s&&s<=n.endOf(t)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||U.fromObject({},{zone:this.zone}),s=e.padding?this<t?-e.padding:e.padding:0;let n=["years","months","days","hours","minutes","seconds"],i=e.unit;return Array.isArray(e.unit)&&(n=e.unit,i=void 0),el(t,this.plus(s),{...e,numeric:"always",units:n,unit:i})}toRelativeCalendar(e={}){return this.isValid?el(e.base||U.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(U.isDateTime))throw new Ze("min requires all arguments be DateTimes");return jd(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(U.isDateTime))throw new Ze("max requires all arguments be DateTimes");return jd(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,s={}){const{locale:n=null,numberingSystem:i=null}=s,a=ce.fromOpts({locale:n,numberingSystem:i,defaultToEN:!0});return bh(a,e,t)}static fromStringExplain(e,t,s={}){return U.fromFormatExplain(e,t,s)}static get DATE_SHORT(){return Ln}static get DATE_MED(){return Au}static get DATE_MED_WITH_WEEKDAY(){return Nv}static get DATE_FULL(){return Nu}static get DATE_HUGE(){return Fu}static get TIME_SIMPLE(){return $u}static get TIME_WITH_SECONDS(){return ju}static get TIME_WITH_SHORT_OFFSET(){return Uu}static get TIME_WITH_LONG_OFFSET(){return Bu}static get TIME_24_SIMPLE(){return qu}static get TIME_24_WITH_SECONDS(){return zu}static get TIME_24_WITH_SHORT_OFFSET(){return Vu}static get TIME_24_WITH_LONG_OFFSET(){return Hu}static get DATETIME_SHORT(){return Gu}static get DATETIME_SHORT_WITH_SECONDS(){return Wu}static get DATETIME_MED(){return Zu}static get DATETIME_MED_WITH_SECONDS(){return Ju}static get DATETIME_MED_WITH_WEEKDAY(){return Fv}static get DATETIME_FULL(){return Ku}static get DATETIME_FULL_WITH_SECONDS(){return Yu}static get DATETIME_HUGE(){return Qu}static get DATETIME_HUGE_WITH_SECONDS(){return Xu}}function ms(r){if(U.isDateTime(r))return r;if(r&&r.valueOf&&or(r.valueOf()))return U.fromJSDate(r);if(r&&typeof r=="object")return U.fromObject(r);throw new Ze(`Unknown datetime argument: ${r}, of type ${typeof r}`)}class kS{constructor(){T(this,"_callbacks",[])}onUpdate(e){return this._callbacks.push(e),this}offUpdate(e){const t=this._callbacks.indexOf(e);return t>=0&&this._callbacks.splice(t,1),this}fireUpdate(e){this._callbacks.forEach(t=>t(e||[]))}}class Ao extends Map{constructor(){super();T(this,"_callbacks",[])}onUpdate(t){return this._callbacks.push(t),this}offUpdate(t){const s=this._callbacks.indexOf(t);return s>=0&&this._callbacks.splice(s,1),this}fireUpdate(t){this._callbacks.forEach(s=>s(t||[]))}}class ct extends kS{constructor(t,s){super();T(this,"client");T(this,"data");T(this,"deleted",!1);this.client=t,this.data=s}get source(){return this.data}get _id(){return this.id}get id(){return typeof this.source._id=="string"?this.source._id:this.source._id.user}get createdAt(){return Pv(this.id)}update(t={}){return Object.entries(t).forEach(s=>this.data[s[0]]=s[1]),this.fireUpdate(),this}toString(){return this.id}}class qe extends ct{constructor(e,t){super(e,t)}get name(){return this.source.filename}get contentType(){return this.source.content_type}get size(){return this.source.size}get metadata(){return this.source.metadata}get bucket(){return this.source.tag}generateURL(...e){const[t,s,n]=e,i=this.client.config.features.autumn;if(!(i!=null&&i.enabled)||this.metadata.type==="Image"&&(Math.min(this.metadata.width,this.metadata.height)<=0||this.contentType==="image/gif"&&Math.max(this.metadata.width,this.metadata.height)>=1024))return n;const a=t&&(!s||this.contentType!=="image/gif")?"?"+new URLSearchParams(Object.entries(t).map(c=>c.map(String))).toString():"";return`${i.url}/${this.bucket}/${this.id}${a}`}generateDownloadURL(){var e;return(e=this.generateURL())==null?void 0:e.replace("attachments","attachments/download")}}class No{constructor(e){T(this,"$");this.$=e}isText(){return this.$=="Text"}isMedia(){return this.$=="Media"}isWeb(){return this.$=="Web"}}class xn extends No{constructor(t,s){super("Text");T(this,"client");T(this,"color");T(this,"description");T(this,"iconURL");T(this,"media");T(this,"title");T(this,"url");this.client=t,this.color=s==null?void 0:s.colour,this.description=s==null?void 0:s.description,this.iconURL=s==null?void 0:s.icon_url,this.media=s!=null&&s.media&&this.client?new qe(this.client,s.media):null,this.title=s==null?void 0:s.title,this.url=s==null?void 0:s.url}get proxyIconURL(){return this.client?this.client.proxyFile(this.iconURL):this.iconURL}setColor(t){return this.color=t,this}setDescription(t){return this.description=t,this}setIconURL(t){return this.iconURL=t,this}setMedia(t){return this.media=t,this}setTitle(t){return this.title=t,this}setUrl(t){return this.url=t,this}toJSON(){const t={colour:this.color,description:this.description,icon_url:this.iconURL,media:this.media?this.media.source:void 0,title:this.title,url:this.url};return Object.keys(t).forEach(s=>t[s]??delete t[s]),t}}function rl(r){return r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}function Fo(r,e){let t={nonce:Rs()};return r instanceof xn?t.embeds=[r.toJSON()]:(typeof r!="string"&&(r.embed&&(r.embeds=[r.embed,...r.embeds||[]]),r.embeds&&(r.embeds=r.embeds.map(s=>s instanceof xn?s.toJSON():s)),t={...t,...r}),t.content=typeof r=="string"?r:r.content,e&&(t.content&&typeof r!="string"&&r.expandMentions&&e.isServerBased()&&e.server.members.filter(s=>s.user).forEach(s=>t.content=t.content.replace(new RegExp(rl(`@${s.user.username}`),"g"),`<@${s.id}>`)),t.content&&typeof r!="string"&&!(r instanceof xn)&&r.expandEmojis&&e.client.emojis.known.forEach(s=>t.content=t.content.replace(new RegExp(rl(`:${s.uniqueName}:`),"g"),`:${s.id}:`)))),t}function IS(r,e){const t=Fo(r,e),s={};return"content"in t&&(s.content=t.content),"embeds"in t&&(s.embeds=t.embeds),s}class Ih extends ct{constructor(e,t){super(e,t)}isSystem(){return!!this.source.system}isUser(){return!this.isSystem()}get channelID(){return this.source.channel}get channel(){return this.client.channels.get(this.channelID)}get server(){return this.channel.isServerBased()?this.channel.server:null}async ack(){var e;await((e=this.channel)==null?void 0:e.ack(this))}async reply(e,t=!1){const s=Fo(e,this.channel);return s.replies=[{id:this.id,mention:t}],await this.channel.send(s)}async delete(){await this.client.api.delete(`/channels/${this.channel.id}/messages/${this._id}`),this.channel.messages.delete(this.id)}}class LS extends No{constructor(t,s){super("Media");T(this,"client");T(this,"source");this.client=t,this.source=s}get type(){return this.source.type}get url(){return this.source.url}get proxyURL(){return this.client.proxyFile(this.url)}get width(){return this.source.width}get height(){return this.source.height}get size(){return"size"in this.source?this.source.size:"Large"}}class AS extends No{constructor(t,s){super("Web");T(this,"client");T(this,"source");T(this,"color");T(this,"description");T(this,"iconURL");T(this,"originalURL");T(this,"siteName");T(this,"special");T(this,"title");T(this,"url");T(this,"video");T(this,"_media");this.client=t,this.source=s,this.color=s.colour,this.description=s.description,this.iconURL=s.icon_url,this.originalURL=s.original_url,this.siteName=s.site_name,this.special=s.special,this.title=s.title,this.url=s.url,this._media=s.video||s.image}get proxyIconURL(){return this.client.proxyFile(this.iconURL)}get media(){if(this._media)return"size"in this._media?{type:"Image",height:this._media.height,proxyURL:this.client.proxyFile(this._media.url),size:this._media.size,url:this._media.url,width:this._media.width}:{type:"Video",height:this._media.height,proxyURL:this.client.proxyFile(this._media.url),url:this._media.url,width:this._media.width}}}class sl extends Ih{constructor(e,t){super(e,t)}get content(){return this.source.content??null}get attachments(){var e;return(e=this.source.attachments)!=null&&e.length?this.source.attachments.map(t=>new qe(this.client,t)):null}get edited(){return this.source.edited?new Date(this.source.edited):null}get nonce(){return this.source.nonce??null}get masquerade(){return this.source.masquerade??null}generateMasqAvatarURL(){var t;const e=(t=this.masquerade)==null?void 0:t.avatar;return e?this.client.proxyFile(e):null}get authorID(){return this.source.author}get author(){return this.client.users.get(this.authorID)}async fetchAuthor(e=!1){return await this.client.users.fetch(this.authorID,e)}get member(){return this.channel.isServerBased()?this.channel.server.members.get(this.authorID)??null:null}async fetchMember(){return this.channel.isServerBased()?this.channel.server.members.fetch(this.authorID):null}get mentionIDs(){return this.source.mentions||[]}get mentions(){return this.mentionIDs.map(e=>this.client.users.get(e)).filter(e=>e)}async fetchMentions(){return(await Promise.all(this.mentionIDs.map(e=>this.client.users.fetch(e)))).filter(e=>e)}get replyIDs(){return this.source.replies||[]}get replies(){return this.replyIDs.map(e=>this.channel.messages.get(e)).filter(e=>e)}async fetchReplies(){return(await Promise.all(this.replyIDs.map(e=>this.channel.messages.fetch(e)))).filter(e=>e)}get embeds(){var e;return((e=this.source.embeds)==null?void 0:e.map(t=>{switch(t.type){case"Text":return new xn(this.client,t);case"Website":return new AS(this.client,t);case"Image":case"Video":return new LS(this.client,t)}}).filter(t=>t))||[]}get reactions(){return Object.entries(this.source.reactions).map(e=>({emoji:e[0],userIDs:e[1],users:e[1].map(t=>this.client.users.get(t)).filter(t=>t)}))}get restrictReactions(){var e;return!!((e=this.source.interactions)!=null&&e.restrict_reactions)}async react(e){await this.client.api.put(`/channels/${this.channel.id}/messages/${this._id}/reactions/${typeof e=="string"?e:e.id}`)}async unreact(e){await this.client.api.delete(`/channels/${this.channel.id}/messages/${this._id}/reactions/${typeof e=="string"?e:e.id}`)}async clearReactions(){await this.client.api.delete(`/channels/${this.channel.id}/messages/${this._id}/reactions`)}appendEmbed({embeds:e}){e&&this.update({embeds:[...this.source.embeds??[],...e]})}async edit(e){return this.update(await this.client.api.patch(`/channels/${this.channel.id}/messages/${this._id}`,IS(e,this.channel)))}}class NS extends Ih{constructor(e,t){super(e,t)}get detail(){const e=this.source.system,t=s=>this.client.users.get(s);switch(e.type){case"text":return{type:Ue.Text,content:e.content};case"user_added":return{type:Ue.UserAdded,user:t(e.id),by:t(e.by)};case"user_remove":return{type:Ue.UserRemoved,user:t(e.id),by:t(e.by)};case"user_joined":return{type:Ue.UserJoined,user:t(e.id)};case"user_left":return{type:Ue.UserLeft,user:t(e.id)};case"user_kicked":return{type:Ue.UserKicked,user:t(e.id)};case"user_banned":return{type:Ue.UserBanned,user:t(e.id)};case"channel_renamed":return{type:Ue.GroupRenamed,name:e.name,by:t(e.by)};case"channel_description_changed":return{type:Ue.GroupDescriptionChange,by:t(e.by)};case"channel_icon_changed":return{type:Ue.GroupIconChange,by:t(e.by)};case"channel_ownership_changed":return{type:Ue.GroupOwnershipChange,from:t(e.from),to:t(e.to)}}}}class At extends Ao{constructor(){super()}set(e,t){return super.set(e,t),this.fireUpdate([t]),this}delete(e){const t=this.get(e);return t&&t.update({deleted:!0}),this.fireUpdate(t?[t]:[]),super.delete(e)}items(){return[...this.values()]}find(...e){return this.items().find(...e)}filter(...e){return this.items().filter(...e)}map(e){return this.items().map(e)}sort(...e){return this.items().sort(...e)}}class FS extends At{constructor(t,s){super();T(this,"client");T(this,"channel");this.client=t,this.channel=s}construct(t){const s=this.get(t._id);if(s)return s.update(t);{const n=new(t._id==ka||t.system?NS:sl)(this.client,t);return this.set(n.id,n),n.onUpdate(()=>this.fireUpdate([n])),n}}get ordered(){return this.items().sort((t,s)=>t.createdAt-s.createdAt)}async fetch(t){return this.construct(await this.client.api.get(`/channels/${this.channel.id}/messages/${t}`))}async fetchMultiple(t){const s=await this.client.api.get(`/channels/${this.channel.id}/messages`,{...t});if(t!=null&&t.include_users){const n=s;n.users.forEach(a=>this.client.users.construct(a));const i=this.channel;return i.isServerBased()&&n.members&&n.members.forEach(a=>i.server.members.construct(a)),n.messages.map(a=>this.construct(a))}else return s.map(n=>this.construct(n))}async search(t){const s=await this.client.api.post(`/channels/${this.channel.id}/search`,{...t});if(t!=null&&t.include_users){const n=s;n.users.forEach(a=>this.client.users.construct(a));const i=this.channel;return i.isServerBased()&&n.members&&n.members.forEach(a=>i.server.members.construct(a)),n.messages.map(a=>this.construct(a))}else return s.map(n=>this.construct(n))}async bulkDelete(t){t.length&&(t[0]instanceof sl&&(t=t.filter(s=>U.fromMillis(s.createdAt).diffNow("days").days<7)),await this.client.api.delete(`/channels/${this.channel.id}/messages/bulk`,{data:{ids:t}}),t.forEach(s=>this.delete(s)))}}class Lh extends Ao{constructor(t){super();T(this,"client");this.client=t}async sync(){const t=await this.client.api.get("/sync/unreads");for(const s of t){const{_id:n,...i}=s;this.set(n.channel,i)}this.fireUpdate()}async markRead(t,s,n=!0){const i=s??Rs();this.set(t.id,{last_id:i}),this.fireUpdate(),n&&await t.ack(i),this.fireUpdate()}markUnread(t,s){this.set(t.id,{...this.get(t.id),last_id:s}),this.fireUpdate()}markMention(t){const s=this.get(t.channelID);this.set(t.channelID,{last_id:"0",...s,mentions:[...(s==null?void 0:s.mentions)??[],t.id]}),this.fireUpdate()}}/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var Ye=null;try{Ye=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ee(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}ee.prototype.__isLong__;Object.defineProperty(ee.prototype,"__isLong__",{value:!0});function Ee(r){return(r&&r.__isLong__)===!0}function nl(r){var e=Math.clz32(r&-r);return r?31-e:e}ee.isLong=Ee;var il={},al={};function hr(r,e){var t,s,n;return e?(r>>>=0,(n=0<=r&&r<256)&&(s=al[r],s)?s:(t=te(r,0,!0),n&&(al[r]=t),t)):(r|=0,(n=-128<=r&&r<128)&&(s=il[r],s)?s:(t=te(r,r<0?-1:0,!1),n&&(il[r]=t),t))}ee.fromInt=hr;function Qe(r,e){if(isNaN(r))return e?Pt:nt;if(e){if(r<0)return Pt;if(r>=Ah)return $h}else{if(r<=-cl)return Ae;if(r+1>=cl)return Fh}return r<0?Qe(-r,e).neg():te(r%Hr|0,r/Hr|0,e)}ee.fromNumber=Qe;function te(r,e,t){return new ee(r,e,t)}ee.fromBits=te;var $n=Math.pow;function $o(r,e,t){if(r.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return e?Pt:nt;if(t=t||10,t<2||36<t)throw RangeError("radix");var s;if((s=r.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return $o(r.substring(1),e,t).neg();for(var n=Qe($n(t,8)),i=nt,a=0;a<r.length;a+=8){var c=Math.min(8,r.length-a),u=parseInt(r.substring(a,a+c),t);if(c<8){var o=Qe($n(t,c));i=i.mul(o).add(Qe(u))}else i=i.mul(n),i=i.add(Qe(u))}return i.unsigned=e,i}ee.fromString=$o;function dt(r,e){return typeof r=="number"?Qe(r,e):typeof r=="string"?$o(r,e):te(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}ee.fromValue=dt;var ol=65536,$S=1<<24,Hr=ol*ol,Ah=Hr*Hr,cl=Ah/2,dl=hr($S),nt=hr(0);ee.ZERO=nt;var Pt=hr(0,!0);ee.UZERO=Pt;var Fr=hr(1);ee.ONE=Fr;var Nh=hr(1,!0);ee.UONE=Nh;var Ha=hr(-1);ee.NEG_ONE=Ha;var Fh=te(-1,2147483647,!1);ee.MAX_VALUE=Fh;var $h=te(-1,-1,!0);ee.MAX_UNSIGNED_VALUE=$h;var Ae=te(0,-2147483648,!1);ee.MIN_VALUE=Ae;var C=ee.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low};C.toNumber=function(){return this.unsigned?(this.high>>>0)*Hr+(this.low>>>0):this.high*Hr+(this.low>>>0)};C.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ae)){var t=Qe(e),s=this.div(t),n=s.mul(t).sub(this);return s.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=Qe($n(e,6),this.unsigned),a=this,c="";;){var u=a.div(i),o=a.sub(u.mul(i)).toInt()>>>0,l=o.toString(e);if(a=u,a.isZero())return l+c;for(;l.length<6;)l="0"+l;c=""+l+c}};C.getHighBits=function(){return this.high};C.getHighBitsUnsigned=function(){return this.high>>>0};C.getLowBits=function(){return this.low};C.getLowBitsUnsigned=function(){return this.low>>>0};C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ae)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};C.isZero=function(){return this.high===0&&this.low===0};C.eqz=C.isZero;C.isNegative=function(){return!this.unsigned&&this.high<0};C.isPositive=function(){return this.unsigned||this.high>=0};C.isOdd=function(){return(this.low&1)===1};C.isEven=function(){return(this.low&1)===0};C.equals=function(e){return Ee(e)||(e=dt(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};C.eq=C.equals;C.notEquals=function(e){return!this.eq(e)};C.neq=C.notEquals;C.ne=C.notEquals;C.lessThan=function(e){return this.comp(e)<0};C.lt=C.lessThan;C.lessThanOrEqual=function(e){return this.comp(e)<=0};C.lte=C.lessThanOrEqual;C.le=C.lessThanOrEqual;C.greaterThan=function(e){return this.comp(e)>0};C.gt=C.greaterThan;C.greaterThanOrEqual=function(e){return this.comp(e)>=0};C.gte=C.greaterThanOrEqual;C.ge=C.greaterThanOrEqual;C.compare=function(e){if(Ee(e)||(e=dt(e)),this.eq(e))return 0;var t=this.isNegative(),s=e.isNegative();return t&&!s?-1:!t&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};C.comp=C.compare;C.negate=function(){return!this.unsigned&&this.eq(Ae)?Ae:this.not().add(Fr)};C.neg=C.negate;C.add=function(e){Ee(e)||(e=dt(e));var t=this.high>>>16,s=this.high&65535,n=this.low>>>16,i=this.low&65535,a=e.high>>>16,c=e.high&65535,u=e.low>>>16,o=e.low&65535,l=0,d=0,h=0,p=0;return p+=i+o,h+=p>>>16,p&=65535,h+=n+u,d+=h>>>16,h&=65535,d+=s+c,l+=d>>>16,d&=65535,l+=t+a,l&=65535,te(h<<16|p,l<<16|d,this.unsigned)};C.subtract=function(e){return Ee(e)||(e=dt(e)),this.add(e.neg())};C.sub=C.subtract;C.multiply=function(e){if(this.isZero())return this;if(Ee(e)||(e=dt(e)),Ye){var t=Ye.mul(this.low,this.high,e.low,e.high);return te(t,Ye.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Pt:nt;if(this.eq(Ae))return e.isOdd()?Ae:nt;if(e.eq(Ae))return this.isOdd()?Ae:nt;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(dl)&&e.lt(dl))return Qe(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,n=this.high&65535,i=this.low>>>16,a=this.low&65535,c=e.high>>>16,u=e.high&65535,o=e.low>>>16,l=e.low&65535,d=0,h=0,p=0,f=0;return f+=a*l,p+=f>>>16,f&=65535,p+=i*l,h+=p>>>16,p&=65535,p+=a*o,h+=p>>>16,p&=65535,h+=n*l,d+=h>>>16,h&=65535,h+=i*o,d+=h>>>16,h&=65535,h+=a*u,d+=h>>>16,h&=65535,d+=s*l+n*o+i*u+a*c,d&=65535,te(p<<16|f,d<<16|h,this.unsigned)};C.mul=C.multiply;C.divide=function(e){if(Ee(e)||(e=dt(e)),e.isZero())throw Error("division by zero");if(Ye){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Ye.div_u:Ye.div_s)(this.low,this.high,e.low,e.high);return te(t,Ye.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Pt:nt;var s,n,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Pt;if(e.gt(this.shru(1)))return Nh;i=Pt}else{if(this.eq(Ae)){if(e.eq(Fr)||e.eq(Ha))return Ae;if(e.eq(Ae))return Fr;var a=this.shr(1);return s=a.div(e).shl(1),s.eq(nt)?e.isNegative()?Fr:Ha:(n=this.sub(e.mul(s)),i=s.add(n.div(e)),i)}else if(e.eq(Ae))return this.unsigned?Pt:nt;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=nt}for(n=this;n.gte(e);){s=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var c=Math.ceil(Math.log(s)/Math.LN2),u=c<=48?1:$n(2,c-48),o=Qe(s),l=o.mul(e);l.isNegative()||l.gt(n);)s-=u,o=Qe(s,this.unsigned),l=o.mul(e);o.isZero()&&(o=Fr),i=i.add(o),n=n.sub(l)}return i};C.div=C.divide;C.modulo=function(e){if(Ee(e)||(e=dt(e)),Ye){var t=(this.unsigned?Ye.rem_u:Ye.rem_s)(this.low,this.high,e.low,e.high);return te(t,Ye.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};C.mod=C.modulo;C.rem=C.modulo;C.not=function(){return te(~this.low,~this.high,this.unsigned)};C.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};C.clz=C.countLeadingZeros;C.countTrailingZeros=function(){return this.low?nl(this.low):nl(this.high)+32};C.ctz=C.countTrailingZeros;C.and=function(e){return Ee(e)||(e=dt(e)),te(this.low&e.low,this.high&e.high,this.unsigned)};C.or=function(e){return Ee(e)||(e=dt(e)),te(this.low|e.low,this.high|e.high,this.unsigned)};C.xor=function(e){return Ee(e)||(e=dt(e)),te(this.low^e.low,this.high^e.high,this.unsigned)};C.shiftLeft=function(e){return Ee(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?te(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):te(0,this.low<<e-32,this.unsigned)};C.shl=C.shiftLeft;C.shiftRight=function(e){return Ee(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?te(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):te(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};C.shr=C.shiftRight;C.shiftRightUnsigned=function(e){return Ee(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?te(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?te(this.high,0,this.unsigned):te(this.high>>>e-32,0,this.unsigned)};C.shru=C.shiftRightUnsigned;C.shr_u=C.shiftRightUnsigned;C.rotateLeft=function(e){var t;return Ee(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?te(this.high,this.low,this.unsigned):e<32?(t=32-e,te(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,te(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))};C.rotl=C.rotateLeft;C.rotateRight=function(e){var t;return Ee(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?te(this.high,this.low,this.unsigned):e<32?(t=32-e,te(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,te(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))};C.rotr=C.rotateRight;C.toSigned=function(){return this.unsigned?te(this.low,this.high,!1):this};C.toUnsigned=function(){return this.unsigned?this:te(this.low,this.high,!0)};C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};C.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};ee.fromBytes=function(e,t,s){return s?ee.fromBytesLE(e,t):ee.fromBytesBE(e,t)};ee.fromBytesLE=function(e,t){return new ee(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};ee.fromBytesBE=function(e,t){return new ee(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};function jh(r){return r.reduce((e,t)=>e.or(t),ee.fromNumber(0))}function jS(r,...e){const t=jh(e);return t.and(r).eq(t)}class Hs{constructor(e,t){T(this,"map");T(this,"bits");this.map=e,this.bits=t}has(e){return jS(this.bits,e)}add(e){return this.bits=ee.fromNumber(e).or(this.bits).toNumber(),this}remove(e){return this.bits=jh(this.all().filter(t=>t!=e)).toNumber(),this}mapAll(){return Object.values(this.map).filter(e=>typeof e=="number").map(Number)}all(){return this.mapAll().filter(e=>this.has(e))}}class US extends ct{constructor(t,s){super(t,s);T(this,"timeoutClearer");this.scheduleTimeoutClear(),this.onUpdate(()=>this.scheduleTimeoutClear())}get joinedAt(){return new Date(this.source.joined_at)}get nickname(){return this.source.nickname??null}get roles(){return this.source.roles?this.source.roles.map(t=>this.server.roles.get(t)).filter(t=>t).sort((t,s)=>s.rank-t.rank):[]}get hoistedRole(){return this.roles.filter(t=>t.hoist).slice(-1)[0]??null}get colorRole(){return this.roles.filter(t=>t.color).slice(-1)[0]??null}get timeoutEnds(){return this.source.timeout?new Date(this.source.timeout):null}get serverID(){return this.source._id.server}get server(){return this.client.servers.get(this.serverID)}get user(){return this.client.users.get(this.id)}async fetchUser(){return await this.client.users.fetch(this.id)}get avatar(){return this.source.avatar?new qe(this.client,this.source.avatar):null}generateAvatarURL(...t){return this.avatar?this.avatar.generateURL(...t):null}get permissions(){return new it(jn(this.server,this))}get ranking(){if(this.id===this.server.ownerID)return-1/0;const t=this.roles;return t.length>0?t[t.length-1].rank:1/0}get inferior(){var t;return(((t=this.server.me)==null?void 0:t.ranking)??1/0)<this.ranking}get kickable(){return this.server.me.permissions.has(de.KickMembers)&&this.inferior}get bannable(){return this.server.me.permissions.has(de.BanMembers)&&this.inferior}inferiorTo(t){return t.ranking<this.ranking}async edit(t){this.update(await this.client.api.patch(`/servers/${this.serverID}/members/${this._id}`,t))}async addRole(t){const s=new Set(this.roles.map(n=>n.id));return s.add(t.id),await this.edit({roles:[...s]})}async removeRole(t){const s=new Set(this.roles.map(n=>n.id));return s.delete(t.id),await this.edit(s.size?{roles:[...s]}:{remove:["Roles"]})}async timeout(t){return await this.edit(t?{timeout:new Date(t).toISOString()}:{remove:["Timeout"]})}async kick(){await this.client.api.delete(`/servers/${this.serverID}/members/${this.id}`)}async ban(t){await this.server.members.ban(this,t)}scheduleTimeoutClear(){if(this.timeoutClearer&&clearTimeout(this.timeoutClearer),this.timeoutEnds){const t=+this.timeoutEnds-+new Date;t>0?this.timeoutClearer=setTimeout(()=>{this.update({timeout:null})},t):this.update({timeout:null})}}toString(){return`<@${this.id}>`}}class BS extends At{constructor(t,s){super();T(this,"client");T(this,"server");this.client=t,this.server=s}get self(){return this.items().find(t=>t.id==this.client.users.self.id)}async ban(t,s){await this.client.api.put(`/servers/${this.server.id}/bans/${typeof t=="string"?t:t.id}`,s)}async unban(t){await this.client.api.delete(`/servers/${this.server.id}/bans/${t}`)}construct(t){const s=this.get(t._id.user);if(s)return s.update(t);{const n=new US(this.client,t);return this.set(n.id,n),n.onUpdate(()=>this.fireUpdate([n])),n}}async fetch(t,s=!1){return this.get(t)&&!s?this.get(t):this.construct(await this.client.api.get(`/servers/${this.server.id}/members/${t}`))}async fetchAll(t=!1){const s=await this.client.api.get(`/servers/${this.server.id}/members`,{exclude_offline:t});return s.users.forEach(n=>this.client.users.construct(n)),s.members.map(n=>this.server.members.construct(n))}}class qS extends ct{constructor(t,s,n){super(t,n);T(this,"server");this.server=s}get name(){return this.source.name}get color(){return this.source.colour??null}get rank(){return this.source.rank||0}get hoist(){return!!this.source.hoist}get permissions(){return{allow:new it(this.source.permissions.a),deny:new it(this.source.permissions.d)}}async edit(t){return this.update(await this.client.api.patch(`/servers/${this.server.id}/roles/${this._id}`,t))}async delete(){await this.client.api.delete(`/servers/${this.server.id}/roles/${this._id}`),this.server.roles.delete(this.id)}toString(){return this.name}}class zS extends At{constructor(t,s){super();T(this,"client");T(this,"server");this.client=t,this.server=s,this.update()}get ordered(){return this.items().sort((t,s)=>t.rank-s.rank)}async create(t,s){const n=await this.client.api.post(`/servers/${this.server.id}/roles`,typeof s=="number"?{name:t,rank:s}:{name:t});return this.construct({_id:n.id,...n.role})}construct(t){const s=this.get(t._id);if(s)return s.update(t);{const n=new qS(this.client,this.server,t);return this.set(n.id,n),n.onUpdate(()=>this.fireUpdate([n])),n}}update(){if(!this.server.source.roles)this.clear();else{const t=Object.entries(this.server.source.roles).map(s=>({_id:s[0],...s[1]}));this.items().forEach(s=>{t.find(n=>n._id==s.id)||this.delete(s.id)}),t.forEach(s=>this.construct(s))}}}class VS extends At{constructor(t){super();T(this,"server");this.server=t}async create(t){return await this.server.client.channels.create(this.server,t)}}class HS extends At{constructor(t){super();T(this,"server");this.server=t}async create(t,s){return await this.server.client.emojis.create(this.server,t,s)}}var Ga;(function(r){r[r.Official=1]="Official",r[r.Verified=2]="Verified"})(Ga||(Ga={}));class GS extends Hs{constructor(e){super(Ga,e)}has(e){return super.has(e)}all(){return super.all()}}class Ra extends ct{constructor(t,s,n){super(t,s);T(this,"server");this.server=n}get createdAt(){return this.id=="default"?0:super.createdAt}get name(){return this.source.title}get channelIDs(){return this.source.channels}get channels(){return this.channelIDs.map(t=>this.server.channels.get(t)).filter(t=>t)}toString(){return this.name}}class Uh extends ct{get createdAt(){return 0}constructor(e,t){super(e,t)}get type(){return this.source.type}get creatorID(){return this.source.creator}get creator(){return this.client.users.get(this.creatorID)}async fetchCreator(e=!1){return await this.client.users.fetch(this.creatorID,e)}get channelID(){return this.source.creator}get channel(){return this.client.channels.get(this.channelID)}async fetchChannel(){return await this.client.channels.fetch(this.channelID)}get serverID(){return this.source.type=="Server"?this.source.server:null}get server(){return this.serverID?this.client.servers.get(this.serverID):null}generateURL(e="https://rvlt.gg"){return`${e}/${this.id}`}async delete(){await this.client.api.delete(`/invites/${this._id}`)}}class Bh extends ct{constructor(t,s){super(t,s);T(this,"members");T(this,"roles");this.members=new BS(this.client,this),this.roles=new zS(this.client,this),this.members.onUpdate(()=>this.fireUpdate())}update(t){return super.update(t),this.roles.update(),this}get channels(){const t=new VS(this);return this.client.channels.forEach(s=>s.isServerBased()&&s.serverID==this.id&&t.set(s.id,s)),t}get emojis(){const t=new HS(this);return this.client.emojis.forEach(s=>s.parentID==this.id&&t.set(s.id,s)),t}get categories(){var t;return((t=this.source.categories)==null?void 0:t.map(s=>new Ra(this.client,{_id:s.id,...s},this)))||[]}get orderedChannels(){const t=new Set(this.channels.items().map(i=>i.id)),s=[];let n;if(this.categories)for(const i of this.categories){const a=[];for(const u of i.channelIDs)t.delete(u)&&a.push(this.channels.get(u));const c=new Ra(this.client,{_id:i.id,title:i.name,channels:a.map(u=>u.id)},this);if(c.id==="default"){if(a.length==0)continue;n=c}s.push(c)}return t.size>0&&(n?n.update({channels:[...n.channelIDs,...t]}):s.unshift(new Ra(this.client,{_id:"default",title:"Default",channels:[...t]},this))),s}get name(){return this.source.name}get description(){return this.source.description??null}get nsfw(){return!!this.source.nsfw}get flags(){return new GS(this.source.flags||0)}get ownerID(){return this.source.owner}get owner(){return this.client.users.get(this.ownerID)??null}async fetchOwner(t=!1){return await this.client.users.fetch(this.ownerID,t)}get me(){return this.members.get(this.client.users.self.id)??null}async fetchMe(){return await this.members.fetch(this.client.users.self.id)}get defaultPermissions(){return new it(this.source.default_permissions)}get systemMessages(){return this.source.system_messages??null}get icon(){return this.source.icon?new qe(this.client,this.source.icon):null}generateIconURL(...t){return this.icon?this.icon.generateURL(...t):null}get banner(){return this.source.banner?new qe(this.client,this.source.banner):null}generateBannerURL(...t){return this.banner?this.banner.generateURL(...t):null}async edit(t){this.update(await this.client.api.patch(`/servers/${this._id}`,t))}async leave(t){await this.client.api.delete(`/servers/${this._id}`,{leave_silently:t}),this.client.servers.delete(this.id)}async fetchInvites(){return(await this.client.api.get(`/servers/${this._id}/invites`)).map(t=>new Uh(this.client,t))}async fetchBans(){const t=await this.client.api.get(`/servers/${this._id}/bans`);return t.bans.map(s=>{const n=t.users.find(i=>i._id==s._id.user);return{userID:(n==null?void 0:n._id)??null,userUsername:(n==null?void 0:n.username)??null,userAvatar:n!=null&&n.avatar?new qe(this.client,n.avatar):null,reason:s.reason??null}})}isUnread(t){return t(this)?!1:!!this.channels.find(s=>!t(s)&&s.unread)}getMentions(t){return t(this)?[]:this.channels.filter(n=>!t(n)).map(n=>n.mentions).flat(1)}async ack(){await this.client.api.put(`/servers/${this._id}/ack`)}async setRolePermissions(t,s){this.update(await this.client.api.put(`/servers/${this._id}/permissions/${t}`,{permissions:s}))}}var Mt;(function(r){r[r.Access=1]="Access",r[r.ViewProfile=2]="ViewProfile",r[r.SendMessage=4]="SendMessage",r[r.Invite=8]="Invite"})(Mt||(Mt={}));var de;(function(r){r[r.ManageChannel=1]="ManageChannel",r[r.ManageServer=2]="ManageServer",r[r.ManagePermissions=4]="ManagePermissions",r[r.ManageRole=8]="ManageRole",r[r.ManageCustomisation=16]="ManageCustomisation",r[r.KickMembers=64]="KickMembers",r[r.BanMembers=128]="BanMembers",r[r.TimeoutMembers=256]="TimeoutMembers",r[r.AssignRoles=512]="AssignRoles",r[r.ChangeNickname=1024]="ChangeNickname",r[r.ManageNicknames=2048]="ManageNicknames",r[r.ChangeAvatar=4096]="ChangeAvatar",r[r.RemoveAvatars=8192]="RemoveAvatars",r[r.ViewChannel=1048576]="ViewChannel",r[r.ReadMessageHistory=2097152]="ReadMessageHistory",r[r.SendMessage=4194304]="SendMessage",r[r.ManageMessages=8388608]="ManageMessages",r[r.ManageWebhooks=16777216]="ManageWebhooks",r[r.InviteOthers=33554432]="InviteOthers",r[r.SendEmbeds=67108864]="SendEmbeds",r[r.UploadFiles=134217728]="UploadFiles",r[r.Masquerade=268435456]="Masquerade",r[r.React=536870912]="React",r[r.Connect=1073741824]="Connect",r[r.Speak=2147483648]="Speak",r[r.Video=4294967296]="Video",r[r.MuteMembers=8589934592]="MuteMembers",r[r.DeafenMembers=17179869184]="DeafenMembers",r[r.MoveMembers=34359738368]="MoveMembers",r[r.GrantAllSafe=0xfffffffffffff]="GrantAllSafe"})(de||(de={}));const WS=2**32-1,ll=de.ViewChannel+de.ReadMessageHistory,qh=de.ViewChannel+de.ReadMessageHistory,zh=qh+de.SendMessage+de.InviteOthers+de.SendEmbeds+de.UploadFiles+de.Connect+de.Speak;de.GrantAllSafe;const Ta=zh+de.React+de.ManageChannel;zh+de.React+de.ChangeNickname+de.ChangeAvatar;function jn(r,e){const t=e?e.user:r.client.user;if(t!=null&&t.privileged)return de.GrantAllSafe;if(r instanceof Bh){if(r.ownerID==(t==null?void 0:t.id))return de.GrantAllSafe;{const s=e??r.members.get(t.id)??{roles:null,timeoutEnds:null};if(!s)return 0;let n=ee.fromNumber(r.defaultPermissions.bits);if(s.roles&&r.roles){const i=s.roles.map(a=>a.permissions);for(const a of i)n=n.or(a.allow.bits).and(ee.fromNumber(a.deny.bits).not())}return s.timeoutEnds&&s.timeoutEnds>new Date&&(n=n.and(ll)),n.toNumber()}}else{if(r.isSavedMessages())return de.GrantAllSafe;if(r.isDM())return r.recipient.permissionsAgainst.has(Mt.SendMessage)?Ta:qh;if(r.isGroupDM())return r.ownerID==(t==null?void 0:t.id)?Ta:r.permissions.bits??Ta;if(r.isServerBased()){const s=r.server;if(!s)return 0;if(s.ownerID==(t==null?void 0:t.id))return de.GrantAllSafe;{const n=e??s.members.get(t.id)??{roles:null,timeoutEnds:null};if(!n)return 0;let i=ee.fromNumber(jn(s,e));if(r.defaultPermissions&&(i=i.or(r.defaultPermissions.allow.bits).and(ee.fromNumber(r.defaultPermissions.deny.bits).not())),n.roles&&r.rolePermissions&&s.roles)for(const a of n.roles.map(c=>c.id)){const c=r.rolePermissions.find(u=>u.id==a);c&&(i=i.or(c.allow.bits).and(ee.fromNumber(c.deny.bits).not()))}return n.timeoutEnds&&n.timeoutEnds>new Date&&(i=i.and(ll)),i.toNumber()}}}}class it extends Hs{constructor(e){super(de,e)}has(e){return super.has(e)}add(e){return super.add(e)}remove(e){return super.remove(e)}all(){return super.all()}}var Je;(function(r){r.DM="DirectMessage",r.GroupDM="Group",r.SavedMessages="SavedMessages",r.Text="TextChannel",r.Voice="VoiceChannel"})(Je||(Je={}));class gi extends ct{constructor(t,s){super(t,s);T(this,"messages");T(this,"typingIDs",new Set);this.isTextBased()&&(this.messages=new FS(this.client,this))}get type(){return this.source.channel_type}isText(){return this.type==Je.Text}isVoice(){return this.type==Je.Voice}isDM(){return this.type==Je.DM}isGroupDM(){return this.type==Je.GroupDM}isSavedMessages(){return this.type==Je.SavedMessages}isTextBased(){return this.isText()||this.isDM()||this.isGroupDM()||this.isSavedMessages()}isDMBased(){return this.isDM()||this.isGroupDM()}isServerBased(){return this.isText()||this.isVoice()}get name(){return this.source.channel_type=="SavedMessages"?"Saved Notes":this.source.channel_type=="DirectMessage"?this.isDM()?this.recipient.username:"":this.source.name}get description(){return this.source.channel_type=="SavedMessages"||this.source.channel_type=="DirectMessage"?null:this.source.description??null}get nsfw(){return this.source.channel_type=="DirectMessage"||this.source.channel_type=="SavedMessages"?!1:!!this.source.nsfw}get icon(){return this.source.channel_type=="SavedMessages"?null:this.source.channel_type=="DirectMessage"?this.isDM()?this.recipient.avatar:null:this.source.icon?new qe(this.client,this.source.icon):null}generateIconURL(...t){return this.icon?this.icon.generateURL(...t):null}async setPermissions(t,s){await this.client.api.put(`/channels/${this._id}/permissions/${typeof t=="string"?t:t.id}`,{permissions:s})}get permissions(){return new it(jn(this))}permissionsFor(t){return new it(jn(this,t))}async createInvite(){return new Uh(this.client,await this.client.api.post(`/channels/${this._id}/invites`))}get lastMessageID(){return this.source.channel_type=="SavedMessages"||this.source.channel_type=="VoiceChannel"?null:this.source.last_message_id??null}get lastMessage(){return this.lastMessageID?this.messages.get(this.lastMessageID)??null:null}async fetchLastMessage(){return this.lastMessageID?await this.fetchMessage(this.lastMessageID):null}lastMessageBy(t){return this.messages.ordered.reverse().find(s=>s.isUser()&&s.authorID==t.id)??null}get typing(){return[...this.typingIDs.values()].filter(t=>t!==this.client.user.id).map(t=>this.client.users.get(t)).filter(t=>t)}startTyping(){this.client.ws.send({type:"BeginTyping",channel:this.id})}stopTyping(){this.client.ws.send({type:"EndTyping",channel:this.id})}checkUnread(t){return t(this)?!1:this.unread}get unread(){var t;return!this.lastMessageID||!this.isTextBased()||this.isSavedMessages()?!1:(((t=this.client.unreads.get(this.id))==null?void 0:t.last_id)??Rs()).localeCompare(this.lastMessageID)===-1}getMentions(t){return t(this)?[]:this.mentions}get mentions(){var t;return!this.isTextBased()||this.isSavedMessages()?[]:((t=this.client.unreads.get(this.id))==null?void 0:t.mentions)??[]}async ack(t){const s=(typeof t=="string"?t:t==null?void 0:t.id)??this.lastMessageID??Rs();await this.client.api.put(`/channels/${this._id}/ack/${s}`)}async markRead(t=!1){var s,n;if(this.lastMessageID)if(t){(s=this.client.unreads)==null||s.markRead(this,this.lastMessageID);const i=new Lh(this.client);await i.sync(),(((n=i.get(this.id))==null?void 0:n.last_id)??"0").localeCompare(this.lastMessageID)===-1&&this.ack()}else await this.client.unreads.sync(),this.unread&&await this.ack()}async send(t){return this.messages.construct(await this.client.api.post(`/channels/${this._id}/messages`,Fo(t,this)))}async fetchMessage(t){return await this.messages.fetch(t)}async edit(t){return this.update(await this.client.api.patch(`/channels/${this._id}`,t))}async delete(t){await this.client.api.delete(`/channels/${this._id}`,{leave_silently:t}),this.isDM()&&this.update({active:!1}),this.client.channels.delete(this.id)}toString(){return`<#${this.id}>`}}class ZS extends gi{get type(){return Je.DM}get source(){return super.source}constructor(e,t){super(e,t)}get active(){return this.source.active}get recipientID(){return this.source.recipients.find(e=>e!=this.client.user.id)}get recipient(){return this.recipientID?this.client.users.get(this.recipientID):null}async fetchRecipient(){return this.recipientID?await this.client.users.fetch(this.recipientID):null}async joinCall(){return(await this.client.api.post(`/channels/${this.id}/join_call`)).token}}class JS extends gi{get type(){return Je.GroupDM}get source(){return super.source}constructor(e,t){super(e,t)}get ownerID(){return this.source.owner}get owner(){return this.client.users.get(this.ownerID)}async fetchOwner(e=!1){return await this.client.users.fetch(this.ownerID,e)}get recipientIDs(){return this.source.recipients.filter(e=>e!==this.client.user.id)}get recipients(){return this.recipientIDs.map(e=>this.client.users.get(e)).filter(e=>e)}async fetchRecipients(){return(await this.client.api.get(`/channels/${this._id}/members`)).map(e=>this.client.users.construct(e)).filter(e=>e.id!==this.client.user.id)}async addRecipient(e){await this.client.api.put(`/channels/${this._id}/recipients/${typeof e=="string"?e:e.id}`)}async removeRecipient(e){await this.client.api.delete(`/channels/${this._id}/recipients/${typeof e=="string"?e:e.id}`)}async joinCall(){return(await this.client.api.post(`/channels/${this.id}/join_call`)).token}get permissions(){return new it(this.source.permissions||0)}}class KS extends gi{get type(){return Je.SavedMessages}constructor(e,t){super(e,t)}}class Vh extends gi{get type(){return super.type}get source(){return super.source}constructor(e,t){super(e,t)}get serverID(){return this.source.server}get server(){return this.client.servers.get(this.source.server)}get defaultPermissions(){var e,t;return{allow:new it(((e=this.source.default_permissions)==null?void 0:e.a)||0),deny:new it(((t=this.source.default_permissions)==null?void 0:t.d)||0)}}get rolePermissions(){return this.source.role_permissions?Object.entries(this.source.role_permissions).map(([e,t])=>({id:e,allow:new it(t.a||0),deny:new it(t.d||0)})):[]}}class YS extends Vh{get type(){return Je.Text}constructor(e,t){super(e,t)}}const QS=(r,e)=>r;class XS extends QS(Vh){constructor(t,s){super(t,s);T(this,"type",Je.Voice)}async joinCall(){return(await this.client.api.post(`/channels/${this.id}/join_call`)).token}}class eR extends At{constructor(t){super();T(this,"client");this.client=t}construct(t){const s=this.get(t._id);if(s)return s.update(t);{const n=(()=>{switch(t.channel_type){case"DirectMessage":return new ZS(this.client,t);case"Group":return new JS(this.client,t);case"SavedMessages":return new KS(this.client,t);case"TextChannel":return new YS(this.client,t);case"VoiceChannel":return new XS(this.client,t)}})();return this.set(n.id,n),n.onUpdate(()=>this.fireUpdate([n])),n}}async fetch(t,s){return this.has(t)?this.get(t).update(s):this.construct(s??await this.client.api.get(`/channels/${t}`))}async create(t,s){return this.construct(await this.client.api.post(`/servers/${t.id}/channels`,s))}}class tR{constructor(e){T(this,"name");T(this,"pack","mutant");this.name=e}get id(){return this.name}get imageURL(){return sR(Hh[this.name],this.pack)}get parent(){return null}get uniqueName(){return this.name}setPack(e){return this.pack=e,this}toString(){return`:${this.id}:`}}function rR(r){r=r.indexOf(String.fromCharCode(8205))<0?r.replace(/\uFE0F/g,""):r;const e=[];let t=0,s=0;for(;s<r.length;){const n=r.charCodeAt(s++);t?(e.push(65536+(t-55296<<10)+(n-56320)),t=0):55296<=n&&n<=56319?t=n:e.push(n)}return e.map(n=>n.toString(16)).join("-")}function sR(r,e="mutant"){return`https://static.revolt.chat/emoji/${e}/${rR(r)}.svg?rev=3`}const Hh={100:"💯",1234:"🔢",grinning:"😀",smiley:"😃",smile:"😄",grin:"😁",laughing:"😆",satisfied:"😆",sweat_smile:"😅",rofl:"🤣",joy:"😂",slightly_smiling_face:"🙂",upside_down_face:"🙃",wink:"😉",blush:"😊",innocent:"😇",smiling_face_with_three_hearts:"🥰",heart_eyes:"😍",star_struck:"🤩",kissing_heart:"😘",kissing:"😗",relaxed:"☺️",kissing_closed_eyes:"😚",kissing_smiling_eyes:"😙",smiling_face_with_tear:"🥲",yum:"😋",stuck_out_tongue:"😛",stuck_out_tongue_winking_eye:"😜",zany_face:"🤪",stuck_out_tongue_closed_eyes:"😝",money_mouth_face:"🤑",hugs:"🤗",hand_over_mouth:"🤭",shushing_face:"🤫",thinking:"🤔",zipper_mouth_face:"🤐",raised_eyebrow:"🤨",neutral_face:"😐",expressionless:"😑",no_mouth:"😶",smirk:"😏",unamused:"😒",roll_eyes:"🙄",grimacing:"😬",lying_face:"🤥",relieved:"😌",pensive:"😔",sleepy:"😪",drooling_face:"🤤",sleeping:"😴",mask:"😷",face_with_thermometer:"🤒",face_with_head_bandage:"🤕",nauseated_face:"🤢",vomiting_face:"🤮",sneezing_face:"🤧",hot_face:"🥵",cold_face:"🥶",woozy_face:"🥴",dizzy_face:"😵",exploding_head:"🤯",cowboy_hat_face:"🤠",partying_face:"🥳",disguised_face:"🥸",sunglasses:"😎",nerd_face:"🤓",monocle_face:"🧐",confused:"😕",worried:"😟",slightly_frowning_face:"🙁",frowning_face:"☹️",open_mouth:"😮",hushed:"😯",astonished:"😲",flushed:"😳",pleading_face:"🥺",frowning:"😦",anguished:"😧",fearful:"😨",cold_sweat:"😰",disappointed_relieved:"😥",cry:"😢",sob:"😭",scream:"😱",confounded:"😖",persevere:"😣",disappointed:"😞",sweat:"😓",weary:"😩",tired_face:"😫",yawning_face:"🥱",triumph:"😤",rage:"😡",pout:"😡",angry:"😠",cursing_face:"🤬",smiling_imp:"😈",imp:"👿",skull:"💀",skull_and_crossbones:"☠️",hankey:"💩",poop:"💩",shit:"💩",clown_face:"🤡",japanese_ogre:"👹",japanese_goblin:"👺",ghost:"👻",alien:"👽",space_invader:"👾",robot:"🤖",smiley_cat:"😺",smile_cat:"😸",joy_cat:"😹",heart_eyes_cat:"😻",smirk_cat:"😼",kissing_cat:"😽",scream_cat:"🙀",crying_cat_face:"😿",pouting_cat:"😾",see_no_evil:"🙈",hear_no_evil:"🙉",speak_no_evil:"🙊",kiss:"💋",love_letter:"💌",cupid:"💘",gift_heart:"💝",sparkling_heart:"💖",heartpulse:"💗",heartbeat:"💓",revolving_hearts:"💞",two_hearts:"💕",heart_decoration:"💟",heavy_heart_exclamation:"❣️",broken_heart:"💔",heart:"❤️",orange_heart:"🧡",yellow_heart:"💛",green_heart:"💚",blue_heart:"💙",purple_heart:"💜",brown_heart:"🤎",black_heart:"🖤",white_heart:"🤍",anger:"💢",boom:"💥",collision:"💥",dizzy:"💫",sweat_drops:"💦",dash:"💨",hole:"🕳️",bomb:"💣",speech_balloon:"💬",left_speech_bubble:"🗨️",right_anger_bubble:"🗯️",thought_balloon:"💭",zzz:"💤",wave:"👋",raised_back_of_hand:"🤚",raised_hand_with_fingers_splayed:"🖐️",hand:"✋",raised_hand:"✋",vulcan_salute:"🖖",ok_hand:"👌",pinched_fingers:"🤌",pinching_hand:"🤏",v:"✌️",crossed_fingers:"🤞",love_you_gesture:"🤟",metal:"🤘",call_me_hand:"🤙",point_left:"👈",point_right:"👉",point_up_2:"👆",middle_finger:"🖕",fu:"🖕",point_down:"👇",point_up:"☝️","+1":"👍",thumbsup:"👍","-1":"👎",thumbsdown:"👎",fist_raised:"✊",fist:"✊",fist_oncoming:"👊",facepunch:"👊",punch:"👊",fist_left:"🤛",fist_right:"🤜",clap:"👏",raised_hands:"🙌",open_hands:"👐",palms_up_together:"🤲",handshake:"🤝",pray:"🙏",writing_hand:"✍️",nail_care:"💅",selfie:"🤳",muscle:"💪",mechanical_arm:"🦾",mechanical_leg:"🦿",leg:"🦵",foot:"🦶",ear:"👂",ear_with_hearing_aid:"🦻",nose:"👃",brain:"🧠",anatomical_heart:"🫀",lungs:"🫁",tooth:"🦷",bone:"🦴",eyes:"👀",eye:"👁️",tongue:"👅",lips:"👄",baby:"👶",child:"🧒",boy:"👦",girl:"👧",adult:"🧑",blond_haired_person:"👱",man:"👨",bearded_person:"🧔",red_haired_man:"👨‍🦰",curly_haired_man:"👨‍🦱",white_haired_man:"👨‍🦳",bald_man:"👨‍🦲",woman:"👩",red_haired_woman:"👩‍🦰",person_red_hair:"🧑‍🦰",curly_haired_woman:"👩‍🦱",person_curly_hair:"🧑‍🦱",white_haired_woman:"👩‍🦳",person_white_hair:"🧑‍🦳",bald_woman:"👩‍🦲",person_bald:"🧑‍🦲",blond_haired_woman:"👱‍♀️",blonde_woman:"👱‍♀️",blond_haired_man:"👱‍♂️",older_adult:"🧓",older_man:"👴",older_woman:"👵",frowning_person:"🙍",frowning_man:"🙍‍♂️",frowning_woman:"🙍‍♀️",pouting_face:"🙎",pouting_man:"🙎‍♂️",pouting_woman:"🙎‍♀️",no_good:"🙅",no_good_man:"🙅‍♂️",ng_man:"🙅‍♂️",no_good_woman:"🙅‍♀️",ng_woman:"🙅‍♀️",ok_person:"🙆",ok_man:"🙆‍♂️",ok_woman:"🙆‍♀️",tipping_hand_person:"💁",information_desk_person:"💁",tipping_hand_man:"💁‍♂️",sassy_man:"💁‍♂️",tipping_hand_woman:"💁‍♀️",sassy_woman:"💁‍♀️",raising_hand:"🙋",raising_hand_man:"🙋‍♂️",raising_hand_woman:"🙋‍♀️",deaf_person:"🧏",deaf_man:"🧏‍♂️",deaf_woman:"🧏‍♀️",bow:"🙇",bowing_man:"🙇‍♂️",bowing_woman:"🙇‍♀️",facepalm:"🤦",man_facepalming:"🤦‍♂️",woman_facepalming:"🤦‍♀️",shrug:"🤷",man_shrugging:"🤷‍♂️",woman_shrugging:"🤷‍♀️",health_worker:"🧑‍⚕️",man_health_worker:"👨‍⚕️",woman_health_worker:"👩‍⚕️",student:"🧑‍🎓",man_student:"👨‍🎓",woman_student:"👩‍🎓",teacher:"🧑‍🏫",man_teacher:"👨‍🏫",woman_teacher:"👩‍🏫",judge:"🧑‍⚖️",man_judge:"👨‍⚖️",woman_judge:"👩‍⚖️",farmer:"🧑‍🌾",man_farmer:"👨‍🌾",woman_farmer:"👩‍🌾",cook:"🧑‍🍳",man_cook:"👨‍🍳",woman_cook:"👩‍🍳",mechanic:"🧑‍🔧",man_mechanic:"👨‍🔧",woman_mechanic:"👩‍🔧",factory_worker:"🧑‍🏭",man_factory_worker:"👨‍🏭",woman_factory_worker:"👩‍🏭",office_worker:"🧑‍💼",man_office_worker:"👨‍💼",woman_office_worker:"👩‍💼",scientist:"🧑‍🔬",man_scientist:"👨‍🔬",woman_scientist:"👩‍🔬",technologist:"🧑‍💻",man_technologist:"👨‍💻",woman_technologist:"👩‍💻",singer:"🧑‍🎤",man_singer:"👨‍🎤",woman_singer:"👩‍🎤",artist:"🧑‍🎨",man_artist:"👨‍🎨",woman_artist:"👩‍🎨",pilot:"🧑‍✈️",man_pilot:"👨‍✈️",woman_pilot:"👩‍✈️",astronaut:"🧑‍🚀",man_astronaut:"👨‍🚀",woman_astronaut:"👩‍🚀",firefighter:"🧑‍🚒",man_firefighter:"👨‍🚒",woman_firefighter:"👩‍🚒",police_officer:"👮",cop:"👮",policeman:"👮‍♂️",policewoman:"👮‍♀️",detective:"🕵️",male_detective:"🕵️‍♂️",female_detective:"🕵️‍♀️",guard:"💂",guardsman:"💂‍♂️",guardswoman:"💂‍♀️",ninja:"🥷",construction_worker:"👷",construction_worker_man:"👷‍♂️",construction_worker_woman:"👷‍♀️",prince:"🤴",princess:"👸",person_with_turban:"👳",man_with_turban:"👳‍♂️",woman_with_turban:"👳‍♀️",man_with_gua_pi_mao:"👲",woman_with_headscarf:"🧕",person_in_tuxedo:"🤵",man_in_tuxedo:"🤵‍♂️",woman_in_tuxedo:"🤵‍♀️",person_with_veil:"👰",man_with_veil:"👰‍♂️",woman_with_veil:"👰‍♀️",bride_with_veil:"👰‍♀️",pregnant_woman:"🤰",breast_feeding:"🤱",woman_feeding_baby:"👩‍🍼",man_feeding_baby:"👨‍🍼",person_feeding_baby:"🧑‍🍼",angel:"👼",santa:"🎅",mrs_claus:"🤶",mx_claus:"🧑‍🎄",superhero:"🦸",superhero_man:"🦸‍♂️",superhero_woman:"🦸‍♀️",supervillain:"🦹",supervillain_man:"🦹‍♂️",supervillain_woman:"🦹‍♀️",mage:"🧙",mage_man:"🧙‍♂️",mage_woman:"🧙‍♀️",fairy:"🧚",fairy_man:"🧚‍♂️",fairy_woman:"🧚‍♀️",vampire:"🧛",vampire_man:"🧛‍♂️",vampire_woman:"🧛‍♀️",merperson:"🧜",merman:"🧜‍♂️",mermaid:"🧜‍♀️",elf:"🧝",elf_man:"🧝‍♂️",elf_woman:"🧝‍♀️",genie:"🧞",genie_man:"🧞‍♂️",genie_woman:"🧞‍♀️",zombie:"🧟",zombie_man:"🧟‍♂️",zombie_woman:"🧟‍♀️",massage:"💆",massage_man:"💆‍♂️",massage_woman:"💆‍♀️",haircut:"💇",haircut_man:"💇‍♂️",haircut_woman:"💇‍♀️",walking:"🚶",walking_man:"🚶‍♂️",walking_woman:"🚶‍♀️",standing_person:"🧍",standing_man:"🧍‍♂️",standing_woman:"🧍‍♀️",kneeling_person:"🧎",kneeling_man:"🧎‍♂️",kneeling_woman:"🧎‍♀️",person_with_probing_cane:"🧑‍🦯",man_with_probing_cane:"👨‍🦯",woman_with_probing_cane:"👩‍🦯",person_in_motorized_wheelchair:"🧑‍🦼",man_in_motorized_wheelchair:"👨‍🦼",woman_in_motorized_wheelchair:"👩‍🦼",person_in_manual_wheelchair:"🧑‍🦽",man_in_manual_wheelchair:"👨‍🦽",woman_in_manual_wheelchair:"👩‍🦽",runner:"🏃",running:"🏃",running_man:"🏃‍♂️",running_woman:"🏃‍♀️",woman_dancing:"💃",dancer:"💃",man_dancing:"🕺",business_suit_levitating:"🕴️",dancers:"👯",dancing_men:"👯‍♂️",dancing_women:"👯‍♀️",sauna_person:"🧖",sauna_man:"🧖‍♂️",sauna_woman:"🧖‍♀️",climbing:"🧗",climbing_man:"🧗‍♂️",climbing_woman:"🧗‍♀️",person_fencing:"🤺",horse_racing:"🏇",skier:"⛷️",snowboarder:"🏂",golfing:"🏌️",golfing_man:"🏌️‍♂️",golfing_woman:"🏌️‍♀️",surfer:"🏄",surfing_man:"🏄‍♂️",surfing_woman:"🏄‍♀️",rowboat:"🚣",rowing_man:"🚣‍♂️",rowing_woman:"🚣‍♀️",swimmer:"🏊",swimming_man:"🏊‍♂️",swimming_woman:"🏊‍♀️",bouncing_ball_person:"⛹️",bouncing_ball_man:"⛹️‍♂️",basketball_man:"⛹️‍♂️",bouncing_ball_woman:"⛹️‍♀️",basketball_woman:"⛹️‍♀️",weight_lifting:"🏋️",weight_lifting_man:"🏋️‍♂️",weight_lifting_woman:"🏋️‍♀️",bicyclist:"🚴",biking_man:"🚴‍♂️",biking_woman:"🚴‍♀️",mountain_bicyclist:"🚵",mountain_biking_man:"🚵‍♂️",mountain_biking_woman:"🚵‍♀️",cartwheeling:"🤸",man_cartwheeling:"🤸‍♂️",woman_cartwheeling:"🤸‍♀️",wrestling:"🤼",men_wrestling:"🤼‍♂️",women_wrestling:"🤼‍♀️",water_polo:"🤽",man_playing_water_polo:"🤽‍♂️",woman_playing_water_polo:"🤽‍♀️",handball_person:"🤾",man_playing_handball:"🤾‍♂️",woman_playing_handball:"🤾‍♀️",juggling_person:"🤹",man_juggling:"🤹‍♂️",woman_juggling:"🤹‍♀️",lotus_position:"🧘",lotus_position_man:"🧘‍♂️",lotus_position_woman:"🧘‍♀️",bath:"🛀",sleeping_bed:"🛌",people_holding_hands:"🧑‍🤝‍🧑",two_women_holding_hands:"👭",couple:"👫",two_men_holding_hands:"👬",couplekiss:"💏",couplekiss_man_woman:"👩‍❤️‍💋‍👨",couplekiss_man_man:"👨‍❤️‍💋‍👨",couplekiss_woman_woman:"👩‍❤️‍💋‍👩",couple_with_heart:"💑",couple_with_heart_woman_man:"👩‍❤️‍👨",couple_with_heart_man_man:"👨‍❤️‍👨",couple_with_heart_woman_woman:"👩‍❤️‍👩",family:"👪",family_man_woman_boy:"👨‍👩‍👦",family_man_woman_girl:"👨‍👩‍👧",family_man_woman_girl_boy:"👨‍👩‍👧‍👦",family_man_woman_boy_boy:"👨‍👩‍👦‍👦",family_man_woman_girl_girl:"👨‍👩‍👧‍👧",family_man_man_boy:"👨‍👨‍👦",family_man_man_girl:"👨‍👨‍👧",family_man_man_girl_boy:"👨‍👨‍👧‍👦",family_man_man_boy_boy:"👨‍👨‍👦‍👦",family_man_man_girl_girl:"👨‍👨‍👧‍👧",family_woman_woman_boy:"👩‍👩‍👦",family_woman_woman_girl:"👩‍👩‍👧",family_woman_woman_girl_boy:"👩‍👩‍👧‍👦",family_woman_woman_boy_boy:"👩‍👩‍👦‍👦",family_woman_woman_girl_girl:"👩‍👩‍👧‍👧",family_man_boy:"👨‍👦",family_man_boy_boy:"👨‍👦‍👦",family_man_girl:"👨‍👧",family_man_girl_boy:"👨‍👧‍👦",family_man_girl_girl:"👨‍👧‍👧",family_woman_boy:"👩‍👦",family_woman_boy_boy:"👩‍👦‍👦",family_woman_girl:"👩‍👧",family_woman_girl_boy:"👩‍👧‍👦",family_woman_girl_girl:"👩‍👧‍👧",speaking_head:"🗣️",bust_in_silhouette:"👤",busts_in_silhouette:"👥",people_hugging:"🫂",footprints:"👣",monkey_face:"🐵",monkey:"🐒",gorilla:"🦍",orangutan:"🦧",dog:"🐶",dog2:"🐕",guide_dog:"🦮",service_dog:"🐕‍🦺",poodle:"🐩",wolf:"🐺",fox_face:"🦊",raccoon:"🦝",cat:"🐱",cat2:"🐈",black_cat:"🐈‍⬛",lion:"🦁",tiger:"🐯",tiger2:"🐅",leopard:"🐆",horse:"🐴",racehorse:"🐎",unicorn:"🦄",zebra:"🦓",deer:"🦌",bison:"🦬",cow:"🐮",ox:"🐂",water_buffalo:"🐃",cow2:"🐄",pig:"🐷",pig2:"🐖",boar:"🐗",pig_nose:"🐽",ram:"🐏",sheep:"🐑",goat:"🐐",dromedary_camel:"🐪",camel:"🐫",llama:"🦙",giraffe:"🦒",elephant:"🐘",mammoth:"🦣",rhinoceros:"🦏",hippopotamus:"🦛",mouse:"🐭",mouse2:"🐁",rat:"🐀",hamster:"🐹",rabbit:"🐰",rabbit2:"🐇",chipmunk:"🐿️",beaver:"🦫",hedgehog:"🦔",bat:"🦇",bear:"🐻",polar_bear:"🐻‍❄️",koala:"🐨",panda_face:"🐼",sloth:"🦥",otter:"🦦",skunk:"🦨",kangaroo:"🦘",badger:"🦡",feet:"🐾",paw_prints:"🐾",turkey:"🦃",chicken:"🐔",rooster:"🐓",hatching_chick:"🐣",baby_chick:"🐤",hatched_chick:"🐥",bird:"🐦",penguin:"🐧",dove:"🕊️",eagle:"🦅",duck:"🦆",swan:"🦢",owl:"🦉",dodo:"🦤",feather:"🪶",flamingo:"🦩",peacock:"🦚",parrot:"🦜",frog:"🐸",crocodile:"🐊",turtle:"🐢",lizard:"🦎",snake:"🐍",dragon_face:"🐲",dragon:"🐉",sauropod:"🦕","t-rex":"🦖",whale:"🐳",whale2:"🐋",dolphin:"🐬",flipper:"🐬",seal:"🦭",fish:"🐟",tropical_fish:"🐠",blowfish:"🐡",shark:"🦈",octopus:"🐙",shell:"🐚",snail:"🐌",butterfly:"🦋",bug:"🐛",ant:"🐜",bee:"🐝",honeybee:"🐝",beetle:"🪲",lady_beetle:"🐞",cricket:"🦗",cockroach:"🪳",spider:"🕷️",spider_web:"🕸️",scorpion:"🦂",mosquito:"🦟",fly:"🪰",worm:"🪱",microbe:"🦠",bouquet:"💐",cherry_blossom:"🌸",white_flower:"💮",rosette:"🏵️",rose:"🌹",wilted_flower:"🥀",hibiscus:"🌺",sunflower:"🌻",blossom:"🌼",tulip:"🌷",seedling:"🌱",potted_plant:"🪴",evergreen_tree:"🌲",deciduous_tree:"🌳",palm_tree:"🌴",cactus:"🌵",ear_of_rice:"🌾",herb:"🌿",shamrock:"☘️",four_leaf_clover:"🍀",maple_leaf:"🍁",fallen_leaf:"🍂",leaves:"🍃",grapes:"🍇",melon:"🍈",watermelon:"🍉",tangerine:"🍊",orange:"🍊",mandarin:"🍊",lemon:"🍋",banana:"🍌",nanner:"🍌",pineapple:"🍍",mango:"🥭",apple:"🍎",green_apple:"🍏",pear:"🍐",peach:"🍑",cherries:"🍒",strawberry:"🍓",blueberries:"🫐",kiwi_fruit:"🥝",tomato:"🍅",olive:"🫒",coconut:"🥥",avocado:"🥑",eggplant:"🍆",potato:"🥔",carrot:"🥕",corn:"🌽",hot_pepper:"🌶️",bell_pepper:"🫑",cucumber:"🥒",leafy_green:"🥬",broccoli:"🥦",garlic:"🧄",onion:"🧅",mushroom:"🍄",peanuts:"🥜",chestnut:"🌰",bread:"🍞",croissant:"🥐",baguette_bread:"🥖",flatbread:"🫓",pretzel:"🥨",bagel:"🥯",pancakes:"🥞",waffle:"🧇",cheese:"🧀",meat_on_bone:"🍖",poultry_leg:"🍗",cut_of_meat:"🥩",bacon:"🥓",hamburger:"🍔",fries:"🍟",pizza:"🍕",hotdog:"🌭",sandwich:"🥪",taco:"🌮",burrito:"🌯",tamale:"🫔",stuffed_flatbread:"🥙",falafel:"🧆",egg:"🥚",fried_egg:"🍳",shallow_pan_of_food:"🥘",stew:"🍲",fondue:"🫕",bowl_with_spoon:"🥣",green_salad:"🥗",popcorn:"🍿",butter:"🧈",salt:"🧂",canned_food:"🥫",bento:"🍱",rice_cracker:"🍘",rice_ball:"🍙",rice:"🍚",curry:"🍛",ramen:"🍜",spaghetti:"🍝",sweet_potato:"🍠",oden:"🍢",sushi:"🍣",fried_shrimp:"🍤",fish_cake:"🍥",moon_cake:"🥮",dango:"🍡",dumpling:"🥟",fortune_cookie:"🥠",takeout_box:"🥡",crab:"🦀",lobster:"🦞",shrimp:"🦐",squid:"🦑",oyster:"🦪",icecream:"🍦",shaved_ice:"🍧",ice_cream:"🍨",doughnut:"🍩",cookie:"🍪",birthday:"🎂",cake:"🍰",cupcake:"🧁",pie:"🥧",chocolate_bar:"🍫",candy:"🍬",lollipop:"🍭",custard:"🍮",honey_pot:"🍯",baby_bottle:"🍼",milk_glass:"🥛",coffee:"☕",teapot:"🫖",tea:"🍵",sake:"🍶",champagne:"🍾",wine_glass:"🍷",cocktail:"🍸",tropical_drink:"🍹",beer:"🍺",beers:"🍻",clinking_glasses:"🥂",tumbler_glass:"🥃",cup_with_straw:"🥤",bubble_tea:"🧋",beverage_box:"🧃",mate:"🧉",ice_cube:"🧊",chopsticks:"🥢",plate_with_cutlery:"🍽️",fork_and_knife:"🍴",spoon:"🥄",hocho:"🔪",knife:"🔪",amphora:"🏺",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",globe_with_meridians:"🌐",world_map:"🗺️",japan:"🗾",compass:"🧭",mountain_snow:"🏔️",mountain:"⛰️",volcano:"🌋",mount_fuji:"🗻",camping:"🏕️",beach_umbrella:"🏖️",desert:"🏜️",desert_island:"🏝️",national_park:"🏞️",stadium:"🏟️",classical_building:"🏛️",building_construction:"🏗️",bricks:"🧱",rock:"🪨",wood:"🪵",hut:"🛖",houses:"🏘️",derelict_house:"🏚️",house:"🏠",house_with_garden:"🏡",office:"🏢",post_office:"🏣",european_post_office:"🏤",hospital:"🏥",bank:"🏦",hotel:"🏨",love_hotel:"🏩",convenience_store:"🏪",school:"🏫",department_store:"🏬",factory:"🏭",japanese_castle:"🏯",european_castle:"🏰",wedding:"💒",tokyo_tower:"🗼",statue_of_liberty:"🗽",church:"⛪",mosque:"🕌",hindu_temple:"🛕",synagogue:"🕍",shinto_shrine:"⛩️",kaaba:"🕋",fountain:"⛲",tent:"⛺",foggy:"🌁",night_with_stars:"🌃",cityscape:"🏙️",sunrise_over_mountains:"🌄",sunrise:"🌅",city_sunset:"🌆",city_sunrise:"🌇",bridge_at_night:"🌉",hotsprings:"♨️",carousel_horse:"🎠",ferris_wheel:"🎡",roller_coaster:"🎢",barber:"💈",circus_tent:"🎪",steam_locomotive:"🚂",railway_car:"🚃",bullettrain_side:"🚄",bullettrain_front:"🚅",train2:"🚆",metro:"🚇",light_rail:"🚈",station:"🚉",tram:"🚊",monorail:"🚝",mountain_railway:"🚞",train:"🚋",bus:"🚌",oncoming_bus:"🚍",trolley:"🚎",trolleybus:"🚎",minibus:"🚐",ambulance:"🚑",fire_engine:"🚒",police_car:"🚓",oncoming_police_car:"🚔",taxi:"🚕",oncoming_taxi:"🚖",car:"🚗",red_car:"🚗",oncoming_automobile:"🚘",blue_car:"🚙",pickup_truck:"🛻",truck:"🚚",articulated_lorry:"🚛",tractor:"🚜",racing_car:"🏎️",motorcycle:"🏍️",motor_scooter:"🛵",manual_wheelchair:"🦽",motorized_wheelchair:"🦼",auto_rickshaw:"🛺",bike:"🚲",kick_scooter:"🛴",skateboard:"🛹",roller_skate:"🛼",busstop:"🚏",motorway:"🛣️",railway_track:"🛤️",oil_drum:"🛢️",fuelpump:"⛽",rotating_light:"🚨",traffic_light:"🚥",vertical_traffic_light:"🚦",stop_sign:"🛑",construction:"🚧",anchor:"⚓",boat:"⛵",sailboat:"⛵",canoe:"🛶",speedboat:"🚤",passenger_ship:"🛳️",ferry:"⛴️",motor_boat:"🛥️",ship:"🚢",airplane:"✈️",small_airplane:"🛩️",flight_departure:"🛫",flight_arrival:"🛬",parachute:"🪂",seat:"💺",helicopter:"🚁",suspension_railway:"🚟",mountain_cableway:"🚠",aerial_tramway:"🚡",artificial_satellite:"🛰️",rocket:"🚀",flying_saucer:"🛸",bellhop_bell:"🛎️",luggage:"🧳",hourglass:"⌛",hourglass_flowing_sand:"⏳",watch:"⌚",alarm_clock:"⏰",stopwatch:"⏱️",timer_clock:"⏲️",mantelpiece_clock:"🕰️",clock12:"🕛",clock1230:"🕧",clock1:"🕐",clock130:"🕜",clock2:"🕑",clock230:"🕝",clock3:"🕒",clock330:"🕞",clock4:"🕓",clock430:"🕟",clock5:"🕔",clock530:"🕠",clock6:"🕕",clock630:"🕡",clock7:"🕖",clock730:"🕢",clock8:"🕗",clock830:"🕣",clock9:"🕘",clock930:"🕤",clock10:"🕙",clock1030:"🕥",clock11:"🕚",clock1130:"🕦",new_moon:"🌑",waxing_crescent_moon:"🌒",first_quarter_moon:"🌓",moon:"🌔",waxing_gibbous_moon:"🌔",full_moon:"🌕",waning_gibbous_moon:"🌖",last_quarter_moon:"🌗",waning_crescent_moon:"🌘",crescent_moon:"🌙",new_moon_with_face:"🌚",first_quarter_moon_with_face:"🌛",last_quarter_moon_with_face:"🌜",thermometer:"🌡️",sunny:"☀️",full_moon_with_face:"🌝",sun_with_face:"🌞",ringed_planet:"🪐",star:"⭐",star2:"🌟",stars:"🌠",milky_way:"🌌",cloud:"☁️",partly_sunny:"⛅",cloud_with_lightning_and_rain:"⛈️",sun_behind_small_cloud:"🌤️",sun_behind_large_cloud:"🌥️",sun_behind_rain_cloud:"🌦️",cloud_with_rain:"🌧️",cloud_with_snow:"🌨️",cloud_with_lightning:"🌩️",tornado:"🌪️",fog:"🌫️",wind_face:"🌬️",cyclone:"🌀",rainbow:"🌈",closed_umbrella:"🌂",open_umbrella:"☂️",umbrella:"☔",parasol_on_ground:"⛱️",zap:"⚡",snowflake:"❄️",snowman_with_snow:"☃️",snowman:"⛄",comet:"☄️",fire:"🔥",droplet:"💧",ocean:"🌊",jack_o_lantern:"🎃",christmas_tree:"🎄",fireworks:"🎆",sparkler:"🎇",firecracker:"🧨",sparkles:"✨",balloon:"🎈",tada:"🎉",confetti_ball:"🎊",tanabata_tree:"🎋",bamboo:"🎍",dolls:"🎎",flags:"🎏",wind_chime:"🎐",rice_scene:"🎑",red_envelope:"🧧",ribbon:"🎀",gift:"🎁",reminder_ribbon:"🎗️",tickets:"🎟️",ticket:"🎫",medal_military:"🎖️",trophy:"🏆",medal_sports:"🏅","1st_place_medal":"🥇","2nd_place_medal":"🥈","3rd_place_medal":"🥉",soccer:"⚽",baseball:"⚾",softball:"🥎",basketball:"🏀",volleyball:"🏐",football:"🏈",rugby_football:"🏉",tennis:"🎾",flying_disc:"🥏",bowling:"🎳",cricket_game:"🏏",field_hockey:"🏑",ice_hockey:"🏒",lacrosse:"🥍",ping_pong:"🏓",badminton:"🏸",boxing_glove:"🥊",martial_arts_uniform:"🥋",goal_net:"🥅",golf:"⛳",ice_skate:"⛸️",fishing_pole_and_fish:"🎣",diving_mask:"🤿",running_shirt_with_sash:"🎽",ski:"🎿",sled:"🛷",curling_stone:"🥌",dart:"🎯",yo_yo:"🪀",kite:"🪁","8ball":"🎱",crystal_ball:"🔮",magic_wand:"🪄",nazar_amulet:"🧿",video_game:"🎮",joystick:"🕹️",slot_machine:"🎰",game_die:"🎲",jigsaw:"🧩",teddy_bear:"🧸",pinata:"🪅",nesting_dolls:"🪆",spades:"♠️",hearts:"♥️",diamonds:"♦️",clubs:"♣️",chess_pawn:"♟️",black_joker:"🃏",mahjong:"🀄",flower_playing_cards:"🎴",performing_arts:"🎭",framed_picture:"🖼️",art:"🎨",thread:"🧵",sewing_needle:"🪡",yarn:"🧶",knot:"🪢",eyeglasses:"👓",dark_sunglasses:"🕶️",goggles:"🥽",lab_coat:"🥼",safety_vest:"🦺",necktie:"👔",shirt:"👕",tshirt:"👕",jeans:"👖",scarf:"🧣",gloves:"🧤",coat:"🧥",socks:"🧦",dress:"👗",kimono:"👘",sari:"🥻",one_piece_swimsuit:"🩱",swim_brief:"🩲",shorts:"🩳",bikini:"👙",womans_clothes:"👚",purse:"👛",handbag:"👜",pouch:"👝",shopping:"🛍️",school_satchel:"🎒",thong_sandal:"🩴",mans_shoe:"👞",shoe:"👞",athletic_shoe:"👟",hiking_boot:"🥾",flat_shoe:"🥿",high_heel:"👠",sandal:"👡",ballet_shoes:"🩰",boot:"👢",crown:"👑",womans_hat:"👒",tophat:"🎩",mortar_board:"🎓",billed_cap:"🧢",military_helmet:"🪖",rescue_worker_helmet:"⛑️",prayer_beads:"📿",lipstick:"💄",ring:"💍",gem:"💎",mute:"🔇",speaker:"🔈",sound:"🔉",loud_sound:"🔊",loudspeaker:"📢",mega:"📣",postal_horn:"📯",bell:"🔔",no_bell:"🔕",musical_score:"🎼",musical_note:"🎵",notes:"🎶",studio_microphone:"🎙️",level_slider:"🎚️",control_knobs:"🎛️",microphone:"🎤",headphones:"🎧",radio:"📻",saxophone:"🎷",accordion:"🪗",guitar:"🎸",musical_keyboard:"🎹",trumpet:"🎺",violin:"🎻",banjo:"🪕",drum:"🥁",long_drum:"🪘",iphone:"📱",calling:"📲",phone:"☎️",telephone:"☎️",telephone_receiver:"📞",pager:"📟",fax:"📠",battery:"🔋",electric_plug:"🔌",computer:"💻",desktop_computer:"🖥️",printer:"🖨️",keyboard:"⌨️",computer_mouse:"🖱️",trackball:"🖲️",minidisc:"💽",floppy_disk:"💾",cd:"💿",dvd:"📀",abacus:"🧮",movie_camera:"🎥",film_strip:"🎞️",film_projector:"📽️",clapper:"🎬",tv:"📺",camera:"📷",camera_flash:"📸",video_camera:"📹",vhs:"📼",mag:"🔍",mag_right:"🔎",candle:"🕯️",bulb:"💡",flashlight:"🔦",izakaya_lantern:"🏮",lantern:"🏮",diya_lamp:"🪔",notebook_with_decorative_cover:"📔",closed_book:"📕",book:"📖",open_book:"📖",green_book:"📗",blue_book:"📘",orange_book:"📙",books:"📚",notebook:"📓",ledger:"📒",page_with_curl:"📃",scroll:"📜",page_facing_up:"📄",newspaper:"📰",newspaper_roll:"🗞️",bookmark_tabs:"📑",bookmark:"🔖",label:"🏷️",moneybag:"💰",coin:"🪙",yen:"💴",dollar:"💵",euro:"💶",pound:"💷",money_with_wings:"💸",credit_card:"💳",receipt:"🧾",chart:"💹",envelope:"✉️",email:"📧","e-mail":"📧",incoming_envelope:"📨",envelope_with_arrow:"📩",outbox_tray:"📤",inbox_tray:"📥",package:"📦",mailbox:"📫",mailbox_closed:"📪",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",postbox:"📮",ballot_box:"🗳️",pencil2:"✏️",black_nib:"✒️",fountain_pen:"🖋️",pen:"🖊️",paintbrush:"🖌️",crayon:"🖍️",memo:"📝",pencil:"📝",briefcase:"💼",file_folder:"📁",open_file_folder:"📂",card_index_dividers:"🗂️",date:"📅",calendar:"📆",spiral_notepad:"🗒️",spiral_calendar:"🗓️",card_index:"📇",chart_with_upwards_trend:"📈",chart_with_downwards_trend:"📉",bar_chart:"📊",clipboard:"📋",pushpin:"📌",round_pushpin:"📍",paperclip:"📎",paperclips:"🖇️",straight_ruler:"📏",triangular_ruler:"📐",scissors:"✂️",card_file_box:"🗃️",file_cabinet:"🗄️",wastebasket:"🗑️",lock:"🔒",unlock:"🔓",lock_with_ink_pen:"🔏",closed_lock_with_key:"🔐",key:"🔑",old_key:"🗝️",hammer:"🔨",axe:"🪓",pick:"⛏️",hammer_and_pick:"⚒️",hammer_and_wrench:"🛠️",dagger:"🗡️",crossed_swords:"⚔️",gun:"🔫",boomerang:"🪃",bow_and_arrow:"🏹",shield:"🛡️",carpentry_saw:"🪚",wrench:"🔧",screwdriver:"🪛",nut_and_bolt:"🔩",gear:"⚙️",clamp:"🗜️",balance_scale:"⚖️",probing_cane:"🦯",link:"🔗",chains:"⛓️",hook:"🪝",toolbox:"🧰",magnet:"🧲",ladder:"🪜",alembic:"⚗️",test_tube:"🧪",petri_dish:"🧫",dna:"🧬",microscope:"🔬",telescope:"🔭",satellite:"📡",syringe:"💉",drop_of_blood:"🩸",pill:"💊",adhesive_bandage:"🩹",stethoscope:"🩺",door:"🚪",elevator:"🛗",mirror:"🪞",window:"🪟",bed:"🛏️",couch_and_lamp:"🛋️",chair:"🪑",toilet:"🚽",plunger:"🪠",shower:"🚿",bathtub:"🛁",mouse_trap:"🪤",razor:"🪒",lotion_bottle:"🧴",safety_pin:"🧷",broom:"🧹",basket:"🧺",roll_of_paper:"🧻",bucket:"🪣",soap:"🧼",toothbrush:"🪥",sponge:"🧽",fire_extinguisher:"🧯",shopping_cart:"🛒",smoking:"🚬",coffin:"⚰️",headstone:"🪦",funeral_urn:"⚱️",moyai:"🗿",placard:"🪧",atm:"🏧",put_litter_in_its_place:"🚮",potable_water:"🚰",wheelchair:"♿",mens:"🚹",womens:"🚺",restroom:"🚻",baby_symbol:"🚼",wc:"🚾",passport_control:"🛂",customs:"🛃",baggage_claim:"🛄",left_luggage:"🛅",warning:"⚠️",children_crossing:"🚸",no_entry:"⛔",no_entry_sign:"🚫",no_bicycles:"🚳",no_smoking:"🚭",do_not_litter:"🚯","non-potable_water":"🚱",no_pedestrians:"🚷",no_mobile_phones:"📵",underage:"🔞",radioactive:"☢️",biohazard:"☣️",arrow_up:"⬆️",arrow_upper_right:"↗️",arrow_right:"➡️",arrow_lower_right:"↘️",arrow_down:"⬇️",arrow_lower_left:"↙️",arrow_left:"⬅️",arrow_upper_left:"↖️",arrow_up_down:"↕️",left_right_arrow:"↔️",leftwards_arrow_with_hook:"↩️",arrow_right_hook:"↪️",arrow_heading_up:"⤴️",arrow_heading_down:"⤵️",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",back:"🔙",end:"🔚",on:"🔛",soon:"🔜",top:"🔝",place_of_worship:"🛐",atom_symbol:"⚛️",om:"🕉️",star_of_david:"✡️",wheel_of_dharma:"☸️",yin_yang:"☯️",latin_cross:"✝️",orthodox_cross:"☦️",star_and_crescent:"☪️",peace_symbol:"☮️",menorah:"🕎",six_pointed_star:"🔯",aries:"♈",taurus:"♉",gemini:"♊",cancer:"♋",leo:"♌",virgo:"♍",libra:"♎",scorpius:"♏",sagittarius:"♐",capricorn:"♑",aquarius:"♒",pisces:"♓",ophiuchus:"⛎",twisted_rightwards_arrows:"🔀",repeat:"🔁",repeat_one:"🔂",arrow_forward:"▶️",fast_forward:"⏩",next_track_button:"⏭️",play_or_pause_button:"⏯️",arrow_backward:"◀️",rewind:"⏪",previous_track_button:"⏮️",arrow_up_small:"🔼",arrow_double_up:"⏫",arrow_down_small:"🔽",arrow_double_down:"⏬",pause_button:"⏸️",stop_button:"⏹️",record_button:"⏺️",eject_button:"⏏️",cinema:"🎦",low_brightness:"🔅",high_brightness:"🔆",signal_strength:"📶",vibration_mode:"📳",mobile_phone_off:"📴",female_sign:"♀️",male_sign:"♂️",transgender_symbol:"⚧️",heavy_multiplication_x:"✖️",heavy_plus_sign:"➕",heavy_minus_sign:"➖",heavy_division_sign:"➗",infinity:"♾️",bangbang:"‼️",interrobang:"⁉️",question:"❓",grey_question:"❔",grey_exclamation:"❕",exclamation:"❗",heavy_exclamation_mark:"❗",wavy_dash:"〰️",currency_exchange:"💱",heavy_dollar_sign:"💲",medical_symbol:"⚕️",recycle:"♻️",fleur_de_lis:"⚜️",trident:"🔱",name_badge:"📛",beginner:"🔰",o:"⭕",white_check_mark:"✅",ballot_box_with_check:"☑️",heavy_check_mark:"✔️",x:"❌",negative_squared_cross_mark:"❎",curly_loop:"➰",loop:"➿",part_alternation_mark:"〽️",eight_spoked_asterisk:"✳️",eight_pointed_black_star:"✴️",sparkle:"❇️",copyright:"©️",registered:"®️",tm:"™️",hash:"#️⃣",asterisk:"*️⃣",zero:"0️⃣",one:"1️⃣",two:"2️⃣",three:"3️⃣",four:"4️⃣",five:"5️⃣",six:"6️⃣",seven:"7️⃣",eight:"8️⃣",nine:"9️⃣",keycap_ten:"🔟",capital_abcd:"🔠",abcd:"🔡",symbols:"🔣",abc:"🔤",a:"🅰️",ab:"🆎",b:"🅱️",cl:"🆑",cool:"🆒",free:"🆓",information_source:"ℹ️",id:"🆔",m:"Ⓜ️",new:"🆕",ng:"🆖",o2:"🅾️",ok:"🆗",parking:"🅿️",sos:"🆘",up:"🆙",vs:"🆚",koko:"🈁",sa:"🈂️",u6708:"🈷️",u6709:"🈶",u6307:"🈯",ideograph_advantage:"🉐",u5272:"🈹",u7121:"🈚",u7981:"🈲",accept:"🉑",u7533:"🈸",u5408:"🈴",u7a7a:"🈳",congratulations:"㊗️",secret:"㊙️",u55b6:"🈺",u6e80:"🈵",red_circle:"🔴",orange_circle:"🟠",yellow_circle:"🟡",green_circle:"🟢",large_blue_circle:"🔵",purple_circle:"🟣",brown_circle:"🟤",black_circle:"⚫",white_circle:"⚪",red_square:"🟥",orange_square:"🟧",yellow_square:"🟨",green_square:"🟩",blue_square:"🟦",purple_square:"🟪",brown_square:"🟫",black_large_square:"⬛",white_large_square:"⬜",black_medium_square:"◼️",white_medium_square:"◻️",black_medium_small_square:"◾",white_medium_small_square:"◽",black_small_square:"▪️",white_small_square:"▫️",large_orange_diamond:"🔶",large_blue_diamond:"🔷",small_orange_diamond:"🔸",small_blue_diamond:"🔹",small_red_triangle:"🔺",small_red_triangle_down:"🔻",diamond_shape_with_a_dot_inside:"💠",radio_button:"🔘",white_square_button:"🔳",black_square_button:"🔲",checkered_flag:"🏁",triangular_flag_on_post:"🚩",crossed_flags:"🎌",black_flag:"🏴",white_flag:"🏳️",rainbow_flag:"🏳️‍🌈",transgender_flag:"🏳️‍⚧️",pirate_flag:"🏴‍☠️",ascension_island:"🇦🇨",andorra:"🇦🇩",united_arab_emirates:"🇦🇪",afghanistan:"🇦🇫",antigua_barbuda:"🇦🇬",anguilla:"🇦🇮",albania:"🇦🇱",armenia:"🇦🇲",angola:"🇦🇴",antarctica:"🇦🇶",argentina:"🇦🇷",american_samoa:"🇦🇸",austria:"🇦🇹",australia:"🇦🇺",aruba:"🇦🇼",aland_islands:"🇦🇽",azerbaijan:"🇦🇿",bosnia_herzegovina:"🇧🇦",barbados:"🇧🇧",bangladesh:"🇧🇩",belgium:"🇧🇪",burkina_faso:"🇧🇫",bulgaria:"🇧🇬",bahrain:"🇧🇭",burundi:"🇧🇮",benin:"🇧🇯",st_barthelemy:"🇧🇱",bermuda:"🇧🇲",brunei:"🇧🇳",bolivia:"🇧🇴",caribbean_netherlands:"🇧🇶",brazil:"🇧🇷",bahamas:"🇧🇸",bhutan:"🇧🇹",bouvet_island:"🇧🇻",botswana:"🇧🇼",belarus:"🇧🇾",belize:"🇧🇿",canada:"🇨🇦",cocos_islands:"🇨🇨",congo_kinshasa:"🇨🇩",central_african_republic:"🇨🇫",congo_brazzaville:"🇨🇬",switzerland:"🇨🇭",cote_divoire:"🇨🇮",cook_islands:"🇨🇰",chile:"🇨🇱",cameroon:"🇨🇲",cn:"🇨🇳",colombia:"🇨🇴",clipperton_island:"🇨🇵",costa_rica:"🇨🇷",cuba:"🇨🇺",cape_verde:"🇨🇻",curacao:"🇨🇼",christmas_island:"🇨🇽",cyprus:"🇨🇾",czech_republic:"🇨🇿",de:"🇩🇪",diego_garcia:"🇩🇬",djibouti:"🇩🇯",denmark:"🇩🇰",dominica:"🇩🇲",dominican_republic:"🇩🇴",algeria:"🇩🇿",ceuta_melilla:"🇪🇦",ecuador:"🇪🇨",estonia:"🇪🇪",egypt:"🇪🇬",western_sahara:"🇪🇭",eritrea:"🇪🇷",es:"🇪🇸",ethiopia:"🇪🇹",eu:"🇪🇺",european_union:"🇪🇺",finland:"🇫🇮",fiji:"🇫🇯",falkland_islands:"🇫🇰",micronesia:"🇫🇲",faroe_islands:"🇫🇴",fr:"🇫🇷",gabon:"🇬🇦",gb:"🇬🇧",uk:"🇬🇧",grenada:"🇬🇩",georgia:"🇬🇪",french_guiana:"🇬🇫",guernsey:"🇬🇬",ghana:"🇬🇭",gibraltar:"🇬🇮",greenland:"🇬🇱",gambia:"🇬🇲",guinea:"🇬🇳",guadeloupe:"🇬🇵",equatorial_guinea:"🇬🇶",greece:"🇬🇷",south_georgia_south_sandwich_islands:"🇬🇸",guatemala:"🇬🇹",guam:"🇬🇺",guinea_bissau:"🇬🇼",guyana:"🇬🇾",hong_kong:"🇭🇰",heard_mcdonald_islands:"🇭🇲",honduras:"🇭🇳",croatia:"🇭🇷",haiti:"🇭🇹",hungary:"🇭🇺",canary_islands:"🇮🇨",indonesia:"🇮🇩",ireland:"🇮🇪",israel:"🇮🇱",isle_of_man:"🇮🇲",india:"🇮🇳",british_indian_ocean_territory:"🇮🇴",iraq:"🇮🇶",iran:"🇮🇷",iceland:"🇮🇸",it:"🇮🇹",jersey:"🇯🇪",jamaica:"🇯🇲",jordan:"🇯🇴",jp:"🇯🇵",kenya:"🇰🇪",kyrgyzstan:"🇰🇬",cambodia:"🇰🇭",kiribati:"🇰🇮",comoros:"🇰🇲",st_kitts_nevis:"🇰🇳",north_korea:"🇰🇵",kr:"🇰🇷",kuwait:"🇰🇼",cayman_islands:"🇰🇾",kazakhstan:"🇰🇿",laos:"🇱🇦",lebanon:"🇱🇧",st_lucia:"🇱🇨",liechtenstein:"🇱🇮",sri_lanka:"🇱🇰",liberia:"🇱🇷",lesotho:"🇱🇸",lithuania:"🇱🇹",luxembourg:"🇱🇺",latvia:"🇱🇻",libya:"🇱🇾",morocco:"🇲🇦",monaco:"🇲🇨",moldova:"🇲🇩",montenegro:"🇲🇪",st_martin:"🇲🇫",madagascar:"🇲🇬",marshall_islands:"🇲🇭",macedonia:"🇲🇰",mali:"🇲🇱",myanmar:"🇲🇲",mongolia:"🇲🇳",macau:"🇲🇴",northern_mariana_islands:"🇲🇵",martinique:"🇲🇶",mauritania:"🇲🇷",montserrat:"🇲🇸",malta:"🇲🇹",mauritius:"🇲🇺",maldives:"🇲🇻",malawi:"🇲🇼",mexico:"🇲🇽",malaysia:"🇲🇾",mozambique:"🇲🇿",namibia:"🇳🇦",new_caledonia:"🇳🇨",niger:"🇳🇪",norfolk_island:"🇳🇫",nigeria:"🇳🇬",nicaragua:"🇳🇮",netherlands:"🇳🇱",norway:"🇳🇴",nepal:"🇳🇵",nauru:"🇳🇷",niue:"🇳🇺",new_zealand:"🇳🇿",oman:"🇴🇲",panama:"🇵🇦",peru:"🇵🇪",french_polynesia:"🇵🇫",papua_new_guinea:"🇵🇬",philippines:"🇵🇭",pakistan:"🇵🇰",poland:"🇵🇱",st_pierre_miquelon:"🇵🇲",pitcairn_islands:"🇵🇳",puerto_rico:"🇵🇷",palestinian_territories:"🇵🇸",portugal:"🇵🇹",palau:"🇵🇼",paraguay:"🇵🇾",qatar:"🇶🇦",reunion:"🇷🇪",romania:"🇷🇴",serbia:"🇷🇸",ru:"🇷🇺",rwanda:"🇷🇼",saudi_arabia:"🇸🇦",solomon_islands:"🇸🇧",seychelles:"🇸🇨",sudan:"🇸🇩",sweden:"🇸🇪",singapore:"🇸🇬",st_helena:"🇸🇭",slovenia:"🇸🇮",svalbard_jan_mayen:"🇸🇯",slovakia:"🇸🇰",sierra_leone:"🇸🇱",san_marino:"🇸🇲",senegal:"🇸🇳",somalia:"🇸🇴",suriname:"🇸🇷",south_sudan:"🇸🇸",sao_tome_principe:"🇸🇹",el_salvador:"🇸🇻",sint_maarten:"🇸🇽",syria:"🇸🇾",swaziland:"🇸🇿",tristan_da_cunha:"🇹🇦",turks_caicos_islands:"🇹🇨",chad:"🇹🇩",french_southern_territories:"🇹🇫",togo:"🇹🇬",thailand:"🇹🇭",tajikistan:"🇹🇯",tokelau:"🇹🇰",timor_leste:"🇹🇱",turkmenistan:"🇹🇲",tunisia:"🇹🇳",tonga:"🇹🇴",tr:"🇹🇷",trinidad_tobago:"🇹🇹",tuvalu:"🇹🇻",taiwan:"🇹🇼",tanzania:"🇹🇿",ukraine:"🇺🇦",uganda:"🇺🇬",us_outlying_islands:"🇺🇲",united_nations:"🇺🇳",us:"🇺🇸",uruguay:"🇺🇾",uzbekistan:"🇺🇿",vatican_city:"🇻🇦",st_vincent_grenadines:"🇻🇨",venezuela:"🇻🇪",british_virgin_islands:"🇻🇬",us_virgin_islands:"🇻🇮",vietnam:"🇻🇳",vanuatu:"🇻🇺",wallis_futuna:"🇼🇫",samoa:"🇼🇸",kosovo:"🇽🇰",yemen:"🇾🇪",mayotte:"🇾🇹",south_africa:"🇿🇦",zambia:"🇿🇲",zimbabwe:"🇿🇼",england:"🏴󠁧󠁢󠁥󠁮󠁧󠁿",scotland:"🏴󠁧󠁢󠁳󠁣󠁴󠁿",wales:"🏴󠁧󠁢󠁷󠁬󠁳󠁿"},nR=Object.keys(Hh).map(r=>new tR(String(r)));class iR extends ct{constructor(e,t){super(e,t)}get name(){return this.source.name}get animated(){return!!this.source.animated}get nsfw(){return!!this.source.nsfw}get creatorID(){return this.source.creator_id}get creator(){return this.client.users.get(this.creatorID)}async fetchCreator(e=!1){return await this.client.users.fetch(this.creatorID,e)}get imageURL(){var e;return`${(e=this.client.config)==null?void 0:e.features.autumn.url}/emojis/${this.id}${this.animated?"":"?max_side=128"}`}get parentID(){return this.source.parent.type=="Server"?this.source.parent.id:""}get parent(){return this.parentID?this.client.servers.get(this.parentID)??null:null}get uniqueName(){const e=[...nR,...this.client.emojis.ordered],t=e.filter(s=>s.name==this.name).findIndex(s=>s.id==this.id);return t<=0?this.name:`${this.name}~${t+1}`}async delete(){await this.client.api.delete(`/custom/emoji/${this._id}`),this.client.emojis.delete(this.id)}toString(){return`:${this.id}:`}}class aR extends At{constructor(t){super();T(this,"client");T(this,"orderCache",[]);this.client=t,this.onUpdate(()=>this.orderCache=[])}get ordered(){return this.orderCache.length?this.orderCache:this.orderCache=this.sort((t,s)=>t.createdAt-s.createdAt)}get known(){return this.filter(t=>t.parentID&&this.client.servers.has(t.parentID))}construct(t){const s=this.get(t._id);if(s)return s.update(t);{const n=new iR(this.client,t);return this.set(n.id,n),n.onUpdate(()=>this.fireUpdate([n])),n}}async fetch(t,s=!1){return this.get(t)&&!s?this.get(t):this.construct(await this.client.api.get(`/custom/emoji/${t}`))}async create(t,s,n){return this.construct(await this.client.api.put(`/custom/emoji/${s}`,{name:n,parent:{type:"Server",id:t.id}}))}}class oR extends At{constructor(t){super();T(this,"client");this.client=t}construct(t){const s=this.get(t._id);if(s)return s.update(t);{const n=new Bh(this.client,t);return this.set(n.id,n),n.onUpdate(()=>this.fireUpdate([n])),n}}async fetch(t,s,n){if(this.has(t))return this.get(t).update(s);const i=s??await this.client.api.get(`/servers/${t}`);if(n)for(const a of n)await this.client.channels.fetch(a._id,a);else for(const a of i.channels)try{await this.client.channels.fetch(a)}catch{}return this.construct(i)}}var Ie;(function(r){r[r.Developer=1]="Developer",r[r.Translator=2]="Translator",r[r.Supporter=4]="Supporter",r[r.ResponsibleDisclosure=8]="ResponsibleDisclosure",r[r.Founder=16]="Founder",r[r.PlatformModeration=32]="PlatformModeration",r[r.ActiveSupporter=64]="ActiveSupporter",r[r.Paw=128]="Paw",r[r.EarlyAdopter=256]="EarlyAdopter",r[r.ReservedRelevantJokeBadge1=512]="ReservedRelevantJokeBadge1",r[r.ReservedRelevantJokeBadge2=1024]="ReservedRelevantJokeBadge2"})(Ie||(Ie={}));class cR extends Hs{constructor(e){super(Ie,e)}has(e){return super.has(e)}all(){return super.all()}}Ie.Developer+"",Ie.Translator+"",Ie.Supporter+"",Ie.ResponsibleDisclosure+"",Ie.Founder+"",Ie.PlatformModeration+"",Ie.ActiveSupporter+"",Ie.Paw+"",Ie.EarlyAdopter+"",Ie.ReservedRelevantJokeBadge1+"",Ie.ReservedRelevantJokeBadge2+"";var Wa;(function(r){r[r.Suspended=1]="Suspended",r[r.Deleted=2]="Deleted",r[r.Banned=4]="Banned"})(Wa||(Wa={}));class dR extends Hs{constructor(e){super(Wa,e)}has(e){return super.has(e)}all(){return super.all()}}class Da extends Hs{constructor(e){super(Mt,e)}has(e){return super.has(e)}all(){return super.all()}}class lR{constructor(e){T(this,"parent");this.parent=e}get ownerID(){return this.parent.source.bot.owner}get owner(){return this.parent.client.users.get(this.ownerID)}async fetchOwner(e=!1){return await this.parent.client.users.fetch(this.ownerID,e)}}class uR extends ct{constructor(e,t){super(e,t)}get username(){return this.source.username}get bot(){return this.source.bot?new lR(this):null}get online(){return!!this.source.online}get privileged(){return!!this.source.privileged}get badges(){return new cR(this.source.badges||0)}get flags(){return new dR(this.source.flags||0)}get avatar(){return this.source.avatar?new qe(this.client,this.source.avatar):null}get defaultAvatarURL(){return this.client.users.defaultAvatarURL(this.id)}generateAvatarURL(...e){return e[2]||(e[2]=this.defaultAvatarURL),this.avatar?this.avatar.generateURL(...e):this.defaultAvatarURL}get relationship(){return this.source.relationship}get status(){var e;return((e=this.source.status)==null?void 0:e.text)??null}get presence(){var e;return((e=this.source.status)==null?void 0:e.presence)??null}async addFriend(){this.client.users.construct(await this.client.api.post("/users/friend",{username:this.username}))}async removeFriend(){this.client.users.construct(await this.client.api.delete(`/users/${this._id}/friend`))}async block(){this.client.users.construct(await this.client.api.put(`/users/${this._id}/block`))}async unblock(){this.client.users.construct(await this.client.api.delete(`/users/${this._id}/block`))}async openDM(){let e=this.client.channels.find(t=>t.isDM()&&t.recipientID==this.id);if(!e){const t=await this.client.api.get(`/users/${this._id}/dm`);e=await this.client.channels.fetch(t._id,t)}return e.update({active:!0})}async fetchProfile(){const e=await this.client.api.get(`/users/${this._id}/profile`),t=this.client;return{background:e.background?new qe(this.client,e.background):null,bio:e.content??null,generateBackgroundURL(...s){return e.background?new qe(t,e.background).generateURL(...s):null}}}async fetchMutual(){const e=await this.client.api.get(`/users/${this._id}/mutual`);return{friends:e.users,servers:e.servers}}get permissionsAgainst(){let e=0;switch(this.relationship){case Et.Friend:case Et.Self:return new Da(WS);case Et.Blocked:case Et.SelfBlocked:return new Da(Mt.Access);case Et.Incoming:case Et.Outgoing:e=Mt.Access}return(this.client.channels.find(t=>t.isDM()&&t.recipientID==this.id||t.isGroupDM()&&t.recipientIDs.includes(this.id))||this.client.servers.find(t=>t.members.find(s=>s.id==this.client.user.id)))&&((this.client.user.bot||this.bot)&&(e|=Mt.SendMessage),e|=Mt.Access|Mt.ViewProfile),new Da(e)}toString(){return`<@${this.id}>`}}class hR extends At{constructor(t){super();T(this,"client");this.client=t}get self(){return this.items().find(t=>t.relationship==Et.Self)}defaultAvatarURL(t){return`${this.client.options.apiURL}/users/${t}/default_avatar`}construct(t){const s=this.get(t._id);if(s)return s.update(t);{const n=new uR(this.client,t);return this.set(n.id,n),n.onUpdate(()=>this.fireUpdate([n])),n}}async fetch(t,s=!1){return this.has(t)&&!s?this.get(t):this.construct(await this.client.api.get(`/users/${t}`))}}class pR extends ct{get createdAt(){return 0}constructor(e,t){super(e,t)}get type(){return this.source.type}get creator(){return{name:this.source.user_name,avatar:this.source.user_avatar?new qe(this.client,this.source.user_avatar):null}}get channel(){return{id:this.source.channel_id,name:this.source.channel_name,description:this.source.channel_description??null}}get server(){return this.source.type=="Server"?{id:this.source.server_id,name:this.source.server_name,icon:this.source.server_icon?new qe(this.client,this.source.server_icon):null,banner:this.source.server_banner?new qe(this.client,this.source.server_banner):null,members:this.source.member_count}:null}async accept(){return await this.client.acceptInvite(this)}}const fR={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:()=>!0,startingDelay:100,timeMultiple:2};function mR(r){const e=Object.assign(Object.assign({},fR),r);return e.numOfAttempts<1&&(e.numOfAttempts=1),e}function gR(r){const e=Math.random()*r;return Math.round(e)}function _R(r){return r}function wR(r){switch(r.jitter){case"full":return gR;case"none":default:return _R}}class Gh{constructor(e){this.options=e,this.attempt=0}apply(){return new Promise(e=>setTimeout(e,this.jitteredDelay))}setAttemptNumber(e){this.attempt=e}get jitteredDelay(){return wR(this.options)(this.delay)}get delay(){const e=this.options.startingDelay,t=this.options.timeMultiple,s=this.numOfDelayedAttempts,n=e*Math.pow(t,s);return Math.min(n,this.options.maxDelay)}get numOfDelayedAttempts(){return this.attempt}}var yR=globalThis&&globalThis.__awaiter||function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function c(l){try{o(s.next(l))}catch(d){a(d)}}function u(l){try{o(s.throw(l))}catch(d){a(d)}}function o(l){l.done?i(l.value):n(l.value).then(c,u)}o((s=s.apply(r,e||[])).next())})};class vR extends Gh{apply(){const e=Object.create(null,{apply:{get:()=>super.apply}});return yR(this,void 0,void 0,function*(){return this.isFirstAttempt?!0:e.apply.call(this)})}get isFirstAttempt(){return this.attempt===0}get numOfDelayedAttempts(){return this.attempt-1}}class bR extends Gh{}function SR(r,e){const t=RR(r);return t.setAttemptNumber(e),t}function RR(r){return r.delayFirstAttempt?new bR(r):new vR(r)}var Za=globalThis&&globalThis.__awaiter||function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function c(l){try{o(s.next(l))}catch(d){a(d)}}function u(l){try{o(s.throw(l))}catch(d){a(d)}}function o(l){l.done?i(l.value):n(l.value).then(c,u)}o((s=s.apply(r,e||[])).next())})};function TR(r,e={}){return Za(this,void 0,void 0,function*(){const t=mR(e);return yield new DR(r,t).execute()})}class DR{constructor(e,t){this.request=e,this.options=t,this.attemptNumber=0}execute(){return Za(this,void 0,void 0,function*(){for(;!this.attemptLimitReached;)try{return yield this.applyDelay(),yield this.request()}catch(e){if(this.attemptNumber++,!(yield this.options.retry(e,this.attemptNumber))||this.attemptLimitReached)throw e}throw new Error("Something went wrong.")})}get attemptLimitReached(){return this.attemptNumber>=this.options.numOfAttempts}applyDelay(){return Za(this,void 0,void 0,function*(){yield SR(this.options,this.attemptNumber).apply()})}}var Nr=null;typeof WebSocket<"u"?Nr=WebSocket:typeof MozWebSocket<"u"?Nr=MozWebSocket:typeof global<"u"?Nr=global.WebSocket||global.MozWebSocket:typeof window<"u"?Nr=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(Nr=self.WebSocket||self.MozWebSocket);const nr=Nr;class CR{constructor(e){T(this,"client");T(this,"ws");T(this,"heartbeat");T(this,"connected",!1);T(this,"ready",!1);T(this,"ping");this.client=e}disconnect(){clearInterval(this.heartbeat),this.connected=this.ready=!1,this.ws&&this.ws.readyState===nr.OPEN&&this.ws.close()}send(e){if(typeof this.ws>"u"||this.ws.readyState!==nr.OPEN)return;const t=JSON.stringify(e);this.client.options.debug&&console.debug("[<<] Outgoing Packet",t),this.ws.send(t)}connect(e){return this.client.emit("connecting"),new Promise((t,s)=>{let n=!1;const i=d=>{n||(n=!0,s(d))};if(this.disconnect(),!this.client.config)throw new Error("Attempted to open WebSocket without syncing configuration from server.");if(!this.client.session)throw new Error("Attempted to open WebSocket without valid session.");this.ws=new nr(this.client.config.ws),this.ws.onopen=()=>this.send({type:"Authenticate",token:this.client.session.token});const a=async d=>{var h,p,f,w,g,b,E,M,P;this.client.emit("packet",d);try{switch(d.type){case"Bulk":{for(const y of d.v)await a(y);break}case"Error":{i(d.error);break}case"Authenticated":{e=!1,this.client.emit("connected"),this.connected=!0;break}case"Ready":{if(d.type!=="Ready")throw 0;for(const y of d.users)this.client.users.construct(y);for(const y of d.channels)this.client.channels.construct(y);for(const y of d.servers)this.client.servers.construct(y);for(const y of d.members)(h=this.client.servers.get(y._id.server))==null||h.members.construct(y);if(d.emojis)for(const y of d.emojis)this.client.emojis.construct(y);this.client.emit("ready"),this.ready=!0,t(),this.client.unreads.sync(),this.client.options.heartbeat>0&&(this.send({type:"Ping",data:+new Date}),this.heartbeat=setInterval(()=>{if(this.send({type:"Ping",data:+new Date}),this.client.options.pingTimeout){let y=!1;this.client.once("packet",D=>{D.type=="Pong"&&(y=!0)}),setTimeout(()=>{if(!y){if(this.client.options.exitOnTimeout)throw"Client did not receive a pong in time.";console.warn("Warning: Client did not receive a pong in time. Reconnecting."),this.disconnect(),this.connect(e)}},this.client.options.pingTimeout*1e3)}},this.client.options.heartbeat*1e3));break}case"Message":{if(d.author===ka){if(d.system)switch(d.system.type){case"user_added":case"user_remove":await this.client.users.fetch(d.system.by);break;case"user_joined":await this.client.users.fetch(d.system.id);break;case"channel_description_changed":case"channel_icon_changed":case"channel_renamed":await this.client.users.fetch(d.system.by);break}}else await this.client.users.fetch(d.author);const y=await this.client.channels.fetch(d.channel);if(y.isServerBased()){const Z=await this.client.servers.fetch(y.serverID);d.author!==ka&&await Z.members.fetch(d.author)}const D=y.messages.construct(d);y.isDM()&&y.update({active:!0}),y.update({last_message_id:D.id}),this.client.emit("message",D),D.isUser()&&D.mentionIDs.includes(this.client.user.id)&&this.client.unreads.markMention(D);break}case"MessageUpdate":{const y=this.client.channels.get(d.channel),D=y==null?void 0:y.messages.get(d.id);D&&(D.update(d.data),this.client.emit("messageUpdate",D));break}case"MessageAppend":{const y=this.client.channels.get(d.channel),D=y==null?void 0:y.messages.get(d.id);D!=null&&D.isUser()&&(D.appendEmbed(d.append),this.client.emit("messageUpdate",D));break}case"MessageDelete":{const y=this.client.channels.get(d.channel);if(y){const D=y.messages.get(d.id);y.messages.delete(d.id),this.client.emit("messageDelete",d.id,D)}break}case"MessageReact":{const y=this.client.channels.get(d.channel_id),D=y==null?void 0:y.messages.get(d.id);D&&(D.update({reactions:{...D.source.reactions,[d.emoji_id]:[...new Set([...((p=D.source.reactions)==null?void 0:p[d.emoji_id])||[],d.user_id])]}}),this.client.emit("messageUpdate",D));break}case"MessageUnreact":{const y=this.client.channels.get(d.channel_id),D=y==null?void 0:y.messages.get(d.id);if(D){const Z=(f=D.source.reactions)==null?void 0:f[d.emoji_id];if(Z){const ae=new Set(Z);ae.delete(d.user_id),ae.size?D.update({reactions:{...D.source.reactions,[d.emoji_id]:[...ae]}}):(delete D.source.reactions[d.emoji_id],D.update({reactions:D.source.reactions}))}this.client.emit("messageUpdate",D)}break}case"MessageRemoveReaction":{const y=this.client.channels.get(d.channel_id),D=y==null?void 0:y.messages.get(d.id);D&&(delete D.source.reactions[d.emoji_id],D.update({reactions:D.source.reactions}),this.client.emit("messageUpdate",D));break}case"BulkMessageDelete":{const y=this.client.channels.get(d.channel);if(y)for(const D of d.ids){const Z=y.messages.get(D);y.messages.delete(D),this.client.emit("messageDelete",D,Z)}break}case"ChannelCreate":{if(d.channel_type==="TextChannel"||d.channel_type==="VoiceChannel"){const y=await this.client.servers.fetch(d.server);y.update({channels:[...y.source.channels||[],d._id]})}this.client.emit("channelCreate",this.client.channels.construct(d));break}case"ChannelUpdate":{const y=this.client.channels.get(d.id);y&&((w=d.clear)==null||w.forEach(D=>delete y.source[D]),this.client.emit("channelUpdate",y.update(d.data)));break}case"ChannelDelete":{const y=this.client.channels.get(d.id);this.client.channels.delete(d.id),this.client.emit("channelDelete",d.id,y);break}case"ChannelGroupJoin":{const y=this.client.channels.get(d.id);if(y!=null&&y.isGroupDM()){const D=await this.client.users.fetch(d.user);if(D){const Z=new Set(y.source.recipients);Z.add(d.user),y.update({recipients:[...Z]}),this.client.emit("groupMemberJoin",y,D)}}break}case"ChannelGroupLeave":{const y=this.client.channels.get(d.id);if(y!=null&&y.isGroupDM())if(d.user===this.client.user.id)this.client.channels.delete(y.id),this.client.emit("groupExited",y);else{const D=await this.client.users.fetch(d.user);if(D){const Z=new Set(y.source.recipients);Z.delete(d.user),y.update({recipients:[...Z]}),this.client.emit("groupMemberLeave",y,D)}}break}case"ServerCreate":{for(const y of d.channels)await this.client.channels.fetch(y._id,y);this.client.emit("serverCreate",await this.client.servers.fetch(d.id,d.server));break}case"ServerUpdate":{const y=await this.client.servers.fetch(d.id);y&&((g=d.clear)==null||g.forEach(D=>delete y.source[D]),this.client.emit("serverUpdate",y.update(d.data)));break}case"ServerDelete":{const y=this.client.servers.get(d.id);this.client.servers.delete(d.id),this.client.emit("serverExited",d.id,y);break}case"ServerMemberJoin":{const y=await this.client.servers.fetch(d.id);await this.client.users.fetch(d.user),this.client.emit("serverMemberJoin",y.members.construct({_id:{server:d.id,user:d.user},joined_at:new Date().toISOString()}));break}case"ServerMemberLeave":{const y=this.client.servers.get(d.id);d.user==this.client.user.id?(this.client.servers.delete(d.id),this.client.emit("serverExited",d.id,y)):(y.members.delete(d.id),this.client.emit("serverMemberLeave",y,await this.client.users.fetch(d.id)));break}case"ServerMemberUpdate":{const y=await this.client.servers.fetch(d.id.server),D=y.members.get(d.id.user);D&&((b=d.clear)==null||b.forEach(Z=>delete D.source[Z]),this.client.emit("serverMemberUpdate",D.update(d.data)));break}case"ServerRoleUpdate":{const y=await this.client.servers.fetch(d.id);if(y){const D=!y.roles.get(d.role_id);y.update({roles:{...y.source.roles,[d.role_id]:{...(E=y.source.roles)==null?void 0:E[d.role_id],...d.data}}}),this.client.emit(D?"serverRoleCreate":"serverRoleUpdate",y.roles.get(d.role_id))}break}case"ServerRoleDelete":{const y=await this.client.servers.fetch(d.id);if(y){const D=y.roles.get(d.role_id);D&&((M=y.source.roles)==null||delete M[d.role_id],y.update({roles:y.source.roles}),this.client.emit("serverRoleDelete",D))}break}case"UserUpdate":{const y=this.client.users.get(d.id);y&&((P=d.clear)==null||P.forEach(D=>delete y.source[D]),y.update(d.data),this.client.emit("userUpdate",y));break}case"UserRelationship":{const y=this.client.users.get(d.user._id);y?(y.update({...d.user,relationship:d.status}),this.client.emit("userRelationshipUpdate",y)):this.client.emit("userRelationshipUpdate",this.client.users.construct(d.user));break}case"EmojiCreate":{this.client.emit("emojiCreate",this.client.emojis.construct(d));break}case"EmojiDelete":{const y=this.client.emojis.get(d.id);this.client.emojis.delete(d.id),this.client.emit("emojiDelete",d.id,y);break}case"ChannelAck":{const y=this.client.channels.get(d.id);y&&this.client.unreads.markRead(y,d.message_id,!1);break}case"ChannelStartTyping":{const y=this.client.channels.get(d.id),D=await this.client.users.fetch(d.user);y&&D&&(y.typingIDs.add(D.id),clearTimeout(c[y.id+D.id]),c[y.id+D.id]=setTimeout(()=>{y.typingIDs.delete(D.id)},3e3),this.client.emit("channelStartTyping",y,D));break}case"ChannelStopTyping":{const y=this.client.channels.get(d.id),D=await this.client.users.fetch(d.user);y&&D&&(y.typingIDs.delete(D.id),clearTimeout(c[y.id+D.id]),this.client.emit("channelStopTyping",y,D));break}case"Pong":{this.ping=+new Date-d.data;break}default:this.client.options.debug&&console.warn(`Warning: Unhandled packet! ${d.type}`)}}catch(y){console.error(y)}},c={},u=async d=>{const h=d.data;if(typeof h!="string")return;this.client.options.debug&&console.debug("[>>] Incoming Packet",h);const p=JSON.parse(h);await a(p)};let o=!1;const l=[];this.ws.onmessage=async d=>{if(l.push(d),!o){for(o=!0;l.length>0;)await u(l.shift());o=!1}},this.ws.onerror=d=>i(d),this.ws.onclose=()=>{this.client.emit("disconnected"),this.connected=!1,this.ready=!1,Object.keys(c).map(d=>c[d]).forEach(clearTimeout),this.client.users.forEach(d=>d.update({online:!1})),this.client.channels.forEach(d=>(d.typingIDs.clear(),d.update())),!e&&this.client.options.reconnect&&TR(()=>this.connect(!0)).catch(i)}})}}const ER={apiURL:"https://api.revolt.chat",debug:!1,heartbeat:30,reconnect:!0};class Ca extends mo{constructor(t){super();T(this,"api");T(this,"options");T(this,"config");T(this,"session");T(this,"ws");T(this,"channels");T(this,"emojis");T(this,"servers");T(this,"unreads");T(this,"users");this.options={...ER,...t},this.setup(),this.api=new vd({baseURL:this.options.apiURL}),this.ws=new CR(this)}get user(){return this.users.self}async uploadAttachment(t,s,n="attachments"){var c,u;if(await this.fetchConfiguration(),!this.config.features.autumn.enabled)throw"Autumn is not enabled!";const i=new Cv;return i.append("file",s,t),(u=(await mn.post(`${this.config.features.autumn.url}/${n}`,i,{headers:((c=i.getHeaders)==null?void 0:c.call(i))||{},data:i})).data)==null?void 0:u.id}proxyFile(t){var s;return(s=this.config)!=null&&s.features.january.enabled?`${this.config.features.january.url}/proxy?url=${encodeURIComponent(t)}`:null}async createServer(t){const{server:s,channels:n}=await this.api.post("/servers/create",t);return await this.servers.fetch(s._id,s,n)}async createGroup(t){const s=await this.api.post("/channels/create",t);return await this.channels.fetch(s._id,s)}async editUser(t){return this.user.update(await this.api.patch("/users/@me",t))}async changeUsername(t){return this.user.update(await this.api.patch("/users/@me/username",t))}async fetchInvite(t){const s=await this.api.get(`/invites/${t}`);return new pR(this,{_id:s.code,...s})}async acceptInvite(t){if(typeof t!="string")switch(t.type){case"Group":{const n=this.channels.get(t.channel.id);if(n!=null&&n.isGroupDM())return n;break}case"Server":{const n=this.servers.get(t.server.id);if(n)return n}}const s=await this.api.post(`/invites/${typeof t=="string"?t:t.id}`);return s.type==="Server"?await this.servers.fetch(s.server._id,s.server,s.channels):null}async login(t,s,n=!0,i){this.session={token:t,type:s,id:(i==null?void 0:i.id)||Rs(),name:(i==null?void 0:i.name)||""},this.api=new vd({baseURL:this.options.apiURL,authentication:{revolt:s=="user"?{token:t}:t}}),await this.fetchConfiguration(),n&&await this.ws.connect()}async authenticate(t){await this.fetchConfiguration();const s=this,n=await this.api.post("/auth/session/login",t);if(n.result==="Success"){await this.login(n.token,"user",!1);const{onboarding:i}=await this.api.get("/onboard/hello");return i?{type:"onboard",async respond(a,c=!0){await s.api.post("/onboard/complete",{username:a}),c&&await s.login(n.token,"user",!0,{name:n.name,id:n._id})}}:(await this.login(n.token,"user",!0,{name:n.name,id:n._id}),{type:"none"})}else if(n.result=="MFA")return{type:"mfa",ticket:n.ticket,methods:n.allowed_methods,async respond(i){return await s.authenticate({mfa_ticket:n.ticket,mfa_response:{totp_code:i},friendly_name:t.friendly_name})}}}get mfa(){const t=this;function s(i){return{headers:{"X-MFA-Ticket":i}}}const n={async status(){return{hasRecovery:(await t.api.get("/auth/mfa/")).recovery_active}},async allowedMethods(){return await t.api.get("/auth/mfa/methods")},async generateTicket(i){const a=await t.api.put("/auth/mfa/ticket",i);return{id:a._id,accountID:a.account_id,token:a.token,validated:a.validated,authorized:!!a.authorised,lastTOTPCode:a.last_totp_code??null}},async generateTOTPSecret(i){return(await t.api.post("/auth/mfa/totp",void 0,s(i))).secret},async enableTOTP(i,a){return await t.api.put("/auth/mfa/totp",{totp_code:a},s(i))},async disableTOTP(i){await t.api.delete("/auth/mfa/totp",{},s(i))},async fetchRecoveryCodes(i){return(await n.status()).hasRecovery?await t.api.post("/auth/mfa/recovery",void 0,s(i)):await n.generateRecoveryCodes(i)},async generateRecoveryCodes(i){return await t.api.patch("/auth/mfa/recovery",void 0,s(i))}};return n}async syncFetchSettings(t){return await this.api.post("/sync/settings/fetch",{keys:t})}async syncSetSettings(t,s){const n={};for(const i of Object.keys(t)){const a=t[i];n[i]=typeof a=="string"?a:JSON.stringify(a)}await this.api.post("/sync/settings/set",{...n,timestamp:s})}async fetchConfiguration(t=!1){(!this.config||t)&&(this.config=await this.api.get("/"))}async fetchAutumnConfiguration(){return await this.fetchConfiguration(),this.config.features.autumn.enabled?(await mn.get(this.config.features.autumn.url)).data:null}async fetchJanuaryConfiguration(){return await this.fetchConfiguration(),this.config.features.january.enabled?(await mn.get(this.config.features.january.url)).data:null}async fetchVortexConfiguration(){return await this.fetchConfiguration(),this.config.features.voso.enabled?(await mn.get(this.config.features.voso.url)).data:null}setup(){this.channels=new eR(this),this.emojis=new aR(this),this.servers=new oR(this),this.unreads=new Lh(this),this.users=new hR(this)}async destroy(t=!1){this.emit("destroyed"),t&&await this.api.post("/auth/session/logout"),this.ws.disconnect(),delete this.session,this.setup()}on(t,s,n){return super.on(t,s,n)}once(t,s,n){return super.once(t,s,n)}}var bs;(function(r){r[r.CHANNEL=0]="CHANNEL",r[r.EMOJI=1]="EMOJI",r[r.USER=2]="USER"})(bs||(bs={}));bs.CHANNEL,bs.EMOJI,bs.USER;var ul;(function(r){r["01:37"]="t",r["01:37:42"]="T",r["22 September 2022"]="D",r["22 September 2022 01:37"]="f",r["Thursday, 22 September 2022 01:37"]="F",r["in 9 months"]="R"})(ul||(ul={}));var $r;(function(r){r.UserJoined="UserJoined",r.UserLeft="UserLeft",r.UserStartProduce="UserStartProduce",r.UserStopProduce="UserStopProduce"})($r||($r={}));var rt;(function(r){r.Authenticate="Authenticate",r.RoomInfo="RoomInfo",r.InitializeTransports="InitializeTransports",r.ConnectTransport="ConnectTransport",r.StartProduce="StartProduce",r.StopProduce="StopProduce",r.StartConsume="StartConsume",r.StopConsume="StopConsume",r.SetConsumerPause="SetConsumerPause"})(rt||(rt={}));var Ja;(function(r){r[r.NotConnected=0]="NotConnected",r[r.NotFound=404]="NotFound",r[r.TransportConnectionFailure=601]="TransportConnectionFailure",r[r.ProducerFailure=611]="ProducerFailure",r[r.ProducerNotFound=614]="ProducerNotFound",r[r.ConsumerFailure=621]="ConsumerFailure",r[r.ConsumerNotFound=624]="ConsumerNotFound"})(Ja||(Ja={}));var hl;(function(r){r[r.InvalidData=1003]="InvalidData",r[r.Unauthorized=4001]="Unauthorized",r[r.RoomClosed=4004]="RoomClosed",r[r.InvalidState=1002]="InvalidState",r[r.ServerError=1011]="ServerError"})(hl||(hl={}));var ke;(function(r){r[r.UNAVAILABLE=0]="UNAVAILABLE",r[r.UNLOADED=1]="UNLOADED",r[r.LOADING=2]="LOADING",r[r.READY=3]="READY",r[r.CONNECTING=4]="CONNECTING",r[r.AUTHENTICATING=5]="AUTHENTICATING",r[r.RTC_CONNECTING=6]="RTC_CONNECTING",r[r.CONNECTED=7]="CONNECTED"})(ke||(ke={}));class MR extends mo{constructor(){super();T(this,"ws",null);T(this,"index",0);T(this,"pending",new Map)}get connected(){return!!this.ws&&this.ws.readyState!==nr.CLOSING&&this.ws.readyState!==nr.CLOSED}connect(t){this.disconnect(),this.ws=new nr(t),this.ws.onopen=n=>this.emit("open",n),this.ws.onclose=n=>this.emit("close",n),this.ws.onerror=n=>this.emit("error",n),this.ws.onmessage=n=>this.parseData(n);let s=!1;return new Promise((n,i)=>{this.once("open",()=>{s||(s=!0,n())}),this.once("error",()=>{s||(s=!0,i())})})}disconnect(){var t;this.connected&&((t=this.ws)==null||t.close(1e3))}parseData(t){if(typeof t.data!="string")return;const s=JSON.parse(t.data),n=this.pending.get(s.id);if(n===void 0){this.emit("data",s);return}n(s)}sendRequest(t,s){if(!this.ws||this.ws.readyState!==nr.OPEN)return Promise.reject({error:Ja.NotConnected});const n=this.ws;return new Promise((i,a)=>{for(this.index>=2**32&&(this.index=0);this.pending.has(this.index);)this.index++;const c=l=>{a({error:l.code,message:l.reason})},u=l=>{this.removeListener("close",c),l.error&&a({error:l.error,message:l.message,data:l.data}),i(l.data)};this.pending.set(this.index,u),this.once("close",c);const o={id:this.index,type:t,data:s};n.send(`${JSON.stringify(o)}
`),this.index++})}authenticate(t,s){return this.sendRequest(rt.Authenticate,{token:t,roomId:s})}async roomInfo(){const t=await this.sendRequest(rt.RoomInfo);return{id:t.id,videoAllowed:t.videoAllowed,users:t.users}}initializeTransports(t){return this.sendRequest(rt.InitializeTransports,{mode:"SplitWebRTC",rtpCapabilities:t})}connectTransport(t,s){return this.sendRequest(rt.ConnectTransport,{id:t,dtlsParameters:s})}async startProduce(t,s){return(await this.sendRequest(rt.StartProduce,{type:t,rtpParameters:s})).producerId}stopProduce(t){return this.sendRequest(rt.StopProduce,{type:t})}startConsume(t,s){return this.sendRequest(rt.StartConsume,{type:s,userId:t})}stopConsume(t){return this.sendRequest(rt.StopConsume,{id:t})}setConsumerPause(t,s){return this.sendRequest(rt.SetConsumerPause,{id:t,paused:s})}}let OR=class extends mo{constructor(t,s,n,i,a){super();T(this,"platform");T(this,"msc");T(this,"createDevice");T(this,"consumeTrack");T(this,"supported",!1);T(this,"device");T(this,"signaling",new MR);T(this,"sendTransport",null);T(this,"recvTransport",null);T(this,"consumers",new Map);T(this,"audioProducer");T(this,"_deafened",!1);T(this,"participants",new Ao);T(this,"status",ke.UNLOADED);T(this,"sessionDetails",null);T(this,"client",new Ca);T(this,"channelID",null);this.platform=t,this.msc=n,this.createDevice=i,this.consumeTrack=a,this.supported=this.msc.detectDevice()!==void 0,s instanceof Ca?this.client=s:(this.client=new Ca(s.apiURL?{apiURL:s.apiURL}:void 0),this.sessionDetails={token:s.token,type:s.type}),this.signaling.on("data",async({type:c,data:u})=>{switch(c){case $r.UserJoined:{const o=await this.client.users.fetch(u.id);if(o){const l={user:o,audio:!1};this.participants.set(u.id,l),this.participants.fireUpdate([l]),this.emit("userJoined",l)}else this.emit("error",new Error(`Invalid voice channel participant: ${u.id}`));break}case $r.UserLeft:{const o=this.participants.get(u.id);if(!o)return;this.participants.delete(u.id),this.participants.fireUpdate([o]),this.recvTransport&&this.stopConsume(u.id),this.emit("userLeft",o);break}case $r.UserStartProduce:{const o=this.participants.get(u.id);if(!o||o.user.id==this.client.user.id||!u.type)return;u.type in o&&(o[u.type]=!0),this.participants.fireUpdate([o]),this.recvTransport&&await this.startConsume(u.id,u.type),this.emit("userStartProduce",o,u.type);break}case $r.UserStopProduce:{const o=this.participants.get(u.id);if(!o||!u.type)return;u.type in o&&(o[u.type]=!1),this.participants.fireUpdate([o]),this.recvTransport&&this.stopConsume(u.id,u.type),this.emit("userStopProduce",o,u.type);break}}},this),this.signaling.on("error",()=>{this.emit("error",new Error("Signaling error"))},this),this.signaling.on("close",c=>{this.disconnectTransport({error:c.code,message:c.reason},!0)},this),this.supported?this.setStatus(ke.READY):this.setStatus(ke.UNAVAILABLE)}get deafened(){return this._deafened}get connected(){return this.status==ke.CONNECTED&&!!this.channelID}get channel(){return this.channelID?this.client.channels.get(this.channelID):void 0}throwIfUnsupported(){if(!this.supported)throw new this.msc.types.UnsupportedError("RTC not supported")}connectTransport(t,s){return this.throwIfUnsupported(),this.device=this.createDevice(),this.channelID=s,this.signaling.connect(t)}disconnectTransport(t,s=!1){!this.signaling.connected&&!s||(this.signaling.disconnect(),this.participants.clear(),this.participants.fireUpdate([]),this.consumers.clear(),this.channelID=null,this.audioProducer=void 0,this.sendTransport&&this.sendTransport.close(),this.recvTransport&&this.recvTransport.close(),this.sendTransport=null,this.recvTransport=null,this.emit("close",t))}async authenticate(t){if(this.throwIfUnsupported(),!this.device||!this.channelID)throw new ReferenceError("Voice client is in an invalid state");const s=await this.signaling.authenticate(t,this.channelID),[n]=await Promise.all([this.signaling.roomInfo(),this.device.load({routerRtpCapabilities:s.rtpCapabilities})]);s.userId!==this.client.user.id&&this.emit("error",new Error("Authenticated user ID does not match client user ID.")),await Promise.all(Object.entries(n.users).map(async([i,a])=>{const c=await this.client.users.fetch(i);c?this.participants.set(i,{user:c,audio:!!a.audio}):this.emit("error",new Error(`Invalid voice user: ${i}`))})),this.participants.fireUpdate([...this.participants.values()])}async initializeTransports(){if(this.throwIfUnsupported(),!this.device)throw new ReferenceError("Voice client is in an invalid state");const t=await this.signaling.initializeTransports(this.device.rtpCapabilities);this.sendTransport=this.device.createSendTransport(t.sendTransport),this.recvTransport=this.device.createRecvTransport(t.recvTransport);const s=n=>{n.on("connect",({dtlsParameters:i},a,c)=>{this.signaling.connectTransport(n.id,i).then(a).catch(c)})};s(this.sendTransport),s(this.recvTransport),this.sendTransport.on("produce",(n,i,a)=>{const c=n.appData.type;if(n.kind==="audio"&&c!=="audio"&&c!=="saudio")return a==null?void 0:a(new Error("err"));if(n.kind==="video"&&c!=="video"&&c!=="svideo")return a==null?void 0:a(new Error("err"));this.signaling.startProduce(c,n.rtpParameters).then(u=>i({id:u})).catch(a)}),this.emit("ready"),this.participants.forEach(async n=>{n.audio&&n.user.id!==this.client.user.id&&(await this.startConsume(n.user.id,"audio"),this.emit("userStartProduce",n,"audio"))})}async startConsume(t,s){if(!this.consumeTrack)return;if(!this.recvTransport)throw new Error("Receive transport undefined");const n=this.consumers.get(t)||{},i=await this.signaling.startConsume(t,s),a=await this.recvTransport.consume(i);switch(s){case"audio":this.deafened&&a.pause(),n.audio={consumer:a,callback:this.consumeTrack(s,a.track)}}await this.signaling.setConsumerPause(a.id,!1),this.consumers.set(t,n)}async stopConsume(t,s){const n=this.consumers.get(t);if(n)if(!s)n.audio&&(n.audio.consumer.close(),n.audio.callback()),this.consumers.delete(t);else{switch(s){case"audio":{n.audio&&(n.audio.consumer.close(),n.audio.callback(),this.signaling.stopConsume(n.audio.consumer.id)),n.audio=void 0;break}}this.consumers.set(t,n)}}async startProduce(t,s){if(!this.sendTransport)throw new Error("Send transport undefined");const n=await this.sendTransport.produce({track:s,appData:{type:t}});switch(t){case"audio":this.audioProducer=n;break}const i=this.participants.get(this.client.user.id);i&&(i[t]=!0,this.participants.set(this.client.user.id,i),this.participants.fireUpdate([i])),this.emit("startProduce",t)}async stopProduce(t){let s;switch(t){case"audio":s=this.audioProducer,this.audioProducer=void 0;break}s&&!s.closed&&(s.close(),this.emit("stopProduce",t));const n=this.participants.get(this.client.user.id);n&&(n[t]=!1,this.participants.set(this.client.user.id,n),this.participants.fireUpdate([n]));try{await this.signaling.stopProduce(t)}catch(i){if(i.error==="ProducerNotFound")return;this.emit("error",i)}}setStatus(t){this.status=t,this.emit("status",t)}async connect(t){var i,a;this.client.session||this.sessionDetails&&(await this.client.login(this.sessionDetails.token,this.sessionDetails.type,!1),await this.client.users.fetch("@me"));const s=typeof t=="string"?await this.client.channels.fetch(t):t;if(this.status>ke.READY)return;if(!this.supported)throw new Error("RTC is unavailable.");if(!s.isVoice()&&!s.isDMBased())throw new Error("Not a voice or (Group) DM channel.");if(await this.client.fetchConfiguration(),!((a=(i=this.client.config)==null?void 0:i.features.voso)!=null&&a.enabled?this.client.config.features.voso.ws:null))throw this.setStatus(ke.UNAVAILABLE),new Error("Vortex is not enabled on target server.");this.setStatus(ke.CONNECTING);try{const c=await s.joinCall();await this.connectTransport(s.client.config.features.voso.ws,s.id),this.setStatus(ke.AUTHENTICATING),await this.authenticate(c),this.setStatus(ke.RTC_CONNECTING),await this.initializeTransports()}catch(c){return this.emit("error",c instanceof Error?c:new Error(String(c))),this.setStatus(ke.READY),this}return this.setStatus(ke.CONNECTED),this.emit("connected"),this}disconnect(){this.disconnectTransport(),this.setStatus(ke.READY)}isProducing(t){switch(t){case"audio":return!!this.audioProducer;default:return!1}}async startDeafen(){this.deafened||(this._deafened=!0,this.consumers.forEach(t=>{var s;(s=t.audio)==null||s.consumer.pause()}),this.emit("selfDeafenUpdate",!0))}async stopDeafen(){this.deafened&&(this._deafened=!1,this.consumers.forEach(t=>{var s;(s=t.audio)==null||s.consumer.resume()}),this.emit("selfDeafenUpdate",!1))}};const PR=(r,e)=>{if(r=="audio"){const t=new MediaStream([e]),s=new Audio;return s.srcObject=t,s.load(),s.play(),()=>s.pause()}return()=>{}};class xR extends OR{constructor(e,t){super("browser",e,ow,()=>new Un.Device,t)}async play(e,t){switch(e){case"audio":{if(this.audioProducer)throw"Already producing audio.";try{if(!(t instanceof MediaStreamTrack)){if(navigator.mediaDevices===void 0)throw"No media devices.";t=(await navigator.mediaDevices.getUserMedia({audio:t?{deviceId:t}:!0})).getAudioTracks()[0]}await this.startProduce("audio",t)}catch(s){throw"WebRTC Error: "+s}break}}}}function kR(r){return{c:Le,l:Le,m:Le,p:Le,i:Le,o:Le,d:Le}}function IR(r){let e;const t=r[5].default,s=df(t,r,r[4],null);return{c(){s&&s.c()},l(n){s&&s.l(n)},m(n,i){s&&s.m(n,i),e=!0},p(n,i){s&&s.p&&(!e||i&16)&&lf(s,t,n,n[4],e?hf(t,n[4],i,null):uf(n[4]),null)},i(n){e||(ml(s,n),e=!0)},o(n){gl(s,n),e=!1},d(n){s&&s.d(n)}}}function LR(r){return{c:Le,l:Le,m:Le,p:Le,i:Le,o:Le,d:Le}}function AR(r){let e,t,s={ctx:r,current:null,token:null,hasCatch:!1,pending:LR,then:IR,catch:kR,blocks:[,,,]};return _f(yf(),s),{c(){e=uc(),s.block.c()},l(n){e=uc(),s.block.l(n)},m(n,i){mf(n,e,i),s.block.m(n,s.anchor=i),s.mount=()=>e.parentNode,s.anchor=e,t=!0},p(n,[i]){r=n,wf(s,r,i)},i(n){t||(ml(s.block),t=!0)},o(n){for(let i=0;i<3;i+=1){const a=s.blocks[i];gl(a)}t=!1},d(n){n&&gf(e),s.block.d(n),s.token=null,s=null}}}function NR(r,e,t){let s,n,{$$slots:i={},$$scope:a}=e;const c=Ai(Tf);tn(vf,c);const u=Ai(JSON.parse(localStorage.getItem("session")||"null"));lc(r,u,d=>t(2,s=d)),tn(bf,u);const o=new If;tn(Sf,o);const l=Ai();return lc(r,l,d=>t(3,n=d)),tn(Rf,l),r.$$set=d=>{"$$scope"in d&&t(4,a=d.$$scope)},r.$$.update=()=>{if(r.$$.dirty&12)if(s==null)o.websocket.disconnect(),n==null||n.disconnect();else{const{token:d}=s;l.set(new xR({token:d,type:"user"},PR)),o.authenticate(d)}r.$$.dirty&4&&s==null&&_l(`${wl}/login`)},[u,l,s,n,a,i]}class XR extends pf{constructor(e){super(),ff(this,e,NR,AR,cf,{})}}export{XR as component,ZR as universal};
