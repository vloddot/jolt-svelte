import{s as X,v as ge,f as V,g as H,h as N,d as v,j as a,i as j,z as C,A as T,B as we,w as ve,x as be,y as ke,C as Se,D as Ie,E as q,F as P,u as b,a as U,c as J,G as je,r as ee,o as ye,H as Oe,e as G,I as te,l as re,m as se,n as $e}from"../chunks/scheduler.7420d6ca.js";import{h as De,u as Ee}from"../chunks/await_block.08f6cb26.js";import{e as ae}from"../chunks/each.e59479a4.js";import{S as Y,i as Z,a as I,t as O,b as M,d as A,m as B,c as ie,e as R,g as ce}from"../chunks/index.637134e4.js";import{g as Ce}from"../chunks/navigation.5c9a8279.js";import{e as K}from"../chunks/singletons.8057edd0.js";import{g as ue,s as Ne}from"../chunks/context.92045884.js";import{g as Ve,a as fe}from"../chunks/util.184f0dfd.js";import{t as He,P as Le}from"../chunks/PlusIcon.a9ccaab6.js";import{s as Me}from"../chunks/context.527da73b.js";import{s as Ae,c as Be}from"../chunks/context.645f4abc.js";import{w as Re}from"../chunks/index.5b89e149.js";import{p as We}from"../chunks/stores.012f75bb.js";function Ue(l){let e,r,t,s,n,o,c;const g=l[7].default,u=ge(g,l,l[6],null);return{c(){e=V("div"),r=V("a"),u&&u.c(),this.h()},l(f){e=H(f,"DIV",{class:!0,"data-focused":!0,"data-selected":!0,"data-unread":!0,"aria-selected":!0});var m=N(e);r=H(m,"A",{href:!0,tabindex:!0,"aria-label":!0,class:!0});var d=N(r);u&&u.l(d),d.forEach(v),m.forEach(v),this.h()},h(){a(r,"href",l[0]),a(r,"tabindex","0"),a(r,"aria-label",t=typeof l[1]=="string"&&l[2]!=null?l[1]:l[2]),a(r,"class","server-sidebar-icon svelte-1avlg8k"),a(e,"class","server-sidebar-icon-base svelte-1avlg8k"),a(e,"data-focused",l[5]),a(e,"data-selected",l[3]),a(e,"data-unread",l[4]),a(e,"aria-selected",l[3])},m(f,m){j(f,e,m),C(e,r),u&&u.m(r,null),n=!0,o||(c=[T(r,"mouseenter",l[8]),T(r,"mouseleave",l[9]),T(r,"focus",l[10]),T(r,"blur",l[11]),we(s=He.call(null,r,{placement:"right",content:l[1],theme:"right-tooltip",animation:"scale-subtle",duration:100}))],o=!0)},p(f,[m]){u&&u.p&&(!n||m&64)&&ve(u,g,f,f[6],n?ke(g,f[6],m,null):be(f[6]),null),(!n||m&1)&&a(r,"href",f[0]),(!n||m&6&&t!==(t=typeof f[1]=="string"&&f[2]!=null?f[1]:f[2]))&&a(r,"aria-label",t),s&&Se(s.update)&&m&2&&s.update.call(null,{placement:"right",content:f[1],theme:"right-tooltip",animation:"scale-subtle",duration:100}),(!n||m&32)&&a(e,"data-focused",f[5]),(!n||m&8)&&a(e,"data-selected",f[3]),(!n||m&16)&&a(e,"data-unread",f[4]),(!n||m&8)&&a(e,"aria-selected",f[3])},i(f){n||(I(u,f),n=!0)},o(f){O(u,f),n=!1},d(f){f&&v(e),u&&u.d(f),o=!1,Ie(c)}}}function Je(l,e,r){let{$$slots:t={},$$scope:s}=e,{href:n}=e,{tooltip:o}=e,{ariaLabel:c=void 0}=e,{selected:g}=e,{unread:u=!1}=e,f=!1;const m=()=>r(5,f=!0),d=()=>r(5,f=!1),D=()=>r(5,f=!0),E=()=>r(5,f=!1);return l.$$set=_=>{"href"in _&&r(0,n=_.href),"tooltip"in _&&r(1,o=_.tooltip),"ariaLabel"in _&&r(2,c=_.ariaLabel),"selected"in _&&r(3,g=_.selected),"unread"in _&&r(4,u=_.unread),"$$scope"in _&&r(6,s=_.$$scope)},[n,o,c,g,u,f,s,t,m,d,D,E]}class F extends Y{constructor(e){super(),Z(this,e,Je,Ue,X,{href:0,tooltip:1,ariaLabel:2,selected:3,unread:4})}}function Ke(l){let e,r;return{c(){e=q("svg"),r=q("path"),this.h()},l(t){e=P(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var s=N(e);r=P(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(r).forEach(v),s.forEach(v),this.h()},h(){a(r,"stroke-linecap","round"),a(r,"stroke-linejoin","round"),a(r,"d","M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(t,s){j(t,e,s),C(e,r)},p:b,i:b,o:b,d(t){t&&v(e)}}}class ze extends Y{constructor(e){super(),Z(this,e,null,Ke,X,{})}}function Ge(l){let e,r,t;return{c(){e=q("svg"),r=q("path"),t=q("path"),this.h()},l(s){e=P(s,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var n=N(e);r=P(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(r).forEach(v),t=P(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(v),n.forEach(v),this.h()},h(){a(r,"stroke-linecap","round"),a(r,"stroke-linejoin","round"),a(r,"d","M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"),a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(s,n){j(s,e,n),C(e,r),C(e,t)},p:b,i:b,o:b,d(s){s&&v(e)}}}class qe extends Y{constructor(e){super(),Z(this,e,null,Ge,X,{})}}function _e(l,e,r){const t=l.slice();return t[9]=e[r],t}function Pe(l){const e=l.slice(),r=e[9].name.split(" ");return e[12]=r,e}function Fe(l){let e,r,t={ctx:l,current:null,token:null,hasCatch:!1,pending:Ze,then:Xe,catch:Qe,value:13,blocks:[,,,]};return De(l[5].user??l[5].api.fetchUser("@me"),t),{c(){e=G(),t.block.c()},l(s){e=G(),t.block.l(s)},m(s,n){j(s,e,n),t.block.m(s,t.anchor=n),t.mount=()=>e.parentNode,t.anchor=e,r=!0},p(s,n){l=s,Ee(t,l,n)},i(s){r||(I(t.block),r=!0)},o(s){for(let n=0;n<3;n+=1){const o=t.blocks[n];O(o)}r=!1},d(s){s&&v(e),t.block.d(s),t.token=null,t=null}}}function Te(l){var n;let e,r,t,s;return e=new F({props:{selected:((n=l[3].route.id)==null?void 0:n.startsWith("/(app)/(home)"))??!1,href:K+"/",tooltip:"Home",$$slots:{default:[xe]},$$scope:{ctx:l}}}),{c(){M(e.$$.fragment),r=U(),t=V("hr")},l(o){A(e.$$.fragment,o),r=J(o),t=H(o,"HR",{})},m(o,c){B(e,o,c),j(o,r,c),j(o,t,c),s=!0},p(o,c){var u;const g={};c&8&&(g.selected=((u=o[3].route.id)==null?void 0:u.startsWith("/(app)/(home)"))??!1),c&256&&(g.$$scope={dirty:c,ctx:o}),e.$set(g)},i(o){s||(I(e.$$.fragment,o),s=!0)},o(o){O(e.$$.fragment,o),s=!1},d(o){o&&(v(r),v(t)),R(e,o)}}}function Qe(l){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function Xe(l){var n;let e,r,t,s;return e=new F({props:{href:K+"/",selected:((n=l[3].route.id)==null?void 0:n.startsWith("/(app)/(home)"))??!1,ariaLabel:"Home",tooltip:l[13].username+"#"+l[13].discriminator,$$slots:{default:[Ye]},$$scope:{ctx:l}}}),{c(){M(e.$$.fragment),r=U(),t=V("hr")},l(o){A(e.$$.fragment,o),r=J(o),t=H(o,"HR",{})},m(o,c){B(e,o,c),j(o,r,c),j(o,t,c),s=!0},p(o,c){var u;const g={};c&8&&(g.selected=((u=o[3].route.id)==null?void 0:u.startsWith("/(app)/(home)"))??!1),c&256&&(g.$$scope={dirty:c,ctx:o}),e.$set(g)},i(o){s||(I(e.$$.fragment,o),s=!0)},o(o){O(e.$$.fragment,o),s=!1},d(o){o&&(v(r),v(t)),R(e,o)}}}function Ye(l){let e,r;return{c(){e=V("img"),this.h()},l(t){e=H(t,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){a(e,"class","cover"),te(e.src,r=Ve(l[13]))||a(e,"src",r),a(e,"alt","Home"),a(e,"width","42px"),a(e,"height","42px")},m(t,s){j(t,e,s)},p:b,d(t){t&&v(e)}}}function Ze(l){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function xe(l){let e,r;return e=new ze({}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function et(l){let e,r,t;return{c(){e=V("img"),this.h()},l(s){e=H(s,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){a(e,"class","cover"),te(e.src,r=fe(l[9].icon,{max_side:"256"}))||a(e,"src",r),a(e,"alt",t=l[9].name),a(e,"width","42px"),a(e,"height","42px")},m(s,n){j(s,e,n)},p(s,n){n&1&&!te(e.src,r=fe(s[9].icon,{max_side:"256"}))&&a(e,"src",r),n&1&&t!==(t=s[9].name)&&a(e,"alt",t)},d(s){s&&v(e)}}}function me(l){let e;function r(n,o){return n[12].length>3?rt:tt}let t=r(l),s=t(l);return{c(){s.c(),e=G()},l(n){s.l(n),e=G()},m(n,o){s.m(n,o),j(n,e,o)},p(n,o){t===(t=r(n))&&s?s.p(n,o):(s.d(1),s=t(n),s&&(s.c(),s.m(e.parentNode,e)))},d(n){n&&v(e),s.d(n)}}}function tt(l){let e=l[12].map(pe).join("")+"",r;return{c(){r=re(e)},l(t){r=se(t,e)},m(t,s){j(t,r,s)},p(t,s){s&1&&e!==(e=t[12].map(pe).join("")+"")&&$e(r,e)},d(t){t&&v(r)}}}function rt(l){let e=l[12].slice(0,3).map(he).join("")+"",r,t;return{c(){r=re(e),t=re("...")},l(s){r=se(s,e),t=se(s,"...")},m(s,n){j(s,r,n),j(s,t,n)},p(s,n){n&1&&e!==(e=s[12].slice(0,3).map(he).join("")+"")&&$e(r,e)},d(s){s&&(v(r),v(t))}}}function st(l){let e;function r(o,c){return o[9].icon==null||o[1]["jolt:low-data-mode"]?me:et}function t(o,c){return c===me?Pe(o):o}let s=r(l),n=s(t(l,s));return{c(){n.c(),e=G()},l(o){n.l(o),e=G()},m(o,c){n.m(o,c),j(o,e,c)},p(o,c){s===(s=r(o))&&n?n.p(t(o,s),c):(n.d(1),n=s(t(o,s)),n&&(n.c(),n.m(e.parentNode,e)))},d(o){o&&v(e),n.d(o)}}}function de(l){let e,r;return e=new F({props:{href:K+"/servers/"+l[9]._id+"/channels/"+l[9].channels[0],tooltip:l[9].name,selected:l[2]==l[9]._id,$$slots:{default:[st]},$$scope:{ctx:l}}}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},p(t,s){const n={};s&1&&(n.href=K+"/servers/"+t[9]._id+"/channels/"+t[9].channels[0]),s&1&&(n.tooltip=t[9].name),s&5&&(n.selected=t[2]==t[9]._id),s&259&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function lt(l){let e,r;return e=new Le({}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function nt(l){let e,r;return e=new qe({}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function ot(l){var le;let e,r,t,s,n,o,c,g,u,f,m,d,D;const E=[Te,Fe],_=[];function w(i,p){return i[1]["jolt:low-data-mode"]?0:1}t=w(l),s=_[t]=E[t](l);let $=ae(l[0]),h=[];for(let i=0;i<$.length;i+=1)h[i]=de(_e(l,$,i));const L=i=>O(h[i],1,1,()=>{h[i]=null});c=new F({props:{selected:l[3].route.id=="/(app)/servers/create",href:K+"/servers/create",tooltip:"Create Server",$$slots:{default:[lt]},$$scope:{ctx:l}}}),m=new F({props:{selected:((le=l[3].route.id)==null?void 0:le.startsWith("/(app)/settings"))??!1,href:K+"/settings",tooltip:"Settings",$$slots:{default:[nt]},$$scope:{ctx:l}}});const z=l[7].default,S=ge(z,l,l[8],null);return{c(){e=V("div"),r=V("div"),s.c(),n=U();for(let i=0;i<h.length;i+=1)h[i].c();o=U(),M(c.$$.fragment),g=U(),u=V("div"),f=U(),M(m.$$.fragment),d=U(),S&&S.c(),this.h()},l(i){e=H(i,"DIV",{class:!0});var p=N(e);r=H(p,"DIV",{class:!0});var k=N(r);s.l(k),n=J(k);for(let W=0;W<h.length;W+=1)h[W].l(k);o=J(k),A(c.$$.fragment,k),g=J(k),u=H(k,"DIV",{class:!0}),N(u).forEach(v),f=J(k),A(m.$$.fragment,k),k.forEach(v),d=J(p),S&&S.l(p),p.forEach(v),this.h()},h(){a(u,"class","flex-1"),a(r,"class","server-sidebar-container svelte-dknhv2"),a(e,"class","app-container svelte-dknhv2")},m(i,p){j(i,e,p),C(e,r),_[t].m(r,null),C(r,n);for(let k=0;k<h.length;k+=1)h[k]&&h[k].m(r,null);C(r,o),B(c,r,null),C(r,g),C(r,u),C(r,f),B(m,r,null),C(e,d),S&&S.m(e,null),D=!0},p(i,[p]){var ne;let k=t;if(t=w(i),t===k?_[t].p(i,p):(ce(),O(_[k],1,1,()=>{_[k]=null}),ie(),s=_[t],s?s.p(i,p):(s=_[t]=E[t](i),s.c()),I(s,1),s.m(r,n)),p&7){$=ae(i[0]);let y;for(y=0;y<$.length;y+=1){const oe=_e(i,$,y);h[y]?(h[y].p(oe,p),I(h[y],1)):(h[y]=de(oe),h[y].c(),I(h[y],1),h[y].m(r,o))}for(ce(),y=$.length;y<h.length;y+=1)L(y);ie()}const W={};p&8&&(W.selected=i[3].route.id=="/(app)/servers/create"),p&256&&(W.$$scope={dirty:p,ctx:i}),c.$set(W);const x={};p&8&&(x.selected=((ne=i[3].route.id)==null?void 0:ne.startsWith("/(app)/settings"))??!1),p&256&&(x.$$scope={dirty:p,ctx:i}),m.$set(x),S&&S.p&&(!D||p&256)&&ve(S,z,i,i[8],D?ke(z,i[8],p,null):be(i[8]),null)},i(i){if(!D){I(s);for(let p=0;p<$.length;p+=1)I(h[p]);I(c.$$.fragment,i),I(m.$$.fragment,i),I(S,i),D=!0}},o(i){O(s),h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)O(h[p]);O(c.$$.fragment,i),O(m.$$.fragment,i),O(S,i),D=!1},d(i){i&&v(e),_[t].d(),je(h,i),R(c),R(m),S&&S.d(i)}}}function Q(l,e){return l.sort((r,t)=>{const s=e.indexOf(r._id)??-1,n=e.indexOf(t._id)??-1;return n==-1?-1:s==-1?1:s-n})}const he=l=>l[0],pe=l=>l[0];function at(l,e,r){let t,s,n;ee(l,We,d=>r(3,n=d));let{$$slots:o={},$$scope:c}=e;const g=ue(Ae);ee(l,g,d=>r(1,t=d));const u=ue(Be),f=Re();ee(l,f,d=>r(2,s=d)),Ne(Me,f);let m=Array.from(u.api.cache.servers.values());return g.subscribe(d=>{r(0,m=Q(m,d.ordering.servers??[]))}),u.on("ServerCreate",()=>{r(0,m=Q(Array.from(u.api.cache.servers.values()),t.ordering.servers??[]))}),u.on("ServerDelete",({id:d})=>{r(0,m=Q(Array.from(u.api.cache.servers.values()),t.ordering.servers??[])),s==d&&Ce(`${K}/`)}),u.on("Ready",d=>{r(0,m=Q(d.servers,t.ordering.servers??[]))}),ye(async()=>{const d=Oe(g);for(const _ of Object.keys(d)){const w=localStorage.getItem(_);w!=null&&(d[_]=JSON.parse(w))}const D=await u.api.fetchSettings(Object.keys(d)),E={};for(const[_,w]of Object.entries(d)){const $=`revision:${_}`,h=D[_];if(h==null)continue;const[L,z]=h,S=Number(localStorage.getItem($)??"0");L!=S&&(L>S?(localStorage.setItem($,L.toString()),localStorage.setItem(_,z),d[_]=JSON.parse(z)):E[_]=w)}Object.keys(E).length!=0&&u.api.setSettings(E),g.set(d),g.subscribe(_=>{for(const[w,$]of Object.entries(_))localStorage.setItem(w,JSON.stringify($))})}),u.on("UserSettingsUpdate",({id:d,update:D})=>{var _;if(d!=((_=u.user)==null?void 0:_._id))return;let E={};for(const[w,[$,h]]of Object.entries(D)){const L=`revision:${w}`;$>Number(localStorage.getItem(L))&&(localStorage.setItem(L,$.toString()),localStorage.setItem(w,h),E[w]=JSON.parse(h))}g.update(w=>{for(const[$,h]of Object.entries(E))w[$]=h;return w})}),l.$$set=d=>{"$$scope"in d&&r(8,c=d.$$scope)},[m,t,s,n,g,u,f,o,c]}class $t extends Y{constructor(e){super(),Z(this,e,at,ot,X,{})}}export{$t as component};
