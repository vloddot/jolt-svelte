import{s as B,f as G,c as O}from"../chunks/scheduler.a21a5cad.js";import{S as K,i as L,g as b,s as E,h as k,j as C,f as d,c as N,k as $,a as w,x as v,z as F,d as h,p as P,b as V,t as g,y as H,r as x,m as J,u as A,n as Q,v as I,o as W,w as M,e as U}from"../chunks/index.4419476b.js";import{g as R,v as X}from"../chunks/context.898bb4a8.js";import{C as Y}from"../chunks/index.b2210e13.js";import{e as S}from"../chunks/each.e59479a4.js";import{b as Z}from"../chunks/paths.0ffc389c.js";import{b as ee}from"../chunks/util.367677fc.js";import{U as te}from"../chunks/UserProfilePicture.82787d6a.js";import{c as ne}from"../chunks/context.dd405c9c.js";function T(c,t,n){const e=c.slice();e[5]=t[n].user;const a=ee(e[5]);return e[6]=a,e}function j(c){let t,n,e,a,s=c[6]+"",f,p,r;return n=new te({props:{name:c[6],src:c[5].generateAvatarURL({max_side:256}),width:100,height:100,inline:!1}}),{c(){t=b("div"),x(n.$$.fragment),e=E(),a=b("span"),f=J(s),p=E(),this.h()},l(o){t=k(o,"DIV",{class:!0});var i=C(t);A(n.$$.fragment,i),e=N(i),a=k(i,"SPAN",{class:!0});var l=C(a);f=Q(l,s),l.forEach(d),p=N(i),i.forEach(d),this.h()},h(){$(a,"class","align-center text-sm"),$(t,"class","flex flex-col m-2")},m(o,i){w(o,t,i),I(n,t,null),v(t,e),v(t,a),v(a,f),v(t,p),r=!0},p(o,i){const l={};i&1&&(l.name=o[6]),i&1&&(l.src=o[5].generateAvatarURL({max_side:256})),n.$set(l),(!r||i&1)&&s!==(s=o[6]+"")&&W(f,s)},i(o){r||(h(n.$$.fragment,o),r=!0)},o(o){g(n.$$.fragment,o),r=!1},d(o){o&&d(t),M(n)}}}function ae(c){let t,n,e,a,s,f,p,r,o,i=S(c[0].values()),l=[];for(let u=0;u<i.length;u+=1)l[u]=j(T(c,i,u));const z=u=>g(l[u],1,1,()=>{l[u]=null});return{c(){t=b("div"),n=b("button"),e=b("img"),s=E(),f=b("div");for(let u=0;u<l.length;u+=1)l[u].c();this.h()},l(u){t=k(u,"DIV",{class:!0});var _=C(t);n=k(_,"BUTTON",{class:!0});var m=C(n);e=k(m,"IMG",{src:!0,alt:!0}),m.forEach(d),s=N(_),f=k(_,"DIV",{class:!0});var y=C(f);for(let D=0;D<l.length;D+=1)l[D].l(y);y.forEach(d),_.forEach(d),this.h()},h(){G(e.src,a=Z+"/call.svg")||$(e,"src",a),$(e,"alt","Call"),$(n,"class","m-2"),$(f,"class","flex justify-center"),$(t,"class","main-content-container")},m(u,_){w(u,t,_),v(t,n),v(n,e),v(t,s),v(t,f);for(let m=0;m<l.length;m+=1)l[m]&&l[m].m(f,null);p=!0,r||(o=F(n,"click",c[4]),r=!0)},p(u,[_]){if(_&1){i=S(u[0].values());let m;for(m=0;m<i.length;m+=1){const y=T(u,i,m);l[m]?(l[m].p(y,_),h(l[m],1)):(l[m]=j(y),l[m].c(),h(l[m],1),l[m].m(f,null))}for(P(),m=i.length;m<l.length;m+=1)z(m);V()}},i(u){if(!p){for(let _=0;_<i.length;_+=1)h(l[_]);p=!0}},o(u){l=l.filter(Boolean);for(let _=0;_<l.length;_+=1)g(l[_]);p=!1},d(u){u&&d(t),H(l,u),r=!1,o()}}}function re(c,t,n){let{channel:e}=t;const a=R(X);let s=new Map;a.participants.onUpdate(()=>n(0,s=a.participants));function f(){Promise.all([navigator.mediaDevices.getUserMedia({audio:!0}),a.connect(e._id)]).then(([r,o])=>{const i=r.getAudioTracks()[0];o.play("audio",i)})}const p=()=>a.connected?a.disconnect():f();return c.$$set=r=>{"channel"in r&&n(3,e=r.channel)},[s,a,f,e,p]}class le extends K{constructor(t){super(),L(this,t,re,ae,B,{channel:3})}}function q(c){let t,n,e,a;const s=[ce,se],f=[];function p(r,o){return r[0].channel_type=="VoiceChannel"?0:1}return t=p(c),n=f[t]=s[t](c),{c(){n.c(),e=U()},l(r){n.l(r),e=U()},m(r,o){f[t].m(r,o),w(r,e,o),a=!0},p(r,o){let i=t;t=p(r),t===i?f[t].p(r,o):(P(),g(f[i],1,1,()=>{f[i]=null}),V(),n=f[t],n?n.p(r,o):(n=f[t]=s[t](r),n.c()),h(n,1),n.m(e.parentNode,e))},i(r){a||(h(n),a=!0)},o(r){g(n),a=!1},d(r){r&&d(e),f[t].d(r)}}}function se(c){let t,n;return t=new Y({props:{channel:c[0]}}),{c(){x(t.$$.fragment)},l(e){A(t.$$.fragment,e)},m(e,a){I(t,e,a),n=!0},p(e,a){const s={};a&1&&(s.channel=e[0]),t.$set(s)},i(e){n||(h(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){M(t,e)}}}function ce(c){let t,n;return t=new le({props:{channel:c[0]}}),{c(){x(t.$$.fragment)},l(e){A(t.$$.fragment,e)},m(e,a){I(t,e,a),n=!0},p(e,a){const s={};a&1&&(s.channel=e[0]),t.$set(s)},i(e){n||(h(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){M(t,e)}}}function oe(c){let t,n,e=c[0]!=null&&q(c);return{c(){e&&e.c(),t=U()},l(a){e&&e.l(a),t=U()},m(a,s){e&&e.m(a,s),w(a,t,s),n=!0},p(a,[s]){a[0]!=null?e?(e.p(a,s),s&1&&h(e,1)):(e=q(a),e.c(),h(e,1),e.m(t.parentNode,t)):e&&(P(),g(e,1,1,()=>{e=null}),V())},i(a){n||(h(e),n=!0)},o(a){g(e),n=!1},d(a){a&&d(t),e&&e.d(a)}}}function ie(c,t,n){let e;const a=R(ne);return O(c,a,s=>n(0,e=s)),[e,a]}class $e extends K{constructor(t){super(),L(this,t,ie,oe,B,{})}}export{$e as component};
