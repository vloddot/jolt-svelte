import{s as ee,n as h,f as G,d as le,u as ie,g as ae,e as ce,c as T,o as fe}from"../chunks/scheduler.bc65eea2.js";import{S as re,i as te,g as E,m as ne,s as R,h as O,j as H,n as oe,f as p,c as U,k as b,a as N,x as D,o as se,r as K,u as L,v as P,t as $,b as M,d,w as V,e as J,p as B,y as ue}from"../chunks/index.cf715be0.js";import{h as me,u as _e}from"../chunks/await_block.b32c7e6c.js";import{e as z}from"../chunks/each.e59479a4.js";import{g as de}from"../chunks/navigation.6d653878.js";import{b as j}from"../chunks/paths.e5c957f4.js";import{g as F,s as Q,a as he,c as pe}from"../chunks/context.90bee080.js";/* empty css                      */import{g as ge,a as W}from"../chunks/util.892acc65.js";import{s as be,a as ve}from"../chunks/context.fa34f1f8.js";import{w as X}from"../chunks/index.27f04a12.js";import{P as ke}from"../chunks/plus.4a89c26f.js";function $e(l){let r,n;return{c(){r=E("img"),this.h()},l(e){r=O(e,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){b(r,"class","sidebar-icon group-hover:rounded-xl group-hover:bg-blue-500 group-hover:text-white"),G(r.src,n=l[2])||b(r,"src",n),b(r,"alt",l[1])},m(e,t){N(e,r,t)},p(e,t){t&4&&!G(r.src,n=e[2])&&b(r,"src",n),t&2&&b(r,"alt",e[1])},d(e){e&&p(r)}}}function Se(l){let r,n;return{c(){r=E("span"),n=ne(l[3]),this.h()},l(e){r=O(e,"SPAN",{class:!0});var t=H(r);n=oe(t,l[3]),t.forEach(p),this.h()},h(){b(r,"class","sidebar-icon group-hover:rounded-xl group-hover:bg-blue-500 overflow-ellipsis")},m(e,t){N(e,r,t),D(r,n)},p(e,t){t&8&&se(n,e[3])},d(e){e&&p(r)}}}function ye(l){let r,n,e,t,o;function i(c,_){return c[2]==null?Se:$e}let a=i(l),s=a(l);return{c(){r=E("div"),n=E("span"),e=ne(l[1]),t=R(),o=E("a"),s.c(),this.h()},l(c){r=O(c,"DIV",{class:!0});var _=H(r);n=O(_,"SPAN",{class:!0});var g=H(n);e=oe(g,l[1]),g.forEach(p),t=U(_),o=O(_,"A",{href:!0,"aria-label":!0});var m=H(o);s.l(m),m.forEach(p),_.forEach(p),this.h()},h(){b(n,"class","sidebar-tooltip group-hover:scale-100"),b(o,"href",l[0]),b(o,"aria-label",l[1]),b(r,"class","group m-0")},m(c,_){N(c,r,_),D(r,n),D(n,e),D(r,t),D(r,o),s.m(o,null)},p(c,[_]){_&2&&se(e,c[1]),a===(a=i(c))&&s?s.p(c,_):(s.d(1),s=a(c),s&&(s.c(),s.m(o,null))),_&1&&b(o,"href",c[0]),_&2&&b(o,"aria-label",c[1])},i:h,o:h,d(c){c&&p(r),s.d()}}}function Ie(l,r,n){let e,{href:t}=r,{tooltip:o}=r,{icon:i=void 0}=r;return l.$$set=a=>{"href"in a&&n(0,t=a.href),"tooltip"in a&&n(1,o=a.tooltip),"icon"in a&&n(2,i=a.icon)},l.$$.update=()=>{l.$$.dirty&2&&n(3,e=o.split(" ").map(a=>a[0]).join(""))},[t,o,i,e]}class q extends re{constructor(r){super(),te(this,r,Ie,ye,ee,{href:0,tooltip:1,icon:2})}}const we=""+new URL("../assets/home.292f202b.svg",import.meta.url).href,De=""+new URL("../assets/cog-6-tooth.02c70f59.svg",import.meta.url).href;function Y(l,r,n){const e=l.slice();return e[9]=r[n],e}function Ne(l){let r,n,e={ctx:l,current:null,token:null,hasCatch:!1,pending:Oe,then:Ee,catch:Ce,value:12,blocks:[,,,]};return me(l[3].user??l[3].api.fetchUser("@me"),e),{c(){r=J(),e.block.c()},l(t){r=J(),e.block.l(t)},m(t,o){N(t,r,o),e.block.m(t,e.anchor=o),e.mount=()=>r.parentNode,e.anchor=r,n=!0},p(t,o){l=t,_e(e,l,o)},i(t){n||(d(e.block),n=!0)},o(t){for(let o=0;o<3;o+=1){const i=e.blocks[o];$(i)}n=!1},d(t){t&&p(r),e.block.d(t),e.token=null,e=null}}}function Ae(l){let r,n,e,t;return r=new q({props:{href:j+"/",tooltip:"Home",icon:we}}),{c(){K(r.$$.fragment),n=R(),e=E("hr"),this.h()},l(o){L(r.$$.fragment,o),n=U(o),e=O(o,"HR",{class:!0}),this.h()},h(){b(e,"class","border-gray-600 mx-4")},m(o,i){P(r,o,i),N(o,n,i),N(o,e,i),t=!0},p:h,i(o){t||(d(r.$$.fragment,o),t=!0)},o(o){$(r.$$.fragment,o),t=!1},d(o){o&&(p(n),p(e)),V(r,o)}}}function Ce(l){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Ee(l){let r,n,e,t;return r=new q({props:{href:j+"/",tooltip:l[12].username+"#"+l[12].discriminator,icon:ge(l[3].user)}}),{c(){K(r.$$.fragment),n=R(),e=E("hr"),this.h()},l(o){L(r.$$.fragment,o),n=U(o),e=O(o,"HR",{class:!0}),this.h()},h(){b(e,"class","border-gray-600 mx-4")},m(o,i){P(r,o,i),N(o,n,i),N(o,e,i),t=!0},p:h,i(o){t||(d(r.$$.fragment,o),t=!0)},o(o){$(r.$$.fragment,o),t=!1},d(o){o&&(p(n),p(e)),V(r,o)}}}function Oe(l){return{c:h,l:h,m:h,p:h,i:h,o:h,d:h}}function Z(l){let r,n,e=z(l[0]),t=[];for(let i=0;i<e.length;i+=1)t[i]=x(Y(l,e,i));const o=i=>$(t[i],1,1,()=>{t[i]=null});return{c(){for(let i=0;i<t.length;i+=1)t[i].c();r=J()},l(i){for(let a=0;a<t.length;a+=1)t[a].l(i);r=J()},m(i,a){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,a);N(i,r,a),n=!0},p(i,a){if(a&3){e=z(i[0]);let s;for(s=0;s<e.length;s+=1){const c=Y(i,e,s);t[s]?(t[s].p(c,a),d(t[s],1)):(t[s]=x(c),t[s].c(),d(t[s],1),t[s].m(r.parentNode,r))}for(B(),s=e.length;s<t.length;s+=1)o(s);M()}},i(i){if(!n){for(let a=0;a<e.length;a+=1)d(t[a]);n=!0}},o(i){t=t.filter(Boolean);for(let a=0;a<t.length;a+=1)$(t[a]);n=!1},d(i){i&&p(r),ue(t,i)}}}function je(l){let r,n;return r=new q({props:{href:j+"/servers/"+l[9]._id+"/channels/"+l[9].channels[0],tooltip:l[9].name,icon:l[9].icon==null?void 0:`${W(l[9].icon,{max_side:"256"})}`}}),{c(){K(r.$$.fragment)},l(e){L(r.$$.fragment,e)},m(e,t){P(r,e,t),n=!0},p(e,t){const o={};t&1&&(o.href=j+"/servers/"+e[9]._id+"/channels/"+e[9].channels[0]),t&1&&(o.tooltip=e[9].name),t&1&&(o.icon=e[9].icon==null?void 0:`${W(e[9].icon,{max_side:"256"})}`),r.$set(o)},i(e){n||(d(r.$$.fragment,e),n=!0)},o(e){$(r.$$.fragment,e),n=!1},d(e){V(r,e)}}}function Re(l){let r,n;return r=new q({props:{href:j+"/servers/"+l[9]._id+"/channels/"+l[9].channels[0],tooltip:l[9].name}}),{c(){K(r.$$.fragment)},l(e){L(r.$$.fragment,e)},m(e,t){P(r,e,t),n=!0},p(e,t){const o={};t&1&&(o.href=j+"/servers/"+e[9]._id+"/channels/"+e[9].channels[0]),t&1&&(o.tooltip=e[9].name),r.$set(o)},i(e){n||(d(r.$$.fragment,e),n=!0)},o(e){$(r.$$.fragment,e),n=!1},d(e){V(r,e)}}}function x(l){let r,n,e,t;const o=[Re,je],i=[];function a(s,c){return s[1]["jolt:low-data-mode"]?0:1}return r=a(l),n=i[r]=o[r](l),{c(){n.c(),e=J()},l(s){n.l(s),e=J()},m(s,c){i[r].m(s,c),N(s,e,c),t=!0},p(s,c){let _=r;r=a(s),r===_?i[r].p(s,c):(B(),$(i[_],1,1,()=>{i[_]=null}),M(),n=i[r],n?n.p(s,c):(n=i[r]=o[r](s),n.c()),d(n,1),n.m(e.parentNode,e))},i(s){t||(d(n),t=!0)},o(s){$(n),t=!1},d(s){s&&p(e),i[r].d(s)}}}function Ue(l){let r,n,e,t,o,i,a,s,c,_,g,m,S;const A=[Ae,Ne],v=[];function w(u,y){return u[1]["jolt:low-data-mode"]?0:1}e=w(l),t=v[e]=A[e](l);let f=l[0]!=null&&Z(l);a=new q({props:{href:j+"/servers/create",icon:ke,tooltip:"Create Server"}}),g=new q({props:{href:j+"/settings",icon:De,tooltip:"Settings"}});const C=l[6].default,k=le(C,l,l[5],null);return{c(){r=E("div"),n=E("div"),t.c(),o=R(),f&&f.c(),i=R(),K(a.$$.fragment),s=R(),c=E("div"),_=R(),K(g.$$.fragment),m=R(),k&&k.c(),this.h()},l(u){r=O(u,"DIV",{class:!0});var y=H(r);n=O(y,"DIV",{class:!0});var I=H(n);t.l(I),o=U(I),f&&f.l(I),i=U(I),L(a.$$.fragment,I),s=U(I),c=O(I,"DIV",{class:!0}),H(c).forEach(p),_=U(I),L(g.$$.fragment,I),I.forEach(p),m=U(y),k&&k.l(y),y.forEach(p),this.h()},h(){b(c,"class","flex-1"),b(n,"class","server-sidebar-container"),b(r,"class","grid-container")},m(u,y){N(u,r,y),D(r,n),v[e].m(n,null),D(n,o),f&&f.m(n,null),D(n,i),P(a,n,null),D(n,s),D(n,c),D(n,_),P(g,n,null),D(r,m),k&&k.m(r,null),S=!0},p(u,[y]){let I=e;e=w(u),e===I?v[e].p(u,y):(B(),$(v[I],1,1,()=>{v[I]=null}),M(),t=v[e],t?t.p(u,y):(t=v[e]=A[e](u),t.c()),d(t,1),t.m(n,o)),u[0]!=null?f?(f.p(u,y),y&1&&d(f,1)):(f=Z(u),f.c(),d(f,1),f.m(n,i)):f&&(B(),$(f,1,1,()=>{f=null}),M()),k&&k.p&&(!S||y&32)&&ie(k,C,u,u[5],S?ce(C,u[5],y,null):ae(u[5]),null)},i(u){S||(d(t),d(f),d(a.$$.fragment,u),d(g.$$.fragment,u),d(k,u),S=!0)},o(u){$(t),$(f),$(a.$$.fragment,u),$(g.$$.fragment,u),$(k,u),S=!1},d(u){u&&p(r),v[e].d(),f&&f.d(),V(a),V(g),k&&k.d(u)}}}function He(l,r,n){let e,t,{$$slots:o={},$$scope:i}=r;const a=F(he);T(l,a,m=>n(1,t=m));const s=F(pe),c=X();T(l,c,m=>n(7,e=m));const _=X();Q(be,_),Q(ve,c);let g=Array.from(s.api.cache.servers.values());return a.subscribe(m=>{n(0,g=g.sort((S,A)=>{var f,C;const v=((f=m.ordering.servers)==null?void 0:f.indexOf(S._id))??-1,w=((C=m.ordering.servers)==null?void 0:C.indexOf(A._id))??-1;return w==-1?-1:v==-1?1:v-w}))}),s.on("ServerCreate",()=>{n(0,g=Array.from(s.api.cache.servers.values()))}),s.on("ServerDelete",async({id:m})=>{n(0,g=Array.from(s.api.cache.servers.values())),e==m&&await de(`${j}/`)}),s.on("Ready",async m=>{n(0,g=m.servers);const S=await s.api.fetchSettings(["ordering"]);if(S.ordering==null)return;const[A,v]=S.ordering;A>Number(localStorage.getItem("revision:ordering"))&&(localStorage.setItem("revision:ordering",A.toString()),a.update(w=>w.ordering=JSON.parse(v).servers))}),s.on("UserSettingsUpdate",({id:m,update:S})=>{var v;if(m!=((v=s.user)==null?void 0:v._id))return;let A={};for(const[w,[f,C]]of Object.entries(S)){const k=`revision:${w}`;f>Number(localStorage.getItem(k))&&(localStorage.setItem(k,f.toString()),A[w]=C)}a.update(w=>{for(const[f,C]of Object.entries(A))w[f]=C;return w})}),fe(()=>{const m=localStorage.getItem("settings");m!=null&&a.set(JSON.parse(m)),a.subscribe(S=>{localStorage.setItem("settings",JSON.stringify(S))})}),l.$$set=m=>{"$$scope"in m&&n(5,i=m.$$scope)},[g,t,a,s,c,i,o]}class Qe extends re{constructor(r){super(),te(this,r,He,Ue,ee,{})}}export{Qe as component};
