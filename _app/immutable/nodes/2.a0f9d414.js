import{s as Y,v as be,f as H,g as L,h as N,d as v,j as a,i as j,z as C,A as Q,B as Ie,w as ke,x as $e,y as we,C as je,D as ye,E as P,F,u as k,a as U,c as q,G as De,r as te,o as Oe,H as Ce,e as z,I as re,l as se,m as le,n as Se}from"../chunks/scheduler.fede8105.js";import{h as Ee,u as Ne}from"../chunks/await_block.ecc72e0a.js";import{e as ae}from"../chunks/each.e59479a4.js";import{S as Z,i as x,a as I,t as O,b as A,d as B,m as R,c as ie,e as W,g as ce}from"../chunks/index.257844fa.js";import{g as Ve}from"../chunks/navigation.2ea4b366.js";import{e as J}from"../chunks/singletons.1e1430be.js";import{g as ue,s as fe,a as He,c as Le}from"../chunks/context.682cab63.js";import{g as Me,a as _e}from"../chunks/util.883c3f21.js";import{t as Ae,P as Be}from"../chunks/PlusIcon.3856cf8f.js";import{s as Re,a as We}from"../chunks/context.fa34f1f8.js";import{w as me}from"../chunks/index.3ac45322.js";import{p as Ke}from"../chunks/stores.70d07f98.js";function Ue(l){let e,r,t,s,n,o,c;const g=l[7].default,u=be(g,l,l[6],null);return{c(){e=H("div"),r=H("a"),u&&u.c(),this.h()},l(f){e=L(f,"DIV",{class:!0,"data-focused":!0,"data-selected":!0,"data-unread":!0,"aria-selected":!0});var p=N(e);r=L(p,"A",{href:!0,tabindex:!0,"aria-label":!0,class:!0});var y=N(r);u&&u.l(y),y.forEach(v),p.forEach(v),this.h()},h(){a(r,"href",l[0]),a(r,"tabindex","0"),a(r,"aria-label",t=typeof l[1]=="string"&&l[2]!=null?l[1]:l[2]),a(r,"class","server-sidebar-icon svelte-1avlg8k"),a(e,"class","server-sidebar-icon-base svelte-1avlg8k"),a(e,"data-focused",l[5]),a(e,"data-selected",l[3]),a(e,"data-unread",l[4]),a(e,"aria-selected",l[3])},m(f,p){j(f,e,p),C(e,r),u&&u.m(r,null),n=!0,o||(c=[Q(r,"mouseenter",l[8]),Q(r,"mouseleave",l[9]),Q(r,"focus",l[10]),Q(r,"blur",l[11]),Ie(s=Ae.call(null,r,{placement:"right",content:l[1],theme:"right-tooltip",animation:"scale-subtle",duration:100,onShow:l[12]}))],o=!0)},p(f,[p]){u&&u.p&&(!n||p&64)&&ke(u,g,f,f[6],n?we(g,f[6],p,null):$e(f[6]),null),(!n||p&1)&&a(r,"href",f[0]),(!n||p&6&&t!==(t=typeof f[1]=="string"&&f[2]!=null?f[1]:f[2]))&&a(r,"aria-label",t),s&&je(s.update)&&p&2&&s.update.call(null,{placement:"right",content:f[1],theme:"right-tooltip",animation:"scale-subtle",duration:100,onShow:f[12]}),(!n||p&32)&&a(e,"data-focused",f[5]),(!n||p&8)&&a(e,"data-selected",f[3]),(!n||p&16)&&a(e,"data-unread",f[4]),(!n||p&8)&&a(e,"aria-selected",f[3])},i(f){n||(I(u,f),n=!0)},o(f){O(u,f),n=!1},d(f){f&&v(e),u&&u.d(f),o=!1,ye(c)}}}function qe(l,e,r){let{$$slots:t={},$$scope:s}=e,{href:n}=e,{tooltip:o}=e,{ariaLabel:c=void 0}=e,{selected:g}=e,{unread:u=!1}=e,f=!1;const p=()=>r(5,f=!0),y=()=>r(5,f=!1),m=()=>r(5,f=!0),M=()=>r(5,f=!1),w=function(){if(!o)return!1};return l.$$set=d=>{"href"in d&&r(0,n=d.href),"tooltip"in d&&r(1,o=d.tooltip),"ariaLabel"in d&&r(2,c=d.ariaLabel),"selected"in d&&r(3,g=d.selected),"unread"in d&&r(4,u=d.unread),"$$scope"in d&&r(6,s=d.$$scope)},[n,o,c,g,u,f,s,t,p,y,m,M,w]}class T extends Z{constructor(e){super(),x(this,e,qe,Ue,Y,{href:0,tooltip:1,ariaLabel:2,selected:3,unread:4})}}function Je(l){let e,r;return{c(){e=P("svg"),r=P("path"),this.h()},l(t){e=F(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var s=N(e);r=F(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(r).forEach(v),s.forEach(v),this.h()},h(){a(r,"stroke-linecap","round"),a(r,"stroke-linejoin","round"),a(r,"d","M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(t,s){j(t,e,s),C(e,r)},p:k,i:k,o:k,d(t){t&&v(e)}}}class ze extends Z{constructor(e){super(),x(this,e,null,Je,Y,{})}}function Ge(l){let e,r,t;return{c(){e=P("svg"),r=P("path"),t=P("path"),this.h()},l(s){e=F(s,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var n=N(e);r=F(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(r).forEach(v),t=F(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(v),n.forEach(v),this.h()},h(){a(r,"stroke-linecap","round"),a(r,"stroke-linejoin","round"),a(r,"d","M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"),a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(s,n){j(s,e,n),C(e,r),C(e,t)},p:k,i:k,o:k,d(s){s&&v(e)}}}class Pe extends Z{constructor(e){super(),x(this,e,null,Ge,Y,{})}}function de(l,e,r){const t=l.slice();return t[10]=e[r],t}function Fe(l){const e=l.slice(),r=e[10].name.split(" ");return e[13]=r,e}function Te(l){let e,r,t={ctx:l,current:null,token:null,hasCatch:!1,pending:xe,then:Ye,catch:Xe,value:14,blocks:[,,,]};return Ee(l[5].user??l[5].api.fetchUser("@me"),t),{c(){e=z(),t.block.c()},l(s){e=z(),t.block.l(s)},m(s,n){j(s,e,n),t.block.m(s,t.anchor=n),t.mount=()=>e.parentNode,t.anchor=e,r=!0},p(s,n){l=s,Ne(t,l,n)},i(s){r||(I(t.block),r=!0)},o(s){for(let n=0;n<3;n+=1){const o=t.blocks[n];O(o)}r=!1},d(s){s&&v(e),t.block.d(s),t.token=null,t=null}}}function Qe(l){var n;let e,r,t,s;return e=new T({props:{selected:((n=l[3].route.id)==null?void 0:n.startsWith("/(app)/(home)"))??!1,href:J+"/",tooltip:"Home",$$slots:{default:[et]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment),r=U(),t=H("hr")},l(o){B(e.$$.fragment,o),r=q(o),t=L(o,"HR",{})},m(o,c){R(e,o,c),j(o,r,c),j(o,t,c),s=!0},p(o,c){var u;const g={};c&8&&(g.selected=((u=o[3].route.id)==null?void 0:u.startsWith("/(app)/(home)"))??!1),c&256&&(g.$$scope={dirty:c,ctx:o}),e.$set(g)},i(o){s||(I(e.$$.fragment,o),s=!0)},o(o){O(e.$$.fragment,o),s=!1},d(o){o&&(v(r),v(t)),W(e,o)}}}function Xe(l){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function Ye(l){var n;let e,r,t,s;return e=new T({props:{href:J+"/",selected:((n=l[3].route.id)==null?void 0:n.startsWith("/(app)/(home)"))??!1,ariaLabel:"Home",tooltip:l[14].username+"#"+l[14].discriminator,$$slots:{default:[Ze]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment),r=U(),t=H("hr")},l(o){B(e.$$.fragment,o),r=q(o),t=L(o,"HR",{})},m(o,c){R(e,o,c),j(o,r,c),j(o,t,c),s=!0},p(o,c){var u;const g={};c&8&&(g.selected=((u=o[3].route.id)==null?void 0:u.startsWith("/(app)/(home)"))??!1),c&256&&(g.$$scope={dirty:c,ctx:o}),e.$set(g)},i(o){s||(I(e.$$.fragment,o),s=!0)},o(o){O(e.$$.fragment,o),s=!1},d(o){o&&(v(r),v(t)),W(e,o)}}}function Ze(l){let e,r;return{c(){e=H("img"),this.h()},l(t){e=L(t,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){a(e,"class","cover"),re(e.src,r=Me(l[14]))||a(e,"src",r),a(e,"alt","Home"),a(e,"width","42px"),a(e,"height","42px")},m(t,s){j(t,e,s)},p:k,d(t){t&&v(e)}}}function xe(l){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function et(l){let e,r;return e=new ze({}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){W(e,t)}}}function tt(l){let e,r,t;return{c(){e=H("img"),this.h()},l(s){e=L(s,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){a(e,"class","cover"),re(e.src,r=_e(l[10].icon,{max_side:"256"}))||a(e,"src",r),a(e,"alt",t=l[10].name),a(e,"width","42px"),a(e,"height","42px")},m(s,n){j(s,e,n)},p(s,n){n&1&&!re(e.src,r=_e(s[10].icon,{max_side:"256"}))&&a(e,"src",r),n&1&&t!==(t=s[10].name)&&a(e,"alt",t)},d(s){s&&v(e)}}}function he(l){let e;function r(n,o){return n[13].length>3?st:rt}let t=r(l),s=t(l);return{c(){s.c(),e=z()},l(n){s.l(n),e=z()},m(n,o){s.m(n,o),j(n,e,o)},p(n,o){t===(t=r(n))&&s?s.p(n,o):(s.d(1),s=t(n),s&&(s.c(),s.m(e.parentNode,e)))},d(n){n&&v(e),s.d(n)}}}function rt(l){let e=l[13].map(ve).join("")+"",r;return{c(){r=se(e)},l(t){r=le(t,e)},m(t,s){j(t,r,s)},p(t,s){s&1&&e!==(e=t[13].map(ve).join("")+"")&&Se(r,e)},d(t){t&&v(r)}}}function st(l){let e=l[13].slice(0,3).map(ge).join("")+"",r,t;return{c(){r=se(e),t=se("...")},l(s){r=le(s,e),t=le(s,"...")},m(s,n){j(s,r,n),j(s,t,n)},p(s,n){n&1&&e!==(e=s[13].slice(0,3).map(ge).join("")+"")&&Se(r,e)},d(s){s&&(v(r),v(t))}}}function lt(l){let e;function r(o,c){return o[10].icon==null||o[1]["jolt:low-data-mode"]?he:tt}function t(o,c){return c===he?Fe(o):o}let s=r(l),n=s(t(l,s));return{c(){n.c(),e=z()},l(o){n.l(o),e=z()},m(o,c){n.m(o,c),j(o,e,c)},p(o,c){s===(s=r(o))&&n?n.p(t(o,s),c):(n.d(1),n=s(t(o,s)),n&&(n.c(),n.m(e.parentNode,e)))},d(o){o&&v(e),n.d(o)}}}function pe(l){let e,r;return e=new T({props:{href:J+"/servers/"+l[10]._id+"/channels/"+l[10].channels[0],tooltip:l[10].name,selected:l[2]==l[10]._id,$$slots:{default:[lt]},$$scope:{ctx:l}}}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),r=!0},p(t,s){const n={};s&1&&(n.href=J+"/servers/"+t[10]._id+"/channels/"+t[10].channels[0]),s&1&&(n.tooltip=t[10].name),s&5&&(n.selected=t[2]==t[10]._id),s&259&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){W(e,t)}}}function nt(l){let e,r;return e=new Be({}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){W(e,t)}}}function ot(l){let e,r;return e=new Pe({}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){W(e,t)}}}function at(l){var G;let e,r,t,s,n,o,c,g,u,f,p,y,m;const M=[Qe,Te],w=[];function d(i,h){return i[1]["jolt:low-data-mode"]?0:1}t=d(l),s=w[t]=M[t](l);let b=ae(l[0]),_=[];for(let i=0;i<b.length;i+=1)_[i]=pe(de(l,b,i));const V=i=>O(_[i],1,1,()=>{_[i]=null});c=new T({props:{selected:l[3].route.id=="/(app)/servers/create",href:J+"/servers/create",tooltip:"Create Server",$$slots:{default:[nt]},$$scope:{ctx:l}}}),p=new T({props:{selected:((G=l[3].route.id)==null?void 0:G.startsWith("/(app)/settings"))??!1,href:J+"/settings",tooltip:"Settings",$$slots:{default:[ot]},$$scope:{ctx:l}}});const E=l[7].default,S=be(E,l,l[8],null);return{c(){e=H("div"),r=H("div"),s.c(),n=U();for(let i=0;i<_.length;i+=1)_[i].c();o=U(),A(c.$$.fragment),g=U(),u=H("div"),f=U(),A(p.$$.fragment),y=U(),S&&S.c(),this.h()},l(i){e=L(i,"DIV",{class:!0});var h=N(e);r=L(h,"DIV",{class:!0});var $=N(r);s.l($),n=q($);for(let K=0;K<_.length;K+=1)_[K].l($);o=q($),B(c.$$.fragment,$),g=q($),u=L($,"DIV",{class:!0}),N(u).forEach(v),f=q($),B(p.$$.fragment,$),$.forEach(v),y=q(h),S&&S.l(h),h.forEach(v),this.h()},h(){a(u,"class","flex-1"),a(r,"class","server-sidebar-container svelte-1kqdmjg"),a(e,"class","app-container svelte-1kqdmjg")},m(i,h){j(i,e,h),C(e,r),w[t].m(r,null),C(r,n);for(let $=0;$<_.length;$+=1)_[$]&&_[$].m(r,null);C(r,o),R(c,r,null),C(r,g),C(r,u),C(r,f),R(p,r,null),C(e,y),S&&S.m(e,null),m=!0},p(i,[h]){var ne;let $=t;if(t=d(i),t===$?w[t].p(i,h):(ce(),O(w[$],1,1,()=>{w[$]=null}),ie(),s=w[t],s?s.p(i,h):(s=w[t]=M[t](i),s.c()),I(s,1),s.m(r,n)),h&7){b=ae(i[0]);let D;for(D=0;D<b.length;D+=1){const oe=de(i,b,D);_[D]?(_[D].p(oe,h),I(_[D],1)):(_[D]=pe(oe),_[D].c(),I(_[D],1),_[D].m(r,o))}for(ce(),D=b.length;D<_.length;D+=1)V(D);ie()}const K={};h&8&&(K.selected=i[3].route.id=="/(app)/servers/create"),h&256&&(K.$$scope={dirty:h,ctx:i}),c.$set(K);const ee={};h&8&&(ee.selected=((ne=i[3].route.id)==null?void 0:ne.startsWith("/(app)/settings"))??!1),h&256&&(ee.$$scope={dirty:h,ctx:i}),p.$set(ee),S&&S.p&&(!m||h&256)&&ke(S,E,i,i[8],m?we(E,i[8],h,null):$e(i[8]),null)},i(i){if(!m){I(s);for(let h=0;h<b.length;h+=1)I(_[h]);I(c.$$.fragment,i),I(p.$$.fragment,i),I(S,i),m=!0}},o(i){O(s),_=_.filter(Boolean);for(let h=0;h<_.length;h+=1)O(_[h]);O(c.$$.fragment,i),O(p.$$.fragment,i),O(S,i),m=!1},d(i){i&&v(e),w[t].d(),De(_,i),W(c),W(p),S&&S.d(i)}}}function X(l,e){return l.sort((r,t)=>{const s=e.indexOf(r._id)??-1,n=e.indexOf(t._id)??-1;return n==-1?-1:s==-1?1:s-n})}const ge=l=>l[0],ve=l=>l[0];function it(l,e,r){let t,s,n;te(l,Ke,m=>r(3,n=m));let{$$slots:o={},$$scope:c}=e;const g=ue(He);te(l,g,m=>r(1,t=m));const u=ue(Le),f=me();te(l,f,m=>r(2,s=m));const p=me();fe(Re,p),fe(We,f);let y=Array.from(u.api.cache.servers.values());return g.subscribe(m=>{r(0,y=X(y,m.ordering.servers??[]))}),u.on("ServerCreate",()=>{r(0,y=X(Array.from(u.api.cache.servers.values()),t.ordering.servers??[]))}),u.on("ServerDelete",({id:m})=>{r(0,y=X(Array.from(u.api.cache.servers.values()),t.ordering.servers??[])),s==m&&Ve(`${J}/`)}),u.on("Ready",m=>{r(0,y=X(m.servers,t.ordering.servers??[]))}),Oe(async()=>{const m=Ce(g);for(const d of Object.keys(m)){const b=localStorage.getItem(d);b!=null&&(m[d]=JSON.parse(b))}const M=await u.api.fetchSettings(Object.keys(m)),w={};for(const[d,b]of Object.entries(m)){const _=`revision:${d}`,V=M[d];if(V==null)continue;const[E,S]=V,G=Number(localStorage.getItem(_)??"0");E!=G&&(E>G?(localStorage.setItem(_,E.toString()),localStorage.setItem(d,S),m[d]=JSON.parse(S)):w[d]=b)}Object.keys(w).length!=0&&u.api.setSettings(w),g.set(m),g.subscribe(d=>{for(const[b,_]of Object.entries(d))localStorage.setItem(b,JSON.stringify(_))})}),u.on("UserSettingsUpdate",({id:m,update:M})=>{var d;if(m!=((d=u.user)==null?void 0:d._id))return;let w={};for(const[b,[_,V]]of Object.entries(M)){const E=`revision:${b}`;_>Number(localStorage.getItem(E))&&(localStorage.setItem(E,_.toString()),localStorage.setItem(b,V),w[b]=JSON.parse(V))}g.update(b=>{for(const[_,V]of Object.entries(w))b[_]=V;return b})}),l.$$set=m=>{"$$scope"in m&&r(8,c=m.$$scope)},[y,t,s,n,g,u,f,o,c]}class $t extends Z{constructor(e){super(),x(this,e,it,at,Y,{})}}export{$t as component};
