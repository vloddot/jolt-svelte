import{s as j,c as R}from"../chunks/scheduler.a21a5cad.js";import{S as B,i as H,g as k,s as x,h as b,j as C,A as q,c as A,f as g,k as y,a as w,x as v,z,d as p,p as D,b as N,t as h,y as O,r as P,m as F,u as T,n as G,v as V,o as J,w as E,e as U}from"../chunks/index.4419476b.js";import{g as K,v as Q}from"../chunks/context.898bb4a8.js";import{C as W}from"../chunks/index.57e93061.js";import{e as L}from"../chunks/each.e59479a4.js";import{b as X}from"../chunks/util.c62b600d.js";import{U as Y}from"../chunks/UserProfilePicture.f3e5cd2d.js";import{c as Z}from"../chunks/context.dd405c9c.js";function M(o,t,n){const e=o.slice();e[5]=t[n].user;const a=X(e[5]);return e[6]=a,e}function I(o){let t,n,e,a,r=o[6]+"",u,_,s;return n=new Y({props:{name:o[6],src:o[5].generateAvatarURL({max_side:256}),width:100,height:100,inline:!1}}),{c(){t=k("div"),P(n.$$.fragment),e=x(),a=k("span"),u=F(r),_=x(),this.h()},l(c){t=b(c,"DIV",{class:!0});var l=C(t);T(n.$$.fragment,l),e=A(l),a=b(l,"SPAN",{class:!0});var d=C(a);u=G(d,r),d.forEach(g),_=A(l),l.forEach(g),this.h()},h(){y(a,"class","align-center text-sm"),y(t,"class","flex flex-col m-2")},m(c,l){w(c,t,l),V(n,t,null),v(t,e),v(t,a),v(a,u),v(t,_),s=!0},p(c,l){const d={};l&1&&(d.name=c[6]),l&1&&(d.src=c[5].generateAvatarURL({max_side:256})),n.$set(d),(!s||l&1)&&r!==(r=c[6]+"")&&J(u,r)},i(c){s||(p(n.$$.fragment,c),s=!0)},o(c){h(n.$$.fragment,c),s=!1},d(c){c&&g(t),E(n)}}}function ee(o){let t,n,e='<img src="/call.svg" alt="Call"/>',a,r,u,_,s,c=L(o[0].values()),l=[];for(let i=0;i<c.length;i+=1)l[i]=I(M(o,c,i));const d=i=>h(l[i],1,1,()=>{l[i]=null});return{c(){t=k("div"),n=k("button"),n.innerHTML=e,a=x(),r=k("div");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){t=b(i,"DIV",{class:!0});var m=C(t);n=b(m,"BUTTON",{class:!0,"data-svelte-h":!0}),q(n)!=="svelte-eihvyt"&&(n.innerHTML=e),a=A(m),r=b(m,"DIV",{class:!0});var f=C(r);for(let $=0;$<l.length;$+=1)l[$].l(f);f.forEach(g),m.forEach(g),this.h()},h(){y(n,"class","m-2"),y(r,"class","flex justify-center"),y(t,"class","main-content-container")},m(i,m){w(i,t,m),v(t,n),v(t,a),v(t,r);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(r,null);u=!0,_||(s=z(n,"click",o[4]),_=!0)},p(i,[m]){if(m&1){c=L(i[0].values());let f;for(f=0;f<c.length;f+=1){const $=M(i,c,f);l[f]?(l[f].p($,m),p(l[f],1)):(l[f]=I($),l[f].c(),p(l[f],1),l[f].m(r,null))}for(D(),f=c.length;f<l.length;f+=1)d(f);N()}},i(i){if(!u){for(let m=0;m<c.length;m+=1)p(l[m]);u=!0}},o(i){l=l.filter(Boolean);for(let m=0;m<l.length;m+=1)h(l[m]);u=!1},d(i){i&&g(t),O(l,i),_=!1,s()}}}function te(o,t,n){let{channel:e}=t;const a=K(Q);let r=new Map;a.participants.onUpdate(()=>n(0,r=a.participants));function u(){Promise.all([navigator.mediaDevices.getUserMedia({audio:!0}),a.connect(e._id)]).then(([s,c])=>{const l=s.getAudioTracks()[0];c.play("audio",l)})}const _=()=>a.connected?a.disconnect():u();return o.$$set=s=>{"channel"in s&&n(3,e=s.channel)},[r,a,u,e,_]}class ne extends B{constructor(t){super(),H(this,t,te,ee,j,{channel:3})}}function S(o){let t,n,e,a;const r=[le,ae],u=[];function _(s,c){return s[0].channel_type=="VoiceChannel"?0:1}return t=_(o),n=u[t]=r[t](o),{c(){n.c(),e=U()},l(s){n.l(s),e=U()},m(s,c){u[t].m(s,c),w(s,e,c),a=!0},p(s,c){let l=t;t=_(s),t===l?u[t].p(s,c):(D(),h(u[l],1,1,()=>{u[l]=null}),N(),n=u[t],n?n.p(s,c):(n=u[t]=r[t](s),n.c()),p(n,1),n.m(e.parentNode,e))},i(s){a||(p(n),a=!0)},o(s){h(n),a=!1},d(s){s&&g(e),u[t].d(s)}}}function ae(o){let t,n;return t=new W({props:{channel:o[0]}}),{c(){P(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,a){V(t,e,a),n=!0},p(e,a){const r={};a&1&&(r.channel=e[0]),t.$set(r)},i(e){n||(p(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){E(t,e)}}}function le(o){let t,n;return t=new ne({props:{channel:o[0]}}),{c(){P(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,a){V(t,e,a),n=!0},p(e,a){const r={};a&1&&(r.channel=e[0]),t.$set(r)},i(e){n||(p(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){E(t,e)}}}function re(o){let t,n,e=o[0]!=null&&S(o);return{c(){e&&e.c(),t=U()},l(a){e&&e.l(a),t=U()},m(a,r){e&&e.m(a,r),w(a,t,r),n=!0},p(a,[r]){a[0]!=null?e?(e.p(a,r),r&1&&p(e,1)):(e=S(a),e.c(),p(e,1),e.m(t.parentNode,t)):e&&(D(),h(e,1,1,()=>{e=null}),N())},i(a){n||(p(e),n=!0)},o(a){h(e),n=!1},d(a){a&&g(t),e&&e.d(a)}}}function se(o,t,n){let e;const a=K(Z);return R(o,a,r=>n(0,e=r)),[e,a]}class he extends B{constructor(t){super(),H(this,t,se,re,j,{})}}export{he as component};
