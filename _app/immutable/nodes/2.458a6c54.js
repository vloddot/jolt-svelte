import{s as X,v as ge,f as V,g as H,h as N,d as v,j as a,i as j,z as C,A as T,B as we,w as ve,x as be,y as ke,C as Se,D as Ie,E as q,F as P,u as k,a as U,c as J,G as je,r as ee,o as ye,H as Oe,e as G,I as te,l as re,m as se,n as $e}from"../chunks/scheduler.7420d6ca.js";import{h as De,u as Ee}from"../chunks/await_block.08f6cb26.js";import{e as ae}from"../chunks/each.e59479a4.js";import{S as Y,i as Z,a as I,t as O,b as M,d as A,m as B,c as ie,e as R,g as ce}from"../chunks/index.637134e4.js";import{g as Ce}from"../chunks/navigation.f01edc3c.js";import{e as K}from"../chunks/singletons.ae8b5613.js";import{g as ue,s as Ne}from"../chunks/context.92045884.js";import{g as Ve,a as fe}from"../chunks/util.883c3f21.js";import{t as He,P as Le}from"../chunks/PlusIcon.a9ccaab6.js";import{s as Me}from"../chunks/context.527da73b.js";import{s as Ae,c as Be}from"../chunks/context.645f4abc.js";import{w as Re}from"../chunks/index.5b89e149.js";import{p as We}from"../chunks/stores.fafd9ada.js";function Ue(l){let e,r,t,s,n,o,c;const g=l[7].default,u=ge(g,l,l[6],null);return{c(){e=V("div"),r=V("a"),u&&u.c(),this.h()},l(f){e=H(f,"DIV",{class:!0,"data-focused":!0,"data-selected":!0,"data-unread":!0,"aria-selected":!0});var _=N(e);r=H(_,"A",{href:!0,tabindex:!0,"aria-label":!0,class:!0});var m=N(r);u&&u.l(m),m.forEach(v),_.forEach(v),this.h()},h(){a(r,"href",l[0]),a(r,"tabindex","0"),a(r,"aria-label",t=typeof l[1]=="string"&&l[2]!=null?l[1]:l[2]),a(r,"class","server-sidebar-icon svelte-1avlg8k"),a(e,"class","server-sidebar-icon-base svelte-1avlg8k"),a(e,"data-focused",l[5]),a(e,"data-selected",l[3]),a(e,"data-unread",l[4]),a(e,"aria-selected",l[3])},m(f,_){j(f,e,_),C(e,r),u&&u.m(r,null),n=!0,o||(c=[T(r,"mouseenter",l[8]),T(r,"mouseleave",l[9]),T(r,"focus",l[10]),T(r,"blur",l[11]),we(s=He.call(null,r,{placement:"right",content:l[1],theme:"right-tooltip",animation:"scale-subtle",duration:100,onShow:l[12]}))],o=!0)},p(f,[_]){u&&u.p&&(!n||_&64)&&ve(u,g,f,f[6],n?ke(g,f[6],_,null):be(f[6]),null),(!n||_&1)&&a(r,"href",f[0]),(!n||_&6&&t!==(t=typeof f[1]=="string"&&f[2]!=null?f[1]:f[2]))&&a(r,"aria-label",t),s&&Se(s.update)&&_&2&&s.update.call(null,{placement:"right",content:f[1],theme:"right-tooltip",animation:"scale-subtle",duration:100,onShow:f[12]}),(!n||_&32)&&a(e,"data-focused",f[5]),(!n||_&8)&&a(e,"data-selected",f[3]),(!n||_&16)&&a(e,"data-unread",f[4]),(!n||_&8)&&a(e,"aria-selected",f[3])},i(f){n||(I(u,f),n=!0)},o(f){O(u,f),n=!1},d(f){f&&v(e),u&&u.d(f),o=!1,Ie(c)}}}function Je(l,e,r){let{$$slots:t={},$$scope:s}=e,{href:n}=e,{tooltip:o}=e,{ariaLabel:c=void 0}=e,{selected:g}=e,{unread:u=!1}=e,f=!1;const _=()=>r(5,f=!0),m=()=>r(5,f=!1),D=()=>r(5,f=!0),E=()=>r(5,f=!1),b=function(){if(!o)return!1};return l.$$set=h=>{"href"in h&&r(0,n=h.href),"tooltip"in h&&r(1,o=h.tooltip),"ariaLabel"in h&&r(2,c=h.ariaLabel),"selected"in h&&r(3,g=h.selected),"unread"in h&&r(4,u=h.unread),"$$scope"in h&&r(6,s=h.$$scope)},[n,o,c,g,u,f,s,t,_,m,D,E,b]}class F extends Y{constructor(e){super(),Z(this,e,Je,Ue,X,{href:0,tooltip:1,ariaLabel:2,selected:3,unread:4})}}function Ke(l){let e,r;return{c(){e=q("svg"),r=q("path"),this.h()},l(t){e=P(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var s=N(e);r=P(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(r).forEach(v),s.forEach(v),this.h()},h(){a(r,"stroke-linecap","round"),a(r,"stroke-linejoin","round"),a(r,"d","M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(t,s){j(t,e,s),C(e,r)},p:k,i:k,o:k,d(t){t&&v(e)}}}class ze extends Y{constructor(e){super(),Z(this,e,null,Ke,X,{})}}function Ge(l){let e,r,t;return{c(){e=q("svg"),r=q("path"),t=q("path"),this.h()},l(s){e=P(s,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var n=N(e);r=P(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(r).forEach(v),t=P(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(v),n.forEach(v),this.h()},h(){a(r,"stroke-linecap","round"),a(r,"stroke-linejoin","round"),a(r,"d","M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"),a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"stroke-width","1.5"),a(e,"stroke","currentColor"),a(e,"width","24px"),a(e,"height","24px")},m(s,n){j(s,e,n),C(e,r),C(e,t)},p:k,i:k,o:k,d(s){s&&v(e)}}}class qe extends Y{constructor(e){super(),Z(this,e,null,Ge,X,{})}}function _e(l,e,r){const t=l.slice();return t[9]=e[r],t}function Pe(l){const e=l.slice(),r=e[9].name.split(" ");return e[12]=r,e}function Fe(l){let e,r,t={ctx:l,current:null,token:null,hasCatch:!1,pending:Ze,then:Xe,catch:Qe,value:13,blocks:[,,,]};return De(l[5].user??l[5].api.fetchUser("@me"),t),{c(){e=G(),t.block.c()},l(s){e=G(),t.block.l(s)},m(s,n){j(s,e,n),t.block.m(s,t.anchor=n),t.mount=()=>e.parentNode,t.anchor=e,r=!0},p(s,n){l=s,Ee(t,l,n)},i(s){r||(I(t.block),r=!0)},o(s){for(let n=0;n<3;n+=1){const o=t.blocks[n];O(o)}r=!1},d(s){s&&v(e),t.block.d(s),t.token=null,t=null}}}function Te(l){var n;let e,r,t,s;return e=new F({props:{selected:((n=l[3].route.id)==null?void 0:n.startsWith("/(app)/(home)"))??!1,href:K+"/",tooltip:"Home",$$slots:{default:[xe]},$$scope:{ctx:l}}}),{c(){M(e.$$.fragment),r=U(),t=V("hr")},l(o){A(e.$$.fragment,o),r=J(o),t=H(o,"HR",{})},m(o,c){B(e,o,c),j(o,r,c),j(o,t,c),s=!0},p(o,c){var u;const g={};c&8&&(g.selected=((u=o[3].route.id)==null?void 0:u.startsWith("/(app)/(home)"))??!1),c&256&&(g.$$scope={dirty:c,ctx:o}),e.$set(g)},i(o){s||(I(e.$$.fragment,o),s=!0)},o(o){O(e.$$.fragment,o),s=!1},d(o){o&&(v(r),v(t)),R(e,o)}}}function Qe(l){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function Xe(l){var n;let e,r,t,s;return e=new F({props:{href:K+"/",selected:((n=l[3].route.id)==null?void 0:n.startsWith("/(app)/(home)"))??!1,ariaLabel:"Home",tooltip:l[13].username+"#"+l[13].discriminator,$$slots:{default:[Ye]},$$scope:{ctx:l}}}),{c(){M(e.$$.fragment),r=U(),t=V("hr")},l(o){A(e.$$.fragment,o),r=J(o),t=H(o,"HR",{})},m(o,c){B(e,o,c),j(o,r,c),j(o,t,c),s=!0},p(o,c){var u;const g={};c&8&&(g.selected=((u=o[3].route.id)==null?void 0:u.startsWith("/(app)/(home)"))??!1),c&256&&(g.$$scope={dirty:c,ctx:o}),e.$set(g)},i(o){s||(I(e.$$.fragment,o),s=!0)},o(o){O(e.$$.fragment,o),s=!1},d(o){o&&(v(r),v(t)),R(e,o)}}}function Ye(l){let e,r;return{c(){e=V("img"),this.h()},l(t){e=H(t,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){a(e,"class","cover"),te(e.src,r=Ve(l[13]))||a(e,"src",r),a(e,"alt","Home"),a(e,"width","42px"),a(e,"height","42px")},m(t,s){j(t,e,s)},p:k,d(t){t&&v(e)}}}function Ze(l){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function xe(l){let e,r;return e=new ze({}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function et(l){let e,r,t;return{c(){e=V("img"),this.h()},l(s){e=H(s,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){a(e,"class","cover"),te(e.src,r=fe(l[9].icon,{max_side:"256"}))||a(e,"src",r),a(e,"alt",t=l[9].name),a(e,"width","42px"),a(e,"height","42px")},m(s,n){j(s,e,n)},p(s,n){n&1&&!te(e.src,r=fe(s[9].icon,{max_side:"256"}))&&a(e,"src",r),n&1&&t!==(t=s[9].name)&&a(e,"alt",t)},d(s){s&&v(e)}}}function me(l){let e;function r(n,o){return n[12].length>3?rt:tt}let t=r(l),s=t(l);return{c(){s.c(),e=G()},l(n){s.l(n),e=G()},m(n,o){s.m(n,o),j(n,e,o)},p(n,o){t===(t=r(n))&&s?s.p(n,o):(s.d(1),s=t(n),s&&(s.c(),s.m(e.parentNode,e)))},d(n){n&&v(e),s.d(n)}}}function tt(l){let e=l[12].map(pe).join("")+"",r;return{c(){r=re(e)},l(t){r=se(t,e)},m(t,s){j(t,r,s)},p(t,s){s&1&&e!==(e=t[12].map(pe).join("")+"")&&$e(r,e)},d(t){t&&v(r)}}}function rt(l){let e=l[12].slice(0,3).map(he).join("")+"",r,t;return{c(){r=re(e),t=re("...")},l(s){r=se(s,e),t=se(s,"...")},m(s,n){j(s,r,n),j(s,t,n)},p(s,n){n&1&&e!==(e=s[12].slice(0,3).map(he).join("")+"")&&$e(r,e)},d(s){s&&(v(r),v(t))}}}function st(l){let e;function r(o,c){return o[9].icon==null||o[1]["jolt:low-data-mode"]?me:et}function t(o,c){return c===me?Pe(o):o}let s=r(l),n=s(t(l,s));return{c(){n.c(),e=G()},l(o){n.l(o),e=G()},m(o,c){n.m(o,c),j(o,e,c)},p(o,c){s===(s=r(o))&&n?n.p(t(o,s),c):(n.d(1),n=s(t(o,s)),n&&(n.c(),n.m(e.parentNode,e)))},d(o){o&&v(e),n.d(o)}}}function de(l){let e,r;return e=new F({props:{href:K+"/servers/"+l[9]._id+"/channels/"+l[9].channels[0],tooltip:l[9].name,selected:l[2]==l[9]._id,$$slots:{default:[st]},$$scope:{ctx:l}}}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},p(t,s){const n={};s&1&&(n.href=K+"/servers/"+t[9]._id+"/channels/"+t[9].channels[0]),s&1&&(n.tooltip=t[9].name),s&5&&(n.selected=t[2]==t[9]._id),s&259&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function lt(l){let e,r;return e=new Le({}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function nt(l){let e,r;return e=new qe({}),{c(){M(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){O(e.$$.fragment,t),r=!1},d(t){R(e,t)}}}function ot(l){var le;let e,r,t,s,n,o,c,g,u,f,_,m,D;const E=[Te,Fe],b=[];function h(i,p){return i[1]["jolt:low-data-mode"]?0:1}t=h(l),s=b[t]=E[t](l);let w=ae(l[0]),d=[];for(let i=0;i<w.length;i+=1)d[i]=de(_e(l,w,i));const L=i=>O(d[i],1,1,()=>{d[i]=null});c=new F({props:{selected:l[3].route.id=="/(app)/servers/create",href:K+"/servers/create",tooltip:"Create Server",$$slots:{default:[lt]},$$scope:{ctx:l}}}),_=new F({props:{selected:((le=l[3].route.id)==null?void 0:le.startsWith("/(app)/settings"))??!1,href:K+"/settings",tooltip:"Settings",$$slots:{default:[nt]},$$scope:{ctx:l}}});const z=l[7].default,S=ge(z,l,l[8],null);return{c(){e=V("div"),r=V("div"),s.c(),n=U();for(let i=0;i<d.length;i+=1)d[i].c();o=U(),M(c.$$.fragment),g=U(),u=V("div"),f=U(),M(_.$$.fragment),m=U(),S&&S.c(),this.h()},l(i){e=H(i,"DIV",{class:!0});var p=N(e);r=H(p,"DIV",{class:!0});var $=N(r);s.l($),n=J($);for(let W=0;W<d.length;W+=1)d[W].l($);o=J($),A(c.$$.fragment,$),g=J($),u=H($,"DIV",{class:!0}),N(u).forEach(v),f=J($),A(_.$$.fragment,$),$.forEach(v),m=J(p),S&&S.l(p),p.forEach(v),this.h()},h(){a(u,"class","flex-1"),a(r,"class","server-sidebar-container svelte-dknhv2"),a(e,"class","app-container svelte-dknhv2")},m(i,p){j(i,e,p),C(e,r),b[t].m(r,null),C(r,n);for(let $=0;$<d.length;$+=1)d[$]&&d[$].m(r,null);C(r,o),B(c,r,null),C(r,g),C(r,u),C(r,f),B(_,r,null),C(e,m),S&&S.m(e,null),D=!0},p(i,[p]){var ne;let $=t;if(t=h(i),t===$?b[t].p(i,p):(ce(),O(b[$],1,1,()=>{b[$]=null}),ie(),s=b[t],s?s.p(i,p):(s=b[t]=E[t](i),s.c()),I(s,1),s.m(r,n)),p&7){w=ae(i[0]);let y;for(y=0;y<w.length;y+=1){const oe=_e(i,w,y);d[y]?(d[y].p(oe,p),I(d[y],1)):(d[y]=de(oe),d[y].c(),I(d[y],1),d[y].m(r,o))}for(ce(),y=w.length;y<d.length;y+=1)L(y);ie()}const W={};p&8&&(W.selected=i[3].route.id=="/(app)/servers/create"),p&256&&(W.$$scope={dirty:p,ctx:i}),c.$set(W);const x={};p&8&&(x.selected=((ne=i[3].route.id)==null?void 0:ne.startsWith("/(app)/settings"))??!1),p&256&&(x.$$scope={dirty:p,ctx:i}),_.$set(x),S&&S.p&&(!D||p&256)&&ve(S,z,i,i[8],D?ke(z,i[8],p,null):be(i[8]),null)},i(i){if(!D){I(s);for(let p=0;p<w.length;p+=1)I(d[p]);I(c.$$.fragment,i),I(_.$$.fragment,i),I(S,i),D=!0}},o(i){O(s),d=d.filter(Boolean);for(let p=0;p<d.length;p+=1)O(d[p]);O(c.$$.fragment,i),O(_.$$.fragment,i),O(S,i),D=!1},d(i){i&&v(e),b[t].d(),je(d,i),R(c),R(_),S&&S.d(i)}}}function Q(l,e){return l.sort((r,t)=>{const s=e.indexOf(r._id)??-1,n=e.indexOf(t._id)??-1;return n==-1?-1:s==-1?1:s-n})}const he=l=>l[0],pe=l=>l[0];function at(l,e,r){let t,s,n;ee(l,We,m=>r(3,n=m));let{$$slots:o={},$$scope:c}=e;const g=ue(Ae);ee(l,g,m=>r(1,t=m));const u=ue(Be),f=Re();ee(l,f,m=>r(2,s=m)),Ne(Me,f);let _=Array.from(u.api.cache.servers.values());return g.subscribe(m=>{r(0,_=Q(_,m.ordering.servers??[]))}),u.on("ServerCreate",()=>{r(0,_=Q(Array.from(u.api.cache.servers.values()),t.ordering.servers??[]))}),u.on("ServerDelete",({id:m})=>{r(0,_=Q(Array.from(u.api.cache.servers.values()),t.ordering.servers??[])),s==m&&Ce(`${K}/`)}),u.on("Ready",m=>{r(0,_=Q(m.servers,t.ordering.servers??[]))}),ye(async()=>{const m=Oe(g);for(const b of Object.keys(m)){const h=localStorage.getItem(b);h!=null&&(m[b]=JSON.parse(h))}const D=await u.api.fetchSettings(Object.keys(m)),E={};for(const[b,h]of Object.entries(m)){const w=`revision:${b}`,d=D[b];if(d==null)continue;const[L,z]=d,S=Number(localStorage.getItem(w)??"0");L!=S&&(L>S?(localStorage.setItem(w,L.toString()),localStorage.setItem(b,z),m[b]=JSON.parse(z)):E[b]=h)}Object.keys(E).length!=0&&u.api.setSettings(E),g.set(m),g.subscribe(b=>{for(const[h,w]of Object.entries(b))localStorage.setItem(h,JSON.stringify(w))})}),u.on("UserSettingsUpdate",({id:m,update:D})=>{var b;if(m!=((b=u.user)==null?void 0:b._id))return;let E={};for(const[h,[w,d]]of Object.entries(D)){const L=`revision:${h}`;w>Number(localStorage.getItem(L))&&(localStorage.setItem(L,w.toString()),localStorage.setItem(h,d),E[h]=JSON.parse(d))}g.update(h=>{for(const[w,d]of Object.entries(E))h[w]=d;return h})}),l.$$set=m=>{"$$scope"in m&&r(8,c=m.$$scope)},[_,t,s,n,g,u,f,o,c]}class $t extends Y{constructor(e){super(),Z(this,e,at,ot,X,{})}}export{$t as component};
