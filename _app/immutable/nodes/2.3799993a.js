import{s as Y,v as _e,f as L,g as M,h as O,d as v,j as o,i as C,z as E,A as T,B as be,w as pe,x as ge,y as ve,C as ke,D as $e,E as G,F as J,u as b,a as U,c as q,G as we,r as te,o as Se,H as Ie,e as X,I as re,l as je,m as ye,n as De}from"../chunks/scheduler.693b9c9b.js";import{h as Ce,u as Ee}from"../chunks/await_block.1641c5fa.js";import{e as ne}from"../chunks/each.e59479a4.js";import{S as Z,i as x,a as I,t as D,b as N,d as B,m as R,c as ae,e as W,g as oe}from"../chunks/index.bb1ba657.js";import{g as Oe}from"../chunks/navigation.3d4cfb14.js";import{b as z}from"../chunks/paths.a0b5f327.js";import{g as ie,s as ce,a as Ve,c as He}from"../chunks/context.ca3e4b8d.js";import{g as Le,a as ue}from"../chunks/util.883c3f21.js";import{t as Me,P as Ae}from"../chunks/PlusIcon.80cf0953.js";import{s as Ne,a as Be}from"../chunks/context.fa34f1f8.js";import{w as fe}from"../chunks/index.f1869c04.js";import{p as Re}from"../chunks/stores.07428380.js";function We(l){let e,r,t,s,n,a,f;const g=l[7].default,c=_e(g,l,l[6],null);return{c(){e=L("div"),r=L("a"),c&&c.c(),this.h()},l(u){e=M(u,"DIV",{class:!0,"data-focused":!0,"data-selected":!0,"data-unread":!0,"aria-selected":!0});var _=O(e);r=M(_,"A",{href:!0,tabindex:!0,"aria-label":!0,class:!0});var j=O(r);c&&c.l(j),j.forEach(v),_.forEach(v),this.h()},h(){o(r,"href",l[0]),o(r,"tabindex","0"),o(r,"aria-label",t=typeof l[1]=="string"&&l[2]!=null?l[1]:l[2]),o(r,"class","server-sidebar-icon svelte-ouf4o9"),o(e,"class","server-sidebar-icon-base svelte-ouf4o9"),o(e,"data-focused",l[5]),o(e,"data-selected",l[3]),o(e,"data-unread",l[4]),o(e,"aria-selected",l[3])},m(u,_){C(u,e,_),E(e,r),c&&c.m(r,null),n=!0,a||(f=[T(r,"mouseenter",l[8]),T(r,"mouseleave",l[9]),T(r,"focus",l[10]),T(r,"blur",l[11]),be(s=Me.call(null,r,{placement:"right",content:l[1],theme:"right-tooltip",animation:"scale-subtle",duration:100,onShow:l[12]}))],a=!0)},p(u,[_]){c&&c.p&&(!n||_&64)&&pe(c,g,u,u[6],n?ve(g,u[6],_,null):ge(u[6]),null),(!n||_&1)&&o(r,"href",u[0]),(!n||_&6&&t!==(t=typeof u[1]=="string"&&u[2]!=null?u[1]:u[2]))&&o(r,"aria-label",t),s&&ke(s.update)&&_&2&&s.update.call(null,{placement:"right",content:u[1],theme:"right-tooltip",animation:"scale-subtle",duration:100,onShow:u[12]}),(!n||_&32)&&o(e,"data-focused",u[5]),(!n||_&8)&&o(e,"data-selected",u[3]),(!n||_&16)&&o(e,"data-unread",u[4]),(!n||_&8)&&o(e,"aria-selected",u[3])},i(u){n||(I(c,u),n=!0)},o(u){D(c,u),n=!1},d(u){u&&v(e),c&&c.d(u),a=!1,$e(f)}}}function Ke(l,e,r){let{$$slots:t={},$$scope:s}=e,{href:n}=e,{tooltip:a}=e,{ariaLabel:f=void 0}=e,{selected:g}=e,{unread:c=!1}=e,u=!1;const _=()=>r(5,u=!0),j=()=>r(5,u=!1),m=()=>r(5,u=!0),A=()=>r(5,u=!1),w=function(){if(!a)return!1};return l.$$set=p=>{"href"in p&&r(0,n=p.href),"tooltip"in p&&r(1,a=p.tooltip),"ariaLabel"in p&&r(2,f=p.ariaLabel),"selected"in p&&r(3,g=p.selected),"unread"in p&&r(4,c=p.unread),"$$scope"in p&&r(6,s=p.$$scope)},[n,a,f,g,c,u,s,t,_,j,m,A,w]}class P extends Z{constructor(e){super(),x(this,e,Ke,We,Y,{href:0,tooltip:1,ariaLabel:2,selected:3,unread:4})}}function Ue(l){let e,r;return{c(){e=G("svg"),r=G("path"),this.h()},l(t){e=J(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var s=O(e);r=J(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),O(r).forEach(v),s.forEach(v),this.h()},h(){o(r,"stroke-linecap","round"),o(r,"stroke-linejoin","round"),o(r,"d","M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),o(e,"xmlns","http://www.w3.org/2000/svg"),o(e,"fill","none"),o(e,"viewBox","0 0 24 24"),o(e,"stroke-width","1.5"),o(e,"stroke","currentColor"),o(e,"width","24px"),o(e,"height","24px")},m(t,s){C(t,e,s),E(e,r)},p:b,i:b,o:b,d(t){t&&v(e)}}}class qe extends Z{constructor(e){super(),x(this,e,null,Ue,Y,{})}}function ze(l){let e,r,t;return{c(){e=G("svg"),r=G("path"),t=G("path"),this.h()},l(s){e=J(s,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,width:!0,height:!0});var n=O(e);r=J(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),O(r).forEach(v),t=J(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),O(t).forEach(v),n.forEach(v),this.h()},h(){o(r,"stroke-linecap","round"),o(r,"stroke-linejoin","round"),o(r,"d","M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"),o(t,"stroke-linecap","round"),o(t,"stroke-linejoin","round"),o(t,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),o(e,"xmlns","http://www.w3.org/2000/svg"),o(e,"fill","none"),o(e,"viewBox","0 0 24 24"),o(e,"stroke-width","1.5"),o(e,"stroke","currentColor"),o(e,"width","24px"),o(e,"height","24px")},m(s,n){C(s,e,n),E(e,r),E(e,t)},p:b,i:b,o:b,d(s){s&&v(e)}}}class Ge extends Z{constructor(e){super(),x(this,e,null,ze,Y,{})}}function me(l,e,r){const t=l.slice();return t[10]=e[r],t}function Je(l){let e,r,t={ctx:l,current:null,token:null,hasCatch:!1,pending:Xe,then:Te,catch:Fe,value:13,blocks:[,,,]};return Ce(l[5].user??l[5].api.fetchUser("@me"),t),{c(){e=X(),t.block.c()},l(s){e=X(),t.block.l(s)},m(s,n){C(s,e,n),t.block.m(s,t.anchor=n),t.mount=()=>e.parentNode,t.anchor=e,r=!0},p(s,n){l=s,Ee(t,l,n)},i(s){r||(I(t.block),r=!0)},o(s){for(let n=0;n<3;n+=1){const a=t.blocks[n];D(a)}r=!1},d(s){s&&v(e),t.block.d(s),t.token=null,t=null}}}function Pe(l){var n;let e,r,t,s;return e=new P({props:{selected:((n=l[3].route.id)==null?void 0:n.startsWith("/(app)/(home)"))??!1,href:z+"/",tooltip:"Home",$$slots:{default:[Ye]},$$scope:{ctx:l}}}),{c(){N(e.$$.fragment),r=U(),t=L("hr")},l(a){B(e.$$.fragment,a),r=q(a),t=M(a,"HR",{})},m(a,f){R(e,a,f),C(a,r,f),C(a,t,f),s=!0},p(a,f){var c;const g={};f&8&&(g.selected=((c=a[3].route.id)==null?void 0:c.startsWith("/(app)/(home)"))??!1),f&256&&(g.$$scope={dirty:f,ctx:a}),e.$set(g)},i(a){s||(I(e.$$.fragment,a),s=!0)},o(a){D(e.$$.fragment,a),s=!1},d(a){a&&(v(r),v(t)),W(e,a)}}}function Fe(l){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function Te(l){var n;let e,r,t,s;return e=new P({props:{href:z+"/",selected:((n=l[3].route.id)==null?void 0:n.startsWith("/(app)/(home)"))??!1,ariaLabel:"Home",tooltip:l[13].username+"#"+l[13].discriminator,$$slots:{default:[Qe]},$$scope:{ctx:l}}}),{c(){N(e.$$.fragment),r=U(),t=L("hr")},l(a){B(e.$$.fragment,a),r=q(a),t=M(a,"HR",{})},m(a,f){R(e,a,f),C(a,r,f),C(a,t,f),s=!0},p(a,f){var c;const g={};f&8&&(g.selected=((c=a[3].route.id)==null?void 0:c.startsWith("/(app)/(home)"))??!1),f&256&&(g.$$scope={dirty:f,ctx:a}),e.$set(g)},i(a){s||(I(e.$$.fragment,a),s=!0)},o(a){D(e.$$.fragment,a),s=!1},d(a){a&&(v(r),v(t)),W(e,a)}}}function Qe(l){let e,r;return{c(){e=L("img"),this.h()},l(t){e=M(t,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){o(e,"class","cover"),re(e.src,r=Le(l[13]))||o(e,"src",r),o(e,"alt","Home"),o(e,"width","42px"),o(e,"height","42px")},m(t,s){C(t,e,s)},p:b,d(t){t&&v(e)}}}function Xe(l){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function Ye(l){let e,r;return e=new qe({}),{c(){N(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){W(e,t)}}}function Ze(l){let e,r,t;return{c(){e=L("img"),this.h()},l(s){e=M(s,"IMG",{class:!0,src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){o(e,"class","cover"),re(e.src,r=ue(l[10].icon,{max_side:"256"}))||o(e,"src",r),o(e,"alt",t=l[10].name),o(e,"width","42px"),o(e,"height","42px")},m(s,n){C(s,e,n)},p(s,n){n&1&&!re(e.src,r=ue(s[10].icon,{max_side:"256"}))&&o(e,"src",r),n&1&&t!==(t=s[10].name)&&o(e,"alt",t)},d(s){s&&v(e)}}}function xe(l){let e=l[10].name.split(" ").map(he).join("")+"",r;return{c(){r=je(e)},l(t){r=ye(t,e)},m(t,s){C(t,r,s)},p(t,s){s&1&&e!==(e=t[10].name.split(" ").map(he).join("")+"")&&De(r,e)},d(t){t&&v(r)}}}function et(l){let e;function r(n,a){return n[10].icon==null||n[1]["jolt:low-data-mode"]?xe:Ze}let t=r(l),s=t(l);return{c(){s.c(),e=X()},l(n){s.l(n),e=X()},m(n,a){s.m(n,a),C(n,e,a)},p(n,a){t===(t=r(n))&&s?s.p(n,a):(s.d(1),s=t(n),s&&(s.c(),s.m(e.parentNode,e)))},d(n){n&&v(e),s.d(n)}}}function de(l){let e,r;return e=new P({props:{href:z+"/servers/"+l[10]._id+"/channels/"+l[10].channels[0],tooltip:l[10].name,selected:l[2]==l[10]._id,$$slots:{default:[et]},$$scope:{ctx:l}}}),{c(){N(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),r=!0},p(t,s){const n={};s&1&&(n.href=z+"/servers/"+t[10]._id+"/channels/"+t[10].channels[0]),s&1&&(n.tooltip=t[10].name),s&5&&(n.selected=t[2]==t[10]._id),s&259&&(n.$$scope={dirty:s,ctx:t}),e.$set(n)},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){W(e,t)}}}function tt(l){let e,r;return e=new Ae({}),{c(){N(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){W(e,t)}}}function rt(l){let e,r;return e=new Ge({}),{c(){N(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),r=!0},i(t){r||(I(e.$$.fragment,t),r=!0)},o(t){D(e.$$.fragment,t),r=!1},d(t){W(e,t)}}}function st(l){var F;let e,r,t,s,n,a,f,g,c,u,_,j,m;const A=[Pe,Je],w=[];function p(i,h){return i[1]["jolt:low-data-mode"]?0:1}t=p(l),s=w[t]=A[t](l);let k=ne(l[0]),d=[];for(let i=0;i<k.length;i+=1)d[i]=de(me(l,k,i));const V=i=>D(d[i],1,1,()=>{d[i]=null});f=new P({props:{selected:l[3].route.id=="/(app)/servers/create",href:z+"/servers/create",tooltip:"Create Server",$$slots:{default:[tt]},$$scope:{ctx:l}}}),_=new P({props:{selected:((F=l[3].route.id)==null?void 0:F.startsWith("/(app)/settings"))??!1,href:z+"/settings",tooltip:"Settings",$$slots:{default:[rt]},$$scope:{ctx:l}}});const H=l[7].default,S=_e(H,l,l[8],null);return{c(){e=L("div"),r=L("div"),s.c(),n=U();for(let i=0;i<d.length;i+=1)d[i].c();a=U(),N(f.$$.fragment),g=U(),c=L("div"),u=U(),N(_.$$.fragment),j=U(),S&&S.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var h=O(e);r=M(h,"DIV",{class:!0});var $=O(r);s.l($),n=q($);for(let K=0;K<d.length;K+=1)d[K].l($);a=q($),B(f.$$.fragment,$),g=q($),c=M($,"DIV",{class:!0}),O(c).forEach(v),u=q($),B(_.$$.fragment,$),$.forEach(v),j=q(h),S&&S.l(h),h.forEach(v),this.h()},h(){o(c,"class","flex-1"),o(r,"class","server-sidebar-container svelte-1kqdmjg"),o(e,"class","app-container svelte-1kqdmjg")},m(i,h){C(i,e,h),E(e,r),w[t].m(r,null),E(r,n);for(let $=0;$<d.length;$+=1)d[$]&&d[$].m(r,null);E(r,a),R(f,r,null),E(r,g),E(r,c),E(r,u),R(_,r,null),E(e,j),S&&S.m(e,null),m=!0},p(i,[h]){var se;let $=t;if(t=p(i),t===$?w[t].p(i,h):(oe(),D(w[$],1,1,()=>{w[$]=null}),ae(),s=w[t],s?s.p(i,h):(s=w[t]=A[t](i),s.c()),I(s,1),s.m(r,n)),h&7){k=ne(i[0]);let y;for(y=0;y<k.length;y+=1){const le=me(i,k,y);d[y]?(d[y].p(le,h),I(d[y],1)):(d[y]=de(le),d[y].c(),I(d[y],1),d[y].m(r,a))}for(oe(),y=k.length;y<d.length;y+=1)V(y);ae()}const K={};h&8&&(K.selected=i[3].route.id=="/(app)/servers/create"),h&256&&(K.$$scope={dirty:h,ctx:i}),f.$set(K);const ee={};h&8&&(ee.selected=((se=i[3].route.id)==null?void 0:se.startsWith("/(app)/settings"))??!1),h&256&&(ee.$$scope={dirty:h,ctx:i}),_.$set(ee),S&&S.p&&(!m||h&256)&&pe(S,H,i,i[8],m?ve(H,i[8],h,null):ge(i[8]),null)},i(i){if(!m){I(s);for(let h=0;h<k.length;h+=1)I(d[h]);I(f.$$.fragment,i),I(_.$$.fragment,i),I(S,i),m=!0}},o(i){D(s),d=d.filter(Boolean);for(let h=0;h<d.length;h+=1)D(d[h]);D(f.$$.fragment,i),D(_.$$.fragment,i),D(S,i),m=!1},d(i){i&&v(e),w[t].d(),we(d,i),W(f),W(_),S&&S.d(i)}}}function Q(l,e){return l.sort((r,t)=>{const s=e.indexOf(r._id)??-1,n=e.indexOf(t._id)??-1;return n==-1?-1:s==-1?1:s-n})}const he=l=>l[0];function lt(l,e,r){let t,s,n;te(l,Re,m=>r(3,n=m));let{$$slots:a={},$$scope:f}=e;const g=ie(Ve);te(l,g,m=>r(1,t=m));const c=ie(He),u=fe();te(l,u,m=>r(2,s=m));const _=fe();ce(Ne,_),ce(Be,u);let j=Array.from(c.api.cache.servers.values());return g.subscribe(m=>{r(0,j=Q(j,m.ordering.servers??[]))}),c.on("ServerCreate",()=>{r(0,j=Q(Array.from(c.api.cache.servers.values()),t.ordering.servers??[]))}),c.on("ServerDelete",async({id:m})=>{r(0,j=Q(Array.from(c.api.cache.servers.values()),t.ordering.servers??[])),s==m&&await Oe(`${z}/`)}),c.on("Ready",m=>{r(0,j=Q(m.servers,t.ordering.servers??[]))}),Se(async()=>{const m=Ie(g);for(const p of Object.keys(m)){const k=localStorage.getItem(p);k!=null&&(m[p]=JSON.parse(k))}const A=await c.api.fetchSettings(Object.keys(m)),w={};for(const[p,k]of Object.entries(m)){const d=`revision:${p}`,V=A[p];if(V==null)continue;const[H,S]=V,F=Number(localStorage.getItem(d)??"0");H>=F?(localStorage.setItem(d,H.toString()),localStorage.setItem(p,S),m[p]=JSON.parse(S)):w[p]=k}c.api.setSettings(w),g.set(m)}),c.on("UserSettingsUpdate",({id:m,update:A})=>{var p;if(m!=((p=c.user)==null?void 0:p._id))return;let w={};for(const[k,[d,V]]of Object.entries(A)){const H=`revision:${k}`;d>Number(localStorage.getItem(H))&&(localStorage.setItem(H,d.toString()),localStorage.setItem(k,V),w[k]=JSON.parse(V))}g.update(k=>{for(const[d,V]of Object.entries(w))k[d]=V;return k})}),l.$$set=m=>{"$$scope"in m&&r(8,f=m.$$scope)},[j,t,s,n,g,c,u,a,f]}class gt extends Z{constructor(e){super(),x(this,e,lt,st,Y,{})}}export{gt as component};
