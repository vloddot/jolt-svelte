import{s as x,n as m,d as ee,u as te,g as le,e as ne,c as T}from"../chunks/scheduler.0beedca7.js";import{S as oe,i as re,g as B,m as ce,s as w,h as N,j as I,n as ae,f as g,c as y,a as b,x as E,o as _e,d as p,p as v,b as C,t as d,B as A,e as k,k as ie,r as D,u as K,v as L,w as U}from"../chunks/index.433d2ede.js";import{h as S,u as R}from"../chunks/await_block.05af08bd.js";import{e as $}from"../chunks/each.e59479a4.js";import{p as me}from"../chunks/stores.8946f39a.js";import{g as M,c as se,s as he}from"../chunks/context.62a025aa.js";import{C as fe}from"../chunks/Channel.9dd4a37f.js";import{g as pe}from"../chunks/chunk-NMUKSDLG.3f77d6f4.js";import{n as de}from"../chunks/index.64c63431.js";import{s as ge,a as be}from"../chunks/context.4d0298a0.js";import{U as ke}from"../chunks/UserButton.7fb67515.js";function q(o,l,r){const t=o.slice();return t[4]=l[r],t}const $e=o=>({channel:o&1}),G=o=>({channel:o[7]});function ve(o){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Ce(o){let l,r;const t=o[3].default,e=ee(t,o,o[2],G);return{c(){e&&e.c(),l=w()},l(n){e&&e.l(n),l=y(n)},m(n,a){e&&e.m(n,a),b(n,l,a),r=!0},p(n,a){e&&e.p&&(!r||a&5)&&te(e,t,n,n[2],r?ne(t,n[2],a,$e):le(n[2]),G)},i(n){r||(p(e,n),r=!0)},o(n){d(e,n),r=!1},d(n){n&&g(l),e&&e.d(n)}}}function we(o){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function J(o){let l,r,t,e={ctx:o,current:null,token:null,hasCatch:!1,pending:we,then:Ce,catch:ve,value:7,blocks:[,,,]};return S(r=o[1].fetchChannel(o[4]),e),{c(){l=k(),e.block.c()},l(n){l=k(),e.block.l(n)},m(n,a){b(n,l,a),e.block.m(n,e.anchor=a),e.mount=()=>l.parentNode,e.anchor=l,t=!0},p(n,a){o=n,e.ctx=o,a&1&&r!==(r=o[1].fetchChannel(o[4]))&&S(r,e)||R(e,o,a)},i(n){t||(p(e.block),t=!0)},o(n){for(let a=0;a<3;a+=1){const f=e.blocks[a];d(f)}t=!1},d(n){n&&g(l),e.block.d(n),e.token=null,e=null}}}function ye(o){let l,r,t=o[0].title+"",e,n,a,f=$(o[0].channels),c=[];for(let i=0;i<f.length;i+=1)c[i]=J(q(o,f,i));const _=i=>d(c[i],1,1,()=>{c[i]=null});return{c(){l=B("details"),r=B("summary"),e=ce(t),n=w();for(let i=0;i<c.length;i+=1)c[i].c();this.h()},l(i){l=N(i,"DETAILS",{});var u=I(l);r=N(u,"SUMMARY",{});var s=I(r);e=ae(s,t),s.forEach(g),n=y(u);for(let h=0;h<c.length;h+=1)c[h].l(u);u.forEach(g),this.h()},h(){l.open=!0},m(i,u){b(i,l,u),E(l,r),E(r,e),E(l,n);for(let s=0;s<c.length;s+=1)c[s]&&c[s].m(l,null);a=!0},p(i,[u]){if((!a||u&1)&&t!==(t=i[0].title+"")&&_e(e,t),u&7){f=$(i[0].channels);let s;for(s=0;s<f.length;s+=1){const h=q(i,f,s);c[s]?(c[s].p(h,u),p(c[s],1)):(c[s]=J(h),c[s].c(),p(c[s],1),c[s].m(l,null))}for(v(),s=f.length;s<c.length;s+=1)_(s);C()}},i(i){if(!a){for(let u=0;u<f.length;u+=1)p(c[u]);a=!0}},o(i){c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)d(c[u]);a=!1},d(i){i&&g(l),A(c,i)}}}function Se(o,l,r){let{$$slots:t={},$$scope:e}=l;const n=M(se);let{category:a}=l;return o.$$set=f=>{"category"in f&&r(0,a=f.category),"$$scope"in f&&r(2,e=f.$$scope)},[a,n,e,t]}class Ee extends oe{constructor(l){super(),re(this,l,Se,ye,x,{category:0})}}function P(o,l,r){const t=o.slice();t[11]=l[r];const e=t[10].users.get(t[11]._id.user);return t[12]=e,t}function Y(o,l,r){const t=o.slice();return t[17]=l[r],t}function z(o,l,r){const t=o.slice();return t[20]=l[r],t}function V(o){const l=o.slice(),r=l[0].categories??[];l[15]=r;const t=l[0].channels.filter(function(...n){return o[8](l[15],...n)})??[];return l[16]=t,l}function F(o){let l,r,t,e=$(o[16]),n=[];for(let i=0;i<e.length;i+=1)n[i]=H(z(o,e,i));const a=i=>d(n[i],1,1,()=>{n[i]=null});let f=$(o[15]),c=[];for(let i=0;i<f.length;i+=1)c[i]=Q(Y(o,f,i));const _=i=>d(c[i],1,1,()=>{c[i]=null});return{c(){l=B("div");for(let i=0;i<n.length;i+=1)n[i].c();r=w();for(let i=0;i<c.length;i+=1)c[i].c();this.h()},l(i){l=N(i,"DIV",{class:!0});var u=I(l);for(let s=0;s<n.length;s+=1)n[s].l(u);r=y(u);for(let s=0;s<c.length;s+=1)c[s].l(u);u.forEach(g),this.h()},h(){ie(l,"class","channel-bar-container")},m(i,u){b(i,l,u);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(l,null);E(l,r);for(let s=0;s<c.length;s+=1)c[s]&&c[s].m(l,null);t=!0},p(i,u){if(u&3){e=$(i[16]);let s;for(s=0;s<e.length;s+=1){const h=z(i,e,s);n[s]?(n[s].p(h,u),p(n[s],1)):(n[s]=H(h),n[s].c(),p(n[s],1),n[s].m(l,r))}for(v(),s=e.length;s<n.length;s+=1)a(s);C()}if(u&9){f=$(i[15]);let s;for(s=0;s<f.length;s+=1){const h=Y(i,f,s);c[s]?(c[s].p(h,u),p(c[s],1)):(c[s]=Q(h),c[s].c(),p(c[s],1),c[s].m(l,null))}for(v(),s=f.length;s<c.length;s+=1)_(s);C()}},i(i){if(!t){for(let u=0;u<e.length;u+=1)p(n[u]);for(let u=0;u<f.length;u+=1)p(c[u]);t=!0}},o(i){n=n.filter(Boolean);for(let u=0;u<n.length;u+=1)d(n[u]);c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)d(c[u]);t=!1},d(i){i&&g(l),A(n,i),A(c,i)}}}function Me(o){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function Be(o){let l,r;return l=new fe({props:{channel:o[3]}}),{c(){D(l.$$.fragment)},l(t){K(l.$$.fragment,t)},m(t,e){L(l,t,e),r=!0},p(t,e){const n={};e&1&&(n.channel=t[3]),l.$set(n)},i(t){r||(p(l.$$.fragment,t),r=!0)},o(t){d(l.$$.fragment,t),r=!1},d(t){U(l,t)}}}function Ne(o){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function H(o){let l,r,t,e={ctx:o,current:null,token:null,hasCatch:!1,pending:Ne,then:Be,catch:Me,value:3,blocks:[,,,]};return S(r=o[1].fetchChannel(o[20]),e),{c(){l=k(),e.block.c()},l(n){l=k(),e.block.l(n)},m(n,a){b(n,l,a),e.block.m(n,e.anchor=a),e.mount=()=>l.parentNode,e.anchor=l,t=!0},p(n,a){o=n,e.ctx=o,a&1&&r!==(r=o[1].fetchChannel(o[20]))&&S(r,e)||R(e,o,a)},i(n){t||(p(e.block),t=!0)},o(n){for(let a=0;a<3;a+=1){const f=e.blocks[a];d(f)}t=!1},d(n){n&&g(l),e.block.d(n),e.token=null,e=null}}}function O(o){let l,r;return l=new fe({props:{channel:o[3]}}),{c(){D(l.$$.fragment)},l(t){K(l.$$.fragment,t)},m(t,e){L(l,t,e),r=!0},p(t,e){const n={};e&8&&(n.channel=t[3]),l.$set(n)},i(t){r||(p(l.$$.fragment,t),r=!0)},o(t){d(l.$$.fragment,t),r=!1},d(t){U(l,t)}}}function Ie(o){let l,r,t=o[3]!=null&&O(o);return{c(){t&&t.c(),l=w()},l(e){t&&t.l(e),l=y(e)},m(e,n){t&&t.m(e,n),b(e,l,n),r=!0},p(e,n){e[3]!=null?t?(t.p(e,n),n&8&&p(t,1)):(t=O(e),t.c(),p(t,1),t.m(l.parentNode,l)):t&&(v(),d(t,1,1,()=>{t=null}),C())},i(e){r||(p(t),r=!0)},o(e){d(t),r=!1},d(e){e&&g(l),t&&t.d(e)}}}function Q(o){let l,r;return l=new Ee({props:{category:o[17],$$slots:{default:[Ie,({channel:t})=>({3:t}),({channel:t})=>t?8:0]},$$scope:{ctx:o}}}),{c(){D(l.$$.fragment)},l(t){K(l.$$.fragment,t)},m(t,e){L(l,t,e),r=!0},p(t,e){const n={};e&1&&(n.category=t[17]),e&520&&(n.$$scope={dirty:e,ctx:t}),l.$set(n)},i(t){r||(p(l.$$.fragment,t),r=!0)},o(t){d(l.$$.fragment,t),r=!1},d(t){U(l,t)}}}function W(o){let l,r,t,e={ctx:o,current:null,token:null,hasCatch:!1,pending:Ke,then:De,catch:Ae,value:10,blocks:[,,,]};return S(r=o[1].fetchMembers(o[0]._id),e),{c(){l=B("div"),e.block.c(),this.h()},l(n){l=N(n,"DIV",{class:!0});var a=I(l);e.block.l(a),a.forEach(g),this.h()},h(){ie(l,"class","members-list-container")},m(n,a){b(n,l,a),e.block.m(l,e.anchor=null),e.mount=()=>l,e.anchor=null,t=!0},p(n,a){o=n,e.ctx=o,a&1&&r!==(r=o[1].fetchMembers(o[0]._id))&&S(r,e)||R(e,o,a)},i(n){t||(p(e.block),t=!0)},o(n){for(let a=0;a<3;a+=1){const f=e.blocks[a];d(f)}t=!1},d(n){n&&g(l),e.block.d(),e.token=null,e=null}}}function Ae(o){return{c:m,l:m,m,p:m,i:m,o:m,d:m}}function De(o){let l,r,t=$(o[10].members),e=[];for(let a=0;a<t.length;a+=1)e[a]=Z(P(o,t,a));const n=a=>d(e[a],1,1,()=>{e[a]=null});return{c(){for(let a=0;a<e.length;a+=1)e[a].c();l=k()},l(a){for(let f=0;f<e.length;f+=1)e[f].l(a);l=k()},m(a,f){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(a,f);b(a,l,f),r=!0},p(a,f){if(f&3){t=$(a[10].members);let c;for(c=0;c<t.length;c+=1){const _=P(a,t,c);e[c]?(e[c].p(_,f),p(e[c],1)):(e[c]=Z(_),e[c].c(),p(e[c],1),e[c].m(l.parentNode,l))}for(v(),c=t.length;c<e.length;c+=1)n(c);C()}},i(a){if(!r){for(let f=0;f<t.length;f+=1)p(e[f]);r=!0}},o(a){e=e.filter(Boolean);for(let f=0;f<e.length;f+=1)d(e[f]);r=!1},d(a){a&&g(l),A(e,a)}}}function X(o){let l,r;return l=new ke({props:{user:o[12],member:o[11]}}),{c(){D(l.$$.fragment)},l(t){K(l.$$.fragment,t)},m(t,e){L(l,t,e),r=!0},p(t,e){const n={};e&1&&(n.user=t[12]),e&1&&(n.member=t[11]),l.$set(n)},i(t){r||(p(l.$$.fragment,t),r=!0)},o(t){d(l.$$.fragment,t),r=!1},d(t){U(l,t)}}}function Z(o){let l,r,t=o[12]!=null&&X(o);return{c(){t&&t.c(),l=k()},l(e){t&&t.l(e),l=k()},m(e,n){t&&t.m(e,n),b(e,l,n),r=!0},p(e,n){e[12]!=null?t?(t.p(e,n),n&1&&p(t,1)):(t=X(e),t.c(),p(t,1),t.m(l.parentNode,l)):t&&(v(),d(t,1,1,()=>{t=null}),C())},i(e){r||(p(t),r=!0)},o(e){d(t),r=!1},d(e){e&&g(l),t&&t.d(e)}}}function Ke(o){let l;return{c(){l=ce("Loading...")},l(r){l=ae(r,"Loading...")},m(r,t){b(r,l,t)},p:m,i:m,o:m,d(r){r&&g(l)}}}function Le(o){let l,r,t,e,n=o[0]!=null&&F(V(o));const a=o[7].default,f=ee(a,o,o[9],null);let c=o[0]!=null&&W(o);return{c(){n&&n.c(),l=w(),f&&f.c(),r=w(),c&&c.c(),t=k()},l(_){n&&n.l(_),l=y(_),f&&f.l(_),r=y(_),c&&c.l(_),t=k()},m(_,i){n&&n.m(_,i),b(_,l,i),f&&f.m(_,i),b(_,r,i),c&&c.m(_,i),b(_,t,i),e=!0},p(_,[i]){_[0]!=null?n?(n.p(V(_),i),i&1&&p(n,1)):(n=F(V(_)),n.c(),p(n,1),n.m(l.parentNode,l)):n&&(v(),d(n,1,1,()=>{n=null}),C()),f&&f.p&&(!e||i&512)&&te(f,a,_,_[9],e?ne(a,_[9],i,null):le(_[9]),null),_[0]!=null?c?(c.p(_,i),i&1&&p(c,1)):(c=W(_),c.c(),p(c,1),c.m(t.parentNode,t)):c&&(v(),d(c,1,1,()=>{c=null}),C())},i(_){e||(p(n),p(f,_),p(c),e=!0)},o(_){d(n),d(f,_),d(c),e=!1},d(_){_&&(g(l),g(r),g(t)),n&&n.d(_),f&&f.d(_),c&&c.d(_)}}}function Ue(o,l,r){let t,e,n,a;T(o,me,h=>r(6,a=h));let{$$slots:f={},$$scope:c}=l;const _=M(se),i=M(ge);T(o,i,h=>r(5,e=h));const u=M(be);T(o,u,h=>r(0,n=h));const s=(h,j)=>h.find(ue=>j!=null&&ue.channels.includes(j))==null;return o.$$set=h=>{"$$scope"in h&&r(9,c=h.$$scope)},o.$$.update=()=>{if(o.$$.dirty&64&&r(4,t=a.params),o.$$.dirty&33){let h="Jolt - ";n==null?h+="Server":h+=n.name,e!=null&&e.channel_type!="DirectMessage"&&e.channel_type!="SavedMessages"&&(h+=` | #${e.name}`),"__TAURI__"in window?pe.setTitle(h):document.title=h}if(o.$$.dirty&16){const h=document.getElementById(`MESSAGE-${t.mid}`);h==null?he(de,t.mid):(h==null||h.scrollIntoView({behavior:"smooth",block:"center"}),h.animate([{backgroundColor:"var(--mention)"},{backgroundColor:"var(--mention)",offset:.6},{backgroundColor:"transparent"}],{duration:3e3,iterations:1,easing:"ease"}))}},[n,_,u,i,t,e,a,f,s,c]}class He extends oe{constructor(l){super(),re(this,l,Ue,Le,x,{})}}export{He as component};
