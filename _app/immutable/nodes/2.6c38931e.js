import{s as te,n as b,f as G,d as ae,u as ce,g as fe,e as ue,c as T,o as _e}from"../chunks/scheduler.1c041516.js";import{S as ne,i as se,g as N,m as oe,s as A,h as E,j as K,n as le,f as g,c as O,k as v,a as C,x as y,o as ie,r as H,u as J,v as U,t as k,b as P,d,w as q,e as L,p as B,y as he}from"../chunks/index.69b25549.js";import{h as z,u as me}from"../chunks/await_block.5a2be2b2.js";import{e as F}from"../chunks/each.e59479a4.js";import{g as pe}from"../chunks/navigation.184bcf5c.js";import{b as D}from"../chunks/paths.1bf187e1.js";import{g as Q,s as W,a as de,c as ge}from"../chunks/context.03d0c4ff.js";/* empty css                      */import{g as X,a as Y}from"../chunks/util.d0b945c2.js";import{s as be,a as ve}from"../chunks/context.fa34f1f8.js";import{w as Z}from"../chunks/index.cd290ac5.js";function ke(i){let e,n;return{c(){e=N("img"),this.h()},l(r){e=E(r,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){v(e,"class","sidebar-icon group-hover:rounded-xl group-hover:bg-green-600 group-hover:text-white"),G(e.src,n=i[2])||v(e,"src",n),v(e,"alt",i[1])},m(r,t){C(r,e,t)},p(r,t){t&4&&!G(e.src,n=r[2])&&v(e,"src",n),t&2&&v(e,"alt",r[1])},d(r){r&&g(e)}}}function $e(i){let e,n;return{c(){e=N("span"),n=oe(i[3]),this.h()},l(r){e=E(r,"SPAN",{class:!0});var t=K(e);n=le(t,i[3]),t.forEach(g),this.h()},h(){v(e,"class","sidebar-icon group-hover:rounded-xl group-hover:bg-green-600 group-hover:text-white overflow-ellipsis")},m(r,t){C(r,e,t),y(e,n)},p(r,t){t&8&&ie(n,r[3])},d(r){r&&g(e)}}}function Se(i){let e,n,r,t,s;function l(c,h){return c[2]==null?$e:ke}let a=l(i),o=a(i);return{c(){e=N("div"),n=N("span"),r=oe(i[1]),t=A(),s=N("a"),o.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var h=K(e);n=E(h,"SPAN",{class:!0});var p=K(n);r=le(p,i[1]),p.forEach(g),t=O(h),s=E(h,"A",{href:!0,"aria-label":!0});var u=K(s);o.l(u),u.forEach(g),h.forEach(g),this.h()},h(){v(n,"class","sidebar-tooltip group-hover:scale-100"),v(s,"href",i[0]),v(s,"aria-label",i[1]),v(e,"class","group m-0")},m(c,h){C(c,e,h),y(e,n),y(n,r),y(e,t),y(e,s),o.m(s,null)},p(c,[h]){h&2&&ie(r,c[1]),a===(a=l(c))&&o?o.p(c,h):(o.d(1),o=a(c),o&&(o.c(),o.m(s,null))),h&1&&v(s,"href",c[0]),h&2&&v(s,"aria-label",c[1])},i:b,o:b,d(c){c&&g(e),o.d()}}}function we(i,e,n){let r,{href:t}=e,{tooltip:s}=e,{icon:l=void 0}=e;return i.$$set=a=>{"href"in a&&n(0,t=a.href),"tooltip"in a&&n(1,s=a.tooltip),"icon"in a&&n(2,l=a.icon)},i.$$.update=()=>{i.$$.dirty&2&&n(3,r=s.split(" ").map(a=>a[0]).join(""))},[t,s,l,r]}class M extends ne{constructor(e){super(),se(this,e,we,Se,te,{href:0,tooltip:1,icon:2})}}function x(i,e,n){const r=i.slice();return r[9]=e[n],r}function Ie(i){let e,n,r,t={ctx:i,current:null,token:null,hasCatch:!1,pending:Ne,then:Ce,catch:De,value:12,blocks:[,,,]};return z(n=i[0].user??i[0].api.fetchUser("@me"),t),{c(){e=L(),t.block.c()},l(s){e=L(),t.block.l(s)},m(s,l){C(s,e,l),t.block.m(s,t.anchor=l),t.mount=()=>e.parentNode,t.anchor=e,r=!0},p(s,l){i=s,t.ctx=i,l&1&&n!==(n=i[0].user??i[0].api.fetchUser("@me"))&&z(n,t)||me(t,i,l)},i(s){r||(d(t.block),r=!0)},o(s){for(let l=0;l<3;l+=1){const a=t.blocks[l];k(a)}r=!1},d(s){s&&g(e),t.block.d(s),t.token=null,t=null}}}function ye(i){let e,n,r,t;return e=new M({props:{href:D,tooltip:"Home",icon:D+"/home.svg"}}),{c(){H(e.$$.fragment),n=A(),r=N("hr"),this.h()},l(s){J(e.$$.fragment,s),n=O(s),r=E(s,"HR",{class:!0}),this.h()},h(){v(r,"class","border-gray-600 mx-4")},m(s,l){U(e,s,l),C(s,n,l),C(s,r,l),t=!0},p:b,i(s){t||(d(e.$$.fragment,s),t=!0)},o(s){k(e.$$.fragment,s),t=!1},d(s){s&&(g(n),g(r)),q(e,s)}}}function De(i){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function Ce(i){let e,n,r,t;return e=new M({props:{href:D+"/",tooltip:i[12].username+"#"+i[12].discriminator,icon:X(i[0].user)}}),{c(){H(e.$$.fragment),n=A(),r=N("hr"),this.h()},l(s){J(e.$$.fragment,s),n=O(s),r=E(s,"HR",{class:!0}),this.h()},h(){v(r,"class","border-gray-600 mx-4")},m(s,l){U(e,s,l),C(s,n,l),C(s,r,l),t=!0},p(s,l){const a={};l&1&&(a.tooltip=s[12].username+"#"+s[12].discriminator),l&1&&(a.icon=X(s[0].user)),e.$set(a)},i(s){t||(d(e.$$.fragment,s),t=!0)},o(s){k(e.$$.fragment,s),t=!1},d(s){s&&(g(n),g(r)),q(e,s)}}}function Ne(i){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function ee(i){let e,n,r=F(i[1]),t=[];for(let l=0;l<r.length;l+=1)t[l]=re(x(i,r,l));const s=l=>k(t[l],1,1,()=>{t[l]=null});return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=L()},l(l){for(let a=0;a<t.length;a+=1)t[a].l(l);e=L()},m(l,a){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(l,a);C(l,e,a),n=!0},p(l,a){if(a&6){r=F(l[1]);let o;for(o=0;o<r.length;o+=1){const c=x(l,r,o);t[o]?(t[o].p(c,a),d(t[o],1)):(t[o]=re(c),t[o].c(),d(t[o],1),t[o].m(e.parentNode,e))}for(B(),o=r.length;o<t.length;o+=1)s(o);P()}},i(l){if(!n){for(let a=0;a<r.length;a+=1)d(t[a]);n=!0}},o(l){t=t.filter(Boolean);for(let a=0;a<t.length;a+=1)k(t[a]);n=!1},d(l){l&&g(e),he(t,l)}}}function Ee(i){let e,n;return e=new M({props:{href:D+"/servers/"+i[9]._id+"/channels/"+i[9].channels[0],tooltip:i[9].name,icon:i[9].icon==null?void 0:`${Y(i[9].icon,{max_side:"256"})}`}}),{c(){H(e.$$.fragment)},l(r){J(e.$$.fragment,r)},m(r,t){U(e,r,t),n=!0},p(r,t){const s={};t&2&&(s.href=D+"/servers/"+r[9]._id+"/channels/"+r[9].channels[0]),t&2&&(s.tooltip=r[9].name),t&2&&(s.icon=r[9].icon==null?void 0:`${Y(r[9].icon,{max_side:"256"})}`),e.$set(s)},i(r){n||(d(e.$$.fragment,r),n=!0)},o(r){k(e.$$.fragment,r),n=!1},d(r){q(e,r)}}}function Ae(i){let e,n;return e=new M({props:{href:D+"/servers/"+i[9]._id+"/channels/"+i[9].channels[0],tooltip:i[9].name}}),{c(){H(e.$$.fragment)},l(r){J(e.$$.fragment,r)},m(r,t){U(e,r,t),n=!0},p(r,t){const s={};t&2&&(s.href=D+"/servers/"+r[9]._id+"/channels/"+r[9].channels[0]),t&2&&(s.tooltip=r[9].name),e.$set(s)},i(r){n||(d(e.$$.fragment,r),n=!0)},o(r){k(e.$$.fragment,r),n=!1},d(r){q(e,r)}}}function re(i){let e,n,r,t;const s=[Ae,Ee],l=[];function a(o,c){return o[2]["jolt:low-data-mode"]?0:1}return e=a(i),n=l[e]=s[e](i),{c(){n.c(),r=L()},l(o){n.l(o),r=L()},m(o,c){l[e].m(o,c),C(o,r,c),t=!0},p(o,c){let h=e;e=a(o),e===h?l[e].p(o,c):(B(),k(l[h],1,1,()=>{l[h]=null}),P(),n=l[e],n?n.p(o,c):(n=l[e]=s[e](o),n.c()),d(n,1),n.m(r.parentNode,r))},i(o){t||(d(n),t=!0)},o(o){k(n),t=!1},d(o){o&&g(r),l[e].d(o)}}}function Oe(i){let e,n,r,t,s,l,a,o,c,h,p,u,m;const V=[ye,Ie],w=[];function j(f,$){return f[2]["jolt:low-data-mode"]?0:1}r=j(i),t=w[r]=V[r](i);let _=i[1]!=null&&ee(i);a=new M({props:{href:D+"/servers/create",icon:D+"/plus.svg",tooltip:"Create Server"}}),p=new M({props:{href:D+"/settings",icon:D+"/gears.svg",tooltip:"Settings"}});const R=i[6].default,I=ae(R,i,i[5],null);return{c(){e=N("div"),n=N("div"),t.c(),s=A(),_&&_.c(),l=A(),H(a.$$.fragment),o=A(),c=N("div"),h=A(),H(p.$$.fragment),u=A(),I&&I.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var $=K(e);n=E($,"DIV",{class:!0});var S=K(n);t.l(S),s=O(S),_&&_.l(S),l=O(S),J(a.$$.fragment,S),o=O(S),c=E(S,"DIV",{class:!0}),K(c).forEach(g),h=O(S),J(p.$$.fragment,S),S.forEach(g),u=O($),I&&I.l($),$.forEach(g),this.h()},h(){v(c,"class","flex-1"),v(n,"class","server-sidebar-container"),v(e,"class","grid-container")},m(f,$){C(f,e,$),y(e,n),w[r].m(n,null),y(n,s),_&&_.m(n,null),y(n,l),U(a,n,null),y(n,o),y(n,c),y(n,h),U(p,n,null),y(e,u),I&&I.m(e,null),m=!0},p(f,[$]){let S=r;r=j(f),r===S?w[r].p(f,$):(B(),k(w[S],1,1,()=>{w[S]=null}),P(),t=w[r],t?t.p(f,$):(t=w[r]=V[r](f),t.c()),d(t,1),t.m(n,s)),f[1]!=null?_?(_.p(f,$),$&2&&d(_,1)):(_=ee(f),_.c(),d(_,1),_.m(n,l)):_&&(B(),k(_,1,1,()=>{_=null}),P()),I&&I.p&&(!m||$&32)&&ce(I,R,f,f[5],m?ue(R,f[5],$,null):fe(f[5]),null)},i(f){m||(d(t),d(_),d(a.$$.fragment,f),d(p.$$.fragment,f),d(I,f),m=!0)},o(f){k(t),k(_),k(a.$$.fragment,f),k(p.$$.fragment,f),k(I,f),m=!1},d(f){f&&g(e),w[r].d(),_&&_.d(),q(a),q(p),I&&I.d(f)}}}function Ve(i,e,n){let r,t,{$$slots:s={},$$scope:l}=e;const a=Q(de);T(i,a,u=>n(2,t=u));const o=Q(ge),c=Z();T(i,c,u=>n(7,r=u));const h=Z();W(be,h),W(ve,c);let p=o.api.cache.servers;return a.subscribe(u=>{n(1,p=p==null?void 0:p.sort((m,V)=>{var _,R;const w=((_=u.ordering.servers)==null?void 0:_.indexOf(m._id))??-1,j=((R=u.ordering.servers)==null?void 0:R.indexOf(V._id))??-1;return j==-1?-1:w==-1?1:w-j}))}),o.on("ServerCreate",({server:u,channels:m})=>{n(0,o.api.cache.channels=o.api.cache.channels.concat(m),o),o.api.cache.servers.push(u),n(1,p=o.api.cache.servers)}),o.on("ServerDelete",async({id:u})=>{n(0,o.api.cache.channels=o.api.cache.channels.filter(m=>m.channel_type=="TextChannel"||m.channel_type=="VoiceChannel"?m.server!=u:!0),o),n(0,o.api.cache.servers=o.api.cache.servers.filter(m=>m._id!=u),o),n(1,p=o.api.cache.servers),r==u&&await pe(`${D}/`)}),_e(()=>{const u=localStorage.getItem("settings");u!=null&&a.set(JSON.parse(u)),a.subscribe(m=>{localStorage.setItem("settings",JSON.stringify(m))})}),o.on("Ready",async u=>{n(1,p=u.servers);const m=await o.api.fetchSettings(["ordering"]);if(m.ordering==null)return;const[V,w]=m.ordering;V>Number(localStorage.getItem("revision:ordering"))&&(localStorage.setItem("revision:ordering",V.toString()),a.update(j=>j.ordering=JSON.parse(w).servers))}),i.$$set=u=>{"$$scope"in u&&n(5,l=u.$$scope)},[o,p,t,a,c,l,s]}class Ge extends ne{constructor(e){super(),se(this,e,Ve,Oe,te,{})}}export{Ge as component};
