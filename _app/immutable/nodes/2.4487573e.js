import{s as re,n as F,f as J,d as le,u as ae,g as ce,e as fe,c as M}from"../chunks/scheduler.a21a5cad.js";import{S as te,i as ne,g as D,m as se,s as K,h as C,j as V,n as oe,f as v,c as O,k as g,a as N,x as I,o as ie,r as T,u as L,v as R,t as b,b as H,d,w as q,e as P,p as U,y as ue}from"../chunks/index.4419476b.js";import{e as z}from"../chunks/each.e59479a4.js";import{g as _e}from"../chunks/navigation.f2c84192.js";import{b as E}from"../chunks/paths.360ae9bd.js";import{g as B,s as Q,a as he,b as pe,c as me}from"../chunks/context.898bb4a8.js";/* empty css                      */import{D as de,g as W,a as X}from"../chunks/util.c62b600d.js";import{s as ge,a as be}from"../chunks/context.fa34f1f8.js";import{w as Y}from"../chunks/index.d8292243.js";function ve(l){let r,t;return{c(){r=D("img"),this.h()},l(e){r=C(e,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){g(r,"class","sidebar-icon group-hover:rounded-xl group-hover:bg-green-600 group-hover:text-white"),J(r.src,t=l[2])||g(r,"src",t),g(r,"alt",l[1])},m(e,n){N(e,r,n)},p(e,n){n&4&&!J(r.src,t=e[2])&&g(r,"src",t),n&2&&g(r,"alt",e[1])},d(e){e&&v(r)}}}function ke(l){let r,t;return{c(){r=D("span"),t=se(l[3]),this.h()},l(e){r=C(e,"SPAN",{class:!0});var n=V(r);t=oe(n,l[3]),n.forEach(v),this.h()},h(){g(r,"class","sidebar-icon group-hover:rounded-xl group-hover:bg-green-600 group-hover:text-white overflow-ellipsis")},m(e,n){N(e,r,n),I(r,t)},p(e,n){n&8&&ie(t,e[3])},d(e){e&&v(r)}}}function $e(l){let r,t,e,n,o;function i(c,h){return c[2]==null?ke:ve}let a=i(l),s=a(l);return{c(){r=D("div"),t=D("span"),e=se(l[1]),n=K(),o=D("a"),s.c(),this.h()},l(c){r=C(c,"DIV",{class:!0});var h=V(r);t=C(h,"SPAN",{class:!0});var p=V(t);e=oe(p,l[1]),p.forEach(v),n=O(h),o=C(h,"A",{href:!0,"aria-label":!0});var _=V(o);s.l(_),_.forEach(v),h.forEach(v),this.h()},h(){g(t,"class","sidebar-tooltip group-hover:scale-100"),g(o,"href",l[0]),g(o,"aria-label",l[1]),g(r,"class","group m-0")},m(c,h){N(c,r,h),I(r,t),I(t,e),I(r,n),I(r,o),s.m(o,null)},p(c,[h]){h&2&&ie(e,c[1]),a===(a=i(c))&&s?s.p(c,h):(s.d(1),s=a(c),s&&(s.c(),s.m(o,null))),h&1&&g(o,"href",c[0]),h&2&&g(o,"aria-label",c[1])},i:F,o:F,d(c){c&&v(r),s.d()}}}function Se(l,r,t){let e,{href:n}=r,{tooltip:o}=r,{icon:i=void 0}=r;return l.$$set=a=>{"href"in a&&t(0,n=a.href),"tooltip"in a&&t(1,o=a.tooltip),"icon"in a&&t(2,i=a.icon)},l.$$.update=()=>{l.$$.dirty&2&&t(3,e=o.split(" ").map(a=>a[0]).join(""))},[n,o,i,e]}class G extends te{constructor(r){super(),ne(this,r,Se,$e,re,{href:0,tooltip:1,icon:2})}}function Z(l,r,t){const e=l.slice();return e[10]=r[t],e}function ye(l){let r,t,e,n;return r=new G({props:{href:E,tooltip:l[0].user.username+"#"+l[0].user.discriminator,icon:W(l[0].user)}}),{c(){T(r.$$.fragment),t=K(),e=D("hr"),this.h()},l(o){L(r.$$.fragment,o),t=O(o),e=C(o,"HR",{class:!0}),this.h()},h(){g(e,"class","border-gray-600 mx-4")},m(o,i){R(r,o,i),N(o,t,i),N(o,e,i),n=!0},p(o,i){const a={};i&1&&(a.tooltip=o[0].user.username+"#"+o[0].user.discriminator),i&1&&(a.icon=W(o[0].user)),r.$set(a)},i(o){n||(d(r.$$.fragment,o),n=!0)},o(o){b(r.$$.fragment,o),n=!1},d(o){o&&(v(t),v(e)),q(r,o)}}}function Ie(l){let r,t;return r=new G({props:{href:E,tooltip:"Home",icon:"/home.svg"}}),{c(){T(r.$$.fragment)},l(e){L(r.$$.fragment,e)},m(e,n){R(r,e,n),t=!0},p:F,i(e){t||(d(r.$$.fragment,e),t=!0)},o(e){b(r.$$.fragment,e),t=!1},d(e){q(r,e)}}}function x(l){let r,t,e=z(l[1]),n=[];for(let i=0;i<e.length;i+=1)n[i]=ee(Z(l,e,i));const o=i=>b(n[i],1,1,()=>{n[i]=null});return{c(){for(let i=0;i<n.length;i+=1)n[i].c();r=P()},l(i){for(let a=0;a<n.length;a+=1)n[a].l(i);r=P()},m(i,a){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(i,a);N(i,r,a),t=!0},p(i,a){if(a&6){e=z(i[1]);let s;for(s=0;s<e.length;s+=1){const c=Z(i,e,s);n[s]?(n[s].p(c,a),d(n[s],1)):(n[s]=ee(c),n[s].c(),d(n[s],1),n[s].m(r.parentNode,r))}for(U(),s=e.length;s<n.length;s+=1)o(s);H()}},i(i){if(!t){for(let a=0;a<e.length;a+=1)d(n[a]);t=!0}},o(i){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)b(n[a]);t=!1},d(i){i&&v(r),ue(n,i)}}}function we(l){let r,t;return r=new G({props:{href:E+"/servers/"+l[10]._id+"/channels/"+l[10].channels[0],tooltip:l[10].name,icon:l[10].icon==null?void 0:`${X(l[10].icon,{max_side:"256"})}`}}),{c(){T(r.$$.fragment)},l(e){L(r.$$.fragment,e)},m(e,n){R(r,e,n),t=!0},p(e,n){const o={};n&2&&(o.href=E+"/servers/"+e[10]._id+"/channels/"+e[10].channels[0]),n&2&&(o.tooltip=e[10].name),n&2&&(o.icon=e[10].icon==null?void 0:`${X(e[10].icon,{max_side:"256"})}`),r.$set(o)},i(e){t||(d(r.$$.fragment,e),t=!0)},o(e){b(r.$$.fragment,e),t=!1},d(e){q(r,e)}}}function De(l){let r,t;return r=new G({props:{href:E+"/servers/"+l[10]._id+"/channels/"+l[10].channels[0],tooltip:l[10].name}}),{c(){T(r.$$.fragment)},l(e){L(r.$$.fragment,e)},m(e,n){R(r,e,n),t=!0},p(e,n){const o={};n&2&&(o.href=E+"/servers/"+e[10]._id+"/channels/"+e[10].channels[0]),n&2&&(o.tooltip=e[10].name),r.$set(o)},i(e){t||(d(r.$$.fragment,e),t=!0)},o(e){b(r.$$.fragment,e),t=!1},d(e){q(r,e)}}}function ee(l){let r,t,e,n;const o=[De,we],i=[];function a(s,c){return s[2]["jolt:low-data-mode"]?0:1}return r=a(l),t=i[r]=o[r](l),{c(){t.c(),e=P()},l(s){t.l(s),e=P()},m(s,c){i[r].m(s,c),N(s,e,c),n=!0},p(s,c){let h=r;r=a(s),r===h?i[r].p(s,c):(U(),b(i[h],1,1,()=>{i[h]=null}),H(),t=i[r],t?t.p(s,c):(t=i[r]=o[r](s),t.c()),d(t,1),t.m(e.parentNode,e))},i(s){n||(d(t),n=!0)},o(s){b(t),n=!1},d(s){s&&v(e),i[r].d(s)}}}function Ce(l){let r,t,e,n,o,i,a,s,c,h,p,_,m;const j=[Ie,ye],k=[];function A(f,$){return f[2]["jolt:low-data-mode"]?0:f[0].user!=null?1:-1}~(e=A(l))&&(n=k[e]=j[e](l));let u=l[1]!=null&&x(l);a=new G({props:{href:E+"/servers/create",icon:"/plus.svg",tooltip:"Create Server"}}),p=new G({props:{href:E+"/settings",icon:"/gears.svg",tooltip:"Settings"}});const w=l[6].default,y=le(w,l,l[5],null);return{c(){r=D("div"),t=D("div"),n&&n.c(),o=K(),u&&u.c(),i=K(),T(a.$$.fragment),s=K(),c=D("div"),h=K(),T(p.$$.fragment),_=K(),y&&y.c(),this.h()},l(f){r=C(f,"DIV",{class:!0});var $=V(r);t=C($,"DIV",{class:!0});var S=V(t);n&&n.l(S),o=O(S),u&&u.l(S),i=O(S),L(a.$$.fragment,S),s=O(S),c=C(S,"DIV",{class:!0}),V(c).forEach(v),h=O(S),L(p.$$.fragment,S),S.forEach(v),_=O($),y&&y.l($),$.forEach(v),this.h()},h(){g(c,"class","flex-1"),g(t,"class","server-sidebar-container"),g(r,"class","grid-container")},m(f,$){N(f,r,$),I(r,t),~e&&k[e].m(t,null),I(t,o),u&&u.m(t,null),I(t,i),R(a,t,null),I(t,s),I(t,c),I(t,h),R(p,t,null),I(r,_),y&&y.m(r,null),m=!0},p(f,[$]){let S=e;e=A(f),e===S?~e&&k[e].p(f,$):(n&&(U(),b(k[S],1,1,()=>{k[S]=null}),H()),~e?(n=k[e],n?n.p(f,$):(n=k[e]=j[e](f),n.c()),d(n,1),n.m(t,o)):n=null),f[1]!=null?u?(u.p(f,$),$&2&&d(u,1)):(u=x(f),u.c(),d(u,1),u.m(t,i)):u&&(U(),b(u,1,1,()=>{u=null}),H()),y&&y.p&&(!m||$&32)&&ae(y,w,f,f[5],m?fe(w,f[5],$,null):ce(f[5]),null)},i(f){m||(d(n),d(u),d(a.$$.fragment,f),d(p.$$.fragment,f),d(y,f),m=!0)},o(f){b(n),b(u),b(a.$$.fragment,f),b(p.$$.fragment,f),b(y,f),m=!1},d(f){f&&v(r),~e&&k[e].d(),u&&u.d(),q(a),q(p),y&&y.d(f)}}}function Ee(l,r,t){let e,n,{$$slots:o={},$$scope:i}=r;const a=B(he);M(l,a,_=>t(2,n=_)),B(pe);const s=B(me),c=Y();M(l,c,_=>t(7,e=_));const h=Y();Q(ge,h),Q(be,c);let p=s.api.cache.servers;return a.subscribe(_=>{t(1,p=p==null?void 0:p.sort((m,j)=>{var u,w;const k=((u=_.ordering.servers)==null?void 0:u.indexOf(m._id))??-1,A=((w=_.ordering.servers)==null?void 0:w.indexOf(j._id))??-1;return A==-1?-1:k==-1?1:k-A}))}),s.on("ServerCreate",({server:_,channels:m})=>{t(0,s.api.cache.channels=s.api.cache.channels.concat(m),s),s.api.cache.servers.push(_),t(1,p=s.api.cache.servers)}),s.on("ServerDelete",async({id:_})=>{t(0,s.api.cache.channels=s.api.cache.channels.filter(m=>m.channel_type=="TextChannel"||m.channel_type=="VoiceChannel"?m.server!=_:!0),s),t(0,s.api.cache.servers=s.api.cache.servers.filter(m=>m._id!=_),s),t(1,p=s.api.cache.servers),e==_&&await _e(E)}),s.on("Ready",async _=>{t(1,p=_.servers);const m=await s.api.fetchSettings(Object.keys(de));a.update(j=>{for(const[k,[A,u]]of Object.entries(m)){const w=`revision:${k}`;A<Number(localStorage.getItem(w))||(j[k]=JSON.parse(u),localStorage.setItem(w,A.toString()))}return j})}),l.$$set=_=>{"$$scope"in _&&t(5,i=_.$$scope)},[s,p,n,a,c,i,o]}class Ge extends te{constructor(r){super(),ne(this,r,Ee,Ce,re,{})}}export{Ge as component};
