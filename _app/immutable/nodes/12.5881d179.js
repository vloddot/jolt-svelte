import{s as q,f as z,c as B}from"../chunks/scheduler.bc65eea2.js";import{S as J,i as K,g as k,s as E,h as y,j as w,f as v,c as I,k as g,a as A,x as b,A as F,d,p as L,b as N,t as $,y as H,r as R,m as Q,u as T,n as W,v as V,o as X,w as P,e as U}from"../chunks/index.cf715be0.js";import{g as G,v as Y}from"../chunks/context.90bee080.js";import{T as Z}from"../chunks/TextChat.0fd83586.js";import{e as x}from"../chunks/each.e59479a4.js";import{b as ee}from"../chunks/util.892acc65.js";import{R as te}from"../chunks/RoundedImage.78a8751c.js";import{c as ne}from"../chunks/context.125d2488.js";const ae=""+new URL("../assets/phone.860bd0f7.svg",import.meta.url).href;function M(c,t,n){const e=c.slice();e[6]=t[n].user;const a=ee(e[6]);return e[7]=a,e}function S(c){let t,n,e,a,r=c[7]+"",u,h,s;return n=new te({props:{name:c[7],src:c[6].generateAvatarURL({max_side:256}),width:100,height:100,inline:!1}}),{c(){t=k("div"),R(n.$$.fragment),e=E(),a=k("span"),u=Q(r),h=E(),this.h()},l(l){t=y(l,"DIV",{class:!0});var m=w(t);T(n.$$.fragment,m),e=I(m),a=y(m,"SPAN",{class:!0});var p=w(a);u=W(p,r),p.forEach(v),h=I(m),m.forEach(v),this.h()},h(){g(a,"class","align-center text-sm"),g(t,"class","flex flex-col m-2")},m(l,m){A(l,t,m),V(n,t,null),b(t,e),b(t,a),b(a,u),b(t,h),s=!0},p(l,m){const p={};m&1&&(p.name=l[7]),m&1&&(p.src=l[6].generateAvatarURL({max_side:256})),n.$set(p),(!s||m&1)&&r!==(r=l[7]+"")&&X(u,r)},i(l){s||(d(n.$$.fragment,l),s=!0)},o(l){$(n.$$.fragment,l),s=!1},d(l){l&&v(t),P(n)}}}function le(c){let t,n,e,a,r,u,h,s,l,m,p=x(c[0].values()),o=[];for(let i=0;i<p.length;i+=1)o[i]=S(M(c,p,i));const O=i=>$(o[i],1,1,()=>{o[i]=null});return{c(){t=k("div"),n=k("button"),e=k("img"),u=E(),h=k("div");for(let i=0;i<o.length;i+=1)o[i].c();this.h()},l(i){t=y(i,"DIV",{class:!0});var _=w(t);n=y(_,"BUTTON",{class:!0});var f=w(n);e=y(f,"IMG",{src:!0,alt:!0,width:!0,height:!0}),f.forEach(v),u=I(_),h=y(_,"DIV",{class:!0});var C=w(h);for(let D=0;D<o.length;D+=1)o[D].l(C);C.forEach(v),_.forEach(v),this.h()},h(){z(e.src,a=ae)||g(e,"src",a),g(e,"alt",r=c[1].connected?"Leave Call":"Join Call"),g(e,"width",24),g(e,"height",24),g(n,"class","m-2"),g(h,"class","flex justify-center"),g(t,"class","main-content-container")},m(i,_){A(i,t,_),b(t,n),b(n,e),b(t,u),b(t,h);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(h,null);s=!0,l||(m=F(n,"click",c[5]),l=!0)},p(i,[_]){if((!s||_&2&&r!==(r=i[1].connected?"Leave Call":"Join Call"))&&g(e,"alt",r),_&1){p=x(i[0].values());let f;for(f=0;f<p.length;f+=1){const C=M(i,p,f);o[f]?(o[f].p(C,_),d(o[f],1)):(o[f]=S(C),o[f].c(),d(o[f],1),o[f].m(h,null))}for(L(),f=p.length;f<o.length;f+=1)O(f);N()}},i(i){if(!s){for(let _=0;_<p.length;_+=1)d(o[_]);s=!0}},o(i){o=o.filter(Boolean);for(let _=0;_<o.length;_+=1)$(o[_]);s=!1},d(i){i&&v(t),H(o,i),l=!1,m()}}}function re(c,t,n){let e,{channel:a}=t;const r=G(Y);B(c,r,l=>n(1,e=l));let u=new Map;e.participants.onUpdate(()=>n(0,u=e.participants));function h(){Promise.all([navigator.mediaDevices.getUserMedia({audio:!0}),e.connect(a._id)]).then(([l])=>{const m=l.getAudioTracks()[0];e.play("audio",m)})}const s=()=>e.connected?e.disconnect():h();return c.$$set=l=>{"channel"in l&&n(4,a=l.channel)},[u,e,r,h,a,s]}class se extends J{constructor(t){super(),K(this,t,re,le,q,{channel:4})}}function j(c){let t,n,e,a;const r=[oe,ce],u=[];function h(s,l){return s[0].channel_type=="VoiceChannel"?0:1}return t=h(c),n=u[t]=r[t](c),{c(){n.c(),e=U()},l(s){n.l(s),e=U()},m(s,l){u[t].m(s,l),A(s,e,l),a=!0},p(s,l){let m=t;t=h(s),t===m?u[t].p(s,l):(L(),$(u[m],1,1,()=>{u[m]=null}),N(),n=u[t],n?n.p(s,l):(n=u[t]=r[t](s),n.c()),d(n,1),n.m(e.parentNode,e))},i(s){a||(d(n),a=!0)},o(s){$(n),a=!1},d(s){s&&v(e),u[t].d(s)}}}function ce(c){let t,n;return t=new Z({props:{channel:c[0]}}),{c(){R(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,a){V(t,e,a),n=!0},p(e,a){const r={};a&1&&(r.channel=e[0]),t.$set(r)},i(e){n||(d(t.$$.fragment,e),n=!0)},o(e){$(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}function oe(c){let t,n;return t=new se({props:{channel:c[0]}}),{c(){R(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,a){V(t,e,a),n=!0},p(e,a){const r={};a&1&&(r.channel=e[0]),t.$set(r)},i(e){n||(d(t.$$.fragment,e),n=!0)},o(e){$(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}function ie(c){let t,n,e=c[0]!=null&&j(c);return{c(){e&&e.c(),t=U()},l(a){e&&e.l(a),t=U()},m(a,r){e&&e.m(a,r),A(a,t,r),n=!0},p(a,[r]){a[0]!=null?e?(e.p(a,r),r&1&&d(e,1)):(e=j(a),e.c(),d(e,1),e.m(t.parentNode,t)):e&&(L(),$(e,1,1,()=>{e=null}),N())},i(a){n||(d(e),n=!0)},o(a){$(e),n=!1},d(a){a&&v(t),e&&e.d(a)}}}function fe(c,t,n){let e;const a=G(ne);return B(c,a,r=>n(0,e=r)),[e,a]}class $e extends J{constructor(t){super(),K(this,t,fe,ie,q,{})}}export{$e as component};
