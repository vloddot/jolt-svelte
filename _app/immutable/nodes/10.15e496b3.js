import{s as B,f as O,c as K}from"../chunks/scheduler.236f7e20.js";import{S as L,i as R,g as b,s as E,h as k,j as C,f as d,c as N,k as $,a as w,x as v,z as F,d as h,p as P,b as V,t as g,y as H,r as x,m as J,u as A,n as Q,v as I,o as W,w as M,e as U}from"../chunks/index.bae008e4.js";import{g as z,v as X}from"../chunks/context.0e1cc50f.js";import{C as Y}from"../chunks/index.34c90590.js";import{e as S}from"../chunks/each.e59479a4.js";import{b as Z}from"../chunks/paths.1834ca32.js";import{b as ee}from"../chunks/util.28502bf1.js";import{U as te}from"../chunks/UserProfilePicture.d1bcb4d0.js";import{c as ne}from"../chunks/context.dd405c9c.js";function T(o,t,n){const e=o.slice();e[6]=t[n].user;const a=ee(e[6]);return e[7]=a,e}function j(o){let t,n,e,a,s=o[7]+"",i,p,c;return n=new te({props:{name:o[7],src:o[6].generateAvatarURL({max_side:256}),width:100,height:100,inline:!1}}),{c(){t=b("div"),x(n.$$.fragment),e=E(),a=b("span"),i=J(s),p=E(),this.h()},l(l){t=k(l,"DIV",{class:!0});var f=C(t);A(n.$$.fragment,f),e=N(f),a=k(f,"SPAN",{class:!0});var r=C(a);i=Q(r,s),r.forEach(d),p=N(f),f.forEach(d),this.h()},h(){$(a,"class","align-center text-sm"),$(t,"class","flex flex-col m-2")},m(l,f){w(l,t,f),I(n,t,null),v(t,e),v(t,a),v(a,i),v(t,p),c=!0},p(l,f){const r={};f&1&&(r.name=l[7]),f&1&&(r.src=l[6].generateAvatarURL({max_side:256})),n.$set(r),(!c||f&1)&&s!==(s=l[7]+"")&&W(i,s)},i(l){c||(h(n.$$.fragment,l),c=!0)},o(l){g(n.$$.fragment,l),c=!1},d(l){l&&d(t),M(n)}}}function ae(o){let t,n,e,a,s,i,p,c,l,f=S(o[0].values()),r=[];for(let u=0;u<f.length;u+=1)r[u]=j(T(o,f,u));const G=u=>g(r[u],1,1,()=>{r[u]=null});return{c(){t=b("div"),n=b("button"),e=b("img"),s=E(),i=b("div");for(let u=0;u<r.length;u+=1)r[u].c();this.h()},l(u){t=k(u,"DIV",{class:!0});var _=C(t);n=k(_,"BUTTON",{class:!0});var m=C(n);e=k(m,"IMG",{src:!0,alt:!0}),m.forEach(d),s=N(_),i=k(_,"DIV",{class:!0});var y=C(i);for(let D=0;D<r.length;D+=1)r[D].l(y);y.forEach(d),_.forEach(d),this.h()},h(){O(e.src,a=Z+"/call.svg")||$(e,"src",a),$(e,"alt","Call"),$(n,"class","m-2"),$(i,"class","flex justify-center"),$(t,"class","main-content-container")},m(u,_){w(u,t,_),v(t,n),v(n,e),v(t,s),v(t,i);for(let m=0;m<r.length;m+=1)r[m]&&r[m].m(i,null);p=!0,c||(l=F(n,"click",o[5]),c=!0)},p(u,[_]){if(_&1){f=S(u[0].values());let m;for(m=0;m<f.length;m+=1){const y=T(u,f,m);r[m]?(r[m].p(y,_),h(r[m],1)):(r[m]=j(y),r[m].c(),h(r[m],1),r[m].m(i,null))}for(P(),m=f.length;m<r.length;m+=1)G(m);V()}},i(u){if(!p){for(let _=0;_<f.length;_+=1)h(r[_]);p=!0}},o(u){r=r.filter(Boolean);for(let _=0;_<r.length;_+=1)g(r[_]);p=!1},d(u){u&&d(t),H(r,u),c=!1,l()}}}function re(o,t,n){let e,{channel:a}=t;const s=z(X);K(o,s,l=>n(1,e=l));let i=new Map;e.participants.onUpdate(()=>n(0,i=e.participants));function p(){Promise.all([navigator.mediaDevices.getUserMedia({audio:!0}),e.connect(a._id)]).then(([l,f])=>{const r=l.getAudioTracks()[0];e.play("audio",r)})}const c=()=>e.connected?e.disconnect():p();return o.$$set=l=>{"channel"in l&&n(4,a=l.channel)},[i,e,s,p,a,c]}class le extends L{constructor(t){super(),R(this,t,re,ae,B,{channel:4})}}function q(o){let t,n,e,a;const s=[ce,se],i=[];function p(c,l){return c[0].channel_type=="VoiceChannel"?0:1}return t=p(o),n=i[t]=s[t](o),{c(){n.c(),e=U()},l(c){n.l(c),e=U()},m(c,l){i[t].m(c,l),w(c,e,l),a=!0},p(c,l){let f=t;t=p(c),t===f?i[t].p(c,l):(P(),g(i[f],1,1,()=>{i[f]=null}),V(),n=i[t],n?n.p(c,l):(n=i[t]=s[t](c),n.c()),h(n,1),n.m(e.parentNode,e))},i(c){a||(h(n),a=!0)},o(c){g(n),a=!1},d(c){c&&d(e),i[t].d(c)}}}function se(o){let t,n;return t=new Y({props:{channel:o[0]}}),{c(){x(t.$$.fragment)},l(e){A(t.$$.fragment,e)},m(e,a){I(t,e,a),n=!0},p(e,a){const s={};a&1&&(s.channel=e[0]),t.$set(s)},i(e){n||(h(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){M(t,e)}}}function ce(o){let t,n;return t=new le({props:{channel:o[0]}}),{c(){x(t.$$.fragment)},l(e){A(t.$$.fragment,e)},m(e,a){I(t,e,a),n=!0},p(e,a){const s={};a&1&&(s.channel=e[0]),t.$set(s)},i(e){n||(h(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){M(t,e)}}}function oe(o){let t,n,e=o[0]!=null&&q(o);return{c(){e&&e.c(),t=U()},l(a){e&&e.l(a),t=U()},m(a,s){e&&e.m(a,s),w(a,t,s),n=!0},p(a,[s]){a[0]!=null?e?(e.p(a,s),s&1&&h(e,1)):(e=q(a),e.c(),h(e,1),e.m(t.parentNode,t)):e&&(P(),g(e,1,1,()=>{e=null}),V())},i(a){n||(h(e),n=!0)},o(a){g(e),n=!1},d(a){a&&d(t),e&&e.d(a)}}}function ie(o,t,n){let e;const a=z(ne);return K(o,a,s=>n(0,e=s)),[e,a]}class $e extends L{constructor(t){super(),R(this,t,ie,oe,B,{})}}export{$e as component};
