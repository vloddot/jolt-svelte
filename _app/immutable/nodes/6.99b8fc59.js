import{s as Z,f as M,l as ue,a as w,g as N,h as T,m as _e,d as g,c as I,j as V,i as b,z as S,n as he,G,e as K,u as _,v as x,w as ee,x as te,y as ne,r as E,K as me}from"../chunks/scheduler.fede8105.js";import{h as A,u as le}from"../chunks/await_block.ecc72e0a.js";import{e as y}from"../chunks/each.e59479a4.js";import{S as oe,i as ce,a as m,g as v,c as C,t as d,b as L,d as R,m as U,e as j}from"../chunks/index.257844fa.js";import{p as pe}from"../chunks/stores.59649557.js";import{g as D,c as re,s as q}from"../chunks/context.682cab63.js";import{C as ae}from"../chunks/Channel.a65355d1.js";import{s as de}from"../chunks/context.fa34f1f8.js";import{r as ge}from"../chunks/index.5e2a9a64.js";import{g as be}from"../chunks/chunk-NMUKSDLG.3f77d6f4.js";import{w as z}from"../chunks/index.3ac45322.js";import{c as ke}from"../chunks/context.125d2488.js";import{s as $e}from"../chunks/context.c622ed87.js";import{n as ye}from"../chunks/index.fdd37b7b.js";function J(o,n,r){const e=o.slice();return e[4]=n[r],e}const ve=o=>({channel:o&1}),P=o=>({channel:o[7]});function Ce(o){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function we(o){let n,r;const e=o[3].default,l=x(e,o,o[2],P);return{c(){l&&l.c(),n=w()},l(t){l&&l.l(t),n=I(t)},m(t,s){l&&l.m(t,s),b(t,n,s),r=!0},p(t,s){l&&l.p&&(!r||s&5)&&ee(l,e,t,t[2],r?ne(e,t[2],s,ve):te(t[2]),P)},i(t){r||(m(l,t),r=!0)},o(t){d(l,t),r=!1},d(t){t&&g(n),l&&l.d(t)}}}function Ie(o){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function Y(o){let n,r,e,l={ctx:o,current:null,token:null,hasCatch:!1,pending:Ie,then:we,catch:Ce,value:7,blocks:[,,,]};return A(r=o[1].api.fetchChannel(o[4]),l),{c(){n=K(),l.block.c()},l(t){n=K(),l.block.l(t)},m(t,s){b(t,n,s),l.block.m(t,l.anchor=s),l.mount=()=>n.parentNode,l.anchor=n,e=!0},p(t,s){o=t,l.ctx=o,s&1&&r!==(r=o[1].api.fetchChannel(o[4]))&&A(r,l)||le(l,o,s)},i(t){e||(m(l.block),e=!0)},o(t){for(let s=0;s<3;s+=1){const u=l.blocks[s];d(u)}e=!1},d(t){t&&g(n),l.block.d(t),l.token=null,l=null}}}function Ee(o){let n,r,e=o[0].title+"",l,t,s,u=y(o[0].channels),i=[];for(let a=0;a<u.length;a+=1)i[a]=Y(J(o,u,a));const k=a=>d(i[a],1,1,()=>{i[a]=null});return{c(){n=M("details"),r=M("summary"),l=ue(e),t=w();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){n=N(a,"DETAILS",{class:!0});var f=T(n);r=N(f,"SUMMARY",{class:!0});var c=T(r);l=_e(c,e),c.forEach(g),t=I(f);for(let p=0;p<i.length;p+=1)i[p].l(f);f.forEach(g),this.h()},h(){V(r,"class","svelte-vay0yf"),n.open=!0,V(n,"class","svelte-vay0yf")},m(a,f){b(a,n,f),S(n,r),S(r,l),S(n,t);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(n,null);s=!0},p(a,[f]){if((!s||f&1)&&e!==(e=a[0].title+"")&&he(l,e),f&7){u=y(a[0].channels);let c;for(c=0;c<u.length;c+=1){const p=J(a,u,c);i[c]?(i[c].p(p,f),m(i[c],1)):(i[c]=Y(p),i[c].c(),m(i[c],1),i[c].m(n,null))}for(v(),c=u.length;c<i.length;c+=1)k(c);C()}},i(a){if(!s){for(let f=0;f<u.length;f+=1)m(i[f]);s=!0}},o(a){i=i.filter(Boolean);for(let f=0;f<i.length;f+=1)d(i[f]);s=!1},d(a){a&&g(n),G(i,a)}}}function Se(o,n,r){let{$$slots:e={},$$scope:l}=n;const t=D(re);let{category:s}=n;return o.$$set=u=>{"category"in u&&r(0,s=u.category),"$$scope"in u&&r(2,l=u.$$scope)},[s,t,l,e]}class De extends oe{constructor(n){super(),ce(this,n,Se,Ee,Z,{category:0})}}function F(o,n,r){const e=o.slice();return e[15]=n[r],e}function H(o,n,r){const e=o.slice();return e[18]=n[r],e}function B(o){const n=o.slice(),r=n[0].categories??[];n[13]=r;const e=n[0].channels.filter(function(...t){return o[10](n[13],...t)})??[];return n[14]=e,n}function O(o){let n,r,e,l=y(o[14]),t=[];for(let a=0;a<l.length;a+=1)t[a]=Q(H(o,l,a));const s=a=>d(t[a],1,1,()=>{t[a]=null});let u=y(o[13]),i=[];for(let a=0;a<u.length;a+=1)i[a]=X(F(o,u,a));const k=a=>d(i[a],1,1,()=>{i[a]=null});return{c(){n=M("div");for(let a=0;a<t.length;a+=1)t[a].c();r=w();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){n=N(a,"DIV",{class:!0});var f=T(n);for(let c=0;c<t.length;c+=1)t[c].l(f);r=I(f);for(let c=0;c<i.length;c+=1)i[c].l(f);f.forEach(g),this.h()},h(){V(n,"class","channel-bar-container")},m(a,f){b(a,n,f);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(n,null);S(n,r);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(n,null);e=!0},p(a,f){if(f&3){l=y(a[14]);let c;for(c=0;c<l.length;c+=1){const p=H(a,l,c);t[c]?(t[c].p(p,f),m(t[c],1)):(t[c]=Q(p),t[c].c(),m(t[c],1),t[c].m(n,r))}for(v(),c=l.length;c<t.length;c+=1)s(c);C()}if(f&17){u=y(a[13]);let c;for(c=0;c<u.length;c+=1){const p=F(a,u,c);i[c]?(i[c].p(p,f),m(i[c],1)):(i[c]=X(p),i[c].c(),m(i[c],1),i[c].m(n,null))}for(v(),c=u.length;c<i.length;c+=1)k(c);C()}},i(a){if(!e){for(let f=0;f<l.length;f+=1)m(t[f]);for(let f=0;f<u.length;f+=1)m(i[f]);e=!0}},o(a){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)d(t[f]);i=i.filter(Boolean);for(let f=0;f<i.length;f+=1)d(i[f]);e=!1},d(a){a&&g(n),G(t,a),G(i,a)}}}function Ke(o){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function Ae(o){let n,r;return n=new ae({props:{channel:o[4]}}),{c(){L(n.$$.fragment)},l(e){R(n.$$.fragment,e)},m(e,l){U(n,e,l),r=!0},p(e,l){const t={};l&1&&(t.channel=e[4]),n.$set(t)},i(e){r||(m(n.$$.fragment,e),r=!0)},o(e){d(n.$$.fragment,e),r=!1},d(e){j(n,e)}}}function Be(o){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function Q(o){let n,r,e,l={ctx:o,current:null,token:null,hasCatch:!1,pending:Be,then:Ae,catch:Ke,value:4,blocks:[,,,]};return A(r=o[1].api.fetchChannel(o[18]),l),{c(){n=K(),l.block.c()},l(t){n=K(),l.block.l(t)},m(t,s){b(t,n,s),l.block.m(t,l.anchor=s),l.mount=()=>n.parentNode,l.anchor=n,e=!0},p(t,s){o=t,l.ctx=o,s&1&&r!==(r=o[1].api.fetchChannel(o[18]))&&A(r,l)||le(l,o,s)},i(t){e||(m(l.block),e=!0)},o(t){for(let s=0;s<3;s+=1){const u=l.blocks[s];d(u)}e=!1},d(t){t&&g(n),l.block.d(t),l.token=null,l=null}}}function W(o){let n,r;return n=new ae({props:{channel:o[4]}}),{c(){L(n.$$.fragment)},l(e){R(n.$$.fragment,e)},m(e,l){U(n,e,l),r=!0},p(e,l){const t={};l&16&&(t.channel=e[4]),n.$set(t)},i(e){r||(m(n.$$.fragment,e),r=!0)},o(e){d(n.$$.fragment,e),r=!1},d(e){j(n,e)}}}function Me(o){let n,r,e=o[4]!=null&&W(o);return{c(){e&&e.c(),n=w()},l(l){e&&e.l(l),n=I(l)},m(l,t){e&&e.m(l,t),b(l,n,t),r=!0},p(l,t){l[4]!=null?e?(e.p(l,t),t&16&&m(e,1)):(e=W(l),e.c(),m(e,1),e.m(n.parentNode,n)):e&&(v(),d(e,1,1,()=>{e=null}),C())},i(l){r||(m(e),r=!0)},o(l){d(e),r=!1},d(l){l&&g(n),e&&e.d(l)}}}function X(o){let n,r;return n=new De({props:{category:o[15],$$slots:{default:[Me,({channel:e})=>({4:e}),({channel:e})=>e?16:0]},$$scope:{ctx:o}}}),{c(){L(n.$$.fragment)},l(e){R(n.$$.fragment,e)},m(e,l){U(n,e,l),r=!0},p(e,l){const t={};l&1&&(t.category=e[15]),l&2064&&(t.$$scope={dirty:l,ctx:e}),n.$set(t)},i(e){r||(m(n.$$.fragment,e),r=!0)},o(e){d(n.$$.fragment,e),r=!1},d(e){j(n,e)}}}function Ne(o){let n,r,e=o[0]!=null&&O(B(o));const l=o[9].default,t=x(l,o,o[11],null);return{c(){e&&e.c(),n=w(),t&&t.c()},l(s){e&&e.l(s),n=I(s),t&&t.l(s)},m(s,u){e&&e.m(s,u),b(s,n,u),t&&t.m(s,u),r=!0},p(s,[u]){s[0]!=null?e?(e.p(B(s),u),u&1&&m(e,1)):(e=O(B(s)),e.c(),m(e,1),e.m(n.parentNode,n)):e&&(v(),d(e,1,1,()=>{e=null}),C()),t&&t.p&&(!r||u&2048)&&ee(t,l,s,s[11],r?ne(l,s[11],u,null):te(s[11]),null)},i(s){r||(m(e),m(t,s),r=!0)},o(s){d(e),d(t,s),r=!1},d(s){s&&g(n),e&&e.d(s),t&&t.d(s)}}}function Te(o,n,r){let e,l,t,s,u;E(o,pe,h=>r(8,u=h));let{$$slots:i={},$$scope:k}=n;const a=D(re),f=D($e);E(o,f,h=>r(0,t=h));const c=z();E(o,c,h=>r(6,l=h)),q(ke,c);const p=D(de)??z(e.cid);E(o,p,h=>r(7,s=h));async function se(h){const $=await a.api.fetchChannel(h);if($.channel_type!="TextChannel"&&$.channel_type!="VoiceChannel")throw ge(302,`/channels/${h}`);c.set($)}me(()=>{p.set(void 0)});const ie=(h,$)=>h.find(fe=>$!=null&&fe.channels.includes($))==null;return o.$$set=h=>{"$$scope"in h&&r(11,k=h.$$scope)},o.$$.update=()=>{if(o.$$.dirty&256&&r(5,e=u.params),o.$$.dirty&32&&p.set(e.cid),o.$$.dirty&128&&s&&se(s),o.$$.dirty&65){let h="Jolt - ";t==null?h+="Server":h+=t.name,l!=null&&(h+=` | #${l.name}`),"__TAURI__"in window?be.setTitle(h):document.title=h}if(o.$$.dirty&32){const h=document.getElementById(`MESSAGE-${e.mid}`);h==null?q(ye,e.mid):(h==null||h.scrollIntoView({behavior:"smooth",block:"center"}),h.animate([{backgroundColor:"var(--mention)"},{backgroundColor:"var(--mention)",offset:.6},{backgroundColor:"transparent"}],{duration:3e3,iterations:1,easing:"ease"}))}},[t,a,f,p,c,e,l,s,u,i,ie,k]}class Qe extends oe{constructor(n){super(),ce(this,n,Te,Ne,Z,{})}}export{Qe as component};
